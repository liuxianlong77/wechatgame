window.__require=function e(t,o,n){function a(r,s){if(!o[r]){if(!t[r]){var c=r.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+r+"'")}}var d=o[r]={exports:{}};t[r][0].call(d.exports,function(e){return a(t[r][1][e]||e)},d,d.exports,e,t,o,n)}return o[r].exports}for(var i="function"==typeof __require&&__require,r=0;r<n.length;r++)a(n[r]);return a}({ALConfig:[function(e,t,o){"use strict";cc._RF.push(t,"58a11/XmmFODI4v2afLwH+7","ALConfig"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.sdkVersion="2.2.2",e.envVersion="release",e.appId="",e.version="",e.openId="",e.unionId="",e.themeurl=null,e.draw_font_color=null,e.guesslike_font_color=null,e.RequestUrlDev="http://192.168.0.66:9996",e.RequestUrlTest="https://distribution-beta.boomegg.cn",e.RequestUrlPro="https://mprogram.boomegg.cn",e.RequestUrl=e.RequestUrlPro,e.sdkInitUrl=e.RequestUrl+"/box/sdk/init",e.baseUrl=e.RequestUrl+"/box/sdk/module",e.baseUrlV1=e.RequestUrl+"/box/sdk/list",e.ReportMarketDomain=e.RequestUrl,e.ReportDataDomain="https://distribute-stats.boomegg.cn",e.ImgDomain="https://ad-static.boomegg.cn",e.drawerSpriteV=e.ImgDomain+"/sprite0708.png",e.drawerSpriteH=e.ImgDomain+"/sprite0708H.png",e.boxSprite=e.ImgDomain+"/SDK/img/SDK_Gamebox.png",e.helpSprite=e.ImgDomain+"/SDK/img/refresh.png",e.MainBoxSprite=e.ImgDomain+"/haohaiyou.png",e.MainBoxAppID="wx4233cc143076bfdc",e.MarkerSprite=e.ImgDomain+"/marker/marker.png?t=",e.MarkerRect={mark1:{x:0,y:0,w:66,h:40},mark2:{x:66,y:0,w:66,h:40},mark3:{x:132,y:0,w:66,h:40},redpoint:{x:198,y:0,w:43,h:39}},e.DrawerPortrait={guesslike:{x:1,y:1,w:640,h:200},"background-s":{x:1,y:203,w:524,h:664},"refresh-s":{x:1,y:869,w:192,h:56},close:{x:195,y:869,w:34,h:34},mask:{x:196,y:906,w:2,h:2},aniWhite:{x:528,y:204,w:29,h:29},colorChange:{x:528,y:236,w:41,h:126}},e.DrawerLandscape={background:{x:1,y:1,w:692,h:470},close:{x:695,y:65,w:34,h:34},refresh:{x:643,y:473,w:72,h:180},mask:{x:644,y:656,w:2,h:2},guesslike:{x:1,y:473,w:640,h:200},aniWhite:{x:695,y:102,w:29,h:29},colorChange:{x:695,y:134,w:41,h:126}},e.BoxMap={orangePoint:{x:20,y:20,w:5,h:5},back_button1:{x:0,y:78,w:195,h:45},bottom_bg:{x:0,y:0,w:329,h:75},orange_point:{x:197,y:78,w:7,h:27}},e.HelpMap={unopenicon:{x:236,y:1,w:73,h:72},bg1:{x:1,y:75,w:270,h:89},openicon:{x:161,y:1,w:73,h:72},quanzi:{x:1,y:1,w:78,h:68},refresh:{x:81,y:1,w:78,h:68}},e}();o.ALConfig=n,cc._RF.pop()},{}],ALData:[function(e,t,o){"use strict";cc._RF.push(t,"b9330CX5qNBAq8CAHzmoCUX","ALData"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.opts=null,e.scene=0,e.shareScene=0,e.topInviter="0",e.inviter="0",e.level=1,e.score=1,e.isVertical=!1,e.isTSA=!1,e.allowShare=!1,e.appIdListStr="",e.sdkTexture=null,e.boxTexture=null,e.helpTexture=null,e.markerTexture=null,e.sdkData=null,e.moreData=null,e.iconData=null,e.boxData=null,e}();o.ALData=n,o.SDKAniInterval=Math.floor(100),o.SDKAniDelay=4e3,o.SDKGifSize=144,cc._RF.pop()},{}],ALGameBox:[function(e,t,o){"use strict";cc._RF.push(t,"85f6ePuauFA7J+ybPqFj6YH","ALGameBox"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./util/UIUtil"),a=e("./ALData"),i=e("./ALConfig"),r=e("./util/HttpUtil"),s=e("./util/ImgLoaderUtil"),c=e("./ALReport"),l=e("./ALSDK"),d=e("./UITableView"),h=e("./util/ALUtil"),u=function(){function e(){this._boxNode=null,this.CELL_BANNER_HEIGHT=240,this.CELL_BANNER_IDENTIFYT="Bannner",this.CELL_TITLE_HEIGHT=70,this.CELL_TITLE_IDENTIFYT="Title",this.CELL_ITEM_HEIGHT=280,this.CELL_ITEM_IDENTIFYT="Item",this._tableView=null,this._scrollNode=null,this._scrollContent=null,this._subScrollNode=null,this._subScrollContent=null,this._scrollViewMoved=!1,this._cb=null}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype._initNode=function(){if(this._boxNode)return this._boxNode;var e=n.UIUtil.parseGameUIFromJSON(p);this._boxNode=e;var t=e.children[0],o=e.children[1],i=this._adjustLayout();t.height+=i,o.width+=i;var r=t.children[1],s=t.children[2];s.height+=i;var c=s.children[0];c.height+=i;var l=s.getComponent(cc.ScrollView);l.content=c;var h=new d.UITableViewV({scrollview:l,content:c,allowScroll:a.ALData.isVertical,direction:d.ScrollDirection.Vertical,nodeEstimatedHeightOrWidthCB:this.nodeEstimatedHeightOrWidthCB.bind(this),nodeForIndexCB:this.nodeForIndexCB.bind(this)}),u=n.UIUtil.parseGameUIFromJSON(f),g=n.UIUtil.parseGameUIFromJSON(m),y=n.UIUtil.parseGameUIFromJSON(_);if(h.registerNodeTemplateOfKey(this.CELL_BANNER_IDENTIFYT,u),h.registerNodeTemplateOfKey(this.CELL_TITLE_IDENTIFYT,g),h.registerNodeTemplateOfKey(this.CELL_ITEM_IDENTIFYT,y),this._scrollContent=c,this._scrollNode=s,this._tableView=h,a.ALData.isVertical)l.vertical=!0,r.on(cc.Node.EventType.TOUCH_END,this._onBackClick,this),s.on(cc.Node.EventType.TOUCH_MOVE,this._onScrollViewMove,this),s.on(cc.Node.EventType.TOUCH_END,this._onScrollViewClick,this),o.removeFromParent(),o.destroy();else{l.vertical=!1,o.active=!0,o.children[0].on(cc.Node.EventType.TOUCH_END,this._onBackClick,this);var v=o.children[1];v.width+=i,this._subScrollNode=v;var w=v.children[0];w.width+=i,this._subScrollContent=w,v.getComponent(cc.ScrollView).content=w,v.on("scrolling",this.on_scrolling,this),v.on(cc.Node.EventType.TOUCH_MOVE,this._onScrollViewMove,this),v.on(cc.Node.EventType.TOUCH_END,this._onScrollViewClick,this)}return a.ALData.boxData?this._initContent():this._initData(),this._boxNode},e.prototype._adjustLayout=function(){var e=1,t=0;if(a.ALData.isVertical){e=cc.winSize.width/750;var o=this._boxNode.height*e;t=(cc.winSize.height-o)/e}else{this._boxNode.children[0].rotation=-90,e=cc.winSize.height/750;o=this._boxNode.height*e;t=(cc.winSize.width-o)/e}return t=Math.round(t),h.ALUtil.LOG("ALGameBox _adjustLayout delta&ratio ",t,e),this._boxNode.height+=t,this._boxNode.scale=e,t},e.prototype.on_scrolling=function(){var e=this._subScrollContent.x;this._tableView.scrollToY(-e)},e.prototype._initContent=function(){n.UIUtil.initBitmapOfNode(this._boxNode,a.ALData.boxTexture,i.ALConfig.BoxMap),this._tableView.set_data(a.ALData.boxData),this._subScrollContent&&(this._subScrollContent.width=this._tableView.estimateContentValue())},e.prototype._initData=function(){return __awaiter(this,void 0,void 0,function(){var e,t,o,n;return __generator(this,function(c){switch(c.label){case 0:return e={id:i.ALConfig.appId,module:"box",appidList:a.ALData.appIdListStr,sdk_version:i.ALConfig.sdkVersion,version:i.ALConfig.version},[4,r.HttpUtil.GET(i.ALConfig.baseUrlV1,e)];case 1:return t=c.sent(),o=i.ALConfig.boxSprite,[4,s.ImgLoaderUtil.getImgByUrl(o)];case 2:return n=c.sent(),[4,Promise.all([t,n])];case 3:return c.sent(),t.isSucc&&n.isSucc?(this._handleData(t.data),a.ALData.boxTexture=n.texture,this._initContent(),[2]):(console.warn("ALGameBox init info fail !!!",t.reason),this.hideNode(),[2])}})})},e.prototype._handleData=function(e){var t=new Array,o=e.values||[],n=e.base;if(n&&o.length>0)for(var i=0,r=o.length;i<r;i++){var s=o[i];s[4]=n+s[4]}var c=e.hot_title||[],l=c.length,d=o.length,u=0;for(i=0;i<l;i++){var p=c[i],f=p.count;f=u+f>=d?d-u:f;var m=o.slice(u,u+f);if(m.length<1)break;t.push(p),u+=f;var _=null,g=0;for(r=m.length;g<r;g++)g%2==0&&(_=new Array,t.push(_)),_.push(m[g])}h.ALUtil.LOG("ALGameBox _handleData boxData",t),a.ALData.boxData=t},e.prototype.nodeEstimatedHeightOrWidthCB=function(e,t,o){return o instanceof Array?o.length>2?this.CELL_BANNER_HEIGHT:this.CELL_ITEM_HEIGHT:this.CELL_TITLE_HEIGHT},e.prototype.nodeForIndexCB=function(e,t,o){if(o instanceof Array){if(o.length>2){var r=e.obtainNodeOfKey(this.CELL_BANNER_IDENTIFYT);r.name=t+"";var c=o,l=r.getComponent(cc.Sprite);return c[9]?l.spriteFrame=c[9]:s.ImgLoaderUtil.getImgByUrl(c[4]).then(function(e){e.isSucc?(c[9]=new cc.SpriteFrame(e.texture),l.spriteFrame=c[9]):h.ALUtil.LOG(e.info)}),r}var d=e.obtainNodeOfKey(this.CELL_ITEM_IDENTIFYT);d.name=t+"";var u=(g=o)[0],p=d.children[0];this._initCellItem(p,u);var f=g[1],m=d.children[1];return f?(m.active=!0,this._initCellItem(m,f)):m.active=!1,d}var _=e.obtainNodeOfKey(this.CELL_TITLE_IDENTIFYT),g=o,y=_.children[0];return n.UIUtil.initBitmap(y,y.name,a.ALData.boxTexture,i.ALConfig.BoxMap),_.children[1].getComponent(cc.Label).string=g.title,_},e.prototype._initCellItem=function(e,t){var o=parseInt(e.parent.name),r=e.children[0].getComponent(cc.Sprite);t[9]?r.spriteFrame=t[9]:s.ImgLoaderUtil.getImgByUrl(t[4]).then(function(e){if(e.isSucc){t[9]=new cc.SpriteFrame(e.texture);var n=parseInt(r.node.parent.parent.name);h.ALUtil.LOG("ALGameBox getImgByUrl itemIndex",n),o===n&&(r.spriteFrame=t[9])}else h.ALUtil.LOG(e.info)});var c=e.children[1];n.UIUtil.initBitmap(c,c.name,a.ALData.boxTexture,i.ALConfig.BoxMap);var l=e.children[2].getComponent(cc.Label),d=e.children[3].getComponent(cc.Label);l.string=t[5],d.string=t[7]},e.prototype._onBackClick=function(){h.ALUtil.LOG("ALGameBox _onBackClick"),this.hideNode()},e.prototype._onScrollViewMove=function(e){this._scrollViewMoved=!0},e.prototype._onScrollViewClick=function(e){if(this._scrollViewMoved)this._scrollViewMoved=!1;else{h.ALUtil.LOG("ALGameBox _onScrollViewClick --- ",e);var t=e.getLocation(),o=null;a.ALData.isVertical?(o=this._scrollNode.convertToNodeSpaceAR(t)).y-=this._scrollContent.y:((o=this._subScrollNode.convertToNodeSpaceAR(t)).x-=this._subScrollContent.x,o=cc.v2(o.y,-o.x));var n=this._tableView.getItemByPos(o);if(n){h.ALUtil.LOG("ALGameBox _onItemClick --- ",t,o,n);var i=parseInt(n.name);if(i){var r=a.ALData.boxData[i];if(r instanceof Array)if(r.length>2)l.ALSDK.toMiniProgram(r,c.REPORT_TYPE_GAME_BOX_BANNER_CLICK,"GAME_BOX_BANNER_CLICK","box");else{var s=0;if(o.x>0&&(s=1),1===s&&1===r.length)return;h.ALUtil.LOG("ALGameBox _onItemClick --- ",i,s);var d=r[s];l.ALSDK.toMiniProgram(d,c.REPORT_TYPE_GAME_BOX_CLICK,"GAME_BOX_CLICK","box")}}}}},e.prototype.showNode=function(e){a.ALData.isTSA?this.hideNode():this._boxNode?this._boxNode.parent?(this._cb=e,this._boxNode.active=!0):h.ALUtil.LOG("ALGameBox showNode parent empty"):h.ALUtil.LOG("ALGameBox showNode node empty")},e.prototype.hideNode=function(){this._boxNode?(this._cb&&(this._cb(),this._cb=null),this._boxNode.active=!1):h.ALUtil.LOG("ALGameBox hideNode node empty")},e.prototype.destroyNode=function(){this._boxNode?(this._boxNode.parent&&this._boxNode.removeFromParent(),this._cb=null,a.ALData.boxData=null,this._tableView.destroy(),this._tableView=null,this._boxNode.destroy(),this._boxNode=null):h.ALUtil.LOG("ALGameBox destroyNode node empty")},e._instance=null,e}();o.ALGameBox=u;var p={x:0,y:0,width:750,height:1334,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:0,width:750,height:1334,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,left:0,right:0,top:0,bottom:0,type:4,children:[{x:0,y:0,width:750,height:1334,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,left:0,right:0,top:0,bottom:0,type:0,source:"orangePoint",typeMode:0,sizeMode:0},{x:-238,y:597,width:214,height:80,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,left:30,top:30,type:0,source:"back_button1",typeMode:0,sizeMode:0},{x:0,y:533,width:750,height:1200,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,left:0,right:0,top:134,bottom:0,type:3,horizontal:!1,vertical:!0,inertia:!0,brake:.5,elastic:!0,bounceDuration:1,children:[{x:0,y:0,width:750,height:1200,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,left:0,right:0,top:0,bottom:0,type:4}]}]},{x:0,y:0,width:1334,height:750,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,horizontalCenter:0,verticalCenter:0,type:4,children:[{x:-597,y:-238,width:80,height:214,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,left:30,bottom:30,type:4},{x:-533,y:0,width:1200,height:750,scaleX:1,scaleY:1,anchorX:0,anchorY:.5,rotation:0,left:134,right:0,top:0,bottom:0,type:3,horizontal:!0,vertical:!1,inertia:!0,brake:.5,elastic:!0,bounceDuration:1,children:[{x:0,y:0,width:1200,height:750,scaleX:1,scaleY:1,anchorX:0,anchorY:.5,rotation:0,left:0,right:0,top:0,bottom:0,type:4}]}]}]},f={x:0,y:0,width:688,height:236,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,type:0,source:"banner",typeMode:0,sizeMode:1},m={x:-172,y:0,width:345,height:50,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,type:4,children:[{x:-170,y:-20,width:7,height:28,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,type:0,source:"orange_point",typeMode:0,sizeMode:0},{x:-145,y:-20,width:189.79,height:28,scaleX:1,scaleY:1,anchorX:0,anchorY:1,rotation:0,type:1,size:28,fontFamily:"Arial",textColor:"000000",text:"\u6296\u97f3\u7206\u6b3e..........",textAlign:0,verticalAlign:1}]},_={x:0,y:0,width:750,height:280,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,type:4,children:[{x:-180,y:-20,width:330,height:252,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,type:4,children:[{x:0,y:0,width:330,height:176,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,type:0,source:"tb-diandianfuweng-01",typeMode:0,sizeMode:1},{x:0,y:-176,width:330,height:76,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,type:0,source:"bottom_bg",typeMode:0,sizeMode:1},{x:-141,y:-184,width:208,height:28,scaleX:1,scaleY:1,anchorX:0,anchorY:1,rotation:0,type:1,size:26,fontFamily:"Arial",textColor:"000000",text:"\u8fdb\u5316\u5427\u7cbe\u7075\u3002\u3002\u3002",textAlign:0,verticalAlign:1},{x:-141,y:-214,width:260,height:20,scaleX:1,scaleY:1,anchorX:0,anchorY:1,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"808080",text:"\u56de\u5473\u7ecf\u5178\u6293\u4f4f\u5feb\u4e50\uff0c\u4e00\u8d77\u6765\u73a9",textAlign:0,verticalAlign:1}]},{x:180,y:-20,width:330,height:252,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,type:4,children:[{x:0,y:0,width:330,height:176,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,type:0,source:"tb-jinyongxiakexing",typeMode:0,sizeMode:1},{x:0,y:-176,width:330,height:76,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,type:0,source:"bottom_bg",typeMode:0,sizeMode:1},{x:-141,y:-184,width:208,height:28,scaleX:1,scaleY:1,anchorX:0,anchorY:1,rotation:0,type:1,size:26,fontFamily:"Arial",textColor:"000000",text:"\u8fdb\u5316\u5427\u7cbe\u7075\u3002\u3002\u3002",textAlign:0,verticalAlign:1},{x:-141,y:-214,width:260,height:20,scaleX:1,scaleY:1,anchorX:0,anchorY:1,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"808080",text:"\u56de\u5473\u7ecf\u5178\u6293\u4f4f\u5feb\u4e50\uff0c\u4e00\u8d77\u6765\u73a9",textAlign:0,verticalAlign:1}]}]};cc._RF.pop()},{"./ALConfig":"ALConfig","./ALData":"ALData","./ALReport":"ALReport","./ALSDK":"ALSDK","./UITableView":"UITableView","./util/ALUtil":"ALUtil","./util/HttpUtil":"HttpUtil","./util/ImgLoaderUtil":"ImgLoaderUtil","./util/UIUtil":"UIUtil"}],ALGameDrawer:[function(e,t,o){"use strict";cc._RF.push(t,"f0c08VxxSRCTLYn3yxqMwM3","ALGameDrawer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./util/UIUtil"),a=e("./ALData"),i=e("./ALConfig"),r=e("./util/ImgLoaderUtil"),s=e("./ALSDK"),c=e("./ALReport"),l=e("./util/ALUtil"),d=e("./util/HttpUtil"),h=function(){function e(){this._drawerNode=null,this._containerNode=null,this._gifObjMap={},this._scene="drawer",this._clickCnt=0,this._reportedShow=!1,this._changeTimer=null,this._changeHandler=null,this._nowTimerCnt=-1,this._stayCnt=40,this._lastTime=0,this._cb=null}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype._initNode=function(){var e=this;if(this._drawerNode)return this._drawerNode;var t=n.UIUtil.parseGameUIFromJSON(a.ALData.isVertical?u:p);t.children[0].on(cc.Node.EventType.TOUCH_END,this._onBgClick,this);var o=t.children[1],r=o.children[1],s=this._onItemClick.bind(this);return r.children.forEach(function(t,o){if(t.on(cc.Node.EventType.TOUCH_END,s,e),t.active=!1,t.name=o+"",i.ALConfig.draw_font_color){var n=t.children[1];n.color=n.color.fromHEX(i.ALConfig.draw_font_color)}}),o.children[2].on(cc.Node.EventType.TOUCH_END,this._onCloseClick,this),o.children[0].on(cc.Node.EventType.TOUCH_END,this._onRefreshClick,this),this._drawerNode=t,this._containerNode=o,this._adjustLayout(),a.ALData.iconData?this._initContent():this._initData(),this._initDebugBtn(),this._drawerNode},e.prototype._initDebugBtn=function(){if(!l.ALUtil.wxNotExist()){var e=new cc.Node;e.width=300,e.height=70;var t=e.addComponent(cc.Widget);t.isAlignHorizontalCenter=!0,t.horizontalCenter=0,t.isAlignTop=!0,t.top=0,e.on(cc.Node.EventType.TOUCH_END,this._debugBtnClick,this),this._containerNode.addChild(e)}},e.prototype._debugBtnClick=function(){if(this._clickCnt++,this._clickCnt>=5){var e={appid:i.ALConfig.appId,openid:i.ALConfig.openId,scene:""};d.HttpUtil.POST(i.ALConfig.ReportMarketDomain+"/box/score",e).then(function(e){if(e.isSucc){var t=e.data,o=a.ALData.appIdListStr.replace(/,/g,"   "),n="OpenID:"+i.ALConfig.openId+"\n\u7248\u672c\u53f7:\n"+i.ALConfig.sdkVersion+"\n\u7533\u660e\u5217\u8868:\n"+o+"\n\u57ce\u5e02:"+t.city+"\u5269\u4f59\u79ef\u5206:"+t.score+"\n\u6210\u529f\u6b21\u6570:"+t.succCnt+" \u5931\u8d25\u6b21\u6570:"+t.failCnt;l.ALUtil.wxShowModel("\u7528\u6237\u8c03\u8bd5\u4fe1\u606f",n)}else l.ALUtil.LOG("HttpUtil getShareScore fail --- ",e.reason)}),this._clickCnt=0}},e.prototype._adjustLayout=function(){var e=1;e=a.ALData.isVertical?cc.winSize.width/750:cc.winSize.height/750,this._containerNode.scale=e},e.prototype._initContent=function(){var e=a.ALData.isVertical?i.ALConfig.DrawerPortrait:i.ALConfig.DrawerLandscape;n.UIUtil.initBitmapOfNode(this._drawerNode,a.ALData.sdkTexture,e);for(var t=0,o=a.ALData.iconData.length;t<o;t++){var r=a.ALData.iconData[t];if(r[14]){var s={textCnt:0,textArr:new Array,nowTextCnt:-1,loaded:!1,sp:null};this._gifObjMap[r[1]]=s}}this._refreshContent(),Object.keys(this._gifObjMap).length>0&&this._initTimer()},e.prototype._refreshContent=function(){var e=this,t=this._containerNode.children[1];for(var o in this._gifObjMap){var c=this._gifObjMap[o];c&&(c.sp=null)}for(var d=function(o,c){var d=t.children[o],u=a.ALData.iconData[o];if(!u)return d.active=!1,"continue";d.active=!0;var p=u[1],f=d.children[0].getComponent(cc.Sprite);h._gifObjMap[p]&&(h._gifObjMap[p].sp=f);h._gifObjMap[p]&&h._gifObjMap[p].loaded||r.ImgLoaderUtil.getImgByUrl(h._gifObjMap[p]?u[14]:u[4]).then(function(t){if(t.isSucc){var o=t.texture;if(e._gifObjMap[p]){l.ALUtil.LOG("ALGameDrawer getImgByUrl nodeAppid",p);var n=e._gifObjMap[p],i=Math.floor(o.width/a.SDKGifSize);n.textCnt=i;for(var r=0;r<i;r++){var s=new cc.SpriteFrame(o,new cc.Rect(a.SDKGifSize*r,0,a.SDKGifSize,a.SDKGifSize));n.textArr.push(s)}n.loaded=!0}else f.spriteFrame=new cc.SpriteFrame(o)}else l.ALUtil.LOG(t.info)}),d.children[1].getComponent(cc.Label).string=u[5];var m=d.children[2];m.active="1"===u[12]&&s.ALSDK.allowRedPoint(u);var _=d.children[3];if(u[13]&&"0"!==u[13]?_.active=!0:_.active=!1,m.active&&n.UIUtil.initBitmap(m,"redpoint",a.ALData.markerTexture,i.ALConfig.MarkerRect),_.active){var g="";"1"===u[13]?g="mark1":"2"===u[13]?g="mark2":"3"===u[13]&&(g="mark3"),n.UIUtil.initBitmap(_,g,a.ALData.markerTexture,i.ALConfig.MarkerRect)}},h=this,u=0,p=t.children.length;u<p;u++)d(u)},e.prototype._initData=function(){var e=this;s.ALSDK.requestModuleData(s.SDK_MODULE_DRAWER,function(t){a.ALData.iconData=t,e._reportShow(),e._initContent()})},e.prototype._reportShow=function(){!a.ALData.iconData||a.ALData.iconData.length<1||this._reportedShow||(this._reportedShow=!0,s.ALSDK.reportPicsShow(a.ALData.iconData,c.REPORT_TYPE_DRAWER_SHOW,s.SDK_MODULE_DRAWER_SHOW))},e.prototype._initTimer=function(){this._clearTimer(),this._changeHandler=this._timerHandler.bind(this),this._changeTimer=setInterval(this._changeHandler,a.SDKAniInterval)},e.prototype._clearTimer=function(){this._changeTimer&&(clearInterval(this._changeTimer),this._changeTimer=null,this._changeHandler=null)},e.prototype._timerHandler=function(){if(this._nowTimerCnt++,this._nowTimerCnt<this._stayCnt)for(var e in this._gifObjMap){var t=this._gifObjMap[e];this._changeCntAnim(t)}else{var o=Date.now(),n=.5*a.SDKAniDelay+a.SDKAniInterval*this._stayCnt;if(o-this._lastTime<n)return;this._lastTime=o,this._nowTimerCnt=-1}},e.prototype._changeCntAnim=function(e){if(e.sp&&!(e.textCnt<1)){e.nowTextCnt++,e.nowTextCnt>=e.textCnt&&(e.nowTextCnt=0);var t=e.textArr[e.nowTextCnt];e.sp.spriteFrame=t}},e.prototype._onItemClick=function(e){var t=e.target.name,o=parseInt(t),n=a.ALData.iconData[o];s.ALSDK.saveRedPoint(n)&&(e.target.children[2].active=!1),s.ALSDK.toMiniProgram(n,c.REPORT_TYPE_DRAWER_CLICK,s.SDK_MODULE_DRAWER_CLICK,this._scene)},e.prototype._onBgClick=function(){l.ALUtil.LOG("ALGameDrawer _onBgClick"),this.hideNode()},e.prototype._onCloseClick=function(){this.hideNode()},e.prototype._onRefreshClick=function(){var e=a.ALData.isVertical?9:8;l.ALUtil.shuffle(a.ALData.iconData,e),this._refreshContent()},e.prototype.showNode=function(e,t){a.ALData.isTSA?this.hideNode():this._drawerNode?this._drawerNode.parent?(t&&(this._scene=t),this._cb=e,this._drawerNode.active||(this._changeTimer||this._initTimer(),this._reportShow(),this._drawerNode.active=!0)):l.ALUtil.LOG("ALGameDrawer showNode parent empty"):l.ALUtil.LOG("ALGameDrawer showNode node empty")},e.prototype.hideNode=function(){this._drawerNode?this._drawerNode.active&&(this._cb&&(this._cb(),this._cb=null),this._reportedShow=!1,this._clearTimer(),this._drawerNode.active=!1):l.ALUtil.LOG("ALGameDrawer hideNode node empty")},e.prototype.destroyNode=function(){this._drawerNode?(this._drawerNode.parent&&this._drawerNode.removeFromParent(),this._cb=null,this._reportedShow=!1,this._clearTimer(),this._drawerNode.destroy(),this._drawerNode=null):l.ALUtil.LOG("ALGameDrawer destroyNode node empty")},e._instance=null,e}();o.ALGameDrawer=h;var u={x:562.5,y:1218,width:1125,height:2436,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,left:0,right:0,top:0,bottom:0,type:4,children:[{x:0,y:0,width:1125,height:2436,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,left:0,right:0,top:0,bottom:0,type:0,source:"mask",typeMode:0,sizeMode:0},{x:0,y:0,width:524,height:664,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,horizontalCenter:0,verticalCenter:0,type:0,source:"background-s",typeMode:0,sizeMode:1,children:[{x:0,y:-360,width:192,height:56,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"refresh-s",typeMode:0,sizeMode:0},{x:0,y:-19,width:484,height:582,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:-170,y:194,width:144,height:194,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_adventure-2",typeMode:0,sizeMode:1},{x:0,y:-82,width:100,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u6210\u957f\u5927\u5192\u9669",textAlign:1,verticalAlign:1},{x:66,y:74,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:68,y:74,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:0,y:194,width:144,height:194,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_17miao",typeMode:0,sizeMode:1},{x:0,y:-82,width:82.25,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"17\u55b5\u55b5\u55b5",textAlign:1,verticalAlign:1},{x:66,y:74,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:68,y:74,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:170,y:194,width:144,height:194,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_adventure",typeMode:0,sizeMode:1},{x:0,y:-82,width:100,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u6210\u957f\u5927\u5192\u9669",textAlign:1,verticalAlign:1},{x:66,y:74,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:68,y:74,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:-170,y:0,width:144,height:194,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_animalchess",typeMode:0,sizeMode:1},{x:0,y:-82,width:60,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u6597\u517d\u68cb",textAlign:1,verticalAlign:1},{x:66,y:74,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:68,y:74,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:0,y:0,width:144,height:194,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_benyiben",typeMode:0,sizeMode:1},{x:0,y:-82,width:60,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u8e66\u4e00\u8e66",textAlign:1,verticalAlign:1},{x:66,y:74,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:68,y:74,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:170,y:0,width:144,height:194,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_buyu",typeMode:0,sizeMode:1},{x:0,y:-82,width:100,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u6355\u9c7c\u5c0f\u8fbe\u4eba",textAlign:1,verticalAlign:1},{x:66,y:74,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:68,y:74,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:-170,y:-194,width:144,height:194,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_caigewang",typeMode:0,sizeMode:1},{x:0,y:-82,width:60,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u731c\u6b4c\u738b",textAlign:1,verticalAlign:1},{x:66,y:74,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:68,y:74,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:0,y:-194,width:144,height:194,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_carmerge",typeMode:0,sizeMode:1},{x:0,y:-82,width:60,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u8f66\u8f66\u8f66",textAlign:1,verticalAlign:1},{x:66,y:74,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:68,y:74,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:170,y:-194,width:144,height:194,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_chick",typeMode:0,sizeMode:1},{x:0,y:-82,width:60,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u5c0f\u98de\u9e21",textAlign:1,verticalAlign:1},{x:66,y:74,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:68,y:74,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]}]},{x:232,y:303,width:33,height:33,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"close",typeMode:0,sizeMode:1}]}]},p={x:562.5,y:1218,width:1125,height:2436,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,left:0,right:0,top:0,bottom:0,type:4,children:[{x:0,y:0,width:1125,height:2436,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,left:0,right:0,top:0,bottom:0,type:0,source:"mask",typeMode:0,sizeMode:0},{x:0,y:0,width:692,height:470,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,horizontalCenter:0,verticalCenter:0,type:0,source:"background",typeMode:0,sizeMode:1,children:[{x:382,y:-128,width:72,height:180,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"refresh",typeMode:0,sizeMode:1},{x:0,y:-19,width:651,height:388,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:-253.5,y:97,width:144,height:194,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_adventure-2",typeMode:0,sizeMode:1},{x:0,y:-82,width:100,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u6210\u957f\u5927\u5192\u9669",textAlign:1,verticalAlign:1},{x:70,y:80,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:70,y:80,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:-84.5,y:97,width:144,height:192,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_17miao",typeMode:0,sizeMode:1},{x:0,y:-82,width:100,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u6210\u957f\u5927\u5192\u9669",textAlign:1,verticalAlign:1},{x:70,y:80,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:70,y:80,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:84.5,y:97,width:144,height:192,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_adventure",typeMode:0,sizeMode:1},{x:0,y:-82,width:100,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u6210\u957f\u5927\u5192\u9669",textAlign:1,verticalAlign:1},{x:70,y:80,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:70,y:80,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:253.5,y:97,width:144,height:192,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_animalchess",typeMode:0,sizeMode:1},{x:0,y:-82,width:100,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u6210\u957f\u5927\u5192\u9669",textAlign:1,verticalAlign:1},{x:70,y:80,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:70,y:80,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:-253.5,y:-97,width:144,height:192,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_benyiben",typeMode:0,sizeMode:1},{x:0,y:-82,width:100,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u6210\u957f\u5927\u5192\u9669",textAlign:1,verticalAlign:1},{x:70,y:80,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:70,y:80,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:-85,y:-96,width:144,height:192,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_caigewang",typeMode:0,sizeMode:1},{x:0,y:-82,width:100,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u6210\u957f\u5927\u5192\u9669",textAlign:1,verticalAlign:1},{x:70,y:80,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:70,y:80,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:84,y:-96,width:144,height:192,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_carmerge",typeMode:0,sizeMode:1},{x:0,y:-82,width:100,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u6210\u957f\u5927\u5192\u9669",textAlign:1,verticalAlign:1},{x:70,y:80,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:70,y:80,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]},{x:253,y:-96,width:144,height:192,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:9,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_chick",typeMode:0,sizeMode:1},{x:0,y:-82,width:100,height:30,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:20,fontFamily:"Arial",textColor:"ffffff",text:"\u6210\u957f\u5927\u5192\u9669",textAlign:1,verticalAlign:1},{x:70,y:80,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:70,y:80,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]}]},{x:309,y:207,width:33,height:33,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"close",typeMode:0,sizeMode:1}]}]};cc._RF.pop()},{"./ALConfig":"ALConfig","./ALData":"ALData","./ALReport":"ALReport","./ALSDK":"ALSDK","./util/ALUtil":"ALUtil","./util/HttpUtil":"HttpUtil","./util/ImgLoaderUtil":"ImgLoaderUtil","./util/UIUtil":"UIUtil"}],ALGameMore:[function(e,t,o){"use strict";cc._RF.push(t,"18ba84ySZ5Ke6rYabEQxRS5","ALGameMore"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./ALData"),a=e("./util/ImgLoaderUtil"),i=e("./ALSDK"),r=e("./ALReport"),s=e("./util/ALUtil"),c=e("./util/UIUtil"),l=e("./ALConfig"),d=function(){function e(){this._moreNode=null,this._moreNodeSP=null,this._textCnt=0,this._textArr=null,this._scale=0,this._scene="more",this._initScale=1,this._reportedShow=!1,this._colorArr=["#ff970f","#7938f1","#ef6929","#ed4c58"],this._colorIndex=0,this._numMap={},this._changeTimer=null,this._changeHandler=null,this._nowTextCnt=9999,this._stayCnt=40,this._lastTime=0,this._moreIndex=-1,this._loadingRes=!1}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype._initNode=function(e){if(cc.isValid(this._moreNode))return this._moreNode;var t=c.UIUtil.parseGameUIFromJSON(h);return t.on(cc.Node.EventType.TOUCH_START,this.onMoreClick,this),t.opacity=0,e&&e>0&&(this._initScale=e),this._moreNode=t,this._moreNodeSP=t.children[2].getComponent(cc.Sprite),this._adjustLayout(),n.ALData.moreData?this._initTimer():this._initData(),this._moreNode},e.prototype._adjustLayout=function(){var e=1;e=.7*(e=n.ALData.isVertical?cc.winSize.width/750:cc.winSize.height/750)*this._initScale,this._moreNode.scale=e,this._scale=e},e.prototype._initContent=function(){var e=n.ALData.isVertical?l.ALConfig.DrawerPortrait:l.ALConfig.DrawerLandscape;c.UIUtil.initBitmapOfNode(this._moreNode,n.ALData.sdkTexture,e)},e.prototype._initData=function(){var e=this;i.ALSDK.requestModuleData(i.SDK_MODULE_MORE,function(t){n.ALData.moreData=t,e._reportShow(),e._initContent(),e._initTimer()})},e.prototype._reportShow=function(){n.ALData.moreData&&!this._reportedShow&&(this._reportedShow=!0,i.ALSDK.reportPicsShow(n.ALData.moreData,r.REPORT_TYPE_MORE_SHOW,i.SDK_MODULE_MORE_SHOW))},e.prototype.onMoreClick=function(){var e=n.ALData.moreData[this._moreIndex];i.ALSDK.saveRedPoint(e)&&(this._moreNode.children[5].active=!1),i.ALSDK.toMiniProgram(e,r.REPORT_TYPE_MORE_CLICK,i.SDK_MODULE_MORE_CLICK,this._scene)},e.prototype._randomColor=function(){var e=this._colorArr[this._colorIndex];return this._colorIndex++,this._colorIndex%=4,e},e.prototype._randomNum=function(e){if(this._numMap[e])return this._numMap[e];var t=Math.ceil(1e5*Math.random())+"\u4eba\u5728\u73a9";return this._numMap[e]=t,t},e.prototype._initTimer=function(){this._clearTimer(),this._changeHandler=this._changeCntAnim.bind(this),this._changeTimer=setInterval(this._changeHandler,n.SDKAniInterval)},e.prototype._clearTimer=function(){this._changeTimer&&(clearInterval(this._changeTimer),this._changeTimer=null,this._changeHandler=null)},e.prototype._changeCntAnim=function(){if(n.ALData.moreData&&!(n.ALData.moreData.length<1)){if(this._nowTextCnt<this._stayCnt){if(this._loadingRes)return;return this._nowTextCnt++,void this._changeSp()}var e=Date.now(),t=n.SDKAniDelay+n.SDKAniInterval*this._stayCnt;if(!(e-this._lastTime<t||this._loadingRes)){this._loadingRes=!0,this._lastTime=e;var o=cc.fadeOut(.6),a=cc.sequence(o,cc.callFunc(this._fadeOutAnimComplete.bind(this)));this._moreNode.runAction(a)}}},e.prototype._fadeOutAnimComplete=function(){this._nowTextCnt=-1,this._moreIndex++,this._changeNext()},e.prototype._changeSp=function(){if(this._textArr&&!(this._textArr.length<1)){var e=this._nowTextCnt%this._textCnt,t=this._textArr[e];this._moreNodeSP.spriteFrame=t}},e.prototype._changeNext=function(){return __awaiter(this,void 0,void 0,function(){var e,t,o,r,d,h,u,p,f,m,_,g,y,v;return __generator(this,function(w){switch(w.label){case 0:return this._moreIndex=this._moreIndex%n.ALData.moreData.length,e=n.ALData.moreData[this._moreIndex],(t=this._moreNode.children[0]).color=t.color.fromHEX(this._randomColor()),this._moreNode.children[3].getComponent(cc.Label).string=e[5],this._moreNode.children[4].getComponent(cc.Label).string=this._randomNum(e[1]),(o=this._moreNode.children[5]).active="1"===e[12]&&i.ALSDK.allowRedPoint(e),r=this._moreNode.children[6],e[13]&&"0"!==e[13]?r.active=!0:r.active=!1,o.active&&c.UIUtil.initBitmap(o,"redpoint",n.ALData.markerTexture,l.ALConfig.MarkerRect),r.active&&(d="","1"===e[13]?d="mark1":"2"===e[13]?d="mark2":"3"===e[13]&&(d="mark3"),c.UIUtil.initBitmap(r,d,n.ALData.markerTexture,l.ALConfig.MarkerRect)),h=e[4],[4,a.ImgLoaderUtil.getImgByUrl(h)];case 1:if(!(u=w.sent()).isSucc)return s.ALUtil.LOG(u.info),this._loadingRes=!1,[2];if(p=u.texture,(f=Math.floor(p.width/n.SDKGifSize))<1)return s.ALUtil.LOG("ALGameMore _initChangeCnt cnt 0 --- "),[2];for(this._textCnt=f,this._textArr=new Array,m=0;m<f;m++)_=new cc.SpriteFrame(p,new cc.Rect(n.SDKGifSize*m,0,n.SDKGifSize,n.SDKGifSize)),this._textArr.push(_);return this._nowTextCnt++,this._changeSp(),this._moreNode.scale=0,this._moreNode.opacity=0,g=cc.fadeIn(.4),y=cc.scaleTo(.4,this._scale,this._scale).easing(cc.easeBackOut()),v=cc.sequence(cc.spawn(g,y),cc.callFunc(this._fadeShowAnimComplete.bind(this))),this._moreNode.runAction(v),[2]}})})},e.prototype._fadeShowAnimComplete=function(){this._loadingRes=!1},e.prototype.showNode=function(e){this._moreNode?this._moreNode.parent?(e&&(this._scene=e),this._changeTimer||this._initTimer(),this._reportShow(),this._moreNode.active=!0):s.ALUtil.LOG("ALGameMore showNode parent empty"):s.ALUtil.LOG("ALGameMore showNode node empty")},e.prototype.hideNode=function(){this._moreNode?(this._clearTimer(),this._reportedShow=!1,this._moreNode.active=!1):s.ALUtil.LOG("ALGameMore hideNode node empty")},e.prototype.destroyNode=function(){this._moreNode?(this._moreNode.parent&&this._moreNode.removeFromParent(),this._clearTimer(),this._reportedShow=!1,this._moreNode.destroy(),this._moreNode=null,this._moreNodeSP=null):s.ALUtil.LOG("ALGameMore destroyNode node empty")},e._instance=null,e}();o.ALGameMore=d;var h={x:0,y:0,width:120,height:160,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:0,width:120,height:160,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"aniWhite",typeMode:1,sizeMode:0,scale9Grid:"13, 13, 13, 13"},{x:0,y:0,width:120,height:160,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"colorChange",typeMode:1,sizeMode:0,scale9Grid:"57, 17, 57, 17"},{x:0,y:22,width:110,height:110,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,horizontalCenter:0,top:3,type:0,source:"default_sprite",typeMode:0,sizeMode:0},{x:0,y:-49,width:96,height:24,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,horizontalCenter:0,type:1,size:24,fontFamily:"Arial",textColor:"ffffff",text:"\u8d85\u8dd1\u5927\u4ea8",textAlign:1,verticalAlign:1},{x:0,y:-70,width:50,height:14,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,horizontalCenter:0,type:1,size:14,fontFamily:"Arial",textColor:"ffffff",text:"0\u4eba\u5728\u73a9",textAlign:1,verticalAlign:1},{x:48,y:68,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:48,y:68,width:66,height:40,scaleX:.77,scaleY:.77,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]};cc._RF.pop()},{"./ALConfig":"ALConfig","./ALData":"ALData","./ALReport":"ALReport","./ALSDK":"ALSDK","./util/ALUtil":"ALUtil","./util/ImgLoaderUtil":"ImgLoaderUtil","./util/UIUtil":"UIUtil"}],ALGuessLikeV:[function(e,t,o){"use strict";cc._RF.push(t,"1b32527tZtEh5E2Md8NOZKS","ALGuessLikeV"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./util/UIUtil"),a=e("./ALData"),i=e("./ALConfig"),r=e("./util/ImgLoaderUtil"),s=e("./ALSDK"),c=e("./ALReport"),l=e("./UITableView"),d=e("./util/ALUtil"),h=function(){function e(){this._likeNode=null,this.CELL_LIKEITEM_HEIGHT=210,this.CELL_LIKEITEM_IDENTIFYT="LikeItemV",this._gifObjMap={},this._scene="likeV",this._tableView=null,this._scrollView=null,this._scrollContent=null,this._scrollViewWidth=0,this._scollMiddlePos=null,this._bgHide=!1,this._likeData=null,this._reportedShow=!1,this._changeTimer=null,this._changeHandler=null,this._nowTimerCnt=-1,this._stayCnt=40,this._lastTime=0,this._scrollRuning=!1,this._scrollSpeed=25,this._totalWidth=0,this._initScrollEffFunc=null,this._scrollTimer=-1,this._lastAnimItem=null}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype._initNode=function(e,t,o){if(console.log("ALGuessLikeV _initNode before ---"),e){if(this._likeNode)return this._likeNode;console.log("ALGuessLikeV _initNode after ---");var a=n.UIUtil.parseGameUIFromJSON(u);this._likeNode=a,this._refreshHeight(t),o&&(this._bgHide=o);var i=a.children[1];i.addComponent(cc.Mask);var r=i.getComponent(cc.ScrollView);r.content=i.children[0];var s=new l.UITableViewV({scrollview:r,content:r.content,allowScroll:!0,direction:l.ScrollDirection.Vertical,nodeEstimatedHeightOrWidthCB:this.nodeEstimatedHeightOrWidthCB.bind(this),nodeForIndexCB:this.nodeForIndexCB.bind(this),nodeRemoveForIndexCB:this.nodeRemoveForIndexCB.bind(this)}),c=n.UIUtil.parseGameUIFromJSON(p);return s.registerNodeTemplateOfKey(this.CELL_LIKEITEM_IDENTIFYT,c),i.on("scroll-ended",this._scrollEndEvent,this),this._scrollView=r,this._scrollContent=r.content,this._tableView=s,this._adjustLayout(),this._likeData?this._initContent():this._initData(e),this._likeNode}console.warn("ALGuessLike _initNode data empty")},e.prototype._refreshHeight=function(e){if(d.ALUtil.LOG("ALGuessLike _refreshHeight before",e),this._likeNode){d.ALUtil.LOG("ALGuessLike _refreshHeight after",e);var t=this._likeNode,o=t.children[0],n=t.children[1],a=n.children[0];e&&e>40&&(t.height=e,o.height=e,n.height=e-40,a.y=0,a.height=e-40,this._likeNode.parent&&n.getComponent(cc.Widget).updateAlignment()),this._scrollViewWidth=a.height;var i=n.convertToWorldSpaceAR(cc.v2(0,.5*-n.height));this._scollMiddlePos=a.convertToNodeSpaceAR(i)}},e.prototype._adjustLayout=function(){var e=1;e=a.ALData.isVertical?cc.winSize.width/750:cc.winSize.height/750,this._likeNode.scale=e},e.prototype._initContent=function(){var e=this._likeNode.children[0];if(this._bgHide)e.active=!1;else{var t=a.ALData.isVertical?i.ALConfig.DrawerPortrait:i.ALConfig.DrawerLandscape;n.UIUtil.initBitmap(e,e.name,a.ALData.sdkTexture,t)}for(var o=0,r=this._likeData.length;o<r;o++){var s=this._likeData[o];if(s[14]){var c={textCnt:0,textArr:new Array,nowTextCnt:-1,loaded:!1,sp:null};this._gifObjMap[s[1]]=c}}this._tableView.set_data(this._likeData),Object.keys(this._gifObjMap).length>0&&(d.ALUtil.LOG("ALGuessLike _initContent _initTimer"),this._initTimer())},e.prototype._initData=function(e){this._likeData=e,this._reportShow(),this._initContent(),this._beginScrollEff()},e.prototype._reportShow=function(){!this._likeData||this._likeData.length<1||this._reportedShow||(this._reportedShow=!0,s.ALSDK.reportPicsShow(this._likeData,c.REPORT_TYPE_LIKE_SHOW,s.SDK_MODULE_LIKE_SHOW))},e.prototype._initTimer=function(){this._clearTimer(),this._changeHandler=this._timerHandler.bind(this),this._changeTimer=setInterval(this._changeHandler,a.SDKAniInterval)},e.prototype._clearTimer=function(){this._changeTimer&&(clearInterval(this._changeTimer),this._changeTimer=null,this._changeHandler=null)},e.prototype._timerHandler=function(){if(this._nowTimerCnt++,this._nowTimerCnt<this._stayCnt)for(var e in this._gifObjMap){var t=this._gifObjMap[e];this._changeCntAnim(t)}else{var o=Date.now(),n=.5*a.SDKAniDelay+a.SDKAniInterval*this._stayCnt;if(o-this._lastTime<n)return;this._lastTime=o,this._nowTimerCnt=-1}},e.prototype._changeCntAnim=function(e){if(e.sp&&!(e.textCnt<1)){e.nowTextCnt++,e.nowTextCnt>=e.textCnt&&(e.nowTextCnt=0);var t=e.textArr[e.nowTextCnt];e.sp.spriteFrame=t}},e.prototype.nodeEstimatedHeightOrWidthCB=function(e,t,o){return this.CELL_LIKEITEM_HEIGHT},e.prototype.nodeRemoveForIndexCB=function(e,t,o){d.ALUtil.LOG("ALGuessLike nodeRemoveForIndexCB index",t);var n=this._likeData[t][1];this._gifObjMap[n]&&(this._gifObjMap[n].sp=null)},e.prototype.nodeForIndexCB=function(e,t,o){var c=this,l=e.obtainNodeOfKey(this.CELL_LIKEITEM_IDENTIFYT);l.name=t+"";var h=l.children[0];if(!l.addEvent){l.addEvent="1",l.on(cc.Node.EventType.TOUCH_END,this._onItemClick,this);var u=a.ALData.isVertical?i.ALConfig.DrawerPortrait:i.ALConfig.DrawerLandscape;n.UIUtil.initBitmapOfNode(h,a.ALData.sdkTexture,u)}var p=o,f=p[1],m=h.children[1].getComponent(cc.Sprite);this._gifObjMap[f]&&(this._gifObjMap[f].sp=m);this._gifObjMap[f]&&this._gifObjMap[f].loaded||r.ImgLoaderUtil.getImgByUrl(this._gifObjMap[f]?p[14]:p[4]).then(function(e){if(e.isSucc){d.ALUtil.LOG("ALGuessLike getImgByUrl appid",t,f);var o=e.texture;if(c._gifObjMap[f]){var n=c._gifObjMap[f];if(n.loaded)return;var i=Math.floor(o.width/a.SDKGifSize);n.textCnt=i;for(var r=0;r<i;r++){var s=new cc.SpriteFrame(o,new cc.Rect(a.SDKGifSize*r,0,a.SDKGifSize,a.SDKGifSize));n.textArr.push(s)}n.loaded=!0}else m.spriteFrame=new cc.SpriteFrame(o)}else d.ALUtil.LOG(e.info)});var _=h.children[2];i.ALConfig.guesslike_font_color&&(_.color=_.color.fromHEX(i.ALConfig.guesslike_font_color)),_.getComponent(cc.Label).string=p[5];var g=h.children[3];g.active="1"===p[12]&&s.ALSDK.allowRedPoint(p);var y=h.children[4];if(p[13]&&"0"!==p[13]?y.active=!0:y.active=!1,g.active&&n.UIUtil.initBitmap(g,"redpoint",a.ALData.markerTexture,i.ALConfig.MarkerRect),y.active){var v="";"1"===p[13]?v="mark1":"2"===p[13]?v="mark2":"3"===p[13]&&(v="mark3"),n.UIUtil.initBitmap(y,v,a.ALData.markerTexture,i.ALConfig.MarkerRect)}return l},e.prototype._beginScrollEff=function(){this._likeNode&&this._likeNode.active&&(!this._likeData||this._likeData.length<1||this._scrollRuning||(this._scrollRuning=!0,this._totalWidth=this._tableView.estimateContentValue(),this._initScrollEffFunc=this._initScrollEff.bind(this),this._initScrollEff()))},e.prototype._stopScrollEff=function(){d.ALUtil.LOG("ALGuessLike _stopScrollEff"),this._scrollRuning=!1,this._scrollView.stopAutoScroll(),this._stopItemAnim(),this._stopScrollTimer()},e.prototype._scrollEndEvent=function(){var e=this._scrollContent.y,t=this._totalWidth-this._scrollViewWidth;d.ALUtil.LOG("ALGuessLike _scrollEndEvent",e,t),e<.1||e>.5*t||Math.abs(e-t)<.1?(d.ALUtil.LOG("ALGuessLike _scrollEndEvent init"),this._initScrollEff()):(this._stopItemAnim(),this._stopScrollTimer(),this._scrollTimer=setTimeout(this._initScrollEffFunc,2e3))},e.prototype._stopScrollTimer=function(){this._scrollTimer&&(clearTimeout(this._scrollTimer),this._scrollTimer=null)},e.prototype._initScrollEff=function(){this._scrollTimer=null;var e=this._scrollContent.y,t=this._totalWidth-this._scrollViewWidth,o=0;e<.5*t?(o=(t-e)/this._scrollSpeed,this._scrollView.scrollTo(cc.v2(0,-1),o,!1)):(o=e/this._scrollSpeed,this._scrollView.scrollTo(cc.v2(0,1),o,!1)),d.ALUtil.LOG("ALGuessLike _initScrollEff time",o),this._initItemAnim()},e.prototype._initItemAnim=function(){var e=cc.v2(0,this._scollMiddlePos.y+-this._scrollContent.y),t=this._tableView.getItemByPos(e);if(t){this._stopItemAnim(),this._lastAnimItem=t;var o=cc.sequence(cc.scaleTo(.9,1.15),cc.scaleTo(.8,1),cc.delayTime(.2),cc.callFunc(this._initItemAnim.bind(this)));t.children[0].runAction(o)}},e.prototype._stopItemAnim=function(){this._lastAnimItem&&this._lastAnimItem.isValid&&(this._lastAnimItem.children[0].stopAllActions(),this._lastAnimItem.children[0].scale=1,this._lastAnimItem=null)},e.prototype._onItemClick=function(e){var t=e.target.name,o=parseInt(t),n=this._likeData[o];s.ALSDK.saveRedPoint(n)&&(e.target.children[0].children[3].active=!1);s.ALSDK.toMiniProgram(n,c.REPORT_TYPE_LIKE_CLICK,s.SDK_MODULE_LIKE_CLICK,this._scene)},e.prototype.showNode=function(e){console.log("ALGuessLikeV showNode ---"),a.ALData.isTSA?this.hideNode():this._likeNode?this._likeNode.parent?(e&&(this._scene=e),this._likeNode.active=!0,this._scrollRuning||this._beginScrollEff(),this._changeTimer||this._initTimer(),this._reportShow()):d.ALUtil.LOG("ALGuessLike showNode parent empty"):d.ALUtil.LOG("ALGuessLike showNode node empty")},e.prototype.hideNode=function(){console.log("ALGuessLikeV hideNode ---"),this._likeNode?(this._stopScrollEff(),this._reportedShow=!1,this._clearTimer(),this._likeNode.active=!1):d.ALUtil.LOG("ALGuessLike hideNode node empty")},e.prototype.destroyNode=function(){console.log("ALGuessLikeV destroyNode ---"),this._likeNode?(this._likeNode.parent&&this._likeNode.removeFromParent(),this._stopScrollEff(),this._reportedShow=!1,this._clearTimer(),this._tableView.destroy(),this._tableView=null,this._likeNode.destroy(),this._likeNode=null):d.ALUtil.LOG("ALGuessLike destroyNode node empty")},e.prototype.setPos=function(e){if(this._likeNode){var t;if(void 0!==e.x)(t=this._likeNode.getComponent(cc.Widget))&&(t.isAlignHorizontalCenter=!1),this._likeNode.x=parseInt(e.x);if(void 0!==e.y)(t=this._likeNode.getComponent(cc.Widget))&&(t.isAlignBottom=!1),this._likeNode.y=parseInt(e.y);if(void 0!==e.h){var o=parseInt(e.h);this._refreshHeight(o),this._tableView.set_data(this._likeData)}}else d.ALUtil.LOG("ALGuessLike setPos node empty")},e._instance=null,e}();o.ALGuessLikeV=h;var u={x:300,y:0,width:180,height:750,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:0,width:180,height:750,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,left:0,right:0,top:0,bottom:0,type:0,source:"guesslike",typeMode:0,sizeMode:0},{x:0,y:355,width:180,height:710,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,left:0,right:0,top:20,bottom:20,type:3,horizontal:!1,vertical:!0,inertia:!0,brake:.75,elastic:!0,bounceDuration:.23,children:[{x:0,y:0,width:180,height:710,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,type:4}]}]},p={x:0,y:0,width:180,height:210,scaleX:1,scaleY:1,anchorX:.5,anchorY:1,rotation:0,type:4,children:[{x:0,y:-105,width:160,height:190,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,horizontalCenter:0,verticalCenter:0,type:4,children:[{x:0,y:0,width:160,height:190,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"aniWhite",typeMode:1,sizeMode:0,scale9Grid:"13, 13, 13, 13"},{x:0,y:18,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_17miao",typeMode:0,sizeMode:1},{x:0,y:-75,width:120,height:24,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:24,fontFamily:"Arial",textColor:"000000",text:"\u6700\u5f3a\u5c0f\u4e01\u4e01",textAlign:1,verticalAlign:1},{x:68,y:84,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:68,y:84,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]}]};cc._RF.pop()},{"./ALConfig":"ALConfig","./ALData":"ALData","./ALReport":"ALReport","./ALSDK":"ALSDK","./UITableView":"UITableView","./util/ALUtil":"ALUtil","./util/ImgLoaderUtil":"ImgLoaderUtil","./util/UIUtil":"UIUtil"}],ALGuessLike:[function(e,t,o){"use strict";cc._RF.push(t,"32cbfLmwlhANLZTgB8olI4M","ALGuessLike"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./util/UIUtil"),a=e("./ALData"),i=e("./ALConfig"),r=e("./util/ImgLoaderUtil"),s=e("./ALSDK"),c=e("./ALReport"),l=e("./UITableView"),d=e("./util/ALUtil"),h=e("../util/global_def"),u=function(){function e(){this._likeNode=null,this.CELL_LIKEITEM_WIDTH=180,this.CELL_LIKEITEM_IDENTIFYT="LikeItem",this._gifObjMap={},this._scene="like",this._tableView=null,this._scrollView=null,this._scrollContent=null,this._scrollViewWidth=0,this._scollMiddlePos=null,this._bgHide=!1,this._reportedShow=!1,this._changeTimer=null,this._changeHandler=null,this._nowTimerCnt=-1,this._stayCnt=40,this._lastTime=0,this._scrollRuning=!1,this._scrollSpeed=25,this._totalWidth=0,this._initScrollEffFunc=null,this._scrollTimer=-1,this._lastAnimItem=null}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype._initNode=function(e,t){if(cc.isValid(this._likeNode))return this._likeNode;var o=n.UIUtil.parseGameUIFromJSON(p);this._likeNode=o,this._refreshWidth(e),t&&(this._bgHide=t);var i=o.children[1];i.addComponent(cc.Mask);var r=i.getComponent(cc.ScrollView);r.content=i.children[0];var s=new l.UITableViewH({scrollview:r,content:r.content,allowScroll:!0,direction:l.ScrollDirection.Horizontal,nodeEstimatedHeightOrWidthCB:this.nodeEstimatedHeightOrWidthCB.bind(this),nodeForIndexCB:this.nodeForIndexCB.bind(this),nodeRemoveForIndexCB:this.nodeRemoveForIndexCB.bind(this)}),c=n.UIUtil.parseGameUIFromJSON(f);return s.registerNodeTemplateOfKey(this.CELL_LIKEITEM_IDENTIFYT,c),i.on("scroll-ended",this._scrollEndEvent,this),this._scrollView=r,this._scrollContent=r.content,this._tableView=s,this._adjustLayout(),a.ALData.iconData?this._initContent():this._initData(),this._likeNode},e.getIconData=function(){return a.ALData.iconData},e.createIcon=function(e,t,o){var n=cc.instantiate(e);if(null==a.ALData.iconData)return n;var i=a.ALData.iconData.length,l=h.G.randRange(0,i-1);if(null!=o&&(l=o),t)for(var d=0;d<a.ALData.iconData.length;d++){if(a.ALData.iconData[d][0]==t){l=d;break}}var u=a.ALData.iconData[l];n.name=l+"";var p=n.getChildByName("image").getComponent(cc.Sprite);return n.addEvent||(n.addEvent="1",n.on(cc.Node.EventType.TOUCH_END,function(e){var t=e.target.name,o=parseInt(t),n=a.ALData.iconData[o];s.ALSDK.toMiniProgram(n,c.REPORT_TYPE_LIKE_CLICK,s.SDK_MODULE_LIKE_CLICK,"like")},this)),r.ImgLoaderUtil.getImgByUrl(u[4]).then(function(e){if(e.isSucc){var t=new cc.SpriteFrame(e.texture),o=parseInt(n.name);l===o&&(p.spriteFrame=t)}else console.log(e.info)}),n},e.prototype._refreshWidth=function(e){if(this._likeNode){var t=this._likeNode,o=t.children[0],n=t.children[1],a=n.children[0];e&&e>40&&(t.width=e,o.width=e,n.width=e-40,a.x=0,a.width=e-40,this._likeNode.parent&&n.getComponent(cc.Widget).updateAlignment()),this._scrollViewWidth=a.width;var i=n.convertToWorldSpaceAR(cc.v2(.5*n.width,0));this._scollMiddlePos=a.convertToNodeSpaceAR(i)}},e.prototype._adjustLayout=function(){var e=1;e=a.ALData.isVertical?cc.winSize.width/750:cc.winSize.height/750,this._likeNode.scale=e},e.prototype._initContent=function(){var e=this._likeNode.children[0];if(this._bgHide)e.active=!1;else{var t=a.ALData.isVertical?i.ALConfig.DrawerPortrait:i.ALConfig.DrawerLandscape;n.UIUtil.initBitmap(e,e.name,a.ALData.sdkTexture,t)}for(var o=0,r=a.ALData.iconData.length;o<r;o++){var s=a.ALData.iconData[o];if(s[14]){var c={textCnt:0,textArr:new Array,nowTextCnt:-1,loaded:!1,sp:null};this._gifObjMap[s[1]]=c}}this._tableView.set_data(a.ALData.iconData),Object.keys(this._gifObjMap).length>0&&this._initTimer()},e.prototype._initData=function(){var e=this;s.ALSDK.requestModuleData(s.SDK_MODULE_LIKE,function(t){a.ALData.iconData=t,e._reportShow(),e._initContent(),e._beginScrollEff()})},e.prototype._reportShow=function(){!a.ALData.iconData||a.ALData.iconData.length<1||this._reportedShow||(this._reportedShow=!0,s.ALSDK.reportPicsShow(a.ALData.iconData,c.REPORT_TYPE_LIKE_SHOW,s.SDK_MODULE_LIKE_SHOW))},e.prototype._initTimer=function(){this._clearTimer(),this._changeHandler=this._timerHandler.bind(this),this._changeTimer=setInterval(this._changeHandler,a.SDKAniInterval)},e.prototype._clearTimer=function(){this._changeTimer&&(clearInterval(this._changeTimer),this._changeTimer=null,this._changeHandler=null)},e.prototype._timerHandler=function(){if(this._nowTimerCnt++,this._nowTimerCnt<this._stayCnt)for(var e in this._gifObjMap){var t=this._gifObjMap[e];this._changeCntAnim(t)}else{var o=Date.now(),n=.5*a.SDKAniDelay+a.SDKAniInterval*this._stayCnt;if(o-this._lastTime<n)return;this._lastTime=o,this._nowTimerCnt=-1}},e.prototype._changeCntAnim=function(e){if(e.sp&&!(e.textCnt<1)){e.nowTextCnt++,e.nowTextCnt>=e.textCnt&&(e.nowTextCnt=0);var t=e.textArr[e.nowTextCnt];e.sp.spriteFrame=t}},e.prototype.nodeEstimatedHeightOrWidthCB=function(e,t,o){return this.CELL_LIKEITEM_WIDTH},e.prototype.nodeRemoveForIndexCB=function(e,t,o){d.ALUtil.LOG("ALGuessLike nodeRemoveForIndexCB index",t);var n=a.ALData.iconData[t][1];this._gifObjMap[n]&&(this._gifObjMap[n].sp=null)},e.prototype.nodeForIndexCB=function(e,t,o){var c=this,l=e.obtainNodeOfKey(this.CELL_LIKEITEM_IDENTIFYT);l.name=t+"";var h=l.children[0];if(!l.addEvent){l.addEvent="1",l.on(cc.Node.EventType.TOUCH_END,this._onItemClick,this);var u=a.ALData.isVertical?i.ALConfig.DrawerPortrait:i.ALConfig.DrawerLandscape;n.UIUtil.initBitmapOfNode(h,a.ALData.sdkTexture,u)}var p=o,f=o[1],m=h.children[1].getComponent(cc.Sprite);this._gifObjMap[f]&&(this._gifObjMap[f].sp=m);this._gifObjMap[f]&&this._gifObjMap[f].loaded||r.ImgLoaderUtil.getImgByUrl(this._gifObjMap[f]?o[14]:o[4]).then(function(e){if(e.isSucc){var t=e.texture;if(c._gifObjMap[f]){d.ALUtil.LOG("ALGuessLike getImgByUrl nodeAppid",f);var o=c._gifObjMap[f],n=Math.floor(t.width/a.SDKGifSize);o.textCnt=n;for(var i=0;i<n;i++){var r=new cc.SpriteFrame(t,new cc.Rect(a.SDKGifSize*i,0,a.SDKGifSize,a.SDKGifSize));o.textArr.push(r)}o.loaded=!0}else m.spriteFrame=new cc.SpriteFrame(t)}else d.ALUtil.LOG(e.info)});var _=h.children[2];i.ALConfig.guesslike_font_color&&(_.color=_.color.fromHEX(i.ALConfig.guesslike_font_color)),_.getComponent(cc.Label).string=p[5];var g=h.children[3];g.active="1"===p[12]&&s.ALSDK.allowRedPoint(p);var y=h.children[4];if(p[13]&&"0"!==p[13]?y.active=!0:y.active=!1,g.active&&n.UIUtil.initBitmap(g,"redpoint",a.ALData.markerTexture,i.ALConfig.MarkerRect),y.active){var v="";"1"===p[13]?v="mark1":"2"===p[13]?v="mark2":"3"===p[13]&&(v="mark3"),n.UIUtil.initBitmap(y,v,a.ALData.markerTexture,i.ALConfig.MarkerRect)}return l},e.prototype._beginScrollEff=function(){this._likeNode&&this._likeNode.active&&(!a.ALData.iconData||a.ALData.iconData.length<1||this._scrollRuning||(this._scrollRuning=!0,this._totalWidth=this._tableView.estimateContentValue(),this._initScrollEffFunc=this._initScrollEff.bind(this),this._initScrollEff()))},e.prototype._stopScrollEff=function(){d.ALUtil.LOG("ALGuessLike _stopScrollEff"),this._scrollRuning=!1,this._scrollView.stopAutoScroll(),this._stopItemAnim(),this._stopScrollTimer()},e.prototype._scrollEndEvent=function(){var e=-this._scrollContent.x,t=this._totalWidth-this._scrollViewWidth;d.ALUtil.LOG("ALGuessLike _scrollEndEvent",e,t),e<.1||e>.5*t||Math.abs(e-t)<.1?(d.ALUtil.LOG("ALGuessLike _scrollEndEvent init"),this._initScrollEff()):(this._stopItemAnim(),this._stopScrollTimer(),this._scrollTimer=setTimeout(this._initScrollEffFunc,2e3))},e.prototype._stopScrollTimer=function(){this._scrollTimer&&(clearTimeout(this._scrollTimer),this._scrollTimer=null)},e.prototype._initScrollEff=function(){this._scrollTimer=null;var e=-this._scrollContent.x,t=this._totalWidth-this._scrollViewWidth,o=0;e<.5*t?(o=(t-e)/this._scrollSpeed,this._scrollView.scrollTo(cc.v2(1,0),o,!1)):(o=e/this._scrollSpeed,this._scrollView.scrollTo(cc.v2(0,0),o,!1)),d.ALUtil.LOG("ALGuessLike _initScrollEff time",o),this._initItemAnim()},e.prototype._initItemAnim=function(){var e=cc.v2(this._scollMiddlePos.x+-this._scrollContent.x,0),t=this._tableView.getItemByPos(e);if(t){this._stopItemAnim(),this._lastAnimItem=t;var o=cc.sequence(cc.scaleTo(.9,1.15),cc.scaleTo(.8,1),cc.delayTime(.2),cc.callFunc(this._initItemAnim.bind(this)));t.children[0].runAction(o)}},e.prototype._stopItemAnim=function(){this._lastAnimItem&&this._lastAnimItem.isValid&&(this._lastAnimItem.children[0].stopAllActions(),this._lastAnimItem.children[0].scale=1,this._lastAnimItem=null)},e.prototype._onItemClick=function(e){var t=e.target.name,o=parseInt(t),n=a.ALData.iconData[o];s.ALSDK.saveRedPoint(n)&&(e.target.children[0].children[3].active=!1);s.ALSDK.toMiniProgram(n,c.REPORT_TYPE_LIKE_CLICK,s.SDK_MODULE_LIKE_CLICK,this._scene)},e.prototype.showNode=function(e){a.ALData.isTSA?this.hideNode():this._likeNode?this._likeNode.parent?(e&&(this._scene=e),this._likeNode.active=!0,this._scrollRuning||this._beginScrollEff(),this._changeTimer||this._initTimer(),this._reportShow()):d.ALUtil.LOG("ALGuessLike showNode parent empty"):d.ALUtil.LOG("ALGuessLike showNode node empty")},e.prototype.hideNode=function(){this._likeNode?(this._stopScrollEff(),this._reportedShow=!1,this._clearTimer(),this._likeNode.active=!1):d.ALUtil.LOG("ALGuessLike hideNode node empty")},e.prototype.destroyNode=function(){this._likeNode?(this._likeNode.parent&&this._likeNode.removeFromParent(),this._stopScrollEff(),this._reportedShow=!1,this._clearTimer(),this._tableView.destroy(),this._tableView=null,this._likeNode.destroy(),this._likeNode=null):d.ALUtil.LOG("ALGuessLike destroyNode node empty")},e.prototype.setPos=function(e){if(this._likeNode){var t;if(void 0!==e.x)(t=this._likeNode.getComponent(cc.Widget))&&(t.isAlignHorizontalCenter=!1),this._likeNode.x=parseInt(e.x);if(void 0!==e.y)(t=this._likeNode.getComponent(cc.Widget))&&(t.isAlignBottom=!1),this._likeNode.y=parseInt(e.y);if(void 0!==e.w){var o=parseInt(e.w);this._refreshWidth(o),this._tableView.set_data(a.ALData.iconData)}}else d.ALUtil.LOG("ALGuessLike setPos node empty")},e._instance=null,e}();o.ALGuessLike=u;var p={x:375,y:115,width:750,height:230,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,horizontalCenter:0,bottom:0,type:4,children:[{x:0,y:0,width:750,height:230,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,left:0,right:0,top:0,bottom:0,type:0,source:"guesslike",typeMode:0,sizeMode:0},{x:-355,y:0,width:710,height:190,scaleX:1,scaleY:1,anchorX:0,anchorY:.5,rotation:0,left:20,right:20,top:0,bottom:0,type:3,horizontal:!0,vertical:!1,inertia:!0,brake:.75,elastic:!0,bounceDuration:.23,children:[{x:0,y:0,width:710,height:190,scaleX:1,scaleY:1,anchorX:0,anchorY:.5,rotation:0,type:4}]}]},f={x:0,y:0,width:180,height:230,scaleX:1,scaleY:1,anchorX:0,anchorY:.5,rotation:0,type:4,children:[{x:80,y:0,width:160,height:190,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,left:0,type:4,children:[{x:0,y:0,width:160,height:190,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"aniWhite",typeMode:1,sizeMode:0,scale9Grid:"13, 13, 13, 13"},{x:0,y:18,width:144,height:144,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"guess_17miao",typeMode:0,sizeMode:1},{x:0,y:-75,width:120,height:24,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:1,size:24,fontFamily:"Arial",textColor:"000000",text:"\u6700\u5f3a\u5c0f\u4e01\u4e01",textAlign:1,verticalAlign:1},{x:68,y:84,width:43,height:39,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"redpoint",typeMode:0,sizeMode:1},{x:68,y:84,width:66,height:40,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"mark1",typeMode:0,sizeMode:1}]}]};cc._RF.pop()},{"../util/global_def":"global_def","./ALConfig":"ALConfig","./ALData":"ALData","./ALReport":"ALReport","./ALSDK":"ALSDK","./UITableView":"UITableView","./util/ALUtil":"ALUtil","./util/ImgLoaderUtil":"ImgLoaderUtil","./util/UIUtil":"UIUtil"}],ALHelpBar:[function(e,t,o){"use strict";cc._RF.push(t,"b92f9xlTIRFEq751CWTh3EO","ALHelpBar"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./ALData"),a=e("./util/ImgLoaderUtil"),i=e("./ALConfig"),r=e("./util/UIUtil"),s=e("./util/ALUtil"),c=function(){function e(){this._helpNode=null,this._startPos=null}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype._initNode=function(){if(this._helpNode)return this._helpNode;var e=r.UIUtil.parseGameUIFromJSON(l),t=e.children[0];t.on(cc.Node.EventType.TOUCH_START,this.MouseDownEvent,this),t.on(cc.Node.EventType.TOUCH_MOVE,this.MouseMoveEvent,this),t.on(cc.Node.EventType.TOUCH_END,this.MouseUpEvent,this),t.on(cc.Node.EventType.TOUCH_CANCEL,this.MouseUpEvent,this);var o=e.children[1];return o.active=!1,o.children[1].on(cc.Node.EventType.TOUCH_END,this.onCloseClick,this),o.children[2].on(cc.Node.EventType.TOUCH_END,this.onToCommunityClick,this),o.children[3].on(cc.Node.EventType.TOUCH_END,this.onRefreshGameClick,this),this._helpNode=e,n.ALData.helpTexture?this._initUI():this._initData(),this._helpNode},e.prototype._initData=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(o){switch(o.label){case 0:return e=i.ALConfig.helpSprite,[4,a.ImgLoaderUtil.getImgByUrl(e)];case 1:return(t=o.sent()).isSucc?(n.ALData.helpTexture=t.texture,this._initUI(),[2]):(console.warn("ALHelpBar init info fail !!!",t.info),[2])}})})},e.prototype.MouseDownEvent=function(e){this._startPos=this._helpNode.position},e.prototype.MouseMoveEvent=function(e){this._helpNode.position=this._helpNode.position.add(e.getDelta())},e.prototype.MouseUpEvent=function(e){this._helpNode.position.sub(this._startPos).mag()<4&&(this._helpNode.children[1].active=!0)},e.prototype.onCloseClick=function(){this._helpNode.children[1].active=!1},e.prototype.onToCommunityClick=function(){s.ALUtil.LOG("ALHelpBar onToCommunityClick");var e=s.ALUtil.wxExist()?wx:qq;e&&e.navigateToMiniProgram&&e.navigateToMiniProgram({appId:"wx4233cc143076bfdc",path:"pages/index/index",extraData:{appid:i.ALConfig.appId,openid:i.ALConfig.openId,Ads:"sdk",AdsPos:"community",to:"circle"}})},e.prototype.onRefreshGameClick=function(){s.ALUtil.LOG("ALHelpBar onRefreshGameClick");var e=s.ALUtil.wxExist()?wx:qq;e&&e.exitMiniProgram&&e.exitMiniProgram()},e.prototype._initUI=function(){r.UIUtil.initBitmapOfNode(this._helpNode,n.ALData.helpTexture,i.ALConfig.HelpMap)},e.prototype.showNode=function(){this._helpNode?this._helpNode.parent?this._helpNode.active=!0:s.ALUtil.LOG("ALHelpBar showNode parent empty"):s.ALUtil.LOG("ALHelpBar showNode node empty")},e.prototype.hideNode=function(){this._helpNode?this._helpNode.active=!1:s.ALUtil.LOG("ALHelpBar hideNode node empty")},e.prototype.destroyNode=function(){if(this._helpNode){var e=this._helpNode.parent;e&&e.removeChild(this._helpNode),this._helpNode.destroy(),this._helpNode=null}else s.ALUtil.LOG("ALHelpBar hideNode node empty")},e._instance=null,e}();o.ALHelpBar=c;var l={x:0,y:0,width:270,height:90,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:-80,y:0,width:72,height:71,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"unopenicon",typeMode:0,sizeMode:1},{x:0,y:0,width:0,height:0,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:4,children:[{x:0,y:0,width:270,height:89,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"bg1",typeMode:0,sizeMode:1},{x:-80,y:0,width:72,height:71,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"openicon",typeMode:0,sizeMode:1},{x:0,y:0,width:78,height:67,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"quanzi",typeMode:0,sizeMode:1},{x:80,y:0,width:78,height:68,scaleX:1,scaleY:1,anchorX:.5,anchorY:.5,rotation:0,type:0,source:"refresh",typeMode:0,sizeMode:1}]}]};cc._RF.pop()},{"./ALConfig":"ALConfig","./ALData":"ALData","./util/ALUtil":"ALUtil","./util/ImgLoaderUtil":"ImgLoaderUtil","./util/UIUtil":"UIUtil"}],ALIconNode:[function(e,t,o){"use strict";cc._RF.push(t,"e6012GFw/hHArRgtb1H/j+4","ALIconNode"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./ALData"),a=e("./util/ImgLoaderUtil"),i=e("./ALSDK"),r=e("./ALReport"),s=e("./util/ALUtil"),c=e("./util/UIUtil"),l=e("./ALConfig"),d=function(e){function t(t,o,n){var a=e.call(this)||this;return a._textCnt=0,a._textArr=null,a._iconSP=null,a._scene="icons",a._iconData=null,a._initScale=1,a._isGif=!1,a._changeTimer=null,a._changeHandler=null,a._nowTextCnt=-1,a._iconData=t,o&&(a._scene=o),n&&n>0&&(a._initScale=n),t[14]&&(a._isGif=!0),a._initNode(),a}return __extends(t,e),t.prototype._initNode=function(){this.width=this.height=n.SDKGifSize;var e=new cc.Node,t=e.addComponent(cc.Sprite);this._iconSP=t,e.width=e.height=n.SDKGifSize,this.addChild(e);var o=new cc.Node;o.addComponent(cc.Sprite),o.x=48,o.y=48,o.width=43,o.height=39,this.addChild(o);var a=new cc.Node;a.addComponent(cc.Sprite),a.x=48,a.y=48,a.width=66,a.height=40,this.addChild(a),this.on(cc.Node.EventType.TOUCH_START,this.onIconClick,this),this._adjustLayout(),this._initData()},t.prototype._adjustLayout=function(){var e=1;e=.7*(e=n.ALData.isVertical?cc.winSize.width/750:cc.winSize.height/750)*this._initScale,this.scale=e},t.prototype._initContent=function(){if(n.ALData.markerTexture){var e=this.children[1];e.active="1"===this._iconData[12],e.active&&c.UIUtil.initBitmap(e,"redpoint",n.ALData.markerTexture,l.ALConfig.MarkerRect);var t=this.children[2];if(this._iconData[13]&&"0"!==this._iconData[13]?t.active=!0:t.active=!1,t.active){var o="";"1"===this._iconData[13]?o="mark1":"2"===this._iconData[13]?o="mark2":"3"===this._iconData[13]&&(o="mark3"),c.UIUtil.initBitmap(t,o,n.ALData.markerTexture,l.ALConfig.MarkerRect)}}},t.prototype._initData=function(){return __awaiter(this,void 0,void 0,function(){var e,t=this;return __generator(this,function(o){return e=this._isGif?this._iconData[14]:this._iconData[4],a.ImgLoaderUtil.getImgByUrl(e).then(function(e){if(e.isSucc){var o=e.texture;if(t._isGif){var a=Math.floor(o.width/n.SDKGifSize);if(a<1)return void s.ALUtil.LOG("ALGameMore _initChangeCnt cnt 0 --- ");t._textCnt=a,t._textArr=new Array;for(var i=0;i<a;i++){var r=new cc.SpriteFrame(o,new cc.Rect(n.SDKGifSize*i,0,n.SDKGifSize,n.SDKGifSize));t._textArr.push(r)}t._initTimer()}else t._iconSP.spriteFrame=new cc.SpriteFrame(o);t._initContent()}else s.ALUtil.LOG(e.info)}),[2]})})},t.prototype.onIconClick=function(){var e=this._iconData;i.ALSDK.saveRedPoint(e)&&(this.children[5].active=!1),i.ALSDK.toMiniProgram(e,r.REPORT_TYPE_MORE_CLICK,i.SDK_MODULE_MORE_CLICK,this._scene)},t.prototype._initTimer=function(){this._clearTimer(),this._changeHandler=this._changeSp.bind(this),this._changeTimer=setInterval(this._changeHandler,n.SDKAniInterval)},t.prototype._clearTimer=function(){this._changeTimer&&(clearInterval(this._changeTimer),this._changeTimer=null,this._changeHandler=null)},t.prototype._changeSp=function(){if(this.isValid){if(this._textArr&&!(this._textArr.length<1)){this._nowTextCnt++,this._nowTextCnt=this._nowTextCnt%this._textCnt;var e=this._textArr[this._nowTextCnt];this._iconSP.spriteFrame=e}}else this._clearTimer()},t.prototype.destroyNode=function(){this._clearTimer(),this._iconSP=null,this._textArr=null},t}(cc.Node);o.ALIconNode=d,cc._RF.pop()},{"./ALConfig":"ALConfig","./ALData":"ALData","./ALReport":"ALReport","./ALSDK":"ALSDK","./util/ALUtil":"ALUtil","./util/ImgLoaderUtil":"ImgLoaderUtil","./util/UIUtil":"UIUtil"}],ALIntercept:[function(e,t,o){"use strict";cc._RF.push(t,"fe860pppLFHbKxUOE9oidCr","ALIntercept"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./util/StringUtil"),a=e("./ALData"),i=e("./util/ALUtil"),r=e("./ALReport"),s=function(){function e(){this._inited=!1}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e,e._instance.interceptWXShare()),e._instance},enumerable:!0,configurable:!0}),e.prototype.interceptWXShare=function(){i.ALUtil.LOG("ALIntercept intercept WXShare "),i.ALUtil.wxqqNotExist()||(this._onShareApp(),this._rewardedVideoAd(),i.ALUtil.readAppIDList().then(function(e){a.ALData.appIdListStr=e,console.log("ALIntercept readAppIDList ",e)}))},e.prototype.init=function(){this._inited||(this._inited=!0,i.ALUtil.LOG("ALIntercept init "),i.ALUtil.wxqqNotExist()||(this._pay(),this._shareApp(),this._execShowHide(),i.ALUtil.LOG("ALIntercept init success ")))},e.prototype._execShowHide=function(){e.TimeShow=Date.now(),e.Params={type:"duration",sub_type:r.REPORT_TYPE_GAME_DURATION,diff_key:"",extra:""};var t=i.ALUtil.wxExist()?wx:qq;t.onShow(function(t){e.TimeShow=Date.now(),i.ALUtil.LOG("ALIntercept wxQQ.onShow ")}),t.onHide(function(t){var o=Math.ceil((Date.now()-e.TimeShow)/1e3);o>2&&(e.Params.diff_key=o.toString(),e.Params.extra=r.ALReport.instance.getAdsPos(),r.ALReport.instance.reportDataToMarket(e.Params)),i.ALUtil.LOG("ALIntercept wxQQ.onHide ")})},e.prototype._rewardedVideoAd=function(){var t=i.ALUtil.wxExist()?wx:qq,o=t.createRewardedVideoAd;Object.defineProperty(t,"createRewardedVideoAd",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=o.apply(this,arguments);if(t.isIntercept)return t;t.isIntercept=!0;var n=arguments[0]||{};e.VideoId=n.adUnitId;var a=t.show;Object.defineProperty(t,"show",{configurable:!0,enumerable:!0,writable:!0,value:function(){return i.ALUtil.LOG("ALIntercept _rewardedVideoAd show --- "),r.ALReport.instance.report(r.REPORT_TYPE_VIDEO_OPEN,e.VideoId),a.apply(this,arguments)}}),t.onClose(e.VideoClose);var s=t.offClose;return Object.defineProperty(t,"offClose",{configurable:!0,enumerable:!0,writable:!0,value:function(){s.apply(this,arguments),0==arguments.length&&this.onClose(e.VideoClose)}}),t}})},e.VideoClose=function(t){i.ALUtil.LOG("ALIntercept _rewardedVideoAd onClose --- ",t),void 0===t||t&&t.isEnded?r.ALReport.instance.report(r.REPORT_TYPE_VIDEO_WATCH_NORMAL,e.VideoId):r.ALReport.instance.report(r.REPORT_TYPE_VIDEO_WATCH_FAIL,e.VideoId)},e.prototype._pay=function(){var e=i.ALUtil.wxExist()?wx:qq,t=e.requestMidasPayment;Object.defineProperty(e,"requestMidasPayment",{configurable:!0,enumerable:!0,writable:!0,value:function(){r.ALReport.instance.report(r.REPORT_TYPE_PAY_MENT_START);var e=arguments[0]||{},o=e.buyQuantity||"0",n=e.success||null;e.success=function(e){i.ALUtil.LOG("ALIntercept _pay success --- ",e),o+="|1",r.ALReport.instance.reportPay(o),n&&n(e)};var a=e.fail||null;return e.fail=function(e){i.ALUtil.LOG("ALIntercept _pay fail --- ",e),o+="|0",r.ALReport.instance.reportPay(o),a&&a(e)},t.apply(this,arguments)}})},e.prototype._execOnShareApp=function(){if(e.InfoGot=!0,e.ShareParamFunc){var t=i.ALUtil.wxExist()?wx:qq;t.offShareAppMessage(e.ShareParamFunc),t.onShareAppMessage(e.ShareParamFunc)}},e.prototype._shareApp=function(){var t=i.ALUtil.wxExist()?wx:qq,o=t.shareAppMessage;Object.defineProperty(t,"shareAppMessage",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=arguments[0]||{};return e._handleShareParam(t),t.query=t.query+"&a_inviter="+a.ALData.inviter+"&a_level="+a.ALData.level+"&a_top_inviter="+a.ALData.topInviter,i.ALUtil.LOG("ALIntercept shareAppMessage query ",t.query),o.apply(this,arguments)}})},e.prototype._onShareApp=function(){var t=i.ALUtil.wxExist()?wx:qq,o=t.onShareAppMessage;Object.defineProperty(t,"onShareAppMessage",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=arguments[0];return t?e.InfoGot?(i.ALUtil.LOG("ALIntercept onShareAppMessage _infoExist"),arguments[0]=function(){var o=t();return e._handleShareParam(o,!1),o.query=o.query+"&a_inviter="+a.ALData.inviter+"&a_level="+a.ALData.level+"&a_top_inviter="+a.ALData.topInviter,i.ALUtil.LOG("ALIntercept onShareAppMessage query ",o.query),{title:o.title,imageUrl:o.imageUrl,imageUrlId:o.imageUrlId,query:o.query}},o.apply(this,arguments)):(e.ShareParamFunc=t,i.ALUtil.LOG("ALIntercept onShareAppMessage _infoExist not"),o.apply(this,arguments)):(i.ALUtil.LOG("ALIntercept onShareAppMessage argument0F empty"),o.apply(this,arguments))}});var n=t.offShareAppMessage;Object.defineProperty(t,"offShareAppMessage",{configurable:!0,enumerable:!0,writable:!0,value:function(){n.apply(this,arguments),console.warn("ALIntercept offShareAppMessage !!!!!! ")}})},e._handleShareParam=function(e,t){void 0===t&&(t=!0);var o=e.query||"",s=e.imageUrl,c=e.imageUrlId,l=n.StringUtil.parseQueryString(o);i.ALUtil.LOG("ALIntercept _handleShareParam queryObj ",l),a.ALData.shareScene=l.shareScene||0;var d="default";if(!l.Ads){if(a.ALData.sdkData&&a.ALData.sdkData.shares&&a.ALData.sdkData.shares.length>0){var h=Math.floor(Math.random()*a.ALData.sdkData.shares.length),u=a.ALData.sdkData.shares[h];e.imageUrl=u.url,e.title=u.desc,d=u.shareid}else if(c)d=c;else if(s){var p=i.ALUtil.getUrlFileName(s);i.ALUtil.LOG("ALIntercept _handleShareParam ",s,p),d=0!==s.indexOf("http")&&-1===p.indexOf(".")?"screenShot":p.replace(".","_")}var f="&Ads=a_Share&AdsPos="+d;i.ALUtil.LOG("ALIntercept _handleShareParam ads_str ",f),e.query=o+f}t&&r.ALReport.instance.report(r.REPORT_TYPE_SHARE_READY,d)},e._instance=null,e.TimeShow=null,e.Params=null,e.VideoId=null,e.InfoGot=!1,e.ShareParamFunc=null,e}();o.ALIntercept=s,cc._RF.pop()},{"./ALData":"ALData","./ALReport":"ALReport","./util/ALUtil":"ALUtil","./util/StringUtil":"StringUtil"}],ALReport:[function(e,t,o){"use strict";cc._RF.push(t,"5fc0eB8CFBOtIXZbnXcRa5R","ALReport"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./ALData"),a=e("./ALConfig"),i=e("./util/HttpUtil"),r=e("./util/StringUtil"),s=e("./util/ALUtil"),c=e("./ALIntercept"),l=function(){function e(){this.Ads="",this.AdsPos="",this.reportPrefix="",this.reportDevice2Sence="",this._inited=!1}return e.prototype.getAdsPos=function(){return this.Ads+"|"+this.AdsPos},Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){this._inited||(this._inited=!0,s.ALUtil.LOG("ALReport init "),s.ALUtil.wxqqNotExist()||(this._initAdsPos(),this._initReportData(),s.ALUtil.LOG("ALReport init success ")))},e.prototype.reportAnalytics=function(e,t){if(isNaN(t))s.ALUtil.LOG("ALReport step error --- ",t);else{this._inited||(a.ALConfig.appId=e,this.init());var o=this.reportPrefix+this._getCurrentDate()+"|"+this._getTimeStamp()+"|"+this.reportDevice2Sence+n.ALData.level+"|0|"+a.ALConfig.openId+"|10|"+t+"||||"+n.ALData.topInviter;s.ALUtil.LOG("ALReport reportAnalytics str --- ",o);var c=r.StringUtil.base64encode(o);i.HttpUtil.POST(a.ALConfig.ReportDataDomain+"/report",{info:c}).then(function(e){e.isSucc||s.ALUtil.LOG("ALReport reportAnalytics fail --- ",e.reason)})}},e.prototype.report=function(e,t){this._inited||this.init();var c=e.split("_");if(c.length<2)console.warn("ALReport \u53c2\u6570\u4f20\u9012\u9519\u8bef");else{var l=t||"";if(e===o.REPORT_TYPE_OPEN_ID)return a.ALConfig.openId=t,window.ALOpenId=t,this.reportOpenId(),void this._initLevelData();var d=c[0],h=c[1],u=this.reportPrefix+this._getCurrentDate()+"|"+this._getTimeStamp()+"|"+this.reportDevice2Sence+n.ALData.level+"|0|"+a.ALConfig.openId+"|"+d+"|"+h+"|0|"+l+"||"+n.ALData.topInviter;s.ALUtil.LOG("ALReport _report str --- ",u);var p=r.StringUtil.base64encode(u);i.HttpUtil.POST(a.ALConfig.ReportDataDomain+"/report",{info:p}).then(function(e){e.isSucc||s.ALUtil.LOG("ALReport _report fail --- ",e.reason)})}},e.prototype.reportOpenId=function(){var e={type:"openId",sub_type:o.REPORT_TYPE_OPEN_ID,extra:this.getAdsPos()};this.reportDataToMarket(e)},e.prototype.reportPay=function(e){var t={type:"pay",sub_type:o.REPORT_TYPE_PAY_MENT_ENTER,extra:e};this.reportDataToMarket(t)},e.prototype.getShareScore=function(e,t){var o={appid:a.ALConfig.appId,openid:a.ALConfig.openId,scene:t};i.HttpUtil.POST(a.ALConfig.ReportMarketDomain+"/box/score",o).then(function(t){t.isSucc?e(t.data.score):(e(0),s.ALUtil.LOG("ALReport getShareScore fail --- ",t.reason))})},e.prototype.reportShareState=function(e){var t=e?"1":"2",n={type:"share",sub_type:o.REPORT_TYPE_SHARE_SUCCESS,diff_key:t};this.reportDataToMarket(n)},e.prototype.reportDataToMarket=function(e){e.id=a.ALConfig.appId,e.openid=a.ALConfig.openId,i.HttpUtil.POST(a.ALConfig.ReportMarketDomain+"/box/stats_sdk",e).then(function(e){e.isSucc||s.ALUtil.LOG("ALReport reportServer fail --- ",e.reason)})},e.prototype._initAdsPos=function(){var e="",t="";try{var o=(s.ALUtil.wxExist()?wx:qq).getLaunchOptionsSync();if(s.ALUtil.LOG("ALReport opts --- ",o),n.ALData.opts=o,n.ALData.scene=o.scene,(r=o.query).scene){var a=decodeURIComponent(r.scene).split(",");e=a[1],t=a[2]}else if(r.Ads||r.AdsPos)e=r.Ads?r.Ads:"",t=r.AdsPos?r.AdsPos:"";else if(o.referrerInfo&&o.referrerInfo.extraData){var i=o.referrerInfo.extraData;e=i.Ads?i.Ads:"",t=i.AdsPos?i.AdsPos:""}""===e&&("1037"==o.scene?(e="fromMini",t=o.referrerInfo.appId||"0"):(e="weixin",t=o.scene||"0"))}catch(e){console.info("ALReport _initAdSource --- ",e)}if(this.Ads=e,this.AdsPos=t,1044==n.ALData.scene||1007==n.ALData.scene||1036==n.ALData.scene||1008==n.ALData.scene){var r=n.ALData.opts.query;n.ALData.topInviter=r.a_top_inviter||"0",n.ALData.level=r.a_level||1}},e.prototype._initLevelData=function(){var e=null;if(1044==n.ALData.scene||1007==n.ALData.scene||1036==n.ALData.scene||1008==n.ALData.scene){var t=n.ALData.opts.query;e={appid:a.ALConfig.appId,openid:a.ALConfig.openId,level:t.a_level||"",inviter:t.a_inviter||"",top_inviter:t.a_top_inviter||""}}else e={appid:a.ALConfig.appId,openid:a.ALConfig.openId};i.HttpUtil.GET(a.ALConfig.ReportMarketDomain+"/box/accountinfo",e).then(function(e){if(e.isSucc){var t=e.data.info;s.ALUtil.LOG("ALReport _initLevelData data --- ",e.data),n.ALData.topInviter=t.top_inviter||"0",n.ALData.inviter=a.ALConfig.openId,n.ALData.level=t.share_level?parseInt(t.share_level)+1:1,n.ALData.score=t.score?parseInt(t.score):0,c.ALIntercept.instance._execOnShareApp()}else s.ALUtil.LOG("ALReport _initLevelData fail --- ",e.reason)})},e.prototype._initReportData=function(){var e="",t="",o="",n="",i="";try{var r=(s.ALUtil.wxExist()?wx:qq).getSystemInfoSync();e=r.platform,t=r.model,o=r.system,n=r.language,i=r.version}catch(e){console.info("ALReport _initParam --- ",e)}t=t&&"unknown"!==t?-1!=t.indexOf("iPhone")?"ios":"android":"ios",this.reportPrefix="t_event|distribute_all|",this.reportDevice2Sence=e+"|"+t+"|"+a.ALConfig.version+"|"+o+"||0.0.0.0||"+n+"||"+i+"|"+a.ALConfig.appId+"|"+this.Ads+"|"+this.AdsPos+"|"},e.prototype._getCurrentDate=function(){var e=new Date,t=e.getFullYear().toString(),o=(e.getMonth()+1).toString(),n=e.getDate().toString();return 1===o.length&&(o="0"+o),1===n.length&&(n="0"+n),t+o+n},e.prototype._getTimeStamp=function(){return Math.round(Date.now()/1e3)},e._instance=null,e}();o.ALReport=l,o.REPORT_TYPE_SHOW="1_1",o.REPORT_TYPE_LOGIN="1_2",o.REPORT_TYPE_OPEN_ID="1_3",o.REPORT_TYPE_AUTH="1_4",o.REPORT_TYPE_LIKE_CLICK="1_6",o.REPORT_TYPE_LIKE_SHOW="1_8",o.REPORT_TYPE_DRAWER_CLICK="1_7",o.REPORT_TYPE_DRAWER_SHOW="1_9",o.REPORT_TYPE_CLICK_SUCCESS="3_1",o.REPORT_TYPE_SHARE_READY="1_10",o.REPORT_TYPE_SHARE_SUCCESS="1_5",o.REPORT_TYPE_GAME_DURATION="1_12",o.REPORT_TYPE_SCENE_CLICK="1_13",o.REPORT_TYPE_SCENE_CLICK_SUCCESS="1_14",o.REPORT_TYPE_PAY_MENT="6_0",o.REPORT_TYPE_PAY_MENT_START="6_2",o.REPORT_TYPE_PAY_MENT_ENTER="6_3",o.REPORT_TYPE_MORE_SHOW="2_0",o.REPORT_TYPE_MORE_CLICK="2_1",o.REPORT_TYPE_MORE_CLICK_O="2_2",o.REPORT_TYPE_MORE_LONG_CLICK_O="2_3",o.REPORT_TYPE_VIDEO_OPEN="2_4",o.REPORT_TYPE_VIDEO_WATCH_FAIL="2_5",o.REPORT_TYPE_VIDEO_WATCH_NORMAL="2_6",o.REPORT_TYPE_GAME_BOX_SHOW="8_1",o.REPORT_TYPE_GAME_BOX_CLICK="8_2",o.REPORT_TYPE_GAME_BOX_BANNER_CLICK="8_3",o.REPORT_TYPE_VIDEO_BTN_SHOW="5_6",o.REPORT_TYPE_VIDEO_CLICK="5_7",o.REPORT_TYPE_SHARE_BTN_SHOW="5_8",o.REPORT_TYPE_SHARE_CLICK="5_9",cc._RF.pop()},{"./ALConfig":"ALConfig","./ALData":"ALData","./ALIntercept":"ALIntercept","./util/ALUtil":"ALUtil","./util/HttpUtil":"HttpUtil","./util/StringUtil":"StringUtil"}],ALSDK:[function(e,t,o){"use strict";cc._RF.push(t,"8f42311+LtAB5rcBCCfxmKC","ALSDK"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./ALIntercept"),a=e("./ALReport"),i=e("./ALConfig"),r=e("./util/HttpUtil"),s=e("./util/ImgLoaderUtil"),c=e("./ALData"),l=e("./util/ALUtil"),d=function(){function e(){}return e.init=function(e,t,o,d){return __awaiter(this,void 0,void 0,function(){var h,u;return __generator(this,function(p){switch(p.label){case 0:return this._inited?[2]:(this._inited=!0,console.warn("[aladinsdk] laya\u5fc5\u987b\u914d\u7f6e(downloadFile\u5408\u6cd5\u57df\u540d) https://ad-static.boomegg.cn"),l.ALUtil.wxExist()&&0!==e.indexOf("wx")?(console.error("[aladinsdk] \u8bf7\u5728\u521d\u59cb\u5316sdk\u65f6\u4f20\u5165\u6b63\u786e\u7684appid "),[2]):(i.ALConfig.appId=e,i.ALConfig.version=t,window.cc?c.ALData.isVertical=window.cc.winSize.height>window.cc.winSize.width:window.Laya?c.ALData.isVertical=window.Laya.stage.height>window.Laya.stage.width:window.egret&&(c.ALData.isVertical=window.egret.lifecycle.stage.stageHeight>window.egret.lifecycle.stage.stageWidth),this._parseConfigData(o),n.ALIntercept.instance.init(),a.ALReport.instance.init(),h={id:i.ALConfig.appId,sdk_version:i.ALConfig.sdkVersion,version:i.ALConfig.version,appidList:c.ALData.appIdListStr,ads:a.ALReport.instance.Ads,adsPos:a.ALReport.instance.AdsPos},[4,r.HttpUtil.GET(i.ALConfig.sdkInitUrl,h)]));case 1:return(u=p.sent()).isSucc?(c.ALData.sdkData=u.data,this._parseSDKData(),s.ImgLoaderUtil.getImgByUrl(i.ALConfig.MarkerSprite+Math.floor(Date.now()/36e5)).then(function(e){e.isSucc?window.egret&&window.egret.SpriteSheet?c.ALData.markerTexture=new window.egret.SpriteSheet(e.texture):c.ALData.markerTexture=e.texture:console.warn("ImgLoaderUtil:"+e.info)}),d&&(d(),d=null),[2]):(console.warn("ALSDK init info fail !!!",u.reason),[2])}})})},e._parseConfigData=function(e){e&&e.themeurl?i.ALConfig.themeurl=e.themeurl:i.ALConfig.themeurl=c.ALData.isVertical?i.ALConfig.drawerSpriteV:i.ALConfig.drawerSpriteH,e&&(e.draw_font_color&&(i.ALConfig.draw_font_color=e.draw_font_color),e.guesslike_font_color&&(i.ALConfig.guesslike_font_color=e.guesslike_font_color))},e._parseSDKData=function(){var e=c.ALData.sdkData;if(e){if(e.is_tsa&&1==e.is_tsa&&(c.ALData.isTSA=!0),e.shares){if(e.base){var t=e.base;e.shares.forEach(function(e){e.url=t+e.url})}c.ALData.allowShare=e.open&&"1"===e.open}if(e.sdk_version&&e.sdk_version!==i.ALConfig.sdkVersion)this._cmpVersion(e.sdk_version,i.ALConfig.sdkVersion)>0&&(console.log("[aladinsdk] changelog !!!",e.changelog),console.warn("[aladinsdk] \u8bf7\u5347\u7ea7SDK\u7248\u672c\uff1a"),console.warn("[aladinsdk] \u5f53\u524d\u7248\u672c\u53f7\uff1a>>",i.ALConfig.sdkVersion),console.warn("[aladinsdk] \u6700\u65b0\u7248\u672c\u53f7\uff1a>>",e.sdk_version),console.warn("[aladinsdk] \u4e0b\u8f7d\u5730\u5740\uff1ahttps://mprogram.boomegg.cn/sprogram/ads/c/sdk/url"))}},e.requestCPData=function(e,t,o){return __awaiter(this,void 0,void 0,function(){var n,a=this;return __generator(this,function(s){switch(s.label){case 0:return[4,this.readAppIDList()];case 1:return s.sent(),n={id:i.ALConfig.appId,module:e,appidList:c.ALData.appIdListStr,scene:t},r.HttpUtil.GET(i.ALConfig.baseUrl,n).then(function(e){if(e.isSucc){var t=a.handleHttpData(e);o(t)}else console.warn("ALSDK requestBannerData fail !!!",e.reason)}),[2]}})})},e.requestModuleData=function(e,t){return __awaiter(this,void 0,void 0,function(){var o,n,a,l,d,h;return __generator(this,function(u){switch(u.label){case 0:return[4,this.readAppIDList()];case 1:return u.sent(),c.ALData.markerTexture?[3,3]:[4,s.ImgLoaderUtil.getImgByUrl(i.ALConfig.MarkerSprite+Math.floor(Date.now()/36e5))];case 2:(o=u.sent()).isSucc?window.egret&&window.egret.SpriteSheet?c.ALData.markerTexture=new window.egret.SpriteSheet(o.texture):c.ALData.markerTexture=o.texture:console.warn("ImgLoaderUtil:"+o.info),u.label=3;case 3:return n={id:i.ALConfig.appId,module:e,appidList:c.ALData.appIdListStr},a=null,(l="Icon"===e?c.ALData.iconData:c.ALData.moreData)?(c.ALData.sdkTexture?t(l):this.requestTheme().then(function(e){t(l)}),[2]):[4,r.HttpUtil.GET(i.ALConfig.baseUrl,n)];case 4:return a=u.sent(),[4,this.requestTheme()];case 5:return d=u.sent(),[4,Promise.all([a,d])];case 6:return u.sent(),a.isSucc?(h=this.handleHttpData(a),"icon"===e?c.ALData.iconData=h:"more"===e&&(c.ALData.moreData=h),t(h),[2]):(console.warn("ALSDK requestModuleData fail !!!",a.reason,e),[2])}})})},e.handleHttpData=function(e){var t=e.data.values||[],o=e.data.base;if(o&&t.length>0)for(var n=0,a=t.length;n<a;n++){var i=t[n];i[4]=o+i[4]}return t},e.requestTheme=function(){var e=this;if(this._loadedTheme||c.ALData.sdkTexture)return Promise.resolve(!0);if(l.ALUtil.LOG("ALSDK requestTheme log !!!"),!this._loadingTheme){this._loadingTheme=!0,l.ALUtil.LOG("ALSDK requestTheme loading !!!");var t=i.ALConfig.themeurl;s.ImgLoaderUtil.getImgByUrl(t).then(function(t){t.isSucc?window.egret&&window.egret.SpriteSheet?c.ALData.sdkTexture=new window.egret.SpriteSheet(t.texture):c.ALData.sdkTexture=t.texture:console.warn("ImgLoaderUtil:"+t.info),e._execLoadingResolve()})}return new Promise(function(t,o){e._loadingResolveArr||(e._loadingResolveArr=new Array),e._loadingResolveArr.push(t)})},e._execLoadingResolve=function(){if(this._loadingTheme=!1,this._loadedTheme=!0,this._loadingResolveArr){for(var e=0,t=this._loadingResolveArr.length;e<t;e++){(0,this._loadingResolveArr[e])(!0),this._loadingResolveArr[e]=null}this._loadingResolveArr=null}},e.readAppIDList=function(){var e=this;if(l.ALUtil.wxNotExist())return Promise.resolve("");if(this._readedAppID||c.ALData.appIdListStr)return Promise.resolve(c.ALData.appIdListStr);if(l.ALUtil.LOG("ALSDK readAppIDList log !!!"),!this._readingAppID){this._readingAppID=!0,l.ALUtil.LOG("ALSDK readAppIDList loading !!!");var t=l.ALUtil.wxExist()?wx:qq,o="devtools"===t.getSystemInfoSync().platform?"game.json":"app-config.json";t.getFileSystemManager().readFile({filePath:o,encoding:"utf-8",success:function(t){var o=t.data,n=JSON.parse(o).navigateToMiniProgramAppIdList,a=n?n.join(","):"";e._execReadingResolve(a)},fail:function(t){console.warn("ALSDK readAppIDList error ",t),e._execReadingResolve("")}})}return new Promise(function(t,o){e._readingResolveArr||(e._readingResolveArr=new Array),e._readingResolveArr.push(t)})},e._execReadingResolve=function(e){if(c.ALData.appIdListStr=e,this._readingAppID=!1,this._readedAppID=!0,this._readingResolveArr){for(var t=0,o=this._readingResolveArr.length;t<o;t++){(0,this._readingResolveArr[t])(!0),this._readingResolveArr[t]=null}this._readingResolveArr=null}},e.reportPicsShow=function(e,t,o){for(var n=[],i=0,r=e.length;i<r;i++){var s=e[i],c={};c.appid=s[1];var d=s[14]||s[4];c.url=l.ALUtil.getUrlReportName(d),n.push(c)}var h={};h[o]=n;var u={type:"show",sub_type:t,game_list:JSON.stringify(h)};a.ALReport.instance.reportDataToMarket(u)},e.saveRedPoint=function(e){if(l.ALUtil.wxqqNotExist()||"1"!==e[12])return!1;var t="{"+i.ALConfig.appId+":"+e[1]+"}";return(l.ALUtil.wxExist()?wx:qq).setStorage({key:t,data:Date.now()}),!0},e.allowRedPoint=function(e){if(l.ALUtil.wxqqNotExist())return!1;var t="{"+i.ALConfig.appId+":"+e[1]+"}",o=(l.ALUtil.wxExist()?wx:qq).getStorageSync(t);if(!o)return!0;var n=new Date(o),a=new Date,r=n.getDate(),s=a.getDate();return r!==s&&(Math.abs(r-s)>1||a.getHours()>4)},e.toMiniProgram=function(t,o,n,r){var s=l.ALUtil.parseNavigateParam(t),c=t[14]||t[4],d={appid:s.target_appid,type:"click",sub_type:o,diff_key:c,extra:n,scene:r},h={appid:s.target_appid,type:"jump",sub_type:a.REPORT_TYPE_SCENE_CLICK_SUCCESS,extra:n,scene:r};if(l.ALUtil.LOG("[aladinsdk] \u8df3\u8f6c\u53c2\u6570\u5982\u4e0b\uff1a",t),l.ALUtil.LOG("[aladinsdk] data.appId:>>",s.appId),l.ALUtil.LOG("[aladinsdk] data.path:>>",s.path),l.ALUtil.LOG("[aladinsdk] data.extraData:>>",s.extraData),l.ALUtil.LOG("[aladinsdk] Data.conf.envVersion:>>",i.ALConfig.envVersion),!l.ALUtil.wxqqNotExist()){var u=t[6]||null,p=l.ALUtil.wxExist()?wx:qq;a.ALReport.instance.reportDataToMarket(d),u||!p.navigateToMiniProgram?this._preview(u,h):p.navigateToMiniProgram({appId:s.appId,path:s.path,extraData:s.extraData,envVersion:i.ALConfig.envVersion,success:function(e){a.ALReport.instance.reportDataToMarket(h)},fail:function(t){l.ALUtil.LOG("ALSDK navigateToMiniProgram fail ",t),t&&t.errMsg&&-1===t.errMsg.indexOf("cancel")&&u&&e._preview(u,h)}})}},e._preview=function(e,t){(l.ALUtil.wxExist()?wx:qq).previewImage({urls:[e],success:function(){l.ALUtil.LOG("ALSDK _preview success "),a.ALReport.instance.reportDataToMarket(t)},fail:function(e){console.warn("ALSDK _preview error ",e)}})},e._cmpVersion=function(e,t){var o=this._toNum(e),n=this._toNum(t);return l.ALUtil.LOG("ALSDK _cmpVersion _a _b !!!",o,n),o-n},e._toNum=function(e){for(var t=e.split("."),o=["0000","000","00","0",""],n=0;n<t.length;n++){var a=t[n].length;t[n]=o[a]+t[n]}return parseInt(t.join(""))},e.interceptCtrl=n.ALIntercept.instance,e._inited=!1,e._loadingTheme=!1,e._loadedTheme=!1,e._loadingResolveArr=null,e._readingAppID=!1,e._readedAppID=!1,e._readingResolveArr=null,e}();o.ALSDK=d,o.SDK_MODULE_MORE="More",o.SDK_MODULE_LIKE="Icon",o.SDK_MODULE_DRAWER="Icon",o.SDK_DATA_BANNER="Banner",o.SDK_MODULE_MORE_SHOW="MORE_SHOW",o.SDK_MODULE_LIKE_SHOW="LIKE_SHOW",o.SDK_MODULE_DRAWER_SHOW="DRAWER_SHOW",o.SDK_MODULE_ICONS_CLICK="ICONS_CLICK",o.SDK_MODULE_BANNER_CLICK="BANNER_CLICK",o.SDK_MODULE_MORE_CLICK="MORE_CLICK",o.SDK_MODULE_LIKE_CLICK="LIKE_CLICK",o.SDK_MODULE_DRAWER_CLICK="DRAWER_CLICK",cc._RF.pop()},{"./ALConfig":"ALConfig","./ALData":"ALData","./ALIntercept":"ALIntercept","./ALReport":"ALReport","./util/ALUtil":"ALUtil","./util/HttpUtil":"HttpUtil","./util/ImgLoaderUtil":"ImgLoaderUtil"}],ALUtil:[function(e,t,o){"use strict";cc._RF.push(t,"11a98WT/XBK2ovKJlC2f4DX","ALUtil"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../ALConfig"),a=function(){function e(){}return e.LOG=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];this.DEBUG&&console.log(e,t)},e.wxNotExist=function(){return"undefined"==typeof wx},e.wxExist=function(){return"undefined"!=typeof wx},e.wxShowModel=function(e,t){wx.showModal({title:e,content:t,success:function(o){wx.setClipboardData({data:e+t})}})},e.qqNotExist=function(){return"undefined"==typeof qq},e.qqExist=function(){return"undefined"!=typeof qq},e.wxqqExist=function(){return"undefined"!=typeof wx||"undefined"!=typeof qq},e.wxqqNotExist=function(){return"undefined"==typeof wx&&"undefined"==typeof qq},e.readAppIDList=function(){return new Promise(function(t,o){var n=e.wxExist()?wx:qq,a="devtools"===n.getSystemInfoSync().platform?"game.json":"app-config.json";n.getFileSystemManager().readFile({filePath:a,encoding:"utf-8",success:function(e){var o=e.data,n=JSON.parse(o).navigateToMiniProgramAppIdList,a="";n&&(a=n.join(",")),t(a)},fail:function(o){e.LOG("ALSDK readAppIDList error ",o),t("")}})})},e.getUrlFileName=function(e){return e.split("/").pop().split("?")[0].split("#")[0]},e.getUrlReportName=function(e){var t=e.split(n.ALConfig.ImgDomain);return t.length>1?t[1].toString():t[0].toString()},e._buildQueryString=function(e){var t=new Array;for(var o in e)e.hasOwnProperty(o)&&t.push(o+"="+e[o]);return t.join("&")},e._mergeParams=function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},e._parseQueryString=function(e){var t={};if(!e)return t;for(var o=e.split("&"),n=null,a=0,i=o.length;a<i;a++)t[(n=o[a].split("="))[0]]=n[1];return t},e.parseNavigateParam=function(e){var t=e[0],o=e[1],n=e[2]||"pages/index/index",a=this._parseQueryString(e[3]);if(n.indexOf("?")>-1){var i=n.split("?"),r=this._parseQueryString(i[1]);this._mergeParams(a,r)}return a.tgt=e[1],{appId:t,path:n+="?"+this._buildQueryString(a),extraData:a,target_appid:o}},e.shuffle=function(e,t){if(void 0===t&&(t=0),!e||e.length<2)return e;var o=e.length;t=t>o?o:t,t*=2;for(var n=0;n<t;n++){var a=Math.floor(1e4*Math.random())%o,i=Math.floor(1e4*Math.random())%o,r=e[a];e[a]=e[i],e[i]=r}e.sort(function(e,t){return parseInt(t[7])-parseInt(e[7])})},e.randomMathRangeNum=function(e,t){if(e>=t)return e;var o=t-e+1;return Math.floor(Math.random()*o)+e},e.randomMathNum=function(e){return Math.floor(Math.random()*(e+1))},e.DEBUG=!1,e}();o.ALUtil=a,cc._RF.pop()},{"../ALConfig":"ALConfig"}],AladinSDK:[function(e,t,o){"use strict";cc._RF.push(t,"65868jPI41AbJ6Q68zkbFJw","AladinSDK"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./ALGameDrawer"),a=e("./ALSDK"),i=e("./ALReport"),r=e("./ALGameMore"),s=e("./ALGuessLike"),c=e("./ALGameBox"),l=e("./ALHelpBar"),d=e("./util/ALUtil"),h=e("./ALConfig"),u=e("./ALGuessLikeV"),p=e("./ALData"),f=e("./ALIconNode"),m=function(){function e(){}return e.allowDebug=function(e){d.ALUtil.DEBUG=e},e.readAppidList=function(e){p.ALData.appIdListStr?e(p.ALData.appIdListStr):d.ALUtil.readAppIDList().then(function(t){p.ALData.appIdListStr=t,e(p.ALData.appIdListStr),console.log("AladinSDK readAppIDList ",t)})},e.init=function(e,t,o,n){a.ALSDK.init(e,t,o,n)},e.clickToMiniProgram=function(e,t,o){void 0===o&&(o=""),t===this.ClickTypes.ICONS_CLICK?a.ALSDK.toMiniProgram(e,this.ClickTypes.ICONS_CLICK,a.SDK_MODULE_ICONS_CLICK,o||"icons"):t===this.ClickTypes.BANNER_CLICK?a.ALSDK.toMiniProgram(e,this.ClickTypes.BANNER_CLICK,a.SDK_MODULE_BANNER_CLICK,o||"banner"):a.ALSDK.toMiniProgram(e,this.ClickTypes.ICONS_CLICK,a.SDK_MODULE_ICONS_CLICK,o)},e.reportPicsShow=function(e,t){},e.getDisplayData=function(e,t){void 0===t&&(t=""),a.ALSDK.requestCPData(a.SDK_MODULE_LIKE,t,e)},e.getDisplayDataWithScene=function(e,t){a.ALSDK.requestCPData(a.SDK_MODULE_LIKE,e,t)},e.getBannerData=function(e){a.ALSDK.requestCPData(a.SDK_DATA_BANNER,"",e)},e.getShareScore=function(e,t){void 0===t&&(t=""),i.ALReport.instance.getShareScore(e,t)},e.reportShareState=function(e){i.ALReport.instance.reportShareState(e)},e.reportShareSuccess=function(){i.ALReport.instance.reportShareState(!0)},e.generateIconNode=function(e,t,o){return void 0===t&&(t=""),void 0===o&&(o=1),new f.ALIconNode(e,t,o)},e.getMoreNode=function(e){return r.ALGameMore.instance._initNode(e)},e.ShowMore=function(e){r.ALGameMore.instance.showNode(e)},e.showMoreNode=function(e){r.ALGameMore.instance.showNode(e)},e.HideMore=function(){r.ALGameMore.instance.hideNode()},e.hideMoreNode=function(){r.ALGameMore.instance.hideNode()},e.destroyMoreNode=function(){r.ALGameMore.instance.destroyNode()},e.getMoreData=function(e){a.ALSDK.requestModuleData(a.SDK_MODULE_MORE,e)},e.getFavoNodeCls=function(){return new u.ALGuessLikeV},e.getFavoNodeVCls=function(){return new u.ALGuessLikeV},e.getFavoNodeV=function(e,t,o,n){return void 0===t&&(t=null),void 0===o&&(o=0),void 0===n&&(n=!1),t?t._initNode(e,o,n):u.ALGuessLikeV.instance._initNode(e,o,n)},e.showFavoNodeV=function(e,t){void 0===e&&(e=null),void 0===t&&(t=""),e?e.showNode(t):u.ALGuessLikeV.instance.showNode(t)},e.hideFavoNodeV=function(e){e?e.hideNode():u.ALGuessLikeV.instance.hideNode()},e.destroyFavoNodeV=function(e){e?e.destroyNode():u.ALGuessLikeV.instance.destroyNode()},e.setFavoPosV=function(e,t){t?t.setPos(e):u.ALGuessLikeV.instance.setPos(e)},e.getFavoNode=function(e,t){return void 0===t&&(t=!1),s.ALGuessLike.instance._initNode(e,t)},e.showFavoNode=function(e){s.ALGuessLike.instance.showNode(e)},e.hideFavoNode=function(){s.ALGuessLike.instance.hideNode()},e.destroyFavoNode=function(){s.ALGuessLike.instance.destroyNode()},e.setFavoPos=function(e){s.ALGuessLike.instance.setPos(e)},e.getFavoData=function(e){a.ALSDK.requestModuleData(a.SDK_MODULE_LIKE,e)},e.GetDrawerNode=function(){return n.ALGameDrawer.instance._initNode()},e.getDrawerNode=function(){return n.ALGameDrawer.instance._initNode()},e.ShowDrawer=function(e){n.ALGameDrawer.instance.showNode(e,null)},e.showDrawerNode=function(e,t){n.ALGameDrawer.instance.showNode(e,t)},e.HideDrawer=function(){n.ALGameDrawer.instance.hideNode()},e.hideDrawerNode=function(){n.ALGameDrawer.instance.hideNode()},e.destroyDrawerNode=function(){n.ALGameDrawer.instance.destroyNode()},e.getDrawerData=function(e){a.ALSDK.requestModuleData(a.SDK_MODULE_DRAWER,e)},e.SetDrawerScale=function(e){},e.IsShowDrawer=function(){},e.GetGameBoxNode=function(){return c.ALGameBox.instance._initNode()},e.getBoxNode=function(){return c.ALGameBox.instance._initNode()},e.ShowGameBoxNode=function(e){c.ALGameBox.instance.showNode(e)},e.showBoxNode=function(e){c.ALGameBox.instance.showNode(e)},e.HideGameBoxNode=function(){c.ALGameBox.instance.hideNode()},e.hideBoxNode=function(){c.ALGameBox.instance.hideNode()},e.destroyBoxNode=function(){c.ALGameBox.instance.destroyNode()},e.getHelpNode=function(){return l.ALHelpBar.instance._initNode()},e.showHelpNode=function(){l.ALHelpBar.instance.showNode()},e.hideHelpNode=function(){l.ALHelpBar.instance.hideNode()},e.destroryHelpNode=function(){l.ALHelpBar.instance.hideNode()},e.preReprotOpenId=function(e,t){h.ALConfig.appId=e,i.ALReport.instance.report(i.REPORT_TYPE_OPEN_ID,t)},e.reportData=function(e,t){i.ALReport.instance.report(e,t)},e.reportOpenId=function(e,t){i.ALReport.instance.report(i.REPORT_TYPE_OPEN_ID,e)},e.reportAnalytics=function(e,t){i.ALReport.instance.reportAnalytics(e,t)},e.reportVideoShow=function(e){i.ALReport.instance.report(i.REPORT_TYPE_VIDEO_BTN_SHOW,e)},e.reportVideoClick=function(e){i.ALReport.instance.report(i.REPORT_TYPE_VIDEO_CLICK,e)},e.reportShareShow=function(e){i.ALReport.instance.report(i.REPORT_TYPE_SHARE_BTN_SHOW,e)},e.reportShareClick=function(e){i.ALReport.instance.report(i.REPORT_TYPE_SHARE_CLICK,e)},e.reportWithAppId=function(e,t,o){void 0===o&&(o=""),h.ALConfig.appId=e,i.ALReport.instance.report(t,o)},e.report=function(e,t,o){void 0===t&&(t=""),void 0===o&&(o=""),i.ALReport.instance.report(e,t)},e.ClickTypes={ICONS_CLICK:"0_11",BANNER_CLICK:"0_12",MORE_CLICK:"2_1",DRAWER_CLICK:"1_7",LIKE_CLICK:"1_6"},e.ShowTypes={MORE_SHOW:"2_0",DRAWER_SHOW:"1_9",LIKE_SHOW:"1_8"},e.ReportTypes={SHOW:"1_1",LOGIN:"1_2",OPEN_ID:"1_3",AUTH:"1_4",SHARE:"1_5",LIKE_CLICK:"1_6",DRAWER_CLICK:"1_7",LIKE_SHOW:"1_8",DRAWER_SHOW:"1_9",SHARE_Ready:"1_10",PAY_MENT:"6_1",PAY_MENT_STAR:"6_2",PAY_MENT_INTER:"6_3",PAY_MENT_FAIL:"6_4",MORE_SHOW:"2_0",MORE_FOLD:"2_1",MORE_CLICK:"2_2",MORE_LONG_CLICK:"2_3",VIDEO_OPEN:"2_4",VIDEO_WATCH_FAIL:"2_5",VIDEO_WATCH_NORMAL:"2_6",GAME_BOX_SHOW:"8_1",GAME_BOX_CLICK:"8_2",GAME_BOX_BANNER_CLICK:"8_3",VIDEO_BTN_SHOW:"5_6",VIDEO_CLICK:"5_7",SHARE_BTN_SHOW:"5_8",SHARE_CLICK:"5_9"},e}();o.AladinSDK=m,cc._RF.pop()},{"./ALConfig":"ALConfig","./ALData":"ALData","./ALGameBox":"ALGameBox","./ALGameDrawer":"ALGameDrawer","./ALGameMore":"ALGameMore","./ALGuessLike":"ALGuessLike","./ALGuessLikeV":"ALGuessLikeV","./ALHelpBar":"ALHelpBar","./ALIconNode":"ALIconNode","./ALReport":"ALReport","./ALSDK":"ALSDK","./util/ALUtil":"ALUtil"}],Boss:[function(e,t,o){"use strict";cc._RF.push(t,"e04d8wBLBJB77sLhVDChPY3","Boss"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./enemy"),a=e("./../util/global_def"),i=e("./hero"),r=e("./../util/audio_mgr"),s=e("./../game_scene"),c=e("./../game_logic"),l=cc._decorator,d=l.ccclass,h=l.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blood=null,t.totalBlood=0,t}return __extends(t,e),t.prototype.init=function(e){this.info=a.G.Game.getEnemyInfo(4),this.id=e,this.setTexture(e),this.rigidBody=this.node.getComponent(cc.RigidBody),this.rigidBody.linearDamping=5,this.rigidBody.bullet=!0,this.clean()},t.prototype.setTexture=function(e){var t;null!=(t=a.G.Game.getGRes(a.G.Game.GResType.Boss,e))&&(this.image.spriteFrame=t,this.node.setContentSize(a.G.Game.bossBox[e]),this.setBox(),this.node.addComponent(p),this.totalBlood=this.info.HP)},t.prototype.setBox=function(){var e=a.G.Game.bossBox[this.id],t=this.node.getComponent(cc.PhysicsBoxCollider);t.size=e,t.offset.y=e.height/2,t.density=a.G.Game.bossDensity[this.id],t.apply();var o=this.node.getComponent(cc.BoxCollider);o.size=a.G.Game.bossBox[this.id],o.offset.y=a.G.Game.bossBox[this.id].height/2,null!=this.hurtImage&&this.hurtImage.setContentSize(e)},__decorate([h(cc.ProgressBar)],t.prototype,"blood",void 0),t=__decorate([d],t)}(n.default);o.default=u;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attack=!1,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this),this.checkAttack()},t.prototype.checkAttack=function(){var e=this,t=function(){e.node.x-i.default.instance.node.x<=400&&(e.unschedule(t),e.attack=!0)};this.schedule(t,.1)},t.prototype.reset=function(e){var t=this.node.getComponent(u);this.node.setPosition(e),t.blood.progress=1,t.info.HP=t.totalBlood,this.attack=!1,this.checkAttack()},t.prototype.jump_height=function(){var e=this,t=this.node.getComponent(n.default),o=cc.scaleTo(.3,1,.5);o.easing(cc.easeOut(.3));var a=cc.scaleTo(.3,1,1);a.easing(cc.easeIn(.3)),t.image.node.runAction(cc.sequence(o,cc.callFunc(function(){e.speedY=-300}),a))},t.prototype.jump_attack=function(){var e=this,t=this.node.getComponent(n.default),o=cc.scaleTo(.3,1,.5);o.easing(cc.easeOut(.3));var a=cc.scaleTo(.3,1,1);a.easing(cc.easeIn(.3)),this.speedX=0,t.image.node.runAction(cc.sequence(o,cc.callFunc(function(){e.jumpCount++,e.speedY=-.75*e.origSY,e.speedX=-.6}),a)),this.checkHeroDir()},t.prototype.checkHeroDir=function(){i.default.instance.node.x-this.node.x>50&&i.default.instance.die()},t.prototype.jump_up=function(){this.jump_attack()},t.prototype.jump=function(){this.attack&&c.default.instance.gameState==c.GameState.gamePlay?this.jump_attack():this.jump_height()},t.prototype.onBeginContact=function(e,t,o){if(this.checkJump(e,t,o),this.hitHeroFun(e,t,o),o.tag==a.G.Game.roadTag){var n=a.G.Game.getDir(e);if(n!=a.G.Game.dir.up);if(n==a.G.Game.dir.left){var i=t.node.getComponent(cc.RigidBody),r=cc.v2(-200,0);i.linearVelocity=r}}},t.prototype.damage=function(t,o){e.prototype.damage.call(this,t,o);var n=this.node.getComponent(u),a=n.info.HP/n.totalBlood;n.blood.progress=a},t.prototype.dieOver=function(){var e=this,t=this.node.getComponent(n.default),o=this.node.getPosition(),a=cc.v2(this.node.x+300,-1e3),i=new cc.Node;i.group="enemy",i.scale=this.node.width/84,i.addComponent(cc.Sprite).spriteFrame=t.dieF,i.setPosition(o),s.default.instance.node.addChild(i,2e3);var c=cc.v2(0,0);c.x=.25*(a.x-o.x)+o.x+200,c.y=.25*(a.y-o.y)+o.y+200;var l=[o,c,a],d=cc.bezierTo(.8,l);d.easing(cc.easeOut(.8)),i.runAction(cc.sequence(cc.spawn(d,cc.rotateBy(2,-2160)),cc.callFunc(function(){i.destroy()}))),this.node.scale=0,s.default.instance.gameBoss=!1,r.AudioMgr.instance.changeBgmWithFade(r.BgmType.KGameBg,2),this.scheduleOnce(function(){s.default.instance.fenceRight.destroy(),s.default.instance.fenceLeft.destroy(),e.node.destroy(),s.default.instance.gBoss=null,s.default.instance.gbStartNode_0=null,s.default.instance.gbStartNode_0=null},1.5)},t}(n.commonAct);o.bossAct_0=p,cc._RF.pop()},{"./../game_logic":"game_logic","./../game_scene":"game_scene","./../util/audio_mgr":"audio_mgr","./../util/global_def":"global_def","./enemy":"enemy","./hero":"hero"}],BoxLayer:[function(e,t,o){"use strict";cc._RF.push(t,"94536i4XW1HspjwGavwnSrX","BoxLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./unlock"),a=cc._decorator,i=a.ccclass,r=a.property,s=e("../game_logic"),c=e("../util/event_mgr"),l=e("../game_scene"),d=255,h=function(){return function(){this.boxId=d,this.state=0,this.unlookTime=0,this.startTime=null}}();o.boxStruct=h;var u=[{boxId:d,state:n.BoxState.empty,startTime:null},{boxId:d,state:n.BoxState.empty,startTime:null},{boxId:d,state:n.BoxState.empty,startTime:null},{boxId:d,state:n.BoxState.empty,startTime:null}],p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.boxInfo=[],t.unlockBox=null,t.boxManager=[],t}return __extends(t,e),t.prototype.init=function(){var e=s.default.instance.eventManager.addListener(c.EventType.KAddAwardBox,this.fastShow.bind(this));l.default.ListenerManager.push({type:c.EventType.KAddAwardBox,id:e});for(var t=0;t<4;++t){var o=cc.instantiate(this.unlockBox);o.getComponent("unlock").setIndex(t),this.node.addChild(o),this.boxManager.push(o)}},t.prototype.setData=function(e,t){this.boxInfo[e]=t;var o=JSON.stringify(this.boxInfo);cc.sys.localStorage.setItem("boxInfo",o)},t.prototype.getData=function(){var e=cc.sys.localStorage.getItem("boxInfo");return""!=e&&null!=e||(e=JSON.stringify(u),cc.sys.localStorage.setItem("boxInfo",e)),this.boxInfo=JSON.parse(e),this.boxInfo},t.prototype.open=function(){var e=this.getData();for(var t in e){var o=e[t];this.boxManager[t].getComponent("unlock").init(o.boxId,o.state,o.startTime)}},t.prototype.close=function(){},t.prototype.getEmptyIndex=function(){var e=255;for(var t in this.boxManager){if(this.boxManager[t].getComponent("unlock").state==n.BoxState.empty){e=Number(t);break}}return e},t.prototype.fastShow=function(e,t){var o=this,a=new h;a.boxId=t.boxId,a.state=n.BoxState.to_unlock;var i=this.getEmptyIndex();i!=d&&(this.setData(i,a),this.open(),this.scheduleOnce(function(){o.close()},1.5))},__decorate([r(cc.Prefab)],t.prototype,"unlockBox",void 0),__decorate([r(cc.Node)],t.prototype,"boxManager",void 0),t=__decorate([i],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../game_logic":"game_logic","../game_scene":"game_scene","../util/event_mgr":"event_mgr","./unlock":"unlock"}],BoxShowLayer:[function(e,t,o){"use strict";cc._RF.push(t,"a0e08J6SHtG07FSUVpS2eGS","BoxShowLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=e("./unlock"),s=e("../game_scene"),c=e("./../util/global_def"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.boxShowLayer=null,t.bxs_box=null,t.bxs_otherContent=null,t.bxs_discard=null,t.bxs_unlookBtn=null,t.bxs_close=null,t.bxs_content=null,t.box=null,t.price=100,t.price_lab=null,t.unlook_time=null,t.boxName=null,t.names=["\u751f\u9508\u5b9d\u7bb1","\u666e\u901a\u5b9d\u7bb1","\u7a00\u6709\u5b9d\u7bb1","\u53f2\u8bd7\u5b9d\u7bb1"],t}return __extends(t,e),t.prototype.init=function(e){this.bxs_content.removeAllChildren();for(var t=0;t<5;++t){var o=new cc.Node,n=o.addComponent(cc.Sprite);n.spriteFrame=c.G.Game.getGRes(c.G.Game.GResType.Hero,t);var a=.8*n.spriteFrame.getRect().width,i=.8*n.spriteFrame.getRect().height;o.setContentSize(cc.size(a,i)),this.bxs_content.addChild(o);var r=cc.delayTime(.2*t),s=cc.jumpBy(.15,cc.v2(0,15),15,1),l=cc.jumpBy(.15,cc.v2(0,-15),-15,1);o.runAction(cc.sequence(r,cc.spawn(s,cc.scaleTo(.15,1)),l))}this.price=c.G.Game.getNeedCoin(e),this.price_lab.string=String(this.price);var d=c.G.Game.getOrigUnlookTime(e);this.unlook_time.string=c.G.Game.turnTime(d),this.boxName.string=this.names[e]},t.prototype.openBoxShowLayer=function(e,t){void 0===e&&(e=0),this.boxShowLayer.active=!0,this.box=t,this.init(e),this.bxs_box.getComponent(cc.Sprite).spriteFrame=c.G.Game.getGRes(c.G.Game.GResType.Box,e),this.bxs_box.scale=0,this.bxs_box.x-=70,this.bxs_box.y+=70;var o=cc.scaleTo(.35,2,2),n=cc.jumpBy(.35,cc.v2(70,-70),70,1);this.bxs_box.runAction(cc.spawn(o,n)),this.bxs_otherContent.opacity=0,this.bxs_otherContent.runAction(cc.fadeTo(.5,255)),this.bxs_unlookBtn.scale=.1;var a=cc.scaleTo(.5,1,1);a.easing(cc.easeBackOut()),this.bxs_unlookBtn.runAction(a),this.bxs_discard.scale=.1;var i=cc.scaleTo(.5,1,1);i.easing(cc.easeBackOut()),this.bxs_discard.runAction(i),this.bxs_close.getComponent("ui_motion").triggerMotion(),s.default.instance.closeBoxLayer()},t.prototype.discard=function(){this.colseBoxShowLayer(),this.box.getComponent("unlock").updateData(r.BoxState.empty),this.box.getComponent("unlock").setState(r.BoxState.empty)},t.prototype.colseBoxShowLayer=function(){this.boxShowLayer.active=!1,s.default.instance.openBoxLayer()},t.prototype.unlock=function(){var e=this;s.default.instance.buy(s.WealthType.coin,this.price,function(){e.colseBoxShowLayer(),e.box.getComponent("unlock").updateData(r.BoxState.countdown),e.box.getComponent("unlock").setState(r.BoxState.countdown)})},__decorate([i(cc.Node)],t.prototype,"boxShowLayer",void 0),__decorate([i(cc.Node)],t.prototype,"bxs_box",void 0),__decorate([i(cc.Node)],t.prototype,"bxs_otherContent",void 0),__decorate([i(cc.Node)],t.prototype,"bxs_discard",void 0),__decorate([i(cc.Node)],t.prototype,"bxs_unlookBtn",void 0),__decorate([i(cc.Node)],t.prototype,"bxs_close",void 0),__decorate([i(cc.Node)],t.prototype,"bxs_content",void 0),__decorate([i(cc.Label)],t.prototype,"price_lab",void 0),__decorate([i(cc.Label)],t.prototype,"unlook_time",void 0),__decorate([i(cc.Label)],t.prototype,"boxName",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../game_scene":"game_scene","./../util/global_def":"global_def","./unlock":"unlock"}],HttpUtil:[function(e,t,o){"use strict";cc._RF.push(t,"08328hiaEtBNrsueEJvgJX7","HttpUtil"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./ALUtil");o.METHOD_GET="GET",o.METHOD_POST="POST";var a=function(){function e(){}return e.GET=function(e,t,n){return this._request(e,o.METHOD_GET,t,n)},e.POST=function(e,t,n){return this._request(e,o.METHOD_POST,t,n)},e._request=function(e,t,o,a){var i=this;return"undefined"!=typeof wx?new Promise(function(a,r){"GET"==t&&o&&(e+=encodeURI(i.objParam2GetString(o))),n.ALUtil.LOG("HttpUtil url ----- ",e);var s={url:e,method:t,success:function(e){n.ALUtil.LOG("HttpUtil responseText---",e);try{var t=e.data;t&&0!==t.code&&0!==t.ret?(n.ALUtil.LOG("HttpUtil json---"),a({isSucc:!1,reason:t.msg})):a({isSucc:!0,data:t?t.data:null})}catch(e){n.ALUtil.LOG("HttpUtil parse---",e),a({isSucc:!1,reason:"json_parse_error"})}},fail:function(e){n.ALUtil.LOG("HttpUtil fail---",e),a({isSucc:!1,reason:"network_error"})}};i.Authorization?s.header={"content-type":"application/x-www-form-urlencoded",Authorization:i.Authorization}:s.header={"content-type":"application/x-www-form-urlencoded"},o&&(s.data=o),(n.ALUtil.wxExist()?wx:qq).request(s)}):new Promise(function(a,r){var s=new XMLHttpRequest,c=null;"GET"==t?o&&(e+=encodeURI(i.objParam2GetString(o))):c=null==o?null:encodeURI(i.objParam2PostString(o)),s.open(t,e,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.Authorization&&s.setRequestHeader("Authorization",i.Authorization),s.onreadystatechange=function(){if(4===s.readyState&&s.status>199&&s.status<400){n.ALUtil.LOG("HttpUtil responseText---",s.responseText);try{var e=s.responseText?JSON.parse(s.responseText):null;e&&0!==e.code&&0!==e.ret?(n.ALUtil.LOG("HttpUtil json---"),a({isSucc:!1,reason:e.msg})):a({isSucc:!0,data:e?e.data:null})}catch(e){n.ALUtil.LOG("HttpUtil parse---",e),a({isSucc:!1,reason:"json_parse_error"})}}},s.onerror=function(e){n.ALUtil.LOG("HttpUtil onerror---",e),a({isSucc:!1,reason:"network_error"})},s.ontimeout=function(e){n.ALUtil.LOG("HttpUtil ontimeout---",e),a({isSucc:!1,reason:"timeout_error"})},s.send(c)})},e.objParam2PostString=function(e){var t="";for(var o in e)t+=o+"="+e[o],t+="&";return""!=t&&(t=t.slice(0,t.length-1)),t},e.objParam2GetString=function(e){var t="?";for(var o in e)t+=o+"="+e[o],t+="&";return""!=t&&(t=t.slice(0,t.length-1)),t},e.Authorization=null,e}();o.HttpUtil=a,cc._RF.pop()},{"./ALUtil":"ALUtil"}],ImgLoaderUtil:[function(e,t,o){"use strict";cc._RF.push(t,"2b78eSar8VKspW5Bf7wrkUE","ImgLoaderUtil"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.getImgByUrl=function(e){return new Promise(function(t,o){e?cc.loader.load(e,function(o,n){t(o?{isSucc:!1,info:"load faild: "+e}:{isSucc:!0,texture:n})}):t({isSucc:!1,info:"load faild: "+e})})},e}();o.ImgLoaderUtil=n,cc._RF.pop()},{}],RankLayer:[function(e,t,o){"use strict";cc._RF.push(t,"64102KOQ39HMLTXDt8YXvTv","RankLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./Rank"),a=cc._decorator,i=a.ccclass,r=a.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.rank=null,t}return __extends(t,e),t.prototype.open=function(){n.Rank.friendButtonFunc(),this.node.active=!0,this.content.getComponent("ui_motion").triggerMotion()},t.prototype.close=function(){n.Rank.clean(),this.node.active=!1},__decorate([r(cc.Node)],t.prototype,"content",void 0),__decorate([r(cc.Node)],t.prototype,"rank",void 0),t=__decorate([i],t)}(cc.Component);o.default=s,cc._RF.pop()},{"./Rank":"Rank"}],Rank:[function(e,t,o){"use strict";cc._RF.push(t,"b6670osHVlI343kWT64pYWJ","Rank"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator;n.ccclass,n.property;o.Rank={friendButtonFunc:function(){wx.getOpenDataContext().postMessage({messageType:1,MAIN_MENU_NUM:"x1"})},groupFriendButtonFunc:function(){wx.shareAppMessage({title:"\u94c1\u5934\u82f1\u96c4",imageUrl:cc.url.raw("resources/Shop_BgSmall.png"),query:"",success:function(e){void 0!=e.shareTickets&&e.shareTickets.length>0&&wx.getOpenDataContext().postMessage({messageType:5,MAIN_MENU_NUM:"x1",shareTicket:e.shareTickets[0]})}})},gameOverButtonFunc:function(){wx.getOpenDataContext().postMessage({messageType:4,MAIN_MENU_NUM:"x1"})},submitScoreButtonFunc:function(e){wx.getOpenDataContext().postMessage({messageType:3,MAIN_MENU_NUM:"x1",score:e})},submitCurtSocre:function(e){wx.getOpenDataContext().postMessage({messageType:6,MAIN_MENU_NUM:"x1",score:e})},clean:function(){console.log("\u6e05\u9664\u6392\u884c\u699c"),wx.getOpenDataContext().postMessage({messageType:0,MAIN_MENU_NUM:"x1"})}},cc._RF.pop()},{}],StringUtil:[function(e,t,o){"use strict";cc._RF.push(t,"0ebeetHacJC3LisUltuTGkH","StringUtil"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){}return e.base64encode=function(e){var t,o,n,a,i,r,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(n=e.length,o=0,t="";o<n;){if(a=255&e.charCodeAt(o++),o==n){t+=s.charAt(a>>2),t+=s.charAt((3&a)<<4),t+="==";break}if(i=e.charCodeAt(o++),o==n){t+=s.charAt(a>>2),t+=s.charAt((3&a)<<4|(240&i)>>4),t+=s.charAt((15&i)<<2),t+="=";break}r=e.charCodeAt(o++),t+=s.charAt(a>>2),t+=s.charAt((3&a)<<4|(240&i)>>4),t+=s.charAt((15&i)<<2|(192&r)>>6),t+=s.charAt(63&r)}return t},e.parseQueryString=function(e){var t={};if(!e)return t;for(var o=e.split("&"),n=null,a=0,i=o.length;a<i;a++)t[(n=o[a].split("="))[0]]=n[1];return t},e}();o.StringUtil=n,cc._RF.pop()},{}],UITableView:[function(e,t,o){"use strict";cc._RF.push(t,"1069csam9BHBJ4VM8seIRxi","UITableView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./util/ALUtil"),a=function(){function e(e){this.NODEKEY="NodeKey",this.direction=r.Vertical,this.datas=null,this.allowScroll=!1,this.showNodeCount=0,this.visibleHeight=0,this.visibleWidth=0,this.contentLastY=0,this._tmpXY=0,this.scrollview=e.scrollview,this.content=e.content,this.direction=e.direction,this.nodeEstimatedHeightOrWidthCB=e.nodeEstimatedHeightOrWidthCB,this.nodeForIndexCB=e.nodeForIndexCB,this.nodeRemoveForIndexCB=e.nodeRemoveForIndexCB,this.node_pools_map=new Map,this.node_templates_map=new Map,e.allowScroll&&(this.allowScroll=!0,this.scrollview.node.on("scrolling",this._on_scrolling,this)),this.refreshContentWH()}return e.prototype.refreshContentWH=function(){n.ALUtil.LOG("UITableView refreshContentWH"),this.content.width=this.scrollview.node.width,this.content.height=this.scrollview.node.height,this.visibleHeight=this.content.height,this.visibleWidth=this.content.width},e.prototype.registerNodeTemplateOfKey=function(e,t){this.stringIsEmpty(e)||this.objectIsEmpty(t)||(this.node_templates_map[e]=t)},e.prototype.obtainNodeOfKey=function(e){if(!this.stringIsEmpty(e)){var t,o=this.node_pools_map.get(e);if(o&&o.length>0)t=o.pop();else{var a=this.node_templates_map[e];t=cc.instantiate(a),n.ALUtil.LOG("UITableView obtainNodeOfKey, key = ",e)}return t[this.NODEKEY]=e,t.active=!0,t.parent||this.content.addChild(t),t}},e.prototype.set_data=function(e){var t=this;if(this.objectIsEmpty(e)||e.length<1)n.ALUtil.LOG("UITableView nothing to set");else{this._recycle_items(),this.showNodeArr=new Array;var o=null;e.forEach(function(e,n){o=t._generateShowNode(e,n),t.showNodeArr.push(o)}),this.showNodeCount=this.showNodeArr.length,this.start_index=0,this.stop_index=0,this.refreshContentWH(),this.layout_items()}},e.prototype.append_data=function(e){if(this.showNodeCount<1)this.set_data([e]);else{n.ALUtil.LOG("UITableView append_data --- ",e);var t=this._generateShowNode(e,this.showNodeCount);this.showNodeArr.push(t),this.showNodeCount++,this.layout_lastest_item()}},e.prototype._recycle_items=function(){var e=this;this.showNodeArr&&this.showNodeArr.forEach(function(t){e._recycle_item(t)})},e.prototype._recycle_item=function(e){if(e.node){var t=e.node[this.NODEKEY];n.ALUtil.LOG("UITableView recycle_item = ",t);var o=this.node_pools_map.get(t);null==o&&(o=new Array,this.node_pools_map.set(t,o)),e.node.active=!1,this.nodeRemoveForIndexCB&&this.nodeRemoveForIndexCB(this,e.index,e.node),o.push(e.node),e.node=null}},e.prototype._generateShowNode=function(e,t){var o={x:0,y:0,height:0,width:0,index:-1,data:e,node:null,selected:!1};if(this.direction===r.Vertical){var n=this.nodeEstimatedHeightOrWidthCB(this,t,o.data);o.y=this._tmpXY,o.height=n,this._tmpXY-=n}else{var a=this.nodeEstimatedHeightOrWidthCB(this,t,o.data);o.x=this._tmpXY,o.width=a,this._tmpXY+=a}return o},e.prototype.destroy=function(){this._recycle_items(),this.node_pools_map.forEach(function(e,t){e.forEach(function(e){e.destroy()})}),this.node_pools_map=null,this.node_templates_map.forEach(function(e){e.destroy()}),this.node_templates_map=null,this.showNodeArr=null,this.scrollview&&(this.allowScroll&&this.scrollview.node.off("scrolling",this._on_scrolling,this),this.scrollview=null,this.content=null)},e.prototype._alivingItemCount=function(){var e=0;return this.showNodeArr.forEach(function(t){t.node&&e++}),e},e.prototype.stringIsEmpty=function(e){return null===e||void 0===e||""===e},e.prototype.objectIsEmpty=function(e){return null===e||void 0===e},e}(),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.estimateContentValue=function(){var e=this;if(!this.showNodeArr)return 0;var t=0;return this.showNodeArr.forEach(function(o,n){o.height>0?t+=o.height:t+=e.nodeEstimatedHeightOrWidthCB(e,n,o.data)}),t},t.prototype.getItemByPos=function(e){for(var t=null,o=0,n=this.showNodeArr.length;o<n;o++){var a=this.showNodeArr[o];if(a.node&&(e.y<a.node.y&&e.y>a.node.y-a.height)){t=a.node;break}}return t},t.prototype.scrollToY=function(e){this.content.y=e,this._calcVertical(e)},t.prototype._on_scrolling=function(){var e=this.content.y;this._calcVertical(e)},t.prototype._calcVertical=function(e){var t=e-this.contentLastY;if(!(Math.abs(t)<.1)){var o=e-this.contentLastY>0?s.Bottom:s.Top;this.contentLastY=e;var a=this.start_index,i=this.stop_index,r=-e,c=-e-this.visibleHeight,l=null;if(o==s.Bottom){for(var d=i;d<this.showNodeCount;d++)if((l=this.showNodeArr[d]).height<1||l.y-l.height<c){i=d;break}for(d=i-1;d>=a;d--)if((l=this.showNodeArr[d]).y>r){a=d;break}}else{for(d=a;d>-1;d--)if((l=this.showNodeArr[d]).y>r){a=d;break}for(d=a+1;d<=i;d++)if((l=this.showNodeArr[d]).y-l.height<c){i=d;break}}a==this.start_index&&i==this.stop_index||(this.start_newer_index=a,this.stop_newer_index=i,n.ALUtil.LOG("UITableView on_scrolling render_items --- ",a,i),this._render_items(o))}},t.prototype._render_items=function(e){var t=null,o=0;if(e==s.Bottom)for(var a=this.start_index;a<this.start_newer_index;a++)t=this.showNodeArr[a],this._recycle_item(t);else for(a=this.stop_index;a>this.stop_newer_index;a--)t=this.showNodeArr[a],this._recycle_item(t);o=0===this.start_newer_index?(t=this.showNodeArr[0]).y:(t=this.showNodeArr[this.start_newer_index-1]).y-t.height;for(a=this.start_newer_index;a<=this.stop_newer_index;a++)(t=this.showNodeArr[a]).node?o-=t.height:o-=this.decorateShowNode(t,a,o).height;this.content.height=this.estimateContentValue(),n.ALUtil.LOG("UITableView content height --- ",this.content.height),this.start_index=this.start_newer_index,this.stop_index=this.stop_newer_index,n.ALUtil.LOG("UITableView alivingShowNodesCount --- ",this._alivingItemCount())},t.prototype._try_recycle_item=function(){var e=this.content.y;this.contentLastY=e;for(var t=this.start_index,o=-e,n=null,a=t;a<this.stop_index&&!((n=this.showNodeArr[a]).y-n.height<o);a++);if(a!=t)for(var i=t;i<a;i++)(n=this.showNodeArr[i]).node&&this._recycle_item(n);this.start_index=a},t.prototype.layout_items=function(){for(var e=null,t=this.showNodeCount-1,o=0,a=this.start_index;a<=t;a++)if(e=this.showNodeArr[a],(o-=this.decorateShowNode(e,a,o).height)<-this.visibleHeight){this.stop_index=a;break}this.content.height=this.estimateContentValue(),n.ALUtil.LOG("UITableView content height --- ",this.content.height),n.ALUtil.LOG("UITableView layout_items start_index --- ",this.start_index),n.ALUtil.LOG("UITableView layout_items stop_index --- ",this.stop_index),n.ALUtil.LOG("UITableView layout_items height --- ",this.visibleHeight,this.content.height)},t.prototype.layout_lastest_item=function(){var e=null,t=this.showNodeCount-1;if(null==(e=this.showNodeArr[t-1]).node)return this.content.height=this.estimateContentValue(),void n.ALUtil.LOG("UITableView content height --- ",this.content.height);var o=e.y-e.height;e=this.showNodeArr[t],o-=this.decorateShowNode(e,t,o).height,this.stop_index=t,this.content.height=this.estimateContentValue(),n.ALUtil.LOG("UITableView content height --- ",this.content.height),o<-this.visibleHeight&&(this.scrollview.scrollToBottom(),this._try_recycle_item())},t.prototype.decorateShowNode=function(e,t,o){var n=this.nodeForIndexCB(this,t,e.data);return n.y=o,e.node=n,e.y=n.y,e.height=n.height,e.index=t,n},t}(a);o.UITableViewV=i;var r,s,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.estimateContentValue=function(){var e=this;if(!this.showNodeArr)return 0;var t=0;return this.showNodeArr.forEach(function(o,n){o.width>0?t+=o.width:t+=e.nodeEstimatedHeightOrWidthCB(e,n,o.data)}),t},t.prototype.getItemByPos=function(e){for(var t=null,o=0,n=this.showNodeArr.length;o<n;o++){var a=this.showNodeArr[o];if(a.node&&(e.x<a.node.x+a.width&&e.x>a.node.x)){t=a.node;break}}return t},t.prototype.scrollToY=function(e){},t.prototype._on_scrolling=function(){var e=this.content.x;this._calcVertical(e)},t.prototype._calcVertical=function(e){var t=e-this.contentLastY;if(!(Math.abs(t)<.1)){var o=e-this.contentLastY<0?s.Right:s.Left;this.contentLastY=e;var a=this.start_index,i=this.stop_index,r=-e,c=-e+this.visibleWidth,l=null;if(o==s.Right){for(var d=i;d<this.showNodeCount;d++)if((l=this.showNodeArr[d]).width<1||l.x+l.width>c){i=d;break}for(d=i-1;d>=a;d--)if((l=this.showNodeArr[d]).x<r){a=d;break}}else{for(d=a;d>-1;d--)if((l=this.showNodeArr[d]).x<r){a=d;break}for(d=a+1;d<=i;d++)if((l=this.showNodeArr[d]).x+l.width>c){i=d;break}}a==this.start_index&&i==this.stop_index||(this.start_newer_index=a,this.stop_newer_index=i,n.ALUtil.LOG("UITableView on_scrolling render_items --- ",a,i),this._render_items(o))}},t.prototype._render_items=function(e){var t=null,o=0;if(e==s.Right)for(var a=this.start_index;a<this.start_newer_index;a++)t=this.showNodeArr[a],this._recycle_item(t);else for(a=this.stop_index;a>this.stop_newer_index;a--)t=this.showNodeArr[a],this._recycle_item(t);o=0===this.start_newer_index?(t=this.showNodeArr[0]).x:(t=this.showNodeArr[this.start_newer_index-1]).x+t.width;for(a=this.start_newer_index;a<=this.stop_newer_index;a++)(t=this.showNodeArr[a]).node?o+=t.width:o+=this.decorateShowNode(t,a,o).width;this.content.width=this.estimateContentValue(),this.start_index=this.start_newer_index,this.stop_index=this.stop_newer_index,n.ALUtil.LOG("UITableView alivingShowNodesCount --- ",this._alivingItemCount())},t.prototype._try_recycle_item=function(){var e=this.content.x;this.contentLastY=e;for(var t=this.start_index,o=e,n=null,a=t;a<this.stop_index&&!((n=this.showNodeArr[a]).x+n.width>o);a++);if(a!=t)for(var i=t;i<a;i++)(n=this.showNodeArr[i]).node&&this._recycle_item(n);this.start_index=a},t.prototype.layout_items=function(){for(var e=null,t=this.showNodeCount-1,o=0,a=this.start_index;a<=t;a++)if(e=this.showNodeArr[a],(o+=this.decorateShowNode(e,a,o).width)>this.visibleWidth){this.stop_index=a;break}this.content.width=this.estimateContentValue(),n.ALUtil.LOG("UITableView layout_items start_index --- ",this.start_index),n.ALUtil.LOG("UITableView layout_items stop_index --- ",this.stop_index),n.ALUtil.LOG("UITableView layout_items width --- ",this.visibleWidth,this.content.width)},t.prototype.layout_lastest_item=function(){var e=null,t=this.showNodeCount-1;if(null!=(e=this.showNodeArr[t-1]).node){var o=e.x+e.width;e=this.showNodeArr[t],o+=this.decorateShowNode(e,t,o).width,this.stop_index=t,this.content.width=this.estimateContentValue(),o>this.visibleWidth&&(this.scrollview.scrollToRight(),this._try_recycle_item())}else this.content.width=this.estimateContentValue()},t.prototype.decorateShowNode=function(e,t,o){var n=this.nodeForIndexCB(this,t,e.data);return n.x=o,e.node=n,e.x=n.x,e.width=n.width,e.index=t,n},t}(a);o.UITableViewH=c,function(e){e[e.Vertical=1]="Vertical",e[e.Horizontal=2]="Horizontal"}(r=o.ScrollDirection||(o.ScrollDirection={})),function(e){e[e.Bottom=1]="Bottom",e[e.Top=2]="Top",e[e.Left=3]="Left",e[e.Right=4]="Right"}(s||(s={})),cc._RF.pop()},{"./util/ALUtil":"ALUtil"}],UIUtil:[function(e,t,o){"use strict";cc._RF.push(t,"f020bHhDxNLwb4o+fY9Xhzo","UIUtil"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./ALUtil"),i=function(){function e(){}return e.initBitmapOfNode=function(e,t,o){if(e.getComponent(cc.Sprite)){var n=e.getComponent(cc.Sprite),i=e.name,r=o[i];if(r)if(r.x+r.w>t.width||r.y+r.h>t.height)a.ALUtil.LOG("EUIUtil initBitmapOfNode textRect error",i);else{var s=new cc.SpriteFrame(t,cc.rect(r.x,r.y,r.w,r.h));if(n.spriteFrame=s,n.name){var c=n.name.split(",");c.length>3&&(n.spriteFrame.insetTop=parseInt(c[0]),n.spriteFrame.insetLeft=parseInt(c[1]),n.spriteFrame.insetBottom=parseInt(c[2]),n.spriteFrame.insetRight=parseInt(c[3]))}}else a.ALUtil.LOG("EUIUtil initBitmapOfNode textRect not exist !!!",i)}for(var l=0,d=e.children.length;l<d;l++){var h=e.children[l];this.initBitmapOfNode(h,t,o)}},e.initBitmap=function(e,t,o,n){if(!o)return!1;if(!e.getComponent(cc.Sprite))return!1;var i=e.getComponent(cc.Sprite),r=n[t];if(r){if(r.x+r.w>o.width||r.y+r.h>o.height)return a.ALUtil.LOG("EUIUtil initBitmap textRect error",t),!1;var s=new cc.SpriteFrame(o,cc.rect(r.x,r.y,r.w,r.h));if(i.spriteFrame=s,i.name){var c=i.name.split(",");c.length>3&&(i.spriteFrame.insetTop=parseInt(c[0]),i.spriteFrame.insetLeft=parseInt(c[1]),i.spriteFrame.insetBottom=parseInt(c[2]),i.spriteFrame.insetRight=parseInt(c[3]))}return!0}return a.ALUtil.LOG("EUIUtil initBitmap textRect not exist !!!",t),!1},e._generateNodeInfo=function(e){var t={};t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t.scaleX=e.scaleX,t.scaleY=e.scaleY,t.anchorX=e.anchorX,t.anchorY=e.anchorY,t.rotation=e.rotation;var o=e.getComponent(cc.Widget);if(o&&o.enabled&&(o.isAlignHorizontalCenter&&(t.horizontalCenter=o.horizontalCenter),o.isAlignVerticalCenter&&(t.verticalCenter=o.verticalCenter),o.isAlignLeft&&(t.left=o.left),o.isAlignRight&&(t.right=o.right),o.isAlignTop&&(t.top=o.top),o.isAlignBottom&&(t.bottom=o.bottom)),e.getComponent(cc.Sprite)){t.type=n.IMAGE;var a=e.getComponent(cc.Sprite),i=a.spriteFrame;t.source=i.name,t.typeMode=a.type,t.sizeMode=a.sizeMode,(i.insetTop>0||i.insetLeft>0)&&(t.scale9Grid=i.insetTop+","+i.insetLeft+","+i.insetBottom+","+i.insetRight)}else if(e.getComponent(cc.Label)){t.type=n.LABEL;var r=e.getComponent(cc.Label);t.size=r.fontSize,t.fontFamily=r.fontFamily,t.textColor=e.color.toHEX("#rrggbb"),t.text=r.string,t.textAlign=r.horizontalAlign,t.verticalAlign=r.verticalAlign}else if(e.getComponent(cc.ScrollView)){t.type=n.LIST;var s=e.getComponent(cc.ScrollView);t.horizontal=s.horizontal,t.vertical=s.vertical,t.inertia=s.inertia,t.brake=s.brake,t.elastic=s.elastic,t.bounceDuration=s.bounceDuration}else e.getComponent(cc.EditBox)?t.type=n.INPUT:t.type=n.NODE;if(e.children&&e.children.length>0){var c=new Array;t.children=c;for(var l=0,d=e.children.length;l<d;l++){var h=e.children[l],u=this._generateNodeInfo(h);t.children.push(u)}}return t},e.parseGameUIFromJSON=function(e){var t=e,o=new cc.Node;if(t.type===n.IMAGE){var a=o.addComponent(cc.Sprite);o.name=t.source,a.type=t.typeMode,a.sizeMode=t.sizeMode,t.scale9Grid&&(a.name=t.scale9Grid)}else if(t.type===n.LABEL){var i=o.addComponent(cc.Label);i.fontSize=t.size,i.fontFamily=t.fontFamily,o.color=o.color.fromHEX(t.textColor),i.string=t.text,i.horizontalAlign=t.textAlign,i.verticalAlign=t.verticalAlign}else if(t.type===n.INPUT)o.addComponent(cc.EditBox);else if(t.type===n.LIST){var r=o.addComponent(cc.ScrollView);r.horizontal=t.horizontal,r.vertical=t.vertical,r.inertia=t.inertia,r.brake=t.brake,r.elastic=t.elastic,r.bounceDuration=t.bounceDuration,o.addComponent(cc.Mask)}if(t.children&&t.children.length>0)for(var s=0,c=t.children.length;s<c;s++){var l=t.children[s],d=this.parseGameUIFromJSON(l);o.addChild(d)}return this._decorateNodeParam(o,t),o},e._decorateNodeParam=function(e,t){if(e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e.scaleX=t.scaleX,e.scaleY=t.scaleY,e.anchorX=t.anchorX,e.anchorY=t.anchorY,e.rotation=t.rotation,void 0!==t.horizontalCenter||void 0!==t.verticalCenter||void 0!==t.left||void 0!==t.right||void 0!==t.top||void 0!==t.bottom){var o=e.addComponent(cc.Widget);void 0!==t.horizontalCenter&&(o.isAlignHorizontalCenter=!0,o.horizontalCenter=t.horizontalCenter),void 0!==t.verticalCenter&&(o.isAlignVerticalCenter=!0,o.verticalCenter=t.verticalCenter),void 0!==t.left&&(o.isAlignLeft=!0,o.left=t.left),void 0!==t.right&&(o.isAlignRight=!0,o.right=t.right),void 0!==t.top&&(o.isAlignTop=!0,o.top=t.top),void 0!==t.bottom&&(o.isAlignBottom=!0,o.bottom=t.bottom)}},e}();o.UIUtil=i,function(e){e[e.IMAGE=0]="IMAGE",e[e.LABEL=1]="LABEL",e[e.INPUT=2]="INPUT",e[e.LIST=3]="LIST",e[e.NODE=4]="NODE"}(n=o.ALNodeType||(o.ALNodeType={})),o.AL9Grid="AL9Grid",cc._RF.pop()},{"./ALUtil":"ALUtil"}],aceHeroLayer:[function(e,t,o){"use strict";cc._RF.push(t,"25c7ejW/uxMbYNgXJ7zxl6R","aceHeroLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../util/global_def"),a=e("./load"),i=e("../game_scene"),r=e("./skinHero"),s=e("./../util/wx_util"),c=cc._decorator,l=c.ccclass,d=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.heroImage=null,t.wpImage=null,t.crown=null,t.coin=null,t.priceLabel=null,t.price=null,t.priceType=null,t.BannerNode=null,t.id=null,t}return __extends(t,e),t.prototype.open=function(e){this.id=e,this.node.active=!0,this.content.getComponent("ui_motion").triggerMotion(),this.heroImage.spriteFrame=a.default.instance.heroImage[this.id];var t=n.G.Game.hero_weapon[e][0];this.wpImage=n.G.Game.getGRes(n.G.Game.GResType.Weapon,t);var o=a.default.instance.SkinLayer.getComponent("skinLayer").skinHeroInfo.json;this.price=o[e].cost;var r=o[e].get_type;this.priceLabel.string=String(this.price),this.coin.active=!1,this.crown.active=!1,1==r?(this.priceType=i.WealthType.coin,this.coin.active=!0):2==r&&(this.priceType=i.WealthType.crown,this.crown.active=!0),s.default.delBanner(),s.default.addBanner(n.G.BannerId[0],null,this.BannerNode)},t.prototype.onClickTrial=function(){var e=this;s.default.watchVideoAds(n.G.VideoId.trialHero,function(){n.G.GlobalData.trialId=e.id,n.G.GlobalData.trialCount=1,e.close(),a.default.instance.enterGame(),n.G.reportToAld(n.G.Report.aceClick)})},t.prototype.onClickBuy=function(){var e=this;a.default.instance.buy(this.priceType,this.price,function(){a.default.instance.showTip("\u89e3\u9501\u6210\u529f"),n.G.GameData.setHeroData(e.id,r.skinHeroState.unlock)})},t.prototype.close=function(){s.default.delBanner(),this.node.active=!1},__decorate([d(cc.Node)],t.prototype,"content",void 0),__decorate([d(cc.Sprite)],t.prototype,"heroImage",void 0),__decorate([d(cc.Sprite)],t.prototype,"wpImage",void 0),__decorate([d(cc.Node)],t.prototype,"crown",void 0),__decorate([d(cc.Node)],t.prototype,"coin",void 0),__decorate([d(cc.Label)],t.prototype,"priceLabel",void 0),__decorate([d(cc.Node)],t.prototype,"BannerNode",void 0),t=__decorate([l],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../game_scene":"game_scene","../util/global_def":"global_def","./../util/wx_util":"wx_util","./load":"load","./skinHero":"skinHero"}],"afterImage ":[function(e,t,o){"use strict";cc._RF.push(t,"bdffbdbq95Hxa9S63Z4pqXN","afterImage "),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.camera=null,t.spriteNew=null,t.spriteOld=null,t.flag=!0,t.showAfterImage=!1,t.oldX=0,t.oldY=0,t}return __extends(t,e),t.prototype.onLoad=function(){this.texture1=new cc.RenderTexture,this.texture1.initWithSize(cc.winSize.width,cc.winSize.height),this.texture2=new cc.RenderTexture,this.texture2.initWithSize(cc.winSize.width,cc.winSize.height)},t.prototype.addShadow=function(){var e;(this.flag?this.camera.targetTexture=this.texture1:this.camera.targetTexture=this.texture2,this.flag)?((e=new cc.SpriteFrame).setTexture(this.texture2),this.spriteOld.spriteFrame=e):((e=new cc.SpriteFrame).setTexture(this.texture1),this.spriteOld.spriteFrame=e);(this.spriteOld.node.setPosition(this.camera.node.getPosition()),this.camera.render(this.node.parent),this.flag)?((e=new cc.SpriteFrame).setTexture(this.texture1),this.spriteNew.spriteFrame=e):((e=new cc.SpriteFrame).setTexture(this.texture2),this.spriteNew.spriteFrame=e);this.flag=!this.flag},t.prototype.start=function(){this.schedule(this.addShadow,1,cc.macro.REPEAT_FOREVER,0)},__decorate([i(cc.Camera)],t.prototype,"camera",void 0),__decorate([i(cc.Sprite)],t.prototype,"spriteNew",void 0),__decorate([i(cc.Sprite)],t.prototype,"spriteOld",void 0),t=__decorate([a],t)}(cc.Component);o.default=r,cc._RF.pop()},{}],audio_mgr:[function(e,t,o){"use strict";cc._RF.push(t,"effd6VkQTRMbbLxELyupSGi","audio_mgr"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./global_def"),i=e("./Storage"),r=e("./structure/hd_map"),s=cc._decorator,c=s.ccclass;s.property;(function(e){e[e.kBattle=0]="kBattle",e[e.KHall=1]="KHall",e[e.KGameBg=2]="KGameBg",e[e.KBoss=3]="KBoss",e[e.kNone=9999]="kNone"})(n=o.BgmType||(o.BgmType={}));var l,d=["battle","hall","game_bg","boss"];(function(e){e[e.kButton=0]="kButton",e[e.kCoin=1]="kCoin",e[e.kNewCoin=2]="kNewCoin",e[e.KMove=3]="KMove",e[e.KHit=4]="KHit",e[e.KCut=5]="KCut",e[e.KBoom=6]="KBoom",e[e.KChains=7]="KChains",e[e.KBox=8]="KBox",e[e.KDie=9]="KDie",e[e.KSpeer=10]="KSpeer",e[e.KThrowDarts=11]="KThrowDarts",e[e.kNone=9999]="kNone"})(l=o.SfxType||(o.SfxType={}));var h=["button","coin","newCoin","move","hit","cut","boom","chains","box","die","spear","throwDarts"],u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bMuteMusic_=!1,t.bMuteSound_=!1,t.curBgmType_=n.KGameBg,t.bgmId_=0,t.maxBgmVol_=1,t.maxSfxVol_=1,t.maxFadeVol_=0,t.bgms_=new r.default,t.sfxMap_=new r.default,t.bgmRemoteDelayType_=n.kNone,t.bgmProcCb_=null,t.sfxProcCb_=null,t.bgmProcCnt_=0,t.bgmProcTotal_=0,t.sfxProcCnt_=0,t.sfxProcTotal_=0,t.coinCool=!1,t}var o;return __extends(t,e),o=t,t.prototype.isStopMusic=function(){return this.bMuteMusic_},t.prototype.isStopSound=function(){return this.bMuteSound_},t.prototype.onLoad=function(){o.instance=this,this._readData(),cc.game.addPersistRootNode(this.node)},t.prototype.start=function(){},t.prototype.preloadAll=function(e,t){void 0===e&&(e=null),void 0===t&&(t=null);for(var o=0;o<d.length;++o)this.bgms_.containsKey(o)||(++this.bgmProcTotal_,a.G.readAudio("audio/"+d[o],this._loadBgm.bind(this),o));for(o=0;o<h.length;++o)this.sfxMap_.containsKey(o)||(++this.sfxProcTotal_,a.G.readAudio("audio/"+h[o],this._loadSfx.bind(this),o));this.bgmProcCb_=e,this.sfxProcCb_=t},t.prototype.preloadBgmInEnumRange=function(e,t,o){if(void 0===t&&(t=n.kNone),void 0===o&&(o=null),t!=n.kNone)for(var i=e;i<=t;++i)this.bgms_.containsKey(i)||(++this.bgmProcTotal_,a.G.readAudio("audio/"+d[i],this._loadBgm.bind(this),i));else this.bgms_.containsKey(e)||(++this.bgmProcTotal_,a.G.readAudio("audio/"+d[e],this._loadBgm.bind(this),e));this.bgmProcCb_=o},t.prototype.releaseBgmInEnumRange=function(e,t){if(void 0===t&&(t=n.kNone),cc.audioEngine.stopMusic(),t==n.kNone)this.bgms_.containsKey(t)&&(cc.loader.release(this.bgms_.get(t)),this.bgms_.remove(t));else for(var o=e;o<=t;++o)this.bgms_.containsKey(o)&&(cc.loader.release(this.bgms_.get(o)),this.bgms_.remove(o))},t.prototype.preloadSfxInEnumRange=function(e,t,o){void 0===o&&(o=null);for(var n=e;n<=t;++n)this.sfxMap_.containsKey(n)||(++this.sfxProcTotal_,a.G.readAudio("audio/"+h[n],this._loadSfx.bind(this),n));this.sfxProcCb_=o},t.prototype.releaseSfxInEnumRange=function(e,t){cc.audioEngine.stopAllEffects();for(var o=e;o<=t;++o)this.sfxMap_.containsKey(o)||(cc.loader.release(this.sfxMap_.get(o)),this.sfxMap_.remove(o))},t.prototype._loadBgm=function(e,t,o){void 0===o&&(o=!1),this.bgms_.put(t,e),this.bgmRemoteDelayType_!=n.kNone&&this.bgmRemoteDelayType_==t?(this.playMusic(this.bgmRemoteDelayType_),this.bgmRemoteDelayType_=n.kNone):o&&this.playMusic(t),++this.bgmProcCnt_,this.bgmProcCb_&&(this.bgmProcCb_(this.bgmProcCnt_,this.bgmProcTotal_),this.bgmProcCnt_>=this.bgmProcTotal_&&(this.bgmProcCb_=null))},t.prototype._loadSfx=function(e,t,o){void 0===o&&(o=!1),this.sfxMap_.put(t,e),o&&!this.bMuteSound_&&cc.audioEngine.playEffect(e,!1),++this.sfxProcCnt_,this.sfxProcCb_&&(this.sfxProcCb_(this.sfxProcCnt_,this.sfxProcTotal_),this.sfxProcCnt_>=this.sfxProcTotal_&&(this.sfxProcCb_=null))},t.prototype.setIfMuteMusic=function(e){this.bMuteMusic_=e,e?cc.audioEngine.stopMusic():this.bgmId_=cc.audioEngine.playMusic(this.bgms_.get(this.curBgmType_),!0),this.bMuteMusic_!=e&&this._saveData()},t.prototype.setIfMuteSound=function(e){this.bMuteSound_=e,this.bMuteSound_!=e&&this._saveData()},t.prototype.setBgmVolume=function(e){this.maxBgmVol_=e,cc.audioEngine.setMusicVolume(e),a.G.isEqualF(e,this.maxBgmVol_)||this._saveData()},t.prototype.setSfxVolume=function(e){this.maxSfxVol_=e,cc.audioEngine.setEffectsVolume(e),a.G.isEqualF(e,this.maxSfxVol_)||this._saveData()},t.prototype._saveData=function(){var e={bMuteBgm:this.bMuteMusic_,bMuteSfx:this.bMuteSound_,maxBgmVol:this.maxBgmVol_,maxSfxVol:this.maxSfxVol_};i.default.writeJSON(i.SaveDef.kAudio,e)},t.prototype._readData=function(){var e=i.default.readJSON(i.SaveDef.kAudio);a.G.isExistObj(e)?(this.bMuteMusic_=e.bMuteBgm,this.bMuteSound_=e.bMuteSfx,this.maxBgmVol_=e.maxBgmVol,this.maxSfxVol_=e.maxSfxVol):this._saveData(),this.setBgmVolume(this.maxBgmVol_),this.setSfxVolume(this.maxSfxVol_)},t.prototype.playMusic=function(e,t){void 0===t&&(t=!1),this.bMuteMusic_||(cc.audioEngine.stopMusic(),this.curBgmType_=e,this.bgms_.containsKey(e)?this.bgmId_=cc.audioEngine.playMusic(this.bgms_.get(e),!0):t?this.bgmRemoteDelayType_=e:a.G.readAudio("audio/"+d[e],this._loadBgm.bind(this),e,!0))},t.prototype.replayMusic=function(){this.curBgmType_&&this.bgms_.containsKey(this.curBgmType_)&&(cc.audioEngine.stopMusic(),this.bgmId_=cc.audioEngine.playMusic(this.bgms_.get(this.curBgmType_),!0))},t.prototype.pauseMusic=function(){cc.audioEngine.pauseMusic()},t.prototype.resumeMusic=function(){cc.audioEngine.resumeMusic()},t.prototype.stopEffects=function(){cc.audioEngine.stopAllEffects()},t.prototype.changeBgmWithFade=function(e,t){void 0===t&&(t=1),this.unscheduleAllCallbacks(),this.maxFadeVol_>0&&(this.maxBgmVol_=this.maxFadeVol_),this.maxFadeVol_=this.maxBgmVol_;var o=this.maxBgmVol_,n=t/10,a=this.maxFadeVol_/10*2,i=!1;this.schedule(function(){this.maxBgmVol_>0&&!i?(this.maxBgmVol_-=a,this.maxBgmVol_<=0&&(this.maxBgmVol_=0,this.playMusic(e),i=!0)):(this.maxBgmVol_+=a,this.maxBgmVol_>=o&&(this.maxBgmVol_=o)),cc.log(this.maxBgmVol_),this.setBgmVolume(this.maxBgmVol_)}.bind(this),n,10)},t.prototype._playSfx=function(e){this.bMuteSound_||(this.sfxMap_.containsKey(e)?cc.audioEngine.playEffect(this.sfxMap_.get(e),!1):a.G.readAudio("audio/"+h[e],this._loadSfx.bind(this),e,!0))},t.prototype.playButton=function(){this._playSfx(l.kButton)},t.prototype.playCoin=function(){this._playSfx(l.kCoin)},t.prototype.playNewCoin=function(){var e=this;this.coinCool||(this.scheduleOnce(function(){e.coinCool=!1},.2),this.coinCool=!0,this._playSfx(l.kNewCoin))},t.prototype.playMove=function(){this._playSfx(l.KMove)},t.prototype.playHit=function(){this._playSfx(l.KHit)},t.prototype.playCut=function(){this._playSfx(l.KCut)},t.prototype.playChains=function(){this._playSfx(l.KChains)},t.prototype.playBoom=function(){this._playSfx(l.KBoom)},t.prototype.playBox=function(){this._playSfx(l.KBox)},t.prototype.playDie=function(){this._playSfx(l.KDie)},t.prototype.playSpear=function(){this._playSfx(l.KSpeer)},t.prototype.playThrowDarts=function(){this._playSfx(l.KThrowDarts)},t.instance=null,t=o=__decorate([c],t)}(cc.Component);o.AudioMgr=u,cc._RF.pop()},{"./Storage":"storage","./global_def":"global_def","./structure/hd_map":"hd_map"}],balloon:[function(e,t,o){"use strict";cc._RF.push(t,"4740bpqiDFDs5nr5nK/vGMY","balloon"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=e("./../util/global_def"),s=e("./enemy"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.top=null,t.top_image=null,t.mid=null,t.bottom=null,t}return __extends(t,e),t.prototype.onPreSolve=function(e,t,o){},t.prototype.onPostSolve=function(e,t,o){},t.prototype.onBeginContact=function(e,t,o){var n=r.G.Game.getDir(e);if(o.tag==r.G.Game.heroTag||o.tag==r.G.Game.enemyTag||o.tag==r.G.Game.petTag){var a=o.node;if(n==r.G.Game.dir.down||n==r.G.Game.dir.left_down){this.top_image.scaleY=.7;var i=cc.scaleTo(.1,1,1);i.easing(cc.easeOut(1)),this.top_image.runAction(cc.sequence(i,cc.callFunc(function(){}))),o.tag==r.G.Game.enemyTag?a.getComponent(s.commonAct).jumpBalloon():a.getComponent("entity").jump(300,.05)}else n==r.G.Game.dir.right_down&&o.tag==r.G.Game.heroTag&&(a.getComponent("entity").sidefric=!0,a.getComponent("entity").side_jump=!0,a.getComponent("entity").s_speed=2,a.getComponent("entity").s_jump_h=100,n==r.G.Game.dir.left_down&&(a.getComponent("entity").s_jump_h=200),a.getComponent("entity").s_min_y=t.node.y+t.node.height/2-100,a.getComponent("entity").s_max_y=t.node.y+t.node.height/2+5)}},t.prototype.onEndContact=function(e,t,o){},__decorate([i(cc.Node)],t.prototype,"top",void 0),__decorate([i(cc.Node)],t.prototype,"top_image",void 0),__decorate([i(cc.Node)],t.prototype,"mid",void 0),__decorate([i(cc.Node)],t.prototype,"bottom",void 0),t=__decorate([a],t)}(cc.Component);o.default=c,cc._RF.pop()},{"./../util/global_def":"global_def","./enemy":"enemy"}],begin:[function(e,t,o){"use strict";cc._RF.push(t,"2640d57jTZEppmyNl31KsQa","begin"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=e("../SDK/aladinSDK"),s=e("../util/global_def"),c=e("./../util/storage"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.curLoad=null,t.curPro=0,t.ani=null,t.switch_2=!0,t.switch_4=!0,t.switch_6=!0,t.switch_8=!0,t.switch_10=!0,t.totalPro=0,t.pro=null,t.index=0,t}return __extends(t,e),t.prototype.onLoadRes=function(){var e=this;this.schedule(function(){0==e.index?e.ani.string=".":1==e.index?e.ani.string="..":2==e.index&&(e.ani.string="..."),e.index=(e.index+1)%3},.1);var t=["fight","map","WeaponLayer","EndScene","backGround"];this.totalPro=t.length,this.pro=0;var o=function(o){var n=t[o];cc.loader.downloader.loadSubpackage(n,function(t){if(console.log(t),t)return console.log(n+"\u4e0b\u8f7d\u5931\u8d25"),console.error(t);e.pro++,console.log(n+"\u4e0b\u8f7d\u6210\u529f")})};for(var n in t)o(n)},t.prototype.update=function(){this.curPro++,this.curPro>=100&&(this.curPro=100),this.curLoad.string=String(this.curPro)+"/100",null!=this.pro&&this.pro>=this.totalPro&&(this.enter(),this.pro=null)},t.prototype.enter=function(){var e=this;r.AladinSDK.init(s.G.appid,"1.0.0",{adaptation:!0,themeurl:"https://huandong-1257458597.cos.ap-guangzhou.myqcloud.com/HeadStrong/SDK/sprite1.png",guesslike_font_color:"#F0FFF0"}),s.G.GlobalData.novice=c.default.readNum("novice"),cc.director.preloadScene("load",function(t,o,n){var a=t/o;a>=1&&e.switch_10?(e.switch_10=!1,s.G.reportToAladin(s.G.aladinType.toLoad_10)):a>=.8&&e.switch_8?(e.switch_8=!1,s.G.reportToAladin(s.G.aladinType.toLoad_8)):a>=.6&&e.switch_6?(e.switch_6=!1,s.G.reportToAladin(s.G.aladinType.toLoad_6)):a>=.4&&e.switch_4?(e.switch_4=!1,s.G.reportToAladin(s.G.aladinType.toLoad_4)):a>=.2&&e.switch_2&&(e.switch_2=!1,s.G.reportToAladin(s.G.aladinType.toLoad_2))},function(e){e?console.log("\u8fdb\u5165Load\u9875\u9762\u5931\u8d25"):(console.log("\u8fdb\u5165Load\u9875\u9762\u6210\u529f"),cc.director.loadScene("load"))})},t.prototype.onLoad=function(){s.G.BlendBanner(),this.enter()},__decorate([i(cc.Label)],t.prototype,"curLoad",void 0),__decorate([i(cc.Label)],t.prototype,"ani",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../SDK/aladinSDK":"AladinSDK","../util/global_def":"global_def","./../util/storage":"storage"}],box:[function(e,t,o){"use strict";cc._RF.push(t,"a569eRqr8FFgJgN2lwiSfz2","box"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=cc._decorator,i=a.ccclass,r=a.property,s=e("./../util/global_def"),c=e("../game_logic"),l=e("../util/event_mgr"),d=e("./../util/audio_mgr");(function(e){e[e.weapon=0]="weapon",e[e.award_0=1]="award_0",e[e.award_1=2]="award_1",e[e.award_2=3]="award_2",e[e.award_3=4]="award_3"})(n=o.BoxType||(o.BoxType={}));var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.wpF=null,t.image=null,t.openImage=[],t.open=!1,t.type=0,t}return __extends(t,e),t.prototype.init=function(e){this.type=e,this.type==n.weapon?this.image.spriteFrame=this.wpF:this.image.spriteFrame=s.G.Game.getGRes(s.G.Game.GResType.Box,e-1)},t.prototype.onLoad=function(){var e=cc.jumpBy(.1,cc.v2(0,10),10,1),t=cc.jumpBy(.1,cc.v2(0,-10),-10,1),o=cc.sequence(e,t,e,t,cc.delayTime(1));this.node.runAction(cc.repeatForever(o))},t.prototype.onCollisionEnter=function(e,t){if(!this.open){d.AudioMgr.instance.playBox(),this.node.stopAllActions(),this.node.y=this.node.parent.parent.height/2+30,this.open=!0;var o=e.node,a=this.openImage[this.type];switch(null!=a&&(this.image.spriteFrame=a),this.type){case n.weapon:var i=s.G.Game.hero_weapon[o.getComponent("hero").id].length,r=s.G.randRange(0,i-1),h=(o.getComponent("hero").weapon_id,o.getComponent("hero").weapon_id[r]);o.getComponent("hero").addWeapon(h),o.getComponent("hero").setWeapon(h),c.default.instance.eventManager.addEvent(l.EventType.kOpenBox,this,{index:r}),c.default.instance.eventManager.addEvent(l.EventType.KTaskBox,this,{});break;case n.award_0:case n.award_1:case n.award_2:case n.award_3:this.node.destroy(),c.default.instance.eventManager.addEvent(l.EventType.KAddAwardBox,this,{boxId:this.type-1})}c.default.instance.report(c.default.instance.rType.pickBox,1)}},__decorate([r(cc.SpriteFrame)],t.prototype,"wpF",void 0),__decorate([r(cc.Sprite)],t.prototype,"image",void 0),__decorate([r([cc.SpriteFrame])],t.prototype,"openImage",void 0),t=__decorate([i],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../game_logic":"game_logic","../util/event_mgr":"event_mgr","./../util/audio_mgr":"audio_mgr","./../util/global_def":"global_def"}],brickExplode:[function(e,t,o){"use strict";cc._RF.push(t,"d3e7eYmOSZMepekCZ16x+3a","brickExplode"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./../util/audio_mgr"),a=e("./../util/global_def"),i=e("./../game_scene"),r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.itemManager=[],t}return __extends(t,e),t.prototype.init=function(e){for(var t=0;t<6;++t){var o=new cc.Node;o.setScale(.7),o.group="blood",o.addComponent(cc.Sprite).spriteFrame=this.brickItemF,this.node.addChild(o,3e3),this.itemManager.push(o);var n=o.addComponent(cc.RigidBody);n.fixedRotation=!1,n.gravityScale=0,n.enabledContactListener=!0,n.bullet=!0;var a=o.addComponent(cc.PhysicsBoxCollider);a.density=1,a.size=cc.size(14,14)}},t.prototype.run=function(){var e=this,t=function(t){var n=o.itemManager[t];n.opacity=255;var r=n.getComponent(cc.RigidBody);r.gravityScale=3,n.setPosition(0,0),r.linearVelocity=cc.v2(a.G.randRange(-150,150),a.G.randRange(200,400)),n.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){r.gravityScale=0}))),0==Number(t)&&n.runAction(cc.sequence(cc.delayTime(1.5),cc.callFunc(function(){i.default.instance.Scene[i.SceneType.hell].getComponent("hell_scene").brickExplodePool.put(e.node)})))},o=this;for(var r in this.itemManager)t(r);n.AudioMgr.instance.playCut()},__decorate([c(cc.SpriteFrame)],t.prototype,"brickItemF",void 0),t=__decorate([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{"./../game_scene":"game_scene","./../util/audio_mgr":"audio_mgr","./../util/global_def":"global_def"}],brick:[function(e,t,o){"use strict";cc._RF.push(t,"6fdb29FZqpHqqvFLsPjP6F9","brick"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./../util/global_def"),a=e("./../game_scene"),i=cc._decorator,r=i.ccclass,s=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blink=null,t.coinF=null,t.isContact=!1,t}return __extends(t,e),t.prototype.onBeginContact=function(e,t,o){var i=this;if(!this.isContact&&o.tag==n.G.Game.heroTag){var r=this.getDir(e);if(r==n.G.Game.dir.right||r==n.G.Game.dir.up){var s=o.node.getComponent(cc.RigidBody);s.linearVelocity.x>100?(this.isContact=!0,this.blink.active=!0,this.blink.runAction(cc.sequence(cc.blink(.05,1),cc.callFunc(function(){i.createCoin(),i.blink.active=!1;var e=a.default.instance.Scene[a.SceneType.hell].getComponent("hell_scene").getBrickExplode();e.setPosition(i.node.x,i.node.y),a.default.instance.playScene.addChild(e),e.getComponent("brickExplode").run(),a.default.instance.Scene[a.SceneType.hell].getComponent("hell_scene").brickPool.put(i.node),i.isContact=!1}))),n.G.Game.vibrateShort()):s.linearVelocity=cc.v2(-1e3,0)}}},t.prototype.getDir=function(e){var t=e.getWorldManifold().normal;return t.x=Math.round(t.x),t.y=Math.round(t.y),t.y>0?n.G.Game.dir.down:t.y<0?n.G.Game.dir.up:t.x<0?n.G.Game.dir.right:t.x>0?n.G.Game.dir.left:void 0},t.prototype.createCoin=function(){var e=new cc.Node;e.group="road",e.addComponent(cc.Sprite).spriteFrame=this.coinF,e.setPosition(this.node.x,this.node.y),this.node.parent.addChild(e);var t=cc.jumpBy(.5,cc.v2(0,150),150,1),o=cc.rotateBy(.5,360);e.runAction(cc.sequence(cc.spawn(t,o),cc.callFunc(function(){e.destroy(),a.default.instance.updateWealth(a.WealthType.coin,2,!1)})))},__decorate([s(cc.Node)],t.prototype,"blink",void 0),__decorate([s(cc.SpriteFrame)],t.prototype,"coinF",void 0),t=__decorate([r],t)}(cc.Component);o.default=c,cc._RF.pop()},{"./../game_scene":"game_scene","./../util/global_def":"global_def"}],bridge:[function(e,t,o){"use strict";cc._RF.push(t,"e22f4FjiElAKb1Fl0Wdqhc1","bridge"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=cc._decorator,i=a.ccclass,r=a.property,s=e("./../util/global_def"),c=e("./../game_scene"),l=e("./hero");(function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical"})(n=o.BridgeType||(o.BridgeType={}));var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.image=null,t.dir=null,t.startDown=!1,t.a=.2,t.speedY=0,t}return __extends(t,e),t.prototype.onBeginContact=function(e,t,o){if(o.tag==s.G.Game.heroTag){var a=t.node.parent;if(this.dir==n.vertical){var i=o;s.G.Game.getDir(e)==s.G.Game.dir.right&&(i.node.getComponent("entity").sidefric=!0,i.node.getComponent("entity").side_jump=!1,i.node.getComponent("entity").s_speed=1,i.node.getComponent("entity").s_jump_h=100,i.node.getComponent("entity").s_min_y=this.node.parent.y-10,i.node.getComponent("entity").s_max_y=this.node.parent.y+this.node.parent.height+5,i.node.getComponent("entity").s_x=this.node.parent.x),this.scheduleOnce(function(){a.run()},1)}else a.run()}},t.prototype.init=function(){this.dir=null,this.startDown=!1,this.a=.2,this.speedY=0},t.prototype.down=function(){this.startDown=!0},t.prototype.setDir=function(e){this.dir=e,e==n.vertical?this.node.rotation=90:this.node.rotation=0},t.prototype.update=function(){if(this.startDown){this.speedY+=this.a,this.node.y-=this.speedY;l.default.instance.node.y,this.node.y,this.node.parent.y;this.node.y+this.node.parent.y<=l.default.instance.node.y-1e3&&(this.startDown=!1,c.default.instance.bridgePool.put(this.node))}},__decorate([r(cc.SpriteFrame)],t.prototype,"image",void 0),t=__decorate([i],t)}(cc.Component);o.default=d;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bridgeItems=[],t.isRun=!1,t.type=null,t}return __extends(t,e),t.prototype.create=function(e,t){for(var o=37.5,a=37.5,i=0;i<e;++i){var r=c.default.instance.getBridgeItem();r.getComponent("bridge").init(),r.getComponent("bridge").setDir(t),this.type=t,t==n.horizontal?(r.y=0,r.x=o,o+=75,this.width=75*e+5,this.height=30):(r.x=0,r.y=a,a+=75,this.height=75*e+5,this.width=30),this.addChild(r),this.bridgeItems.push(r)}t==n.vertical&&c.default.instance.Scene[c.SceneType.main].getComponent("main_scene").vertBrgManager.push(this);return this},t.prototype.run=function(){var e=this;if(!this.isRun){this.isRun=!0;var t=function(t){var n=o.bridgeItems[t];n.runAction(cc.sequence(cc.delayTime(.3*Number(t)),cc.callFunc(function(){n.getComponent("bridge").down(),Number(t)==e.bridgeItems.length-1&&(l.default.instance.node.getComponent("entity").sidefric=!1)})))},o=this;for(var a in this.bridgeItems)t(a);var i=.5*this.bridgeItems.length;this.runAction(cc.sequence(cc.delayTime(i),cc.callFunc(function(){if(e.destroy(),e.type==n.vertical){var t=c.default.instance.Scene[c.SceneType.main].getComponent("main_scene").vertBrgManager;s.G.Game.rmFromArray(e,t)}})))}},t}(cc.Node);o.bridge=h,cc._RF.pop()},{"./../game_scene":"game_scene","./../util/global_def":"global_def","./hero":"hero"}],bubble_txt:[function(e,t,o){"use strict";cc._RF.push(t,"efb25ZFQR5IGoCH/tMEzW5w","bubble_txt"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.txt_=null,t}return __extends(t,e),t.prototype.popOut=function(e,t){this.node.active=!0,this.node.stopAllActions(),this.txt_.string=e,this.node.width=this.txt_.node.width+10,this.node.height=this.txt_.node.height+20;var o=this.node.convertToWorldSpaceAR(cc.v2(0,0));o=t.convertToNodeSpaceAR(o),this.node.setPosition(o),this.node.scale=.1,this.node.runAction(cc.scaleTo(.1,1,1)),t.addChild(this.node)},t.prototype.onDisable=function(){this.node.stopAllActions(),this.node.removeFromParent()},__decorate([i(cc.Label)],t.prototype,"txt_",void 0),t=__decorate([a],t)}(cc.Component);o.default=r,cc._RF.pop()},{}],coin:[function(e,t,o){"use strict";cc._RF.push(t,"eeed7jxJT5HhZfPBVDPM4EQ","coin"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label_=null,t.exchangeLbl_=null,t.origClr_=null,t.coinVal_=0,t}return __extends(t,e),t.prototype.onLoad=function(){this.origClr_=this.label_.node.color},t.prototype.init=function(e){this.refreshLabel(e)},t.prototype.refreshLabel=function(e){if(this.coinVal_+=e,this.coinVal_>=99999999&&(this.coinVal_=99999999),this.label_.string=this.coinVal_.toString(),0!=e){var t=cc.scaleTo(.1,1.1,1.1),o=cc.scaleTo(.2,1,1);this.node.runAction(cc.sequence(t,o)),this.origClr_&&(this.label_.node.color=this.origClr_);var n=e>0?0:255,a=e>0?255:0,i=this.origClr_;null==i&&(i=this.label_.node.color);var r=cc.tintTo(.1,n,a,0),s=cc.tintTo(.1,i.getR(),i.getG(),i.getB());this.label_.node.runAction(cc.sequence(r,s));var c=e>0?"+":"";this.exchangeLbl_.string=c+e.toString(),this.exchangeLbl_.node.x=this.label_.node.width+this.label_.node.x;var l=cc.fadeIn(.2),d=cc.fadeOut(.4);this.exchangeLbl_.node.runAction(cc.sequence(l,d))}},__decorate([i(cc.Label)],t.prototype,"label_",void 0),__decorate([i(cc.Label)],t.prototype,"exchangeLbl_",void 0),t=__decorate([a],t)}(cc.Component);o.default=r,cc._RF.pop()},{}],dialAward:[function(e,t,o){"use strict";cc._RF.push(t,"a119epRAOZPAofvCxH3gzG+","dialAward"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./../util/global_def"),i=e("./load"),r=e("../game_scene"),s=e("../util/wx_util"),c=cc._decorator,l=c.ccclass,d=c.property;(function(e){e[e.coin=1]="coin",e[e.crown=2]="crown",e[e.hero=3]="hero"})(n||(n={}));var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.awardCoin=null,t.awardHero=null,t.awardCrown=null,t.num=null,t.heroImage=null,t.heroId=null,t.type=null,t.awardNum=null,t.lookVideoBtn=null,t.banNode=null,t.backBtn=null,t}return __extends(t,e),t.prototype.init=function(e,t,o){switch(this.awardCoin.active=!1,this.awardCrown.active=!1,this.awardHero.active=!1,this.type=e,t&&(this.num.string=String(t),this.awardNum=t,this.lookVideoBtn.active=!0,this.num.node.active=!0),o&&(this.heroId=o,this.heroImage.spriteFrame=a.G.Game.getGRes(a.G.Game.GResType.Hero,o),this.lookVideoBtn.active=!1,this.num.node.active=!1),e){case n.coin:this.awardCoin.active=!0;break;case n.crown:this.awardCrown.active=!0;break;case n.hero:this.awardHero.active=!0}s.default.delBanner(),s.default.addBanner(a.G.BannerId[0],null,this.banNode)},t.prototype.open=function(e,t,o){a.G.reportToAld(a.G.Report.dialDouble),this.init(e,t,o),this.node.active=!0,this.content.getComponent("ui_motion").triggerMotion()},t.prototype.close=function(){s.default.delBanner(),this.node.active=!1},t.prototype.onClickGetAward=function(){this.type==n.coin?(i.default.instance.showTip("\u83b7\u5f97\u91d1\u5e01"+this.awardNum),i.default.instance.updateWealth(r.WealthType.coin,this.awardNum)):this.type==n.crown?(i.default.instance.showTip("\u83b7\u5f97\u7687\u51a0"+this.awardNum),i.default.instance.updateWealth(r.WealthType.crown,this.awardNum)):this.heroId&&a.G.GameData.setHeroData(this.heroId,1),this.close()},t.prototype.onClickGetDoubleAward=function(){var e=this;s.default.watchVideoAds(a.G.VideoId.trialHero,function(){a.G.reportToAld(a.G.Report.dialDoubleVideo),e.type==n.coin?(i.default.instance.showTip("\u83b7\u5f97\u91d1\u5e01"+2*e.awardNum),i.default.instance.updateWealth(r.WealthType.coin,2*e.awardNum)):e.type==n.crown&&(i.default.instance.showTip("\u83b7\u5f97\u7687\u51a0"+2*e.awardNum),i.default.instance.updateWealth(r.WealthType.crown,2*e.awardNum)),e.close()})},__decorate([d(cc.Node)],t.prototype,"content",void 0),__decorate([d(cc.Node)],t.prototype,"awardCoin",void 0),__decorate([d(cc.Node)],t.prototype,"awardHero",void 0),__decorate([d(cc.Node)],t.prototype,"awardCrown",void 0),__decorate([d(cc.Label)],t.prototype,"num",void 0),__decorate([d(cc.Sprite)],t.prototype,"heroImage",void 0),__decorate([d(cc.Node)],t.prototype,"lookVideoBtn",void 0),__decorate([d(cc.Node)],t.prototype,"banNode",void 0),__decorate([d(cc.Node)],t.prototype,"backBtn",void 0),t=__decorate([l],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../game_scene":"game_scene","../util/wx_util":"wx_util","./../util/global_def":"global_def","./load":"load"}],dialog:[function(e,t,o){"use strict";cc._RF.push(t,"85c1ciAjoJMiLHpFQ0NCuTj","dialog"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("../../util/global_def"),i=cc._decorator,r=i.ccclass,s=i.property;(function(e){e[e.kYes=0]="kYes",e[e.kNo=1]="kNo"})(n||(n={}));var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rTxt_=null,t.con_=null,t.btns_=[],t.yesCallback_=null,t.noCallback_=null,t.bLocked_=!1,t.bPause_=!1,t}return __extends(t,e),t.prototype.open=function(e,t,o,i,r){void 0===t&&(t=!1),void 0===o&&(o=!1),this.con_.stopAllActions(),this.node.active=!0,this.rTxt_.string=e,t?(this.btns_[n.kNo].node.active=!1,this.btns_[n.kYes].node.x=0):(this.btns_[n.kNo].node.active=!0,this.btns_[n.kYes].node.x=-90),a.G.isExistObj(i)?this.yesCallback_=i:this.yesCallback_=this.defaultYesCb,a.G.isExistObj(r)?this.noCallback_=r:this.noCallback_=this.defaultNoCb;for(var s=0;s<this.btns_.length;++s)this.btns_[s].interactable=!1;this.con_.scale=.1;var c=cc.scaleTo(.2,1.1,1.1),l=cc.scaleTo(.1,1,1);this.bPause_=o;var d=cc.callFunc(function(){this.bPause_&&(cc.director.pause(),console.log("dialog pause"));for(var e=0;e<this.btns_.length;++e)this.btns_[e].interactable=!0},this);this.con_.runAction(cc.sequence(c,l,d))},t.prototype.onYesClick=function(){this.bPause_&&cc.director.resume(),this.yesCallback_(),this.node.active=!1},t.prototype.onNoClick=function(){this.bPause_&&cc.director.resume(),this.noCallback_(),this.node.active=!1},t.prototype.defaultYesCb=function(){this.node.active=!1,this.bPause_&&cc.director.resume()},t.prototype.defaultNoCb=function(){this.node.active=!1,this.bPause_&&cc.director.resume()},__decorate([s(cc.RichText)],t.prototype,"rTxt_",void 0),__decorate([s(cc.Node)],t.prototype,"con_",void 0),__decorate([s(cc.Button)],t.prototype,"btns_",void 0),t=__decorate([r],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../../util/global_def":"global_def"}],dial:[function(e,t,o){"use strict";cc._RF.push(t,"dd5aesAEYVLHrR2aUBtbyZT","dial"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=e("./../util/global_def"),s=e("./load"),c=e("../util/wx_util"),l=e("../util/Storage"),d=e("../game_logic"),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dialAward=null,t.dial_bg=null,t.dial_light=null,t.content=null,t.videoBtn=null,t.shareBtn=null,t.freeBtn=null,t.dialInfo=null,t.items=[],t.BannerNode=null,t.lastAwardId=0,t.lastRandAngle=null,t.awardId=null,t.dialShareCount=null,t.totalShareCount=0,t.dialVideoCount=null,t.totalVideoCount=3,t}return __extends(t,e),t.prototype.open=function(){0!=d.default.instance.switch?(r.G.reportToAld(r.G.Report.dial),this.init(),this.reSetVideoCount(),this.reSetShareCount(),this.lastAwardId=0,this.node.active=!0,this.content.getComponent("ui_motion").triggerMotion(),this.dialShareCount=l.default.readNum("dialShareCount"),this.dialVideoCount=l.default.readNum("dialVideoCount"),null==this.dialShareCount&&(this.dialShareCount=0,this.dialVideoCount=0),this.dialVideoCount>=this.totalVideoCount&&(this.videoBtn.interactable=!1),this.getFreeCount()>0?(this.freeBtn.node.active=!0,this.shareBtn.node.active=!1):(this.freeBtn.node.active=!1,this.shareBtn.node.active=!0,this.dialShareCount>=this.totalShareCount&&(this.shareBtn.interactable=!1),(1==d.default.instance.ip_switch&&0==d.default.instance.ip_share||0==this.totalShareCount)&&(this.shareBtn.node.active=!1)),c.default.delBanner(),c.default.addBanner(r.G.BannerId[0],null,this.BannerNode)):s.default.instance.showTip("1000\u7687\u51a0\u5f00\u653e")},t.prototype.init=function(){for(var e in this.dialInfo.json){var t=this.items[Number(e)-1],o=this.dialInfo.json[e];if(1==o.reward_ID)t.getChildByName("num").getComponent(cc.Label).string=String(o.reward_numb);else if(2==o.reward_ID){t.getChildByName("num").getComponent(cc.Label).string=String(o.reward_numb)}}},t.prototype.close=function(){c.default.delBanner(),this.node.active=!1},t.prototype.getAwardId=function(){var e=Math.random();console.log("\u6982\u7387\u503c"+e);var t=0,o=0;for(var n in this.dialInfo.json){if("6"==n)return Number(n)-1;if(o=this.dialInfo.json[n].probability+o,e>=t&&e<o)return Number(n)-1;t=o}return 0},t.prototype.run=function(){var e=this;this.videoBtn.interactable=!1,this.shareBtn.interactable=!1,this.freeBtn.interactable=!1,this.dial_bg.rotation=0,this.awardId=this.getAwardId(),console.log("\u5956\u54c1id"+this.awardId);this.awardId,this.lastAwardId;this.lastAwardId=this.awardId;var t=360-60*this.awardId+30,o=r.G.randRange(10,50),n=3600+t-o;this.lastRandAngle=o;var a=cc.rotateBy(3.5,n);a.easing(cc.easeInOut(2)),this.dial_bg.runAction(cc.sequence(a,cc.delayTime(.1),cc.callFunc(function(){e.dialVideoCount>=e.totalVideoCount?e.videoBtn.interactable=!1:e.videoBtn.interactable=!0,e.shareBtn.interactable=!0,e.dialShareCount>=e.totalShareCount&&(e.shareBtn.interactable=!1);var t=e.dialInfo.json[e.awardId+1];if(3==t.reward_ID){var o=r.G.randRange(0,r.G.Game.hatCount-1);e.dialAward.getComponent("dialAward").open(t.reward_ID,null,o)}else e.dialAward.getComponent("dialAward").open(t.reward_ID,t.reward_numb)})))},t.prototype.onClickVideo=function(){var e=this;c.default.watchVideoAds(r.G.VideoId.trialHero,function(){r.G.reportToAld(r.G.Report.dialVideo),e.run(),e.dialVideoCount++,l.default.writeNum("dialVideoCount",e.dialVideoCount)})},t.prototype.onClickShare=function(){var e=this;r.G.shareGame(function(){r.G.reportToAld(r.G.Report.dialShare),e.run(),e.dialShareCount++,l.default.writeNum("dialShareCount",e.dialShareCount)})},t.prototype.onClickFree=function(){this.run(),(0==d.default.instance.ip_switch||1==d.default.instance.ip_share)&&this.totalShareCount>0&&(this.shareBtn.node.active=!0),this.freeBtn.node.active=!1,l.default.writeNum("dialFreeCount",0)},t.prototype.getFreeCount=function(){var e=(new Date).getDate(),t=l.default.readNum("lastDateDial");e!=Number(t)&&l.default.writeNum("dialFreeCount",1);l.default.readNum("dialFreeCount");return l.default.writeNum("lastDateDial",e),0},t.prototype.reSetShareCount=function(){r.G.reSetData("lastDateDialShare","dialShareCount",0)},t.prototype.reSetVideoCount=function(){r.G.reSetData("lastDateDialVideo","dialVideoCount",0)},__decorate([i(cc.Node)],t.prototype,"dialAward",void 0),__decorate([i(cc.Node)],t.prototype,"dial_bg",void 0),__decorate([i(cc.Node)],t.prototype,"dial_light",void 0),__decorate([i(cc.Node)],t.prototype,"content",void 0),__decorate([i(cc.Button)],t.prototype,"videoBtn",void 0),__decorate([i(cc.Button)],t.prototype,"shareBtn",void 0),__decorate([i(cc.Button)],t.prototype,"freeBtn",void 0),__decorate([i(cc.JsonAsset)],t.prototype,"dialInfo",void 0),__decorate([i([cc.Node])],t.prototype,"items",void 0),__decorate([i(cc.Node)],t.prototype,"BannerNode",void 0),t=__decorate([a],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../game_logic":"game_logic","../util/Storage":"storage","../util/wx_util":"wx_util","./../util/global_def":"global_def","./load":"load"}],door:[function(e,t,o){"use strict";cc._RF.push(t,"7ec12zBRSRN/L5R+yynW9ne","door"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./../game_logic"),i=e("../game_scene"),r=e("./../UI/hero"),s=e("./../util/event_mgr"),c=cc._decorator,l=c.ccclass,d=c.property;(function(e){e[e.main=0]="main",e[e.hell=1]="hell",e[e.heaven=2]="heaven"})(o.doorType||(o.doorType={})),function(e){e[e.to_open=0]="to_open",e[e.open=1]="open"}(n=o.doorState||(o.doorState={}));var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.leftDoor=null,t.rightDoor=null,t.doors=[],t.state=null,t.nowSceneType=null,t.toSceneType=null,t.updateMask=2,t.doorSpeed=3,t.doorWidth=138,t.listenerId=null,t}return __extends(t,e),t.prototype.showScene=function(){for(var e=i.default.instance.Scene.length,t=0;t<e;++t)i.default.instance.Scene[t].active=!1;i.default.instance.Scene[this.toSceneType].active=!0,i.default.instance.Scene[this.toSceneType].getComponent("game").showDoorAni()},t.prototype.close=function(){i.default.instance.lastRoadPos.x=i.default.instance.mapCamera.x-400,i.default.instance.lastRoadPos.y=i.default.instance.mapCamera.y-100,i.default.instance.playScene=i.default.instance.Scene[this.toSceneType],i.default.instance.playScene.getComponent("game").cleanAllUp(),i.default.instance.playScene.getComponent("game").startNodeManager(),r.default.instance.node.active=!1,r.default.instance.hero_pause=!0,a.default.instance.gameState=a.GameState.gameOtherScene,this.updateMask=0},t.prototype.update=function(){var e=this;0==this.updateMask?(this.leftDoor.width+=this.doorSpeed,this.rightDoor.width+=this.doorSpeed,this.leftDoor.width>=this.doorWidth&&(this.updateMask=2,this.node.runAction(cc.sequence(cc.scaleTo(.5,0,1),cc.delayTime(.5),cc.callFunc(function(){e.state==n.to_open?e.showScene():e.state==n.open&&(a.default.instance.gameState=a.GameState.gameStart),e.node.destroy()}))))):1==this.updateMask&&(this.leftDoor.width-=this.doorSpeed,this.rightDoor.width-=this.doorSpeed,this.leftDoor.width<=0&&(this.leftDoor.width=0,this.rightDoor.width=0,this.node.runAction(cc.sequence(cc.delayTime(.3),cc.callFunc(function(){e.updateMask=0})))))},t.prototype.open=function(){var e=this;this.node.runAction(cc.sequence(cc.delayTime(.5),cc.scaleTo(.5,1,1),cc.callFunc(function(){e.updateMask=1})))},t.prototype.onCollisionEnter=function(){this.state==n.to_open&&(this.toSceneType==i.SceneType.main?this.close():a.default.instance.eventManager.addEvent(s.EventType.KStartDoorPro,this,{}))},t.prototype.onCollisionExit=function(){this.state==n.to_open&&a.default.instance.eventManager.addEvent(s.EventType.KStopDoorPro,this,{})},t.prototype.setState=function(e){var t=this;this.state=e,e==n.open&&(this.leftDoor.width=this.doorWidth,this.rightDoor.width=this.doorWidth,this.node.scaleX=0,this.open()),this.listenerId=a.default.instance.eventManager.addListener(s.EventType.KOpenDoor,this.close.bind(this)),this.schedule(function(){t.node.parent.x+t.node.width/2+i.default.instance.windowSize.width/2+100<i.default.instance.mapCamera.x&&t.node.destroy()},.2,cc.macro.REPEAT_FOREVER)},t.prototype.onDestroy=function(){a.default.instance.eventManager.removeListener(s.EventType.KOpenDoor,this.listenerId)},t.prototype.setType=function(e,t){this.nowSceneType=e,this.toSceneType=t;for(var o in this.doors){this.doors[o].active=!1}this.doors[t].active=!0},__decorate([d(cc.Node)],t.prototype,"leftDoor",void 0),__decorate([d(cc.Node)],t.prototype,"rightDoor",void 0),__decorate([d([cc.Node])],t.prototype,"doors",void 0),t=__decorate([l],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../game_scene":"game_scene","./../UI/hero":"hero","./../game_logic":"game_logic","./../util/event_mgr":"event_mgr"}],effectManager:[function(e,t,o){"use strict";cc._RF.push(t,"8079eCcn31E8IP0iuuy4uzl","effectManager"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=cc._decorator,i=a.ccclass,r=a.property;(function(e){e[e.bat=0]="bat"})(n=o.effectType||(o.effectType={}));var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.effects=[],t.effectPool=[],t}return __extends(t,e),t.prototype.init=function(){for(var e=n.bat;e<=n.bat;++e)if(null==this.effectPool[e]){this.effectPool[e]=new cc.NodePool;for(var t=0;t<8;t++){var o=cc.instantiate(this.effects[e]);this.effectPool[e].put(o)}}},t.prototype.get=function(e){var t=this.effectPool[e].get();return null==t&&(t=cc.instantiate(this.effects[e])),t},t.prototype.recycle=function(e,t){this.effectPool[e].put(t)},__decorate([r(cc.Prefab)],t.prototype,"effects",void 0),t=__decorate([i],t)}(cc.Component);o.default=s,cc._RF.pop()},{}],endLayer:[function(e,t,o){"use strict";cc._RF.push(t,"6ee52BImnpPprnZXAP5dH15","endLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./../game_scene"),a=e("./../game_logic"),i=e("./../util/wx_util"),r=e("./../util/global_def"),s=e("./../util/storage"),c=e("../SDK/aladinSDK"),l=e("../SDK/ALGuessLike"),d=e("./Rank"),h=cc._decorator,u=h.ccclass,p=h.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.lookVideo=null,t.getCoin=null,t.lookVideoOver=null,t.lookVideo_coinLabl=null,t.lookVideo_light=null,t.lookVideo_tag=null,t.lookVideo_shareBtn=null,t.lookVideo_time=null,t.lookVideo_sp=[],t.lookVideo_shareImage=null,t.lookVideo_back=null,t.getCoin_shareBtn=null,t.getCoin_videoBtn=null,t.getCoin_tag=null,t.getCoin_back=null,t.coinNum=null,t.lucky=null,t.luckyOpen=null,t.canOpen=!1,t.moreGame_0=null,t.moreGame_1=null,t.contentShardBtn=null,t.backToHallNode=null,t.banEnd0=null,t.banEnd0_1=null,t.banEnd1=null,t.banEnd2=null,t.crownNum=5,t.lookVideoMoreGame=null,t.contentMoreGame=null,t.favoNode=null,t.iconGame=null,t.iconGame1=null,t.iconGame2=null,t.iconGame3=null,t.rand=null,t.rand_2=null,t.rand_1=null,t.noJumpCount=0,t.time=4,t.initMultIcon=!1,t.getCoinFirstClick=!1,t.showMod=!1,t.shareCount=null,t.firstClick=!0,t}return __extends(t,e),t.prototype.addOpenCount=function(){var e=s.default.readNum("endOpen");e++,s.default.writeNum("endOpen",e)},t.prototype.getOpenCount=function(){var e=(new Date).getDate(),t=s.default.readNum("lastDateOpenEnd");e!=Number(t)&&s.default.writeNum("endOpen",0);var o=s.default.readNum("endOpen");return s.default.writeNum("lastDateOpenEnd",e),Number(o)},t.prototype.initBanner=function(){var e=this;i.default.createInterstitialAd(),this.rand=r.G.randRange(0,99),this.rand_1=r.G.randRange(0,99),this.rand_2=r.G.randRange(0,99);var t=this.getOpenCount();r.G.ipShield(this.rand_1)&&t>=this.noJumpCount?i.default.addBanner(r.G.BannerId[1],null,this.banEnd0,1,!0,r.G.PreBannerId[0]):i.default.addBanner(r.G.BannerId[1],null,this.banEnd0_1,1,!0,r.G.PreBannerId[0]),i.default.addBanner(r.G.BannerId[2],null,this.banEnd1,1,!0,r.G.PreBannerId[0]),i.default.addBanner(r.G.BannerId[2],null,this.banEnd2,1,!0,r.G.PreBannerId[0]),i.default.delBanner(),wx.onHide(function(){}),wx.onShow(function(){e.showMod||a.default.instance.gameState==a.GameState.gameOver&&e.timeDown()})},t.prototype.down=function(){this.time--,this.lookVideo_time.string=String(this.time),this.time<=0&&(this.unschedule(this.down),this.lookVideo.active=!1,n.default.instance.currentCoin>20?this.openGetCoin():this.openContent())},t.prototype.timeDown=function(){this.time=4,null!=this.lookVideo_time&&(this.lookVideo_time.string=String(this.time),this.unschedule(this.down),this.schedule(this.down,1))},t.prototype.initGuessLike=function(){},t.prototype.showBakc=function(){this.lookVideo_back.active=!0},t.prototype.createMultIcon=function(){if(!this.initMultIcon){this.initMultIcon=!0;var e=l.ALGuessLike.getIconData(),t=this.content.getChildByName("bg");console.log("\u56fe\u6807\u6570\u91cf"+e.length);for(var o=0;o<e.length;o++){var a=l.ALGuessLike.createIcon(n.default.instance.iconItem,null,o);a.x=o%4*130-195,a.y=17-137*Math.floor(o/4),a.parent=t}}},t.prototype.createIconGame_0=function(){var e=this,t=function(){var t=l.ALGuessLike.createIcon(n.default.instance.iconItem);e.iconGame.removeAllChildren(),e.iconGame.addChild(t);var o=l.ALGuessLike.createIcon(n.default.instance.iconItem);e.iconGame1.removeAllChildren(),e.iconGame1.addChild(o);var a=l.ALGuessLike.createIcon(n.default.instance.iconItem);e.iconGame2.removeAllChildren(),e.iconGame2.addChild(a);var i=l.ALGuessLike.createIcon(n.default.instance.iconItem);e.iconGame3.removeAllChildren(),e.iconGame3.addChild(i)};this.schedule(function(){t()},5),t()},t.prototype.open=function(e){n.default.instance.power_bar.node.active=!1,this.initGuessLike(),this.createMultIcon(),this.createIconGame_0(),this.lookVideo_back.active=!1,this.unschedule(this.showBakc),this.scheduleOnce(this.showBakc,5),this.lookVideo_shareBtn.stopAllActions(),this.lookVideo_shareBtn.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.1,.8,.8),cc.scaleTo(.1,1.1,1.1),cc.scaleTo(.1,.8,.8),cc.scaleTo(.1,1.1,1.1),cc.scaleTo(.1,.9,.9),cc.scaleTo(.1,1,1),cc.delayTime(1)))),this.lookVideoOver=this.getLookVideoOver(),this.node.active=!0,this.lookVideo.active=!0,this.content.active=!0,this.getCoin.active=!0,this.content.scale=0,this.getCoin.scale=0,this.contentShardBtn.active=!0;var t=n.default.instance.currentCoin*(r.G.GlobalData.addAwardShared-1);t=Math.floor(t),n.default.instance.updateWealth(n.WealthType.coin,t),n.default.instance.currentCoin=Math.floor(n.default.instance.currentCoin*r.G.GlobalData.addAwardShared),this.lookVideo_coinLabl.string=String(n.default.instance.currentCoin),this.coinNum.string=String(3*n.default.instance.currentCoin);i.default.delBanner();var o=this.getOpenCount();if(r.G.ipShield(this.rand_1)&&o>=this.noJumpCount?i.default.addBanner(r.G.BannerId[1],null,this.banEnd0,1,!1,r.G.PreBannerId[0]):i.default.addBanner(r.G.BannerId[1],null,this.banEnd0_1,1,!1,r.G.PreBannerId[0]),1==e)this.lookVideo.active=!1,n.default.instance.currentCoin>20?this.openGetCoin():this.openContent();else{this.addOpenCount(),this.getShardCount()<a.default.instance.shareCount&&(0==a.default.instance.ip_switch||1==a.default.instance.ip_share)?this.lookVideo_shareImage.spriteFrame=this.lookVideo_sp[0]:this.lookVideo_shareImage.spriteFrame=this.lookVideo_sp[1],r.G.reportToAld(r.G.Report.endLayer_0),this.timeDown();var s=this.getGameCount()/5;if(s>=1){this.canOpen=!0,s=1;var c=.45;this.luckyOpen.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.1,.8*c,.8*c),cc.scaleTo(.1,1.1*c,1.1*c),cc.scaleTo(.1,.8*c,.8*c),cc.scaleTo(.1,1.1*c,1.1*c),cc.scaleTo(.1,.405,.405),cc.scaleTo(.1,.45,.45),cc.delayTime(1))))}this.lucky.progress=s}},t.prototype.getGameCount=function(){var e=s.default.readNum("luckGameCount");return null==e&&(e=0),e++,s.default.writeNum("luckGameCount",e),e},t.prototype.close=function(){this.node.active=!1},t.prototype.destroySDK=function(){c.AladinSDK.destroyDrawerNode(),c.AladinSDK.destroyFavoNode(),c.AladinSDK.destroyMoreNode()},t.prototype.openGetCoin=function(){var e=this,t=c.AladinSDK.getMoreNode();t.scale=.9,t.removeFromParent(!1),this.moreGame_0.addChild(t),this.getCoinFirstClick=!0,r.G.ipShield(this.rand_2)?this.getCoin_back.y=-420:(this.getCoin_back.y=-300,this.getCoinFirstClick=!1);this.getCoin.getComponent("ui_motion").triggerMotion(function(){if(a.default.instance.gameState==a.GameState.gameOver)if(i.default.delBanner(),r.G.ipShield(e.rand)){var t=r.G.showBanner.endLayer_1.time-r.G.delayTime;t<=0?t=0:t>=r.G.maxTime&&(t=r.G.maxTime),r.G.startBanner(r.G.showBanner.endLayer_1),e.getCoin_back.onTouch=!0,e.getCoin_back.runAction(cc.sequence(cc.delayTime(t),cc.moveBy(0,0,120),cc.callFunc(function(){i.default.addBanner(r.G.BannerId[2],null,e.banEnd1,1,!1,r.G.PreBannerId[0]),e.getCoin_back.onTouch=!1})))}else i.default.addBanner(r.G.BannerId[2],null,e.banEnd1,1,!1,r.G.PreBannerId[0])}),this.lookVideo_tag.stopAllActions(),this.lookVideo_tag.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.1,.8,.8),cc.scaleTo(.1,1.1,1.1),cc.scaleTo(.1,.8,.8),cc.scaleTo(.1,1.1,1.1),cc.scaleTo(.1,.9,.9),cc.scaleTo(.1,1,1),cc.delayTime(2)))),i.default.delBanner(),r.G.reportToAld(r.G.Report.endLayer_1)},t.prototype.onClickLookVideo_resurgence=function(){var e=this;this.unschedule(this.down);var t=function(){n.default.instance.power_bar.node.active=!0,e.timeDown();var t=s.default.readNum("shareCount");t++,console.log("\u5206\u4ea8\u6b21\u6570cou"+t),cc.sys.localStorage.setItem("shareCount",t),n.default.instance.resurgence()},o=this.getShardCount();console.log("\u5206\u4ea8\u6b21\u6570cou"+o),o<a.default.instance.shareCount&&(0==a.default.instance.ip_switch||1==a.default.instance.ip_share)?(r.G.reportToAld(r.G.Report.endLayer_0_Share),n.default.instance.shareGame(function(){t()},function(t,o,n,a){e.showMod=!0,wx.showModal({title:"\u63d0\u793a",content:"\u53d1\u9001\u5230\u4e0d\u540c\u7fa4\u624d\u80fd\u83b7\u5f97\u5956\u52b1",showCancel:!0,cancelText:"\u6b8b\u5fcd\u62d2\u7edd",cancelColor:"",confirmText:"\u518d\u8bd5\u4e00\u6b21",success:function(r){r.confirm?i.default.shareNorm(t,o,n,a):e.timeDown(),e.showMod=!1}})})):(this.lookVideo_shareImage.spriteFrame=this.lookVideo_sp[1],r.G.reportToAld(r.G.Report.endLayer_0_Video),i.default.watchVideoAds(r.G.VideoId.end_resurgence,function(){t()},function(){e.timeDown(),n.default.instance.showTip("\u672a\u89c2\u770b\u5b8c\u6574\u89c6\u9891\uff0c\u65e0\u6cd5\u83b7\u5f97\u5956\u52b1")}))},t.prototype.getShardCount=function(){var e=(new Date).getDate(),t=s.default.readNum("lastDateShare"),o=s.default.readNum("shareCount");return e==t&&null!=o||s.default.writeNum("shareCount",0),cc.sys.localStorage.setItem("lastDateShare",e),s.default.readNum("shareCount")},t.prototype.getLookVideoOver=function(){var e=(new Date).getDate(),t=s.default.readNum("lastLookVideoOver"),o=s.default.readNum("lookVideoOver");return e==t&&null!=o||s.default.writeNum("lookVideoOver",0),cc.sys.localStorage.setItem("lastLookVideoOver",e),s.default.readNum("lookVideoOver")},t.prototype.onclickCrownBtn=function(){i.default.delBanner(),n.default.instance.buy(n.WealthType.crown,this.crownNum,function(){n.default.instance.resurgence(),r.G.reportToAld(r.G.Report.endLayer_0_Crown)})},t.prototype.luckySuc=function(){s.default.writeNum("luckGameCount",0),this.luckyOpen.stopAllActions(),this.lucky.progress=0,this.canOpen=!1},t.prototype.onClickLucky=function(){if(this.canOpen){n.default.instance.node.getChildByName("AwardLayer").getComponent("newAwardLayer").open(1)}},t.prototype.onClickGetCoin_videoBtn=function(){var e=this,t=function(){n.default.instance.showTip("\u606d\u559c\u83b7\u5f97\u91d1\u5e01:"+3*n.default.instance.currentCoin),n.default.instance.updateWealth(n.WealthType.coin,2*n.default.instance.currentCoin),e.openContent()};i.default.watchVideoAds(r.G.VideoId.end_coin_double,t,function(){},function(){s.default.writeNum("lookVideoOver",1),0!=a.default.instance.ip_switch&&1!=a.default.instance.ip_share||n.default.instance.shareGame(t)}),r.G.reportToAld(r.G.Report.endLayer_1_Video)},t.prototype.onClickGetCoin_shareBtn=function(){n.default.instance.shareGame(function(){n.default.instance.showTip("\u606d\u559c\u83b7\u5f97\u91d1\u5e01:"+2*n.default.instance.currentCoin),n.default.instance.updateWealth(n.WealthType.coin,1*n.default.instance.currentCoin)})},t.prototype.openContent=function(){var e=this;if(r.G.stopBanner(r.G.showBanner.endLayer_1),!this.getCoin_back.onTouch){i.default.showInterstitialAd();var t=c.AladinSDK.getMoreNode();t.removeFromParent(!1),this.contentMoreGame.addChild(t),i.default.delBanner(),this.getCoin.active=!1,this.firstClick=!0,r.G.ipShield(this.rand)?this.backToHallNode.y=-489:(this.backToHallNode.y=-369,this.firstClick=!1);this.content.getComponent("ui_motion").triggerMotion(function(){if(a.default.instance.gameState==a.GameState.gameOver)if(i.default.delBanner(),r.G.ipShield(e.rand)){var t=r.G.showBanner.endLayer_2.time-r.G.delayTime;t<=0?t=0:t>=r.G.maxTime&&(t=r.G.maxTime),r.G.startBanner(r.G.showBanner.endLayer_2),e.backToHallNode.onTouch=!0,e.backToHallNode.runAction(cc.sequence(cc.delayTime(t),cc.moveBy(0,0,120),cc.callFunc(function(){i.default.addBanner(r.G.BannerId[2],null,e.banEnd2,1,!1,r.G.PreBannerId[0]),e.backToHallNode.onTouch=!1})))}else i.default.addBanner(r.G.BannerId[2],null,e.banEnd2,1,!1,r.G.PreBannerId[0])}),r.G.reportToAld(r.G.Report.endLayer_2)}},t.prototype.onClickContent_shareBtn=function(){r.G.stopBanner(r.G.showBanner.endLayer_2),r.G.reportToAld(r.G.Report.endLayer_2_Share),n.default.instance.shareGame(function(){console.log("\u53d1\u8d77\u6311\u6218\u6210\u529f")})},t.prototype.backToHall=function(){r.G.stopBanner(r.G.showBanner.endLayer_2),this.backToHallNode.onTouch||(d.Rank.clean(),cc.audioEngine.stopMusic(),i.default.delBanner(),n.default.instance.cleanMemory(),a.default.instance.gameLevel=0,this.destroySDK(),a.default.instance.changeScene("load",null,function(){a.default.instance.scheduleOnce(function(){r.G.showPortalAd()},1)}),a.default.instance.gameState=a.GameState.gameLoadRes,r.G.GlobalData.addAwardShared=1,r.G.GlobalData.openSudokuCount--)},t.prototype.playAgain=function(){var e=this;r.G.stopBanner(r.G.showBanner.endLayer_1),d.Rank.clean();var t=function(){r.G.Game.addGameCount(),i.default.delBanner(),n.default.instance.cleanMemory(),a.default.instance.gameLevel=0,e.destroySDK(),a.default.instance.changeScene("game_scene",null,function(){n.default.instance.openTrial()}),a.default.instance.gameState=a.GameState.gameLoadRes,s.default.writeNum("weather",n.default.instance.weather),s.default.writeNum("weatherState",n.default.instance.weatherSt),r.G.GlobalData.addAwardShared=1};r.G.randRange(0,99)<a.default.instance.startGameNeedShare&&(0==a.default.instance.ip_switch||1==a.default.instance.ip_share)&&r.G.Game.getGameCount()>=r.G.Game.needShareToGame?r.G.shareGame(t,null,"\u53d1\u9001\u5230\u4e0d\u540c\u7fa4\u624d\u80fd\u5f00\u59cb\u6e38\u620f"):t()},__decorate([p(cc.Node)],t.prototype,"content",void 0),__decorate([p(cc.Node)],t.prototype,"lookVideo",void 0),__decorate([p(cc.Node)],t.prototype,"getCoin",void 0),__decorate([p(cc.Label)],t.prototype,"lookVideo_coinLabl",void 0),__decorate([p(cc.Node)],t.prototype,"lookVideo_light",void 0),__decorate([p(cc.Node)],t.prototype,"lookVideo_tag",void 0),__decorate([p(cc.Node)],t.prototype,"lookVideo_shareBtn",void 0),__decorate([p(cc.Label)],t.prototype,"lookVideo_time",void 0),__decorate([p([cc.SpriteFrame])],t.prototype,"lookVideo_sp",void 0),__decorate([p(cc.Sprite)],t.prototype,"lookVideo_shareImage",void 0),__decorate([p(cc.Node)],t.prototype,"lookVideo_back",void 0),__decorate([p(cc.Node)],t.prototype,"getCoin_shareBtn",void 0),__decorate([p(cc.Node)],t.prototype,"getCoin_videoBtn",void 0),__decorate([p(cc.Node)],t.prototype,"getCoin_tag",void 0),__decorate([p(cc.Node)],t.prototype,"getCoin_back",void 0),__decorate([p(cc.Label)],t.prototype,"coinNum",void 0),__decorate([p(cc.ProgressBar)],t.prototype,"lucky",void 0),__decorate([p(cc.Node)],t.prototype,"luckyOpen",void 0),__decorate([p(cc.Node)],t.prototype,"moreGame_0",void 0),__decorate([p(cc.Node)],t.prototype,"moreGame_1",void 0),__decorate([p(cc.Node)],t.prototype,"contentShardBtn",void 0),__decorate([p(cc.Node)],t.prototype,"backToHallNode",void 0),__decorate([p(cc.Node)],t.prototype,"banEnd0",void 0),__decorate([p(cc.Node)],t.prototype,"banEnd0_1",void 0),__decorate([p(cc.Node)],t.prototype,"banEnd1",void 0),__decorate([p(cc.Node)],t.prototype,"banEnd2",void 0),__decorate([p(cc.Node)],t.prototype,"lookVideoMoreGame",void 0),__decorate([p(cc.Node)],t.prototype,"contentMoreGame",void 0),__decorate([p(cc.Node)],t.prototype,"favoNode",void 0),__decorate([p(cc.Node)],t.prototype,"iconGame",void 0),__decorate([p(cc.Node)],t.prototype,"iconGame1",void 0),__decorate([p(cc.Node)],t.prototype,"iconGame2",void 0),__decorate([p(cc.Node)],t.prototype,"iconGame3",void 0),t=__decorate([u],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../SDK/ALGuessLike":"ALGuessLike","../SDK/aladinSDK":"AladinSDK","./../game_logic":"game_logic","./../game_scene":"game_scene","./../util/global_def":"global_def","./../util/storage":"storage","./../util/wx_util":"wx_util","./Rank":"Rank"}],endlessLayer:[function(e,t,o){"use strict";cc._RF.push(t,"209a6IhRepKXJUGxusazYxh","endlessLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./game"),i=e("./util/global_def"),r=e("./game_scene"),s=e("./game_logic"),c=e("./UI/myCoin"),l=e("./UI/bridge"),d=e("./UI/hero"),h=e("./util/wx_util"),u=cc._decorator,p=u.ccclass,f=u.property;(function(e){e[e.tnt=0]="tnt",e[e.windmill=1]="windmill",e[e.gear=2]="gear"})(n||(n={}));var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.enemyManager=[],t.coinManager=[],t.noviceRoadManager=[],t.testRoad=[],t.balloon=null,t.balloonPool=null,t.balloonManager=[],t.vertBrgManager=[],t.mapIndex=0,t.tnt=null,t.tntManager=[],t.windmill=null,t.gear=null,t.cloudF=[],t.cloudPool=new cc.NodePool,t.lastCloudPos=cc.v2(0,0),t.cloudManager=[],t.skillTime=null,t.skillLock=null,t.roadF=[],t.plantF=[],t.maxDistance=0,t.VisionLayer=null,t.visionPool=null,t.vision_road=null,t.visionManager=[],t.subRoad=0,t.lastVisionPos=cc.v2(0,0),t.road_min_dis=100,t.road_max_dis=200,t.isBorder=!1,t.testIndex=0,t.firstBox=!0,t.boxDistance=0,t.boxDisOff=30,t.ground_offset=[],t.gr_c=0,t.stopLastData=null,t.lastIndex=0,t.lastTop=null,t}return __extends(t,e),t.prototype.startFallCheck=function(){var e=this;this.schedule(function(){if(null!=r.default.instance.hero&&!(e.roadManager.length<=0||s.default.instance.gameState!=s.GameState.gamePlay&&s.default.instance.gameState!=s.GameState.gameNovice)){for(var t=1e4,o=null,n=new cc.Rect,a=0;a<e.roadManager.length;++a){var i=e.roadManager[a];(l=i.x-i.width/2-r.default.instance.hero.x)>0&&l<t&&(t=l,o=i);r.default.instance.hero.x,r.default.instance.hero.width;null!=o&&(n=o.getComponent(cc.PhysicsBoxCollider))}for(a=0;a<e.balloonManager.length;++a){var c=e.balloonManager[a];(l=c.x-c.width/2-r.default.instance.hero.x)>0&&l<t&&(t=l,o=c),n.size=cc.size(339,87)}for(a=0;a<e.vertBrgManager.length;++a){var l,h=e.vertBrgManager[a];(l=h.x-h.width/2-r.default.instance.hero.x)>0&&l<t&&(t=l,o=h),n.size=cc.size(h.width,h.height)}if(null!=o){var u=o.y+o.height/2-n.size.height-r.default.instance.hero.height-50;r.default.instance.mapCamera.y;r.default.instance.hero.y<u&&r.default.instance.hero.getComponent("hero").die(d.DieType.fall)}else r.default.instance.mapCamera.y<-5e3&&r.default.instance.hero.getComponent("hero").die(d.DieType.fall)}},.5)},t.prototype.init=function(){this.startFallCheck(),this.initVisionPool(),this.initCloudPool(),this.initBalloonPool()},t.prototype.initBalloonPool=function(){this.balloonPool=new cc.NodePool;for(var e=0;e<6;++e){var t=cc.instantiate(this.balloon);this.balloonPool.put(t)}},t.prototype.initVisionPool=function(){this.visionPool=new cc.NodePool;for(var e=0;e<10;e++){var t=cc.instantiate(this.vision_road);t.getComponent("vision_road").init(),this.visionPool.put(t)}for(e=0;e<4;++e)this.creatVisionRoad()},t.prototype.initCloudPool=function(){for(var e=0;e<6;++e){var t=(e+1)%3,o=new cc.Node,n=o.addComponent(cc.Sprite);n.spriteFrame=i.G.Game.getGRes(i.G.Game.GResType.Cloud,t),o.width=n.spriteFrame.getRect().width,o.height=n.spriteFrame.getRect().height,this.cloudPool.put(o)}for(e=0;e<6;++e)this.createCloud()},t.prototype.initNodeManger=function(){this.funs.push(this.startRoadManager.bind(this)),this.funs.push(this.startCoinManager.bind(this)),this.funs.push(this.startVisionManager.bind(this)),this.funs.push(this.startCloudManager.bind(this)),this.funs.push(this.startTntManager.bind(this)),this.funs.push(this.startBridgeManager.bind(this))},t.prototype.startRoadManager=function(){var e=this;if(!r.default.instance.stopRoadManager&&s.default.instance.gameState!=s.GameState.gameNovice)for(0==r.default.instance.gameBoss&&(i.G.Game.fArr(this.roadManager,function(t){t.x+t.width/2+r.default.instance.windowSize.width/2+300<r.default.instance.mapCamera.x&&(r.default.instance.roadPool.put(t),i.G.Game.rmFromArray(t,e.roadManager))}),i.G.Game.fArr(this.balloonManager,function(t){t.x+t.width/2+r.default.instance.windowSize.width/2+300<r.default.instance.mapCamera.x&&(e.balloonPool.put(t),i.G.Game.rmFromArray(t,e.balloonManager))})),this.subRoad=i.G.Game.max_road_num-(this.roadManager.length+this.balloonManager.length);this.subRoad>0;)this.createRoad()},t.prototype.startCoinManager=function(){var e=this;i.G.Game.fArr(this.coinManager,function(t){if(t.x+t.width+r.default.instance.windowSize.width/2<r.default.instance.mapCamera.x){var o=t.coinManager;for(var n in o){var a=o[n];r.default.instance.coinPool.put(a)}i.G.Game.rmFromArray(t,e.coinManager)}})},t.prototype.startVisionManager=function(){if(!r.default.instance.stopRoadManager)for(var e in this.visionManager){var t=this.visionManager[e];t.x+r.default.instance.windowSize.width/2+t.width/2<r.default.instance.mapCamera.x&&(i.G.Game.rmFromArray(t,this.visionManager),this.visionPool.put(t),this.creatVisionRoad())}},t.prototype.startCloudManager=function(){for(var e in this.cloudManager){var t=this.cloudManager[e];t.x+r.default.instance.windowSize.width/2+t.width/2<r.default.instance.mapCamera.x&&(i.G.Game.rmFromArray(t,this.cloudManager),this.cloudPool.put(t),this.createCloud())}},t.prototype.startTntManager=function(){for(var e in this.tntManager){var t=this.tntManager[e];t.x+t.width+r.default.instance.windowSize.width/2<r.default.instance.mapCamera.x&&(i.G.Game.rmFromArray(t,this.tntManager),t.destroy())}},t.prototype.startBridgeManager=function(){for(var e in r.default.instance.bridgeManager){var t=r.default.instance.bridgeManager[e];t.x+t.width+r.default.instance.windowSize.width/2+300<r.default.instance.mapCamera.x&&(t.run(),i.G.Game.rmFromArray(t,r.default.instance.bridgeManager))}},t.prototype.createCloud=function(){var e=this.getCloud(),t=r.default.instance.windowSize.height/2;e.setPosition(this.lastCloudPos.x+i.G.randRange(200,400),i.G.randRange(t-200,t-100)),this.VisionLayer.addChild(e),this.lastCloudPos=cc.v2(e.position.x+e.width/2,e.position.y),this.cloudManager.push(e)},t.prototype.getCloud=function(){var e=this.cloudPool.get();if(e.group="vision",null==e){var t=new cc.Node,o=t.addComponent(cc.Sprite),n=i.G.randRange(0,2);o.spriteFrame=this.cloudF[n],t.width=this.cloudF[n].getRect().width,t.height=this.cloudF[n].getRect().height}return e},t.prototype.creatVisionRoad=function(){var e=this.getVisionRoad();e.getComponent("vision_road").setData(),e.setPosition(this.lastVisionPos.x+i.G.randRange(500,800),r.default.instance.mapCamera.y+i.G.randRange(0,300)),this.VisionLayer.addChild(e,1e3),this.lastVisionPos=cc.v2(e.position.x+e.width/2,e.position.y),this.visionManager.push(e)},t.prototype.getVisionRoad=function(){var e=this.visionPool.get();return null==e&&(e=cc.instantiate(this.vision_road)).getComponent("vision_road").init(),e.group="road",e},t.prototype.createRoad=function(){if(this.isBorder=!0,null==this.stopLastData){var e=i.G.randRange(0,r.default.instance.roundEndless.length-1),t=r.default.instance.roundEndless[e].json;this.createRoundByData(t)}else this.createRoundByData(this.stopLastData)},t.prototype.createRandMap=function(e){this.subRoad-=1;var t=cc.v2(i.G.randRange(50,300)+r.default.instance.lastRoadPos.x,r.default.instance.lastRoadPos.y+i.G.randRange(50,100));Math.random()>.8&&this.addCoin(t);var o=r.default.instance.getRoad();r.default.instance.cleanRoad(o);var n=i.G.Game.getGameResId(s.default.instance.gameLevel),a=r.default.instance.roadF[n].length,c=i.G.randRange(0,a-1);this.first&&(c=0);var l=Math.random()>.9,d=o.width/2+i.G.randRange(this.road_min_dis,this.road_max_dis);Math.random()>.7&&0==e&&(d=o.width/2,l=!1),o.getComponent("road").setData(c,l);var h=r.default.instance.lastRoadPos.x+d,u=r.default.instance.lastRoadPos.y-o.height/2;o.setPosition(cc.v2(h,u)),o.getComponent("road").startFloat(),Math.random()>.8&&!this.first&&this.addTntToRoad(o),Math.random()>.8&&0!=this.roadManager.length&&0!=s.default.instance.gameLevel&&!this.first&&this.addWindmillToRoad(o),r.default.instance.lastRoadPos.x=o.x+o.width/2,r.default.instance.lastRoadPos.y=o.y+o.height/2,this.node.addChild(o),this.roadManager.push(o),this.first=!1},t.prototype.addWindmillToRoad=function(e,t){var o=cc.instantiate(this.windmill),n=o.width,a=(e.width-n)/2,r=cc.v2(i.G.randRange(0,a),e.height/2);null!=t&&(r.x=t.x),o.setPosition(r),o.getComponent("windmill").run(),e.getChildByName("windNode").addChild(o)},t.prototype.getTnt=function(){var e=cc.instantiate(this.tnt);return e.getComponent("tnt").init(),e},t.prototype.getBalloon=function(){var e=this.balloonPool.get();return null==e&&(e=cc.instantiate(this.balloon)),this.balloonManager.push(e),e},t.prototype.addTntToRoad=function(e,t){var o=this.getTnt(),n=(e.width-o.width)/2,a=cc.v2(e.x-e.width/2+i.G.randRange(-n,n),e.y+e.height/2);null!=t&&(a.x=t.x+e.x),o.setPosition(a),this.node.addChild(o,1e3),this.tntManager.push(o)},t.prototype.addCoin=function(e,t){var o=new c.MultiCoin;o.create(t),o.setPosition(e),this.node.addChild(o,1e3),this.coinManager.push(o)},t.prototype.addGearToRoad=function(e,t){e.getChildByName("image").getComponent(cc.Sprite).spriteFrame;var o=cc.instantiate(this.gear);o.setPosition(t),e.getChildByName("otherNode").addChild(o)},t.prototype.createRoundByData=function(e,t){for(void 0===t&&(t=!1),r.default.instance.dealMapData(e),this.lastIndex;this.lastIndex<e.length;this.lastIndex++){var o=0;if(this.subRoad<=0)return void(this.stopLastData=e);var a=e[this.lastIndex];a.y=Math.floor(a.y);var s=null;if(a.id==i.G.Game.BRIDGE_ID){var c=new l.bridge,d=1==a.vertical?1:0;if(c.create(a.creatnumber,d),s=c,c.setPosition(a.x,a.y),null==this.ground_offset[this.gr_c]){var h=cc.v2(0,r.default.instance.lastRoadPos.y-c.height/2-a.y);this.ground_offset[this.gr_c]=h}}else if(a.id==i.G.Game.BALLOON_ID){if(o=44,(s=this.getBalloon()).setPosition(a.x,a.y),null==this.ground_offset[this.gr_c]){h=cc.v2(s.width/2+i.G.randRange(50,100),r.default.instance.lastRoadPos.y-s.height/2-a.y);this.ground_offset[this.gr_c]=h}}else{if(s=r.default.instance.getRoad(),r.default.instance.cleanRoad(s),s.getComponent("road").setData(a.id,a.dou),s.getComponent("road").startFloat(),null==this.lastTop)this.lastTop=a.y+s.height/2;else{var u=a.y+s.height/2;Math.abs(u-this.lastTop)<10&&(a.y+=this.lastTop-u)}if(s.setPosition(a.x,a.y),null==this.ground_offset[this.gr_c]){h=cc.v2(s.width/2,r.default.instance.lastRoadPos.y-s.height/2-a.y);this.ground_offset[this.gr_c]=h}this.roadManager.push(s)}if(s.x+=r.default.instance.lastRoadPos.x+this.ground_offset[this.gr_c].x,s.y+=this.ground_offset[this.gr_c].y,this.node.addChild(s),!this.first){if(null!=a.coin&&0!=a.coin.length){var p=cc.v2(s.x,s.y+o);this.addCoin(p,a.coin)}for(var f in a.Obstruction){switch(a.Obstruction[f].id){case n.tnt:var m=a.Obstruction[f].pos;this.addTntToRoad(s,m);break;case n.windmill:m=a.Obstruction[f].pos;this.addWindmillToRoad(s,m);break;case n.gear:m=a.Obstruction[f].pos;this.addGearToRoad(s,m)}}}if(this.lastIndex==e.length-1&&(a.id==i.G.Game.BRIDGE_ID?(r.default.instance.lastRoadPos.x=s.x+s.width,r.default.instance.lastRoadPos.y=s.y+s.height/2):(r.default.instance.lastRoadPos.x=s.x+s.width/2,r.default.instance.lastRoadPos.y=s.y+s.height/2),this.lastTop=null),this.first=!1,this.subRoad-=1,this.lastIndex==e.length-1){this.lastIndex=0,this.stopLastData=null,this.road_range_count=i.G.randRange(2,3);break}}this.gr_c++},t.prototype.cleanRoadGameItem=function(e){var t=this,o=e.x+e.width/2,n=e.x-e.width/2;i.G.Game.fArr(this.enemyManager,function(e){e.x<o&&e.x>n&&(e.getComponent("enemy").clean(),r.default.instance.enemyPool.put(e),i.G.Game.rmFromArray(e,t.enemyManager))}),i.G.Game.fArr(this.tntManager,function(e){e.x<o&&e.x>n&&(i.G.Game.rmFromArray(e,t.tntManager),e.destroy())})},t.prototype.extendMap=function(){for(var e in this.roadManager){var t=this.roadManager[e];r.default.instance.roadPool.put(t),i.G.Game.rmFromArray(t,this.roadManager)}for(var e in this.visionManager){var o=this.visionManager[e];this.visionPool.put(o),i.G.Game.rmFromArray(o,this.visionManager)}for(var n=0;n<4;++n)this.createRoad();for(n=0;n<4;++n)this.creatVisionRoad()},t.prototype.cleanAllUp=function(){var e=this;this.stopLastData=null,this.lastIndex=0,this.first=!0,i.G.Game.fArr(this.roadManager,function(t){r.default.instance.roadPool.put(t),i.G.Game.rmFromArray(t,e.roadManager)}),i.G.Game.fArr(this.balloonManager,function(t){e.balloonPool.put(t),i.G.Game.rmFromArray(t,e.balloonManager)}),i.G.Game.fArr(this.enemyManager,function(t){r.default.instance.enemyPool.put(t),i.G.Game.rmFromArray(t,e.enemyManager)}),i.G.Game.fArr(this.tntManager,function(t){t.destroy(),i.G.Game.rmFromArray(t,e.tntManager)})},t.prototype.scheduleTime=function(){var e=this;this.skillTime.node.active=!0;var t=30,o=i.G.Game.turnTime(t);this.skillTime.string=o;var n=function(){--t<=0&&(t=0,e.unschedule(n),e.skillLock.active=!0,e.skillTime.node.active=!1,i.G.Game.endlessSkills.magnet=!1);var o=i.G.Game.turnTime(t);e.skillTime.string=o};this.schedule(n,1)},t.prototype.onclickSkillLock=function(){var e=this;h.default.watchVideoAds(i.G.VideoId.trialHero,function(){e.skillLock.active=!1,i.G.Game.endlessSkills.magnet=!0,e.scheduleTime()},function(){r.default.instance.showTip("\u89c2\u770b\u89c6\u9891\u89e3\u9501\u8d85\u7ea7\u78c1\u94c1")})},__decorate([f([cc.JsonAsset])],t.prototype,"testRoad",void 0),__decorate([f(cc.Prefab)],t.prototype,"balloon",void 0),__decorate([f(cc.Prefab)],t.prototype,"tnt",void 0),__decorate([f(cc.Prefab)],t.prototype,"windmill",void 0),__decorate([f(cc.Prefab)],t.prototype,"gear",void 0),__decorate([f([cc.SpriteFrame])],t.prototype,"cloudF",void 0),__decorate([f(cc.Label)],t.prototype,"skillTime",void 0),__decorate([f(cc.Node)],t.prototype,"skillLock",void 0),__decorate([f(cc.Node)],t.prototype,"VisionLayer",void 0),__decorate([f(cc.Prefab)],t.prototype,"vision_road",void 0),t=__decorate([p],t)}(a.default);o.default=m,cc._RF.pop()},{"./UI/bridge":"bridge","./UI/hero":"hero","./UI/myCoin":"myCoin","./game":"game","./game_logic":"game_logic","./game_scene":"game_scene","./util/global_def":"global_def","./util/wx_util":"wx_util"}],enemy:[function(e,t,o){"use strict";cc._RF.push(t,"b368bD6lDVB5LQL/NPyR0Ko","enemy"),Object.defineProperty(o,"__esModule",{value:!0});var n,a,i=cc._decorator,r=i.ccclass,s=i.property,c=e("./../game_scene"),l=e("./../util/global_def"),d=e("../game_logic"),h=e("./hero"),u=e("./explode"),p=e("../util/event_mgr"),f=e("./../UI/weapon");(function(e){e[e.enemy_0=0]="enemy_0",e[e.enemy_1=1]="enemy_1",e[e.enemy_2=2]="enemy_2",e[e.boss_0=3]="boss_0",e[e.boss_1=4]="boss_1",e[e.boss_2=5]="boss_2"})(o.EnemyType||(o.EnemyType={})),function(e){e[e.idle=0]="idle",e[e.win=1]="win",e[e.die=2]="die"}(n||(n={})),function(e){e[e.shield=0]="shield",e[e.speer=1]="speer",e[e.axe=2]="axe",e[e.boom=3]="boom"}(a||(a={}));var m=[["\u6211\u8981\u538b\u6241\u4f60","\u653e\u9a6c\u8fc7\u6765","\u6b7b\u5f00\uff01"],["\u517d\u4eba\u8d62\u4e86","\u8001\u5929\u7237\uff01\u6211\u7231\u8fd9\u5de5\u4f5c","\u5931-\u8d25-\u8005!","\u4e0b\u6b21\u5427!","\u81f4\u547d\u4e00\u51fb","\u9017\u6b7b\u4e86","\u6700\u7f8e\u597d\u7684\u4e00\u5929\uff01"],["\u9760","\u4f60\u4f5c\u5f0a"]],_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.talkNode=null,t.talkLabel=null,t.dieF=null,t.goLeft_=!1,t.hurtImage=null,t.image=null,t.rigidBody=null,t.wpInfo=null,t.wp=null,t.hatInfo=null,t.hat=null,t.id=null,t.info={HP:0,reward_type:1,reward_numb:0},t.boxW=[84,104,125],t.boxSize=cc.size(84,78),t}return __extends(t,e),t.prototype.init=function(e){this.info=l.G.Game.getEnemyInfo(e),this.id=e,this.setTexture(e),this.rigidBody=this.node.getComponent(cc.RigidBody),this.rigidBody.linearDamping=5,this.rigidBody.bullet=!0,this.clean()},t.prototype.setTexture=function(e){var t;null!=(t=l.G.Game.getGRes(l.G.Game.GResType.Enemy,0))&&(this.image.spriteFrame=t,this.node.setContentSize(this.boxSize),this.node.scale=this.boxW[e]/84,this.setBox())},t.prototype.setBox=function(){var e=this.node.getComponent(cc.PhysicsBoxCollider);e.size=this.boxSize,e.offset.y=this.boxSize.height/2,e.density=5,e.apply();var t=this.node.getComponent(cc.BoxCollider);t.size=this.boxSize,t.offset.y=this.boxSize.height/2,null!=this.hurtImage&&this.hurtImage.setContentSize(this.boxSize)},t.prototype.clean=function(){var e=this.node.getComponent(g);null!=e&&e.clean(),this.goLeft_=!1},__decorate([s(cc.Node)],t.prototype,"talkNode",void 0),__decorate([s(cc.Label)],t.prototype,"talkLabel",void 0),__decorate([s(cc.SpriteFrame)],t.prototype,"dieF",void 0),__decorate([s(cc.Node)],t.prototype,"hurtImage",void 0),__decorate([s(cc.Sprite)],t.prototype,"image",void 0),__decorate([s(cc.JsonAsset)],t.prototype,"wpInfo",void 0),__decorate([s(cc.Node)],t.prototype,"wp",void 0),__decorate([s(cc.JsonAsset)],t.prototype,"hatInfo",void 0),__decorate([s(cc.Node)],t.prototype,"hat",void 0),t=__decorate([r],t)}(cc.Component);o.default=_;var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id_num=null,t.protect=!1,t.jumpCount=0,t.a=2e3,t.ax=10,t.speedX=null,t.origSY=800,t.speedY=t.origSY,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this.node.getComponent(_).wp;null!=e&&e.removeAllChildren()},t.prototype.reset=function(e){},t.prototype.setHeadWear=function(e){var t=this.node.getComponent(_),o=t.hat;if(null!=o){o.removeAllChildren();var n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=l.G.Game.getGRes(l.G.Game.GResType.EnemyHat,e);var a=t.hatInfo.json[e];n.anchorX=a.Anchor_x,n.anchorY=a.Anchor_y,n.x=a.Position_x,n.y=a.Position_y,n.rotation=a.Rotation,n.scaleX=a.Scale_x,n.scaleY=a.Scale_y,o.addChild(n)}},t.prototype.clean=function(){this.stopTalk()},t.prototype.onCollisionEnter=function(e,t){if(e.tag==l.G.Game.gasTag){var o=h.default.instance.currentWeapon.getComponent("weapon").info.hurt;this.damage(o,u.ExplodeType.hit)}else if(e.tag==l.G.Game.petLight)this.damage(2,u.ExplodeType.hit);else if(e.tag==l.G.Game.firBall)this.damage(2,u.ExplodeType.rocket);else if(e.tag==l.G.Game.dra_bullet){o=l.G.GameData.getTowerHurt(l.G.GameData.currenTower);this.damage(o,u.ExplodeType.rocket)}},t.prototype.damage=function(e,t){if(d.default.instance.gameState==d.GameState.gamePlay||d.default.instance.gameState==d.GameState.gameNovice){var o=this.node.getComponent(_);if(!(o.info.HP<0))if(o.info.HP-=e,o.info.HP>0)o.hurtImage.opacity=80,o.hurtImage.runAction(cc.fadeOut(.5));else{if(this.die(),null==t)return;this.createBoom(t)}}},t.prototype.createBoom=function(e){var t=c.default.instance.getExplode(e),o=this.node.getPosition();return t.setPosition(o.x,o.y),c.default.instance.node.addChild(t,3e3),t.getComponent("explode").run(),t},t.prototype.die=function(){var e=this.node.getComponent(_);if(null!=h.default.instance.currentWeapon){var t=h.default.instance.currentWeapon.getComponent("weapon").id;h.default.instance.currentWeapon.getComponent("weapon").info.hurt>e.info.HP&&(t==f.WeaponType.spear?d.default.instance.eventManager.addEvent(p.EventType.KTaskSpear,this,{}):t==f.WeaponType.fly_knife?d.default.instance.eventManager.addEvent(p.EventType.KTaskfly_knife,this,{}):t==f.WeaponType.hammer?d.default.instance.eventManager.addEvent(p.EventType.KTaskHammer,this,{}):t==f.WeaponType.bomb?d.default.instance.eventManager.addEvent(p.EventType.KTaskBomb,this,{}):t==f.WeaponType.rocket?d.default.instance.eventManager.addEvent(p.EventType.KTaskRocket,this,{}):t==f.WeaponType.darts?d.default.instance.eventManager.addEvent(p.EventType.KTaskDarts,this,{}):t==f.WeaponType.fly_spear&&d.default.instance.eventManager.addEvent(p.EventType.KTaskFly_spear,this,{}))}l.G.Game.vibrateShort();c.WealthType.coin;2==e.info.reward_type&&c.WealthType.crown;var o=e.info.reward_numb;c.default.instance.updateWealth(c.WealthType.coin,o,!1),this.dieOver()},t.prototype.dieOver=function(){var e=this.node.getComponent(_),t=this.node.getPosition(),o=cc.v2(this.node.x+300,this.node.y-1e3),n=new cc.Node;n.group="enemy",n.scale=e.boxW[e.id]/84,n.addComponent(cc.Sprite).spriteFrame=e.dieF,n.setPosition(t),c.default.instance.node.addChild(n,2e3);var a=cc.v2(0,0);a.x=.25*(o.x-t.x)+t.x+200,a.y=.25*(o.y-t.y)+t.y+200;var i=[t,a,o],r=cc.bezierTo(.8,i);r.easing(cc.easeOut(.8)),n.runAction(cc.sequence(cc.spawn(r,cc.rotateBy(2,-2760)),cc.callFunc(function(){n.destroy()}))),c.default.instance.enemyPool.put(this.node)},t.prototype.talk=function(e){var t=this.node.getComponent(_),o=m[e].length,a=l.G.randRange(0,o-1),i=m[e][a],r=i.length*t.talkLabel.fontSize+30;t.talkLabel.string=i,t.talkNode.width=r,t.talkNode.active=!0,t.talkNode.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){e!=n.idle&&(t.talkNode.active=!1)})))},t.prototype.stopTalk=function(){this.node.getComponent(_).talkNode.active=!1},t.prototype.checkJump=function(e,t,o){if(this.speedX=0,o.tag==l.G.Game.enemyTag||o.tag==l.G.Game.heroTag||o.tag==l.G.Game.roadTag||o.tag==l.G.Game.brick||o.tag==l.G.Game.tntTag){var n=l.G.Game.getDir(e);n==l.G.Game.dir.up?o.tag==l.G.Game.tntTag?this.speedY=.7*-this.origSY:o.tag==l.G.Game.enemyTag?this.jump_up():this.jump():n==l.G.Game.dir.down&&o.tag==l.G.Game.enemyTag&&(this.speedY=0)}},t.prototype.hitHeroFun=function(e,t,o){if(o.tag==l.G.Game.heroTag){if(d.default.instance.gameState==d.GameState.gameOver)return;this.stopTalk();var a=o.node;if(l.G.Game.getDir(e)==l.G.Game.dir.up)return a.getComponent("hero").die(),void this.talk(n.win)}},t.prototype.onBeginContact=function(e,t,o){if((this.checkJump(e,t,o),this.hitHeroFun(e,t,o),o.tag==l.G.Game.roadTag)&&l.G.Game.getDir(e)==l.G.Game.dir.left){var n=t.node.getComponent(cc.RigidBody),a=cc.v2(-100,0);n.linearVelocity=a}},t.prototype.jump=function(){},t.prototype.jump_up=function(){var e=this,t=this.node.getComponent(_),o=cc.scaleTo(0,1,.5),n=cc.scaleTo(.2,1,1);n.easing(cc.easeIn(.2)),t.image.node.runAction(cc.sequence(o,cc.callFunc(function(){e.speedY=-.7*e.origSY}),n))},t.prototype.jumpBalloon=function(){var e=this,t=this.node.getComponent(_),o=cc.scaleTo(.3,1,.5);o.easing(cc.easeOut(.3));var n=cc.scaleTo(.3,1,1);n.easing(cc.easeIn(.3)),t.image.node.runAction(cc.sequence(o,cc.callFunc(function(){e.speedY=-(e.origSY+300)}),n))},t.prototype.subUpdate=function(e){this.speedY+=1/60*this.a;var t=this.speedY*(1/60);this.node.y-=t,this.node.x+=this.speedX},t.prototype.update=function(e){this.subUpdate(e)},t}(cc.Component);o.commonAct=g;var y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.jump=function(){var e=this,t=this.node.getComponent(_),o=cc.scaleTo(.3,1,.5);o.easing(cc.easeOut(.3));var n=cc.scaleTo(.3,1,1);n.easing(cc.easeIn(.3)),t.image.node.runAction(cc.sequence(o,cc.callFunc(function(){e.speedY=-e.origSY}),n))},t}(g);o.jumpOne=y;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.jump=function(){var e=this,t=this.node.getComponent(_),o=cc.scaleTo(.3,1,.5);o.easing(cc.easeOut(.3));var n=cc.scaleTo(.3,1,1);n.easing(cc.easeIn(.3)),t.image.node.runAction(cc.sequence(o,cc.callFunc(function(){e.jumpCount++,e.jumpCount%3==0?e.speedY=-e.origSY:e.speedY=-300}),n))},t}(g);o.jumpThree=v;var w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.shieldNode=null,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this);var t=this.node.getComponent(_);this.shieldNode=new cc.Node,this.shieldNode.addComponent(cc.Sprite).spriteFrame=l.G.Game.getGRes(l.G.Game.GResType.EnemyWp,a.shield);var o=t.wpInfo.json[a.shield];this.shieldNode.anchorX=o.Anchor_x,this.shieldNode.anchorY=o.Anchor_y,this.shieldNode.x=o.Position_x,this.shieldNode.y=o.Position_y,this.shieldNode.rotation=o.Rotation,this.shieldNode.scaleX=o.Scale_x,this.shieldNode.scaleY=o.Scale_y,t.wp.addChild(this.shieldNode),this.setHeadWear(2)},t.prototype.jump=function(){var e=this,t=this.node.getComponent(_),o=cc.scaleTo(.3,1,.5);o.easing(cc.easeOut(.3));var n=cc.scaleTo(.3,1,1);n.easing(cc.easeIn(.3)),t.image.node.runAction(cc.sequence(o,cc.callFunc(function(){e.jumpCount++,e.jumpCount%3==0?(e.speedY=-e.origSY,null!=e.shieldNode&&(e.shieldNode.active=!1,e.protect=!1)):(e.speedY=-300,null!=e.shieldNode&&(e.shieldNode.active=!0,e.protect=!0))}),n))},t.prototype.damage=function(e,t){if(1!=this.protect){var o=this.node.getComponent(_);if(!(o.info.HP<0))if(o.info.HP-=e,o.info.HP>0)o.hurtImage.opacity=80,o.hurtImage.runAction(cc.fadeOut(.5));else{if(this.die(),null==t)return;this.createBoom(t)}}},t}(v);o.shieldAct=w;var C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onCollisionEnter=function(e,t){e.node.getComponent("hero").die()},t}(cc.Component),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this);var t=this.node.getComponent(_),o=new cc.Node,n=o.addComponent(cc.Sprite);n.spriteFrame=l.G.Game.getGRes(l.G.Game.GResType.EnemyWp,a.speer);var i=t.wpInfo.json[a.speer];o.anchorX=i.Anchor_x,o.anchorY=i.Anchor_y,o.x=i.Position_x,o.y=i.Position_y,o.rotation=i.Rotation,o.scaleX=i.Scale_x,o.scaleY=i.Scale_y;var r=o.addComponent(cc.BoxCollider);r.size.width=n.spriteFrame.getRect().width,r.size.height=n.spriteFrame.getRect().height,o.group="enemy_wp",r.addComponent(C),t.wp.addChild(o),this.setHeadWear(3)},t}(v);o.speerAct=b;var x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attack=!1,t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this);var o=this.node.getComponent(_),n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=l.G.Game.getGRes(l.G.Game.GResType.EnemyWp,a.axe);var i=o.wpInfo.json[a.axe];n.anchorX=i.Anchor_x,n.anchorY=i.Anchor_y,n.x=i.Position_x,n.y=i.Position_y,n.rotation=i.Rotation,n.scaleX=i.Scale_x,n.scaleY=i.Scale_y,o.wp.addChild(n),this.setHeadWear(1);var r=function(){t.node.x-h.default.instance.node.x<=400&&(t.unschedule(r),t.attack=!0)};this.schedule(r,.1)},t.prototype.jump_up=function(){this.jump_attack()},t.prototype.jump_height=function(){var e=this,t=this.node.getComponent(_),o=cc.scaleTo(.3,1,.5);o.easing(cc.easeOut(.3));var n=cc.scaleTo(.3,1,1);n.easing(cc.easeIn(.3)),t.image.node.runAction(cc.sequence(o,cc.callFunc(function(){e.speedY=-300}),n))},t.prototype.jump_attack=function(){var e=this,t=this.node.getComponent(_),o=cc.scaleTo(.3,1,.5);o.easing(cc.easeOut(.3));var n=cc.scaleTo(.3,1,1);n.easing(cc.easeIn(.3)),this.speedX=0,t.image.node.runAction(cc.sequence(o,cc.callFunc(function(){e.jumpCount++,e.speedY=-e.origSY,e.speedX=-.6}),n))},t.prototype.jump=function(){this.attack?this.jump_attack():this.jump_height()},t}(g);o.axeAct=x;var S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.attack=!1,t}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this);var o=this.node.getComponent(_),n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=l.G.Game.getGRes(l.G.Game.GResType.EnemyWp,a.axe);var i=o.wpInfo.json[a.axe];n.anchorX=i.Anchor_x,n.anchorY=i.Anchor_y,n.x=i.Position_x,n.y=i.Position_y,n.rotation=i.Rotation,n.scaleX=i.Scale_x,n.scaleY=i.Scale_y,o.wp.addChild(n),this.setHeadWear(0);var r=function(){t.node.x-h.default.instance.node.x<=400&&(t.unschedule(r),t.attack=!0)};this.schedule(r,.1)},t.prototype.jump_up=function(){this.jump_attack()},t.prototype.jump_height=function(){var e=this,t=this.node.getComponent(_),o=cc.scaleTo(.3,1,.5);o.easing(cc.easeOut(.3));var n=cc.scaleTo(.3,1,1);n.easing(cc.easeIn(.3)),t.image.node.runAction(cc.sequence(o,cc.callFunc(function(){e.speedY=-300}),n))},t.prototype.jump_attack=function(){var e=this,t=this.node.getComponent(_),o=cc.scaleTo(.3,1,.5);o.easing(cc.easeOut(.3));var n=cc.scaleTo(.3,1,1);n.easing(cc.easeIn(.3)),this.speedX=0,t.image.node.runAction(cc.sequence(o,cc.callFunc(function(){e.jumpCount++,e.speedY=-e.origSY,e.speedX=-.6}),n))},t.prototype.jump=function(){this.attack?this.jump_attack():this.jump_height()},t}(g);o.unicornAct=S;var G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var t=this;e.prototype.onLoad.call(this);var o=this.node.getComponent(_),n=new cc.Node;n.setContentSize(cc.size(80,70)),n.opacity=80,n.active=!1;var i=n.addComponent(cc.Sprite);i.type=cc.Sprite.Type.SIMPLE,i.sizeMode=cc.Sprite.SizeMode.CUSTOM,i.spriteFrame=l.G.Game.getGRes(l.G.Game.GResType.EnemyWp,a.boom);var r=o.wpInfo.json[a.boom];n.anchorX=r.Anchor_x,n.anchorY=r.Anchor_y,n.x=r.Position_x,n.y=r.Position_y,n.rotation=r.Rotation,n.scaleX=r.Scale_x,n.scaleY=r.Scale_y,o.wp.addChild(n,1e3,"boom"),this.setHeadWear(4);var s=function(){t.node.x-h.default.instance.node.x<=320&&(t.unschedule(s),t.run())};this.schedule(function(){s()},.1)},t.prototype.run=function(){var e=this,t=this.node.getComponent(_).wp.getChildByName("boom");t.active=!0,t.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.2,130),cc.fadeTo(.2,20)))),this.scheduleOnce(function(){var t=c.default.instance.getExplode(u.ExplodeType.tnt),o=e.node.getPosition();t.setPosition(o.x,o.y),c.default.instance.node.addChild(t),t.getComponent("explode").run()},3)},t}(v);o.boomAct=G,cc._RF.pop()},{"../game_logic":"game_logic","../util/event_mgr":"event_mgr","./../UI/weapon":"weapon","./../game_scene":"game_scene","./../util/global_def":"global_def","./explode":"explode","./hero":"hero"}],entity:[function(e,t,o){"use strict";cc._RF.push(t,"e4af4LDczZFO4y6eOzI5LqP","entity"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./../util/global_def"),i=cc._decorator,r=i.ccclass,s=i.property;(function(e){e[e.Hight=0]="Hight",e[e.Low=1]="Low",e[e.ThreeLow=2]="ThreeLow",e[e.Right=3]="Right",e[e.Left=4]="Left"})(n=o.jumpType||(o.jumpType={}));var c,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.jumpCount=0,t}return __extends(t,e),t.prototype.run=function(e,t,o,a){var i=this;void 0===t&&(t=0),void 0===o&&(o=.3),void 0===a&&(a=0);var r=this.node.parent.getComponent("entity");if(!r.isJumping){r.isJumping=!0;var s=o,c=cc.scaleTo(s,1,.5);c.easing(cc.easeOut(s));var l=cc.scaleTo(s,1,1);l.easing(cc.easeIn(s)),this.node.runAction(cc.sequence(c,cc.callFunc(function(){switch(i.jumpCount++,e){case n.Hight:r.speedY=-(r.origSY+t);break;case n.ThreeLow:i.jumpCount%3==0?r.speedY=-(r.origSY+t):r.speedY=-300;break;case n.Right:r.speedY=-(r.origSY+t),r.speedX=-a;break;case n.Left:r.speedY=-(r.origSY+t),r.speedX=a}r.isJumping=!1}),l))}},t}(cc.Component);o.Jump=l,function(e){e[e.hero=0]="hero",e[e.enemy=1]="enemy"}(c=o.EntityType||(o.EntityType={}));var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.image=null,t.rigidBody=null,t.jumpComp=null,t.sidefric=!1,t.side_jump=!1,t.isJumping=!1,t.id=null,t.a=2e3,t.ax=10,t.speedX=null,t.origSY=800,t.speedY=t.origSY,t.down=!0,t.type=null,t.s_x=1e7,t.s_max_y=0,t.s_min_y=0,t.s_speed=.5,t.s_jump_h=100,t}return __extends(t,e),t.prototype.setTexture=function(e){var t=null;switch(this.type){case c.hero:t=a.G.Game.getGRes(a.G.Game.GResType.Hero,e);break;case c.enemy:t=a.G.Game.getGRes(a.G.Game.GResType.Enemy,e)}null!=t&&(this.image.spriteFrame=t,this.node.width=t.getRect().width,this.node.height=t.getRect().height,this.setBox())},t.prototype.setBox=function(){var e=this.node.getComponent(cc.PhysicsBoxCollider);e.size=cc.size(this.node.width,this.node.height),e.offset.y=this.node.height/2,e.apply()},t.prototype.jump=function(e,t){void 0===t&&(t=.3),null==this.jumpComp&&(this.jumpComp=this.image.node.addComponent(l)),this.jumpComp.run(n.Hight,e,t)},t.prototype.onBeginContact=function(e,t,o){(this.speedX=0,o.tag==a.G.Game.enemyTag||o.tag==a.G.Game.heroTag||o.tag==a.G.Game.roadTag||o.tag==a.G.Game.brick||o.tag==a.G.Game.tntTag)&&(a.G.Game.getDir(e)==a.G.Game.dir.up&&this.jump())},t.prototype.subUpdate=function(e){if(1/60,this.down&&!this.sidefric&&!this.isJumping){this.speedY+=1/60*this.a;var t=this.speedY*(1/60);this.node.y-=t,this.node.x+=this.speedX}},t.prototype.die=function(e){},t.prototype.update_slide=function(){if(0!=this.sidefric){this.node.y-=this.s_speed;var e=this.node.x,t=this.node.y+this.node.height,o=this.node.y;(t<this.s_min_y||o>this.s_max_y||e>=this.s_x)&&(this.sidefric=!1),o>this.s_max_y&&(this.node.stopAllActions(),this.node.scaleY=.6,this.jump()),t<this.s_min_y&&this.side_jump&&(this.node.stopAllActions(),this.node.scaleY=.6,this.jump(300,.1))}},t.prototype.update=function(e){this.subUpdate(e),this.update_slide()},__decorate([s(cc.Sprite)],t.prototype,"image",void 0),t=__decorate([r],t)}(cc.Component);o.default=d,cc._RF.pop()},{"./../util/global_def":"global_def"}],event_mgr:[function(e,t,o){"use strict";cc._RF.push(t,"3309c64qi9JF6DWYcovs6HE","event_mgr"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./structure/hd_map");(function(e){e[e.kNone=0]="kNone",e[e.kLoadOver=1]="kLoadOver",e[e.KGameSlow=2]="KGameSlow",e[e.kOpenBox=3]="kOpenBox",e[e.KAddAwardBox=4]="KAddAwardBox",e[e.KStartDoorPro=5]="KStartDoorPro",e[e.KStopDoorPro=6]="KStopDoorPro",e[e.KOpenDoor=7]="KOpenDoor",e[e.KTask=8]="KTask",e[e.KTaskTnt=9]="KTaskTnt",e[e.KTaskBox=10]="KTaskBox",e[e.KTaskPush=11]="KTaskPush",e[e.KTaskSpear=12]="KTaskSpear",e[e.KTaskfly_knife=13]="KTaskfly_knife",e[e.KTaskHammer=14]="KTaskHammer",e[e.KTaskBomb=15]="KTaskBomb",e[e.KTaskRocket=16]="KTaskRocket",e[e.KTaskDarts=17]="KTaskDarts",e[e.KTaskFly_spear=18]="KTaskFly_spear",e[e.KTaskWindmill=19]="KTaskWindmill",e[e.KTaskDestroyTnt=20]="KTaskDestroyTnt"})(n=o.EventType||(o.EventType={}));var i=function(){function e(){this.type_=n.kNone,this.id_=0,this.sender_=null,this.data_=null}return e.prototype.init=function(e,t,o,n){this.id_=e,this.type_=t,this.sender_=o,this.data_=n},Object.defineProperty(e.prototype,"type",{get:function(){return this.type_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.id_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sender",{get:function(){return this.sender_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.data_},enumerable:!0,configurable:!0}),e}(),r=function(){function e(){this.id_=0,this.callback_=null}return Object.defineProperty(e.prototype,"id",{get:function(){return this.id_},enumerable:!0,configurable:!0}),e.prototype.init=function(e,t){this.id_=e,this.callback_=t},e.prototype.excute=function(e,t){this.callback_&&this.callback_(e,t)},e}(),s=function(){function e(){this.baseEvtId_=0,this.baseListenerId_=0,this.listenerMap_=null,this.evtLst_=null,this.bExe_=!1}return e.prototype.init=function(){this.baseEvtId_=0,this.baseListenerId_=0,null==this.listenerMap_&&(this.listenerMap_=new a.default),this.listenerMap_.clear(),null==this.evtLst_&&(this.evtLst_=new Array),this.evtLst_=[],this.bExe_=!1},e.prototype.addEvent=function(e,t,o,n){void 0===n&&(n=!1),++this.baseEvtId_;var a=new i;if(a.init(this.baseEvtId_,e,t,o),n){var r=this.listenerMap_.get(e);if(null!=r)for(var s=0;s<r.length;++s)r[s].excute(a.sender,a.data)}else this.bExe_=!0,this.evtLst_.push(a)},e.prototype.addListener=function(e,t){++this.baseListenerId_;var o,n=new r;(n.init(this.baseListenerId_,t),this.listenerMap_.containsKey(e))?null!=(o=this.listenerMap_.get(e))&&o.push(n):((o=new Array).push(n),this.listenerMap_.put(e,o));return this.baseListenerId_},e.prototype.removeListener=function(e,t){if(this.listenerMap_.containsKey(e)){var o=this.listenerMap_.get(e);if(null!=o){for(var n=0;n<o.length;++n)if(o[n].id==t){o.splice(n,1);break}0==o.length&&this.listenerMap_.remove(e)}}},e.prototype.excuteEvents=function(){if(this.bExe_){for(var e=0;e<this.evtLst_.length;++e){var t=this.evtLst_[e];if(null==t){cc.error("can not find the approriate game event");break}var o=this.listenerMap_.get(t.type);if(o)for(var n=0;n<o.length;++n)o[n].excute(t.sender,t.data);else cc.warn("Can not find the listeners about event ",t.type.toString())}this.evtLst_=[]}},e}();o.default=s,cc._RF.pop()},{"./structure/hd_map":"hd_map"}],explode:[function(e,t,o){"use strict";cc._RF.push(t,"c3498hXwJhO/ZsbFv5KSKtW","explode"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=cc._decorator,i=a.ccclass,r=a.property,s=e("./../util/global_def"),c=e("./../game_scene"),l=e("./../util/audio_mgr"),d=e("./hero"),h=e("../game_logic"),u=e("../util/event_mgr"),p=e("./enemy"),f=e("./effet/effectManager");(function(e){e[e.hit=0]="hit",e[e.tnt=1]="tnt",e[e.boom=2]="boom",e[e.rocket=3]="rocket",e[e.chains=4]="chains",e[e.bat=5]="bat"})(n=o.ExplodeType||(o.ExplodeType={}));var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fm=[],t.itemManager=[],t.hasHurt=!0,t.type=null,t.hurtEntity=[],t}var o;return __extends(t,e),o=t,t.prototype.clean=function(){this.hasHurt=!0,this.hurtEntity=[],this.cleanBlast()},t.prototype.cleanBlast=function(){if(this.type==n.tnt||this.type==n.boom)for(var e in this.itemManager){this.itemManager[e].getComponent("explode").clean()}},t.prototype.init=function(e){switch(this.clean(),this.itemManager=[],this.type=e,this.type){case n.tnt:case n.boom:for(var t=0;t<15;++t){(o=new cc.Node).group="blast",o.addComponent(cc.Sprite).spriteFrame=this.fm[0],this.node.addChild(o),this.itemManager.push(o),(i=o.addComponent(cc.BoxCollider)).size=o.getContentSize(),i.tag=s.G.Game.blastTag,o.addComponent("explode")}break;case n.rocket:for(t=0;t<4;++t){var o=new cc.Node;1==t&&(o.scale=1.05),o.addComponent(cc.Sprite).spriteFrame=this.fm[1],this.node.addChild(o,1e3-t),this.itemManager.push(o)}break;case n.hit:case n.chains:for(t=0;t<15;++t){var a,i;(o=new cc.Node).setScale(.7),o.group="blood",o.addComponent(cc.Sprite).spriteFrame=this.fm[2],this.node.addChild(o,3e3),this.itemManager.push(o),(a=o.addComponent(cc.RigidBody)).fixedRotation=!1,a.gravityScale=0,a.enabledContactListener=!0,a.bullet=!0,(i=o.addComponent(cc.PhysicsBoxCollider)).tag=s.G.Game.bloodTag,i.size=cc.size(14,14),o.addComponent("explode")}}},t.prototype.onCollisionEnter=function(e,t){if(t.tag==s.G.Game.blastTag){var o=t.node.getComponent("explode").hasHurt,a=t.node.parent.getComponent("explode").type;if(!o)return;if(e.tag==s.G.Game.heroTag&&a!=n.boom)(r=e.node).getComponent("entity").die(d.DieType.killing);if(e.tag==s.G.Game.enemyTag){var i=t.node.parent.getComponent("explode").hurtEntity;if(null!=d.default.instance.currentWeapon)d.default.instance.currentWeapon.getComponent("weapon").info.hurt;var r=e.node;0==s.G.Game.hasItemArray(r,i)&&(r.getComponent(p.commonAct).damage(5),5>r.getComponent(p.default).info.HP&&a==n.tnt&&h.default.instance.eventManager.addEvent(u.EventType.KTaskTnt,this,{}),i.push(r))}else if(e.tag==s.G.Game.tntTag){e.node.getComponent("tnt").boom()}}},t.prototype.onBeginContact=function(e,t,o){t.node.runAction(cc.fadeOut(1))},t.prototype.run=function(){var e=this;switch(this.type){case n.boom:case n.tnt:this.hurtEntity=[];var t=function(t){var o=a.itemManager[t];o.opacity=s.G.randRange(155,255),Number(t)<3?o.scale=s.G.randRange(.9,1.1):o.scale=s.G.randRange(.7,.9),o.x=s.G.randRange(-100,100),o.y=s.G.randRange(-100,100);var n=cc.fadeOut(1.5),i=cc.moveTo(2.5,cc.v2(0,0));o.runAction(cc.sequence(cc.spawn(cc.scaleBy(1,.7),n,i),cc.callFunc(function(){0==Number(t)&&c.default.instance.explodePool[e.type].put(e.node)}))),o.getComponent("explode").scheduleOnce(function(){o.getComponent("explode").hasHurt=!1},.05)},a=this;for(var i in this.itemManager)t(i);s.G.Game.musicBoomCount&&(s.G.Game.musicBoomCount=!1,l.AudioMgr.instance.playBoom(),this.scheduleOnce(function(){s.G.Game.musicBoomCount=!0},.7));break;case n.rocket:var r=[.1,1,1.2,1.5],d=[cc.color(255,255,43),cc.color(232,68,26),cc.color(158,129,115),cc.color(201,201,201)],h=function(t){var o=u.itemManager[t];o.color=d[Number(t)],o.stopAllActions(),o.scale=1,o.opacity=255;var a=cc.scaleBy(.2,1.1),i=r[Number(t)],s=cc.spawn(cc.scaleBy(1.5,.7),cc.fadeOut(i));o.runAction(cc.sequence(a,s,cc.callFunc(function(){e.itemManager.length;Number(t)==e.itemManager.length-1&&c.default.instance.explodePool[n.rocket].put(e.node)})))},u=this;for(var i in this.itemManager)h(i);l.AudioMgr.instance.playBoom();break;case n.hit:var p=function(t){if(o.maxHitCount<=0)return c.default.instance.explodePool[n.hit].put(m.node),{value:void 0};o.maxHitCount--;var a=m.itemManager[t];a.opacity=255;var i=a.getComponent(cc.RigidBody);i.gravityScale=3,a.setPosition(0,0),i.linearVelocity=cc.v2(s.G.randRange(-150,150),s.G.randRange(200,400)),a.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){i.gravityScale=0,o.maxHitCount++}))),0==Number(t)&&a.runAction(cc.sequence(cc.delayTime(1.5),cc.callFunc(function(){c.default.instance.explodePool[n.hit].put(e.node)})))},m=this;for(var i in this.itemManager){var _=p(i);if("object"==typeof _)return _.value}l.AudioMgr.instance.playCut();break;case n.chains:var g=function(t){if(o.maxHitCount<=0)return c.default.instance.explodePool[n.hit].put(y.node),{value:void 0};o.maxHitCount--;var a=y.itemManager[t];a.opacity=255;var i=a.getComponent(cc.RigidBody);i.gravityScale=3,a.setPosition(0,0),i.linearVelocity=cc.v2(s.G.randRange(-150,150),s.G.randRange(200,400)),a.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){i.gravityScale=0,o.maxHitCount++}))),0==Number(t)&&a.runAction(cc.sequence(cc.delayTime(1.5),cc.callFunc(function(){c.default.instance.explodePool[n.hit].put(e.node)})))},y=this;for(var i in this.itemManager){var v=g(i);if("object"==typeof v)return v.value}l.AudioMgr.instance.playChains();break;case n.bat:for(var w=function(e){var t=c.default.instance.getComponent("effectManager").get(f.effectType.bat);if(null==t)return"break";t.opacity=255,t.setPosition(0,0);var o=cc.v2(s.G.randRange(100,-100),s.G.randRange(300,400)),n=cc.moveBy(1,o);t.runAction(cc.sequence(cc.spawn(n,cc.fadeOut(1)),cc.callFunc(function(){c.default.instance.getComponent("effectManager").recycle(f.effectType.bat,t)}))),C.node.addChild(t)},C=this,b=0;b<3;++b){if("break"===w())break}this.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){c.default.instance.explodePool[n.hit].put(e.node)})))}},t.maxHitCount=45,__decorate([r([cc.SpriteFrame])],t.prototype,"fm",void 0),__decorate([r([cc.Node])],t.prototype,"itemManager",void 0),t=o=__decorate([i],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../game_logic":"game_logic","../util/event_mgr":"event_mgr","./../game_scene":"game_scene","./../util/audio_mgr":"audio_mgr","./../util/global_def":"global_def","./effet/effectManager":"effectManager","./enemy":"enemy","./hero":"hero"}],fence:[function(e,t,o){"use strict";cc._RF.push(t,"ed091cPf9hBXKlW3CHb+jGj","fence"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./../util/global_def"),a=cc._decorator,i=a.ccclass,r=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onBeginContact=function(e,t,o){o.node;o.tag,n.G.Game.heroTag},t=__decorate([i],t)}(cc.Component));o.default=r,cc._RF.pop()},{"./../util/global_def":"global_def"}],floor:[function(e,t,o){"use strict";cc._RF.push(t,"0a0aagX4O1CJoTn46PW38Qm","floor"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../game_logic"),a=e("./../game_scene"),i=e("./../util/global_def"),r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.floorImage=null,t.floorTop=null,t.box=null,t.level=null,t.startY=0,t.height=0,t}return __extends(t,e),t.prototype.init=function(e){for(var t=this,o=0;o<e;++o){var r=new cc.Node;r.anchorY=0,r.addComponent(cc.Sprite).spriteFrame=this.floorImage,r.y=this.startY,this.startY+=124,this.height+=124,this.node.addChild(r)}var s=new cc.Node;s.anchorY=0,s.addComponent(cc.Sprite).spriteFrame=this.floorTop,s.y=this.startY,this.startY+=141,this.height+=141,this.node.addChild(s),this.box.size=cc.size(270,this.height),this.box.offset=cc.v2(0,this.height/2+5),this.node.setContentSize(cc.size(270,this.height)),this.schedule(function(){n.default.instance.gameState==n.GameState.gamePlay&&1==i.G.GlobalData.novice&&(t.node.x+t.node.width/2+a.default.instance.windowSize.width/2+300<a.default.instance.mapCamera.x&&t.destroy())},1)},__decorate([c(cc.SpriteFrame)],t.prototype,"floorImage",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"floorTop",void 0),__decorate([c(cc.PhysicsBoxCollider)],t.prototype,"box",void 0),t=__decorate([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../game_logic":"game_logic","./../game_scene":"game_scene","./../util/global_def":"global_def"}],game_logic:[function(e,t,o){"use strict";cc._RF.push(t,"967cfNsI3BNu7PpAEDWsY02","game_logic"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./util/global_def"),i=e("./util/wx_util"),r=e("./Util/Storage"),s=e("./util/event_mgr"),c=e("./util/audio_mgr"),l=e("./util/network/http_req"),d=e("./util/statistic_tool"),h=cc._decorator,u=h.ccclass,p=h.property;o.kUnionID=!0,o.kMaxCoins=99999,function(e){e[e.kMenu=0]="kMenu",e[e.kScene=1]="kScene"}(n=o.GameMode||(o.GameMode={})),function(e){e[e.sotry=0]="sotry",e[e.endless=1]="endless"}(o.GameType||(o.GameType={})),function(e){e[e.gameNovice=0]="gameNovice",e[e.gameNoviceOver=1]="gameNoviceOver",e[e.gameLoadRes=2]="gameLoadRes",e[e.gameLoadPlot=3]="gameLoadPlot",e[e.game_Plot=4]="game_Plot",e[e.gamePlotOver=5]="gamePlotOver",e[e.gameSelect=6]="gameSelect",e[e.gameStart=7]="gameStart",e[e.gamePlay=8]="gamePlay",e[e.gameNoTouch=9]="gameNoTouch",e[e.gameOver=10]="gameOver",e[e.gameOtherScene=11]="gameOtherScene"}(o.GameState||(o.GameState={}));var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.config=null,t.uid=null,t.reportSwitch=!0,t.switch=1,t.showCount_fh=3,t.shareCount=0,t.BannerJump=100,t.showWindowNum=100,t.shareCount_com=6,t.startGameNeedShare=0,t.switch_useOtherIp=1,t.trialCount=20,t.bannerIntervalCount=5,t.trialPetCount=0,t.rankSwitch=1,t.useIpShield=1,t.BannerCfg=0,t.reportOpenId=!1,t.startGame=!0,t.openDial=!1,t.BannerClickCount=3,t.ip_switch=0,t.ip_share=0,t.ip_banner=0,t.appid_0=0,t.appid_1=1,t.gameType=0,t.wp_data=null,t.debug=0,t.gameEvtMgr_=null,t.sessionKey="",t.openId="",t.unionId="",t.shareGroupDate=0,t.gameId="",t.gameMode=n.kMenu,t.gameState=null,t.gameLevel=0,t.gameBegain=!1,t.frameTime=0,t.range=45,t.angle=Math.PI/2,t.run=!1,t.rType={pickBox:"pickBoxCnt",openBox:"openBoxCnt",resurrection:"resurrectionCnt",distance:"distanceCnt",dieOfWindmill:"dieOfWindmillCnt",distanceEndLess:"distanceEndLessCnt",hellScene:"hellSceneCnt"},t}var h;return __extends(t,e),h=t,t.prototype.getSwitch=function(){var e=this,t=!1,o=function(){l.default.checkIP(function(e){var t=JSON.parse(e);h.instance.ip_switch=t.res})};l.default.getFuncSwitch(a.G.appVersion,function(t){t=JSON.parse(t);var n=JSON.parse(t.res);h.instance.switch=Number(n.a),h.instance.showCount_fh=Number(n.showCount_fh),h.instance.shareCount=Number(n.shareCount),h.instance.BannerJump=Number(n.BannerJump),h.instance.showWindowNum=Number(n.showWindow),h.instance.shareCount_com=Number(n.shareCount_com),h.instance.startGameNeedShare=Number(n.startGameNeedShare),h.instance.switch_useOtherIp=Number(n.switch_useOtherIp),h.instance.trialCount=Number(n.trialCount),h.instance.bannerIntervalCount=Number(n.bannerIntervalCount),h.instance.ip_share=Number(n.ip_share),h.instance.ip_banner=Number(n.ip_banner),h.instance.trialPetCount=Number(n.trialPetCount),h.instance.rankSwitch=Number(n.rankSwitch),h.instance.useIpShield=Number(n.useIpShield),h.instance.appid_0=Number(n.appid_0),h.instance.appid_1=Number(n.appid_1),h.instance.BannerClickCount=Number(n.BannerClickCount),o(),e.getBannerClickCount()<=0&&(h.instance.BannerJump=0)},function(){0==t&&(t=!0,o())})},t.prototype.onLoad=function(){var e=this;if(cc.dynamicAtlasManager.enabled=!1,this.config={debug:0,testServer:0,framerate:60,proName:"HeadStrong"},h.instance=this,cc.game.addPersistRootNode(this.node),cc.game.setFrameRate(60),null==this.gameEvtMgr_&&(this.gameEvtMgr_=new s.default),this.gameEvtMgr_.init(),1==this.debug&&r.default.clearAllStorage(),this.loadData(),cc.sys.platform==cc.sys.WECHAT_GAME){var t=function(e){this.openId=e.openId,this.sessionKey=e.session_key;i.default.launchInvitationCheck(function(e){1==e?a.G.console("OK lauch invite cb",1,e):a.G.console("No lauch invite cb",1,e)},o.kUnionID),console.log("login succ cb",e)}.bind(this),n=function(e){this.sessionKey=""}.bind(this);o.kUnionID||i.default.login(t,n,!0);var d=function(){return{title:"",imageUrl:"",query:""}}.bind(this);i.default.showForward(d),wx.onShow(function(e){cc.director.resume(),c.AudioMgr.instance.stopEffects(),c.AudioMgr.instance.replayMusic(),a.G.console("onShow",1,e);var t=function(e){a.G.console("on show invite cb",e)}.bind(this);i.default.onShowInvitationCheck(e.query,t,o.kUnionID)}.bind(this)),wx.onHide(function(t){if(console.log("\u5207\u5165\u5230\u540e\u53f0",t),a.G.stopAllBanner(),cc.director.pause(),c.AudioMgr.instance.pauseMusic(),c.AudioMgr.instance.stopEffects(),i.default.isLookVideo&&(console.log("\u89c6\u9891\u5207\u540e\u53f0"),i.default.onClickVideoHide=!0),""!=i.default.bannerId_&&t&&t.mode&&t.targetAction){if("back"==t.mode&&3==t.targetAction||"hide"==t.mode&&-1==t.targetAction)return;var o=e.getBannerClickCount();o<=0&&(e.BannerJump=0),o--,r.default.writeNum("bannerClickCount",o),console.log("Banner \u5207\u540e\u53f0"+o)}})}this.eventManager.addListener(s.EventType.KGameSlow,this.GameSlowdown.bind(this)),l.default.getTimeSwtich(["BannerCfg"],function(e){e=JSON.parse(e),e=JSON.parse(e.res),h.instance.BannerCfg=Number(e.BannerCfg)}),a.G.Game.loadGRes(),this.scheduleOnce(function(){a.G.Game.GResF},2),a.G.Game.requestShareData(),wx.onShow(function(e){i.default.normShareResult()}.bind(this)),this.getSwitch()},t.prototype.getBannerClickCount=function(){var e=(new Date).getDate(),t=r.default.readNum("lastBannerClickCount");e!=Number(t)&&r.default.writeNum("bannerClickCount",this.BannerClickCount);var o=r.default.readNum("bannerClickCount");return r.default.writeNum("lastBannerClickCount",e),Number(o)},t.prototype.GameSlowdown=function(e,t){this.frameTime=1.7,null!=t.time&&(this.frameTime=t.time),this.run=!0},t.prototype.updateFrame=function(){if(this.run){if(this.angle+=Math.PI/(60*this.frameTime),this.angle>Math.PI)return this.angle=Math.PI/2,this.run=!1,void cc.game.setFrameRate(60);var e=60-this.range*Math.sin(this.angle);cc.game.setFrameRate(e)}},t.prototype.start=function(){},t.prototype.log=function(){},t.prototype.loadData=function(){this.readData(),this.readWxData()},t.prototype.saveWxData=function(){for(var e={shareGroups:[],shareGroupDate:this.shareGroupDate},t=0;t<i.default.shareGroups.length;++t)e.shareGroups[t]=i.default.shareGroups[t];r.default.writeJSON(r.SaveDef.kWxStatus,e)},t.prototype.readWxData=function(){var e=r.default.readJSON(r.SaveDef.kWxStatus);if(a.G.isExistObj(e)){if(this.shareGroupDate=e.shareGroupDate,e.shareGroups)for(var t=0;t<e.shareGroups.length;++t)i.default.shareGroups[t]=e.shareGroups[t];if(this.shareGroupDate&&this.shareGroupDate>0)Date.now()-this.shareGroupDate>=216e5&&(i.default.shareGroups=[]);console.log("readWxData",e)}},t.prototype.saveData=function(){r.default.writeJSON(r.SaveDef.kGameData,{})},t.prototype.readData=function(){var e=r.default.readJSON(r.SaveDef.kGameData);a.G.isExistObj(e)},Object.defineProperty(t.prototype,"eventManager",{get:function(){return this.gameEvtMgr_},enumerable:!0,configurable:!0}),t.prototype.changeScene=function(e,t,o){cc.director.preloadScene(e,function(e,o,n){t&&t(e,o,n)},function(t){t?cc.log("change scene err",t):(a.G.console("changeScene over"),cc.director.loadScene(e,o),cc.sys.garbageCollect(),cc.sys.platform==cc.sys.WECHAT_GAME&&wx.triggerGC())})},t.prototype.update=function(e){if(i.default.adsRequestTimer>0&&i.default.updateAdsRequestTimer(e),this.gameEvtMgr_&&this.gameEvtMgr_.excuteEvents(),this.updateFrame(),d.default.schedule(e),1==a.G.runSchedulBanner)for(var t in a.G.showBanner){var o=a.G.showBanner[t];a.G.showBanner;0!=o.run&&(o.time+=e)}},t.prototype.report=function(e,t,o){console.log("\u4e0a\u62a5\u6570\u636e",this.uid),this.reportSwitch&&this.uid},t.instance=null,__decorate([p(cc.JsonAsset)],t.prototype,"wp_data",void 0),__decorate([p(cc.Integer)],t.prototype,"debug",void 0),t=h=__decorate([u],t)}(cc.Component);o.default=f,cc._RF.pop()},{"./Util/Storage":"storage","./util/audio_mgr":"audio_mgr","./util/event_mgr":"event_mgr","./util/global_def":"global_def","./util/network/http_req":"http_req","./util/statistic_tool":"statistic_tool","./util/wx_util":"wx_util"}],game_nav:[function(e,t,o){"use strict";cc._RF.push(t,"3a16dB6sT1Fd68JlaqOGb8I","game_nav"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("../../util/global_def"),i=e("../../util/wx_util"),r=cc._decorator,s=r.ccclass,c=r.property;(function(e){e[e.kElimination2048=0]="kElimination2048",e[e.kRaidenPlane=1]="kRaidenPlane",e[e.kParkour=2]="kParkour"})(n||(n={}));var l=["wxc5c9116726f1792c","wxf3ceb934d2a16974","wx0ec9d0561d021a98"],d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spfArr_=[],t.icon_=null,t.appId_="",t.appType_=n.kElimination2048,t}return __extends(t,e),t.prototype.onEnable=function(){this.appType_=a.G.randRange(n.kElimination2048,n.kParkour),this.appId_=l[this.appType_],this.icon_.spriteFrame=this.spfArr_[this.appType_]},t.prototype.onClick=function(){if(cc.sys.platform==cc.sys.WECHAT_GAME){var e=wx.getSystemInfoSync();console.log(e.SDKVersion),1==i.default.compareVersionForWx(e.SDKVersion,"2.2.0")?wx.navigateToMiniProgram({appId:this.appId_,path:"",extraData:null}):i.default.modalDialog("\u7248\u672c\u63d0\u793a","\u5fae\u4fe1\u7248\u672c\u8f83\u4f4e\uff0c\u6682\u4e0d\u652f\u6301\u6e38\u620f\u8df3\u8f6c",null,null,!1)}},__decorate([c(cc.SpriteFrame)],t.prototype,"spfArr_",void 0),__decorate([c(cc.Sprite)],t.prototype,"icon_",void 0),t=__decorate([s],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../../util/global_def":"global_def","../../util/wx_util":"wx_util"}],game_scene:[function(e,t,o){"use strict";cc._RF.push(t,"70232L2MUNM7reN5ly7C83V","game_scene"),Object.defineProperty(o,"__esModule",{value:!0});var n,a,i,r,s,c,l=cc._decorator,d=l.ccclass,h=l.property,u=e("./util/global_def"),p=e("./UI/enemy"),f=e("./UI/explode"),m=e("./UI/weapon"),_=e("./game_logic"),g=e("./UI/hero"),y=e("./util/event_mgr"),v=e("./util/audio_mgr"),w=e("./SDK/aladinSDK"),C=e("./util/wx_util"),b=e("./util/storage"),x=e("./UI/door"),S=e("./UI/Rank");(function(e){e[e.tnt=0]="tnt",e[e.windmill=1]="windmill",e[e.gear=2]="gear"})(n||(n={})),function(e){e[e.normal=0]="normal",e[e.change=1]="change"}(a||(a={})),function(e){e[e.start=0]="start",e[e.over=1]="over"}(i=o.PlotStep||(o.PlotStep={})),function(e){e[e.daytime=0]="daytime",e[e.night=1]="night",e[e.daytimeToNight=2]="daytimeToNight",e[e.nightToDayTime=3]="nightToDayTime"}(r=o.WeatherState||(o.WeatherState={})),function(e){e[e.coin=0]="coin",e[e.crown=1]="crown"}(s=o.WealthType||(o.WealthType={})),function(e){e[e.main=0]="main",e[e.hell=1]="hell",e[e.endless=2]="endless"}(c=o.SceneType||(o.SceneType={}));var G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.iconItem=null,t.backGround=null,t.backGroundF=[],t.backGround_1=null,t.weather=null,t.weatherSt=null,t.openTask=null,t.noviceInfo=null,t.enemyInfo=null,t.heroCamera=null,t.mapCamera=null,t.visionCamera=null,t.isCameraScale=0,t.mapData=null,t.mapIndex=0,t.roundData=[],t.roundCommon=null,t.roundBoss=null,t.roundEndless=null,t.hero=null,t.enemyPool=null,t.enemyManager=[],t.road_=null,t.startRoad=null,t.startPos=cc.v2(0,0),t.addDistance=0,t.roadPool=null,t.noviceRoadManager=[],t.explode=null,t.explodePool=[],t.box=null,t.boxNum=0,t.bridgePool=null,t.bridgeItem=null,t.bridgeManager=[],t.gamePlot=null,t.plotOver=null,t.gameOverPet=null,t.weapon=null,t.weaponPool=[],t.weaponPoolId=[m.WeaponType.rocket,m.WeaponType.fly_knife,m.WeaponType.fly_spear,m.WeaponType.darts,m.WeaponType.bomb,m.WeaponType.bat_darts],t.weaponLayer=null,t.lastRoadPos=cc.v2(0,0),t.windowSize=null,t.BegainLayer=null,t.hatBtn=null,t.clickBegin=null,t.StartRoad_2=null,t.endLayer=null,t.endPro=null,t.endHero=null,t.endPet=null,t.crown_lab=null,t.crown=0,t.coin_lab=null,t.coin=0,t.currentCoin=0,t.coin_p=null,t.coinPool=null,t.coinManager=[],t.distance_lab=null,t.distance=0,t.runOver=!1,t.power_bar=null,t.boxLayer=null,t.PetBtn=null,t.beyond=null,t.drawerBtn=null,t.novice=!1,t.resurgAni=null,t.TaskLayer=null,t.heroPre=null,t.enemyPre=null,t.endAwardDes=null,t.tipWindow=null,t.resurgenceCount=1,t.freeResurgenceCount=0,t.door=null,t.doorProgress=null,t.playScene=null,t.Scene=[],t.taskShow=null,t.trialLayer=null,t.trialPetLayer=null,t.stopRoadManager=!1,t.firstEnterGame=!1,t.firstTouch=!0,t.doorNode=null,t.newUser=0,t.fenceLeft=null,t.fenceRight=null,t.floor=null,t.floorItem=null,t.wpFactory=null,t.favoNode=null,t.skills=null,t.gameBoss=!1,t.stay_time=600,t.change_time=1.275,t.roadF=[],t.plantF=[],t.tnt=null,t.plotTouch=[!1,!1],t.plotTouchOver=[!1,!1],t.dis_last=0,t.dis_step=200,t.dis_start=null,t.rateCount=0,t.tex=null,t.hellDistance=u.G.randRange(15,25),t.isAddHell=!1,t.easing_x=.1,t.target_x=0,t.ca_min_dis=10,t.ca_max_dis=103,t.easing_y=.2,t.target_y=0,t.ca_run_y=!1,t.gbStartNode_0=null,t.gbStartNode_1=null,t.gBoss=null,t.isResurgence=!1,t.setCamerY=!1,t.camera_offset=cc.v2(3,2),t.camera_scale=1,t.camera_speed=.01,t.doorP=0,t}var o;return __extends(t,e),o=t,t.prototype.onLoad=function(){var e=this,t=w.AladinSDK.getDrawerNode();t.group="layer",this.node.addChild(t),w.AladinSDK.hideDrawerNode();var n=w.AladinSDK.getFavoNode();this.favoNode.addChild(n),_.default.instance.gameType!=_.GameType.endless&&(this.favoNode.active=!1),this.wpFactory=new m.wpFactory,u.G.reportToAladin(u.G.aladinType.toGame),u.G.addGameCount(),this.newUser=b.default.readNum("newUser");for(var a in this.Scene){this.Scene[a].active=!1}if(_.default.instance.gameType==_.GameType.endless?this.playScene=this.Scene[c.endless]:this.playScene=this.Scene[c.main],this.playScene.active=!0,this.endLayer.getComponent("endLayer").initBanner(),_.default.instance.gameType==_.GameType.sotry?this.backGround.spriteFrame=this.backGroundF[0]:this.backGround.spriteFrame=this.backGroundF[1],cc.macro.BATCH_VERTEX_COUNT*=10,o.instance=this,this.windowSize=cc.view.getVisibleSize(),this.Scene[c.main].getComponent("main_scene").maxDistance=u.G.Game.getMaxDistance(_.default.instance.gameLevel),this.drawerBtn.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.1,.8,.8),cc.scaleTo(.1,1.1,1.1),cc.scaleTo(.1,.8,.8),cc.scaleTo(.1,1.1,1.1),cc.scaleTo(.1,.9,.9),cc.scaleTo(.1,1,1),cc.delayTime(2)))),this.TaskLayer.getComponent("taskLayer").init(),this.boxLayer.getComponent("BoxLayer").init(),cc.director.getCollisionManager().enabled=!0,cc.director.getPhysicsManager().enabled=!0,null==b.default.readNum("freeResurgenceCount")&&(this.freeResurgenceCount=1,b.default.writeNum("freeResurgenceCount",1)),0==_.default.instance.reportOpenId)if(""!=_.default.instance.openId)_.default.instance.reportOpenId=!0,w.AladinSDK.report(w.AladinSDK.ReportTypes.OPEN_ID,_.default.instance.openId),console.log("123sdk\u4e0a\u62a5openId\u6210\u529f"+_.default.instance.openId);else{var i=function(){C.default.login(function(t){if(_.default.instance.reportOpenId)return e.unschedule(i),void console.log("\u505c\u6b62\u4e0a\u62a5openId"+_.default.instance.openId);u.G.reportToAladin(u.G.aladinType.toWxLogin);u.G.console(t),_.default.instance.openId=t.openId,_.default.instance.sessionKey=t.sessionKey,w.AladinSDK.report(w.AladinSDK.ReportTypes.OPEN_ID,_.default.instance.openId),console.log("456sdk\u4e0a\u62a5openId\u6210\u529f"+_.default.instance.openId),_.default.instance.reportOpenId=!0},null,!0,!1)};this.schedule(i,2,cc.macro.REPEAT_FOREVER)}if(0==Number(u.G.GlobalData.novice)&&(this.novice=!0),this.novice){var r=["\u8f7b\u6309\u4e00\u6b21\u79fb\u52a8","\u8f7b\u6309\u4e24\u6b21","\u62fe\u53d6\u5b9d\u7bb1\u83b7\u5f97\u6b66\u5668","\u8fd9\u662f\u4e00\u4e2a\u517d\u4eba,\u63a8\u5b83","\u795d\u4f60\u597d\u8fd0"],s=[0,800,2500,3200,3800],l=new cc.Node;this.node.addChild(l,1e3,"noviceLab");for(var a in r){var d=new cc.Node;d.group="road",d.addComponent(cc.Label).string=r[a],d.x=s[a],d.y=120,l.addChild(d)}this.PetBtn.active=!1}this.initTouch(),this.loadRoadRes(_.default.instance.gameLevel,this.initPool.bind(this));var h=this.startRoad.getPosition();this.startPos=cc.v2(h.x+this.startRoad.width/2,h.y+this.startRoad.height/2),this.lastRoadPos=cc.v2(h.x+this.startRoad.width/2,h.y+this.startRoad.height/2),this.clickBegin.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(2,1.3),cc.scaleTo(2,.8))));var p=u.G.randRange(40,60);this.StartRoad_2.runAction(cc.repeatForever(cc.sequence(cc.moveBy(2,0,p),cc.moveBy(2,0,-p)))),this.initWealth(),this.scheduleOnce(function(){u.G.Game.getWeaponInfo(0,1)},1),this.initWeather(),this.schedule(this.update_weather,.1,cc.macro.REPEAT_FOREVER);var f=_.default.instance.eventManager.addListener(y.EventType.KStartDoorPro,this.startDoorPro.bind(this));o.ListenerManager.push({type:y.EventType.KStartDoorPro,id:f});var g=_.default.instance.eventManager.addListener(y.EventType.KStopDoorPro,this.stopDoorPro.bind(this));o.ListenerManager.push({type:y.EventType.KStopDoorPro,id:g}),this.taskShow.getComponent("taskShow").init(),this.taskShow.getComponent("taskShow").open(),this.trialLayer.getComponent("trialLayer").init(1),this.scheduleOnce(function(){e.firstEnterGame&&e.openPetTrialLayer(null)},.5),this.resurgenceCount=_.default.instance.showCount_fh,this.node.getComponent("effectManager").init(),_.default.instance.gameType!=_.GameType.endless&&(this.floorItem=cc.instantiate(this.floor),this.floorItem.getComponent("floor").init(u.G.GameData.floorLevel),this.floorItem.x=-200,this.floorItem.y=-105,this.node.addChild(this.floorItem)),this.initHero()},t.prototype.openPetTrialLayer=function(e){var t=this.getOpenPetTrialCount();null==e&&(u.G.GlobalData.petTrialClose||t>=_.default.instance.trialPetCount)?this.favoNode.active=!0:(this.trialPetLayer.getComponent("petTrialLayer").open(),null==e&&(t++,b.default.writeNum("trialPetOpen",t)))},t.prototype.getOpenPetTrialCount=function(){var e=(new Date).getDate(),t=b.default.readNum("lastDateOpenPetTrial");e!=Number(t)&&b.default.writeNum("trialPetOpen",0);var o=b.default.readNum("trialPetOpen");return b.default.writeNum("lastDateOpenPetTrial",e),Number(o)},t.prototype.openTrial=function(){u.G.GlobalData.trialClose||_.default.instance.gameType==_.GameType.endless||this.trialLayer.getComponent("trialLayer").open()},t.prototype.addDoorToRoad=function(e,t,o,n){if(!this.novice&&1==this.newUser&&_.default.instance.gameType!=_.GameType.endless){var a=cc.instantiate(this.door);a.getComponent("door").setState(t),a.getComponent("door").setType(o,n);var i=e.getContentSize().height/2;a.setPosition(0,i),e.addChild(a,2e3),this.doorNode=a}},t.prototype.initWeather=function(){this.weather=b.default.readNum("weather"),this.weatherSt=b.default.readNum("weatherState"),null==this.weather&&(this.weather=0,this.weatherSt=r.daytime,b.default.writeNum("weather",0),b.default.writeNum("weatherState",r.daytime)),this.backGround_1.opacity=this.weather},t.prototype.update_weather=function(){switch(this.weatherSt){case r.daytime:this.stay_time--,this.stay_time<=0&&(this.weatherSt=r.daytimeToNight);break;case r.night:this.stay_time--,this.stay_time<=0&&(this.weatherSt=r.nightToDayTime);break;case r.daytimeToNight:this.weather+=this.change_time,this.backGround_1.opacity=this.weather,this.weather>=255&&(this.weatherSt=r.night,this.stay_time=600);break;case r.nightToDayTime:this.weather-=this.change_time,this.backGround_1.opacity=this.weather,this.weather<=0&&(this.weatherSt=r.daytime,this.stay_time=600)}},t.prototype.openTaskBox=function(e,t){var o=cc.instantiate(this.openTask);o.getComponent("openTask").run(e,t),this.node.addChild(o)},t.prototype.openTaskLayer=function(){},t.prototype.closeTaskLayer=function(){_.default.instance.gameState!=_.GameState.game_Plot&&this.openBoxLayer(),this.TaskLayer.getComponent("taskLayer").close()},t.prototype.sdkBackBtnClick=function(){w.AladinSDK.ShowGameBoxNode()},t.prototype.drawerBtnClick=function(){w.AladinSDK.ShowDrawer()},t.prototype.setPetBtn=function(e){var t=this.PetBtn.getChildByName("des");e>=u.G.Game.petCount?(t.active=!0,t.getComponent(cc.Sprite).spriteFrame=u.G.Game.getGRes(u.G.Game.GResType.Pet,0)):(t.active=!0,t.getComponent(cc.Sprite).spriteFrame=u.G.Game.getGRes(u.G.Game.GResType.Pet,e));t.scale=70/t.getContentSize().width},t.prototype.openBoxLayer=function(){},t.prototype.closeBoxLayer=function(){_.default.instance.gameType!=_.GameType.endless&&this.boxLayer.getComponent("BoxLayer").close()},t.prototype.setGameStartState=function(e){switch(_.default.instance.gameState=e,e){case _.GameState.game_Plot:_.default.instance.gameState=_.GameState.game_Plot;break;case _.GameState.gameStart:this.clickBegin.active=!0,_.default.instance.gameState=_.GameState.gameStart,this.openBoxLayer();break;case _.GameState.gameNovice:this.BegainLayer.active=!1,this.clickBegin.active=!1,_.default.instance.gameState=_.GameState.gameNovice}},t.prototype.sortRes=function(e){void 0===e&&(e=[]);var t=function(e){var t=e.name,o=t.indexOf("_")+1,n=t.substring(o);return Number(n)};e.sort(function(e,o){var n=t(e),a=t(o);return n>a?1:n==a?0:-1})},t.prototype.loadRoadRes=function(e,t){var o=this;this.boxNum=u.G.Game.getBoxCount(e),_.default.instance.gameType==_.GameType.endless?null==this.roundEndless&&cc.loader.loadResDir("data/round/endless",function(e,t){if(o.roundEndless=[],null==e)for(var n in t){var a=t[n];o.roundEndless.push(a)}}):null==this.roundBoss&&cc.loader.loadResDir("data/round/r_boss",function(e,t){if(o.roundBoss=[],null==e)for(var n in t){var a=t[n];o.roundBoss.push(a)}o.sortRes(o.roundBoss)});var n=function(e,t){if(null==o.roundData[e]){o.roundData[e]=[];var n="data/round/r_"+String(e);cc.loader.loadResDir(n,function(n,a){if(null==n){for(var i in a){var r=a[i];o.roundData[e].push(r)}t()}})}else t()},a=u.G.Game.getGameResId(e);if(null==this.roadF[a]){this.roadF[a]=[],this.plantF[a]=[];var i="map/road/road_"+a;cc.loader.loadResDir(i,function(i,r){if(null==i){for(var s in r)if(r[s]instanceof cc.SpriteFrame){var c=r[s].name;-1!=c.indexOf("p")?o.plantF[a].push(r[s]):-1!=c.indexOf("r")&&o.roadF[a].push(r[s])}o.sortRes(o.plantF[a]),o.sortRes(o.roadF[a]),n(e,t)}})}else n(e,t)},t.prototype.setPlot=function(e){var t=this;switch(e){case i.start:_.default.instance.gameState=_.GameState.game_Plot,this.BegainLayer.active=!1,this.Scene[c.main].getComponent("main_scene").createPlot();break;case i.over:this.scheduleOnce(function(){t.initRoad()},1),this.scheduleOnce(function(){_.default.instance.gameState=_.GameState.gameStart,t.schedule(t.updataDistance,.5)},1.5)}},t.prototype.initGameStartState=function(){var e=u.G.GameData.petInfo;this.novice?this.setGameStartState(_.GameState.gameNovice):_.default.instance.gameType==_.GameType.endless?this.setGameStartState(_.GameState.gameStart):0!=e[0]?this.setGameStartState(_.GameState.gameStart):this.setGameStartState(_.GameState.game_Plot)},t.prototype.startGame=function(){var e=this,t=u.G.GameData.petInfo;switch(this.novice?_.default.instance.gameState=_.GameState.gameLoadRes:_.default.instance.gameType==_.GameType.endless?_.default.instance.gameState=_.GameState.gameLoadRes:0!=t[0]?_.default.instance.gameState=_.GameState.gameLoadRes:_.default.instance.gameState=_.GameState.gameLoadPlot,_.default.instance.gameState){case _.GameState.gameLoadPlot:this.setPlot(i.start);break;case _.GameState.gameLoadRes:this.initRoad(),this.scheduleOnce(function(){e.schedule(e.updataDistance,.5)},1.5)}},t.prototype.initPool=function(){var e=this,t=[];t.push(this.initCoinPool.bind(this)),t.push(this.initRoadPool.bind(this)),t.push(this.initBridgePool.bind(this)),_.default.instance.gameType!=_.GameType.endless&&(t.push(this.initEnemyPool.bind(this)),t.push(this.initWeaponPool.bind(this))),t.push(this.initExplode.bind(this)),this.playScene.getComponent("game").init();var o=.8/t.length,n=0,a=function(){if(n>=t.length)return e.unschedule(a),void e.startGame();t[n](),n++};this.schedule(a,o)},t.prototype.initWealth=function(){this.coin=Number(cc.sys.localStorage.getItem("coin")),this.coin_lab.string=String(this.coin),this.crown=Number(cc.sys.localStorage.getItem("crown")),this.crown_lab.string=String(this.crown)},t.prototype.buy=function(e,t,o){switch(e){case s.coin:this.coin<t?this.tipWindow.getComponent("tipWindow").open(0,this):(this.coin-=t,this.coin_lab.string=String(this.coin),cc.sys.localStorage.setItem("coin",this.coin),o());break;case s.crown:this.crown<t?this.tipWindow.getComponent("tipWindow").open(1,this):(this.crown-=t,this.crown_lab.string=String(this.crown),cc.sys.localStorage.setItem("crown",this.crown),o())}},t.prototype.updateWealth=function(e,t,o){switch(void 0===o&&(o=!0),e){case s.coin:this.coin+=t,this.currentCoin+=t,this.coin_lab.string=String(this.coin),o&&cc.sys.localStorage.setItem("coin",this.coin);break;case s.crown:this.crown+=t,this.crown_lab.string=String(this.crown),o&&cc.sys.localStorage.setItem("crown",this.crown)}},t.prototype.storageWealth=function(){cc.sys.localStorage.setItem("coin",this.coin),cc.sys.localStorage.setItem("crown",this.crown)},t.prototype.initWeaponLayer=function(){var e=g.default.instance.weapon_id;this.weaponLayer.getComponent("weaponLayer").init(e)},t.prototype.initWeaponPool=function(){for(var e in this.weaponPoolId){var t=this.weaponPoolId[e];if(null==this.weaponPool[t]){this.weaponPool[t]=new cc.NodePool;for(var o=0;o<10;++o){var n=cc.instantiate(this.weapon);n.getComponent("weapon").init(t),this.weaponPool[t].put(n)}}}},t.prototype.getWeaponItem=function(e){var t=this.weaponPool[e].get();return null==t&&(t=cc.instantiate(this.weapon)).getComponent("weapon").init(e),t},t.prototype.addBoxToRoad=function(e,t,o){var n=cc.instantiate(this.box);n.getComponent("box").init(e);var a=n.getChildByName("image").width,i=n.getChildByName("image").height,r=(t.width-a)/2,s=cc.v2(u.G.randRange(-r,r),t.height/2+i/2);null!=o&&(s.x=o.x),n.setPosition(s);var c=t.getChildByName("boxNode");null!=c?c.addChild(n,2e3,"box"):t.addChild(n,2e3,"box")},t.prototype.initCoinPool=function(){if(this.coinPool=new cc.NodePool,_.default.instance.gameType==_.GameType.endless)for(var e=0;e<200;++e){var t=cc.instantiate(this.coin_p);this.coinPool.put(t)}else for(e=0;e<60;++e){t=cc.instantiate(this.coin_p);this.coinPool.put(t)}},t.prototype.getCoin=function(){var e=this.coinPool.get();return null==e&&(e=cc.instantiate(this.coin_p)),e},t.prototype.initExplode=function(){for(var e=f.ExplodeType.hit;e<=f.ExplodeType.bat;++e)if(null==this.explodePool[e]){this.explodePool[e]=new cc.NodePool;for(var t=0;t<8;t++){var o=cc.instantiate(this.explode);o.getComponent("explode").init(e),this.explodePool[e].put(o)}}},t.prototype.getExplode=function(e){var t=this.explodePool[e].get();return null==t&&(t=cc.instantiate(this.explode)).getComponent("explode").init(e),t.getComponent("explode").clean(),t},t.prototype.getEnemy=function(){var e=this.enemyPool.get();return null==e&&(e=cc.instantiate(this.enemyPre)),e},t.prototype.showTip=function(e){var t=this.node.getChildByName("tip");t.y=0;var o=t.getChildByName("des").getComponent(cc.Label);o.string=e,o.fontSize=40;cc.moveBy(1,0,200);var n=cc.fadeOut(1.5),a=cc.fadeIn(.5);t.stopAllActions(),t.runAction(cc.sequence(a,cc.delayTime(.5),n))},t.prototype.setEnemyAct=function(e,t){var o=e.getComponent(p.commonAct);null!=o&&e.removeComponent(o),e.addComponent(t)},t.prototype.initEnemyPool=function(){this.enemyPool=new cc.NodePool;for(var e=0;e<20;++e){var t=cc.instantiate(this.enemyPre);this.enemyPool.put(t)}},t.prototype.initRoadPool=function(){this.roadPool=new cc.NodePool;for(var e=0;e<20;++e){var t=cc.instantiate(this.road_),o=u.G.randRange(0,u.G.Game.roadKind);t.getComponent("road").init(o,Math.random()>.8),this.roadPool.put(t)}},t.prototype.initRoad=function(){if(this.novice){u.G.Game.getLevelDif();this.Scene[c.main].getComponent("main_scene").createNoviceData()}else this.playScene.getComponent("game").startNodeManager();this.initGameStartState()},t.prototype.addEnemyToRoad=function(e,t,o){if(void 0===t&&(t=!1),t)for(var n in o){if(o[n].id>u.G.Game.enemy_max_id)break;(d=this.getEnemy()).getComponent("enemy").init(o[n].id);var a=o[n].pos.x+e.x,i=e.y+e.height/2+10;d.setPosition(a,i),this.Scene[c.main].addChild(d,1e3),0==Number(n)&&Math.random()>0&&d.getComponent("enemy").talk(0),this.enemyManager.push(d)}else{var r=cc.v2(e.x-e.width/2+u.G.randRange(50,120),e.y+e.height/2+10),s=1,l=Math.random();if(l>0&&l<.65){p.EnemyType.enemy_0;s=2}else if(l>=.65&&l<.9){p.EnemyType.enemy_1;s=1}else{p.EnemyType.enemy_2;s=1}for(n=0;n<s;++n){var d;(d=this.getEnemy()).getComponent("enemy").init(0),d.setPosition(r),this.Scene[c.main].addChild(d,1e3),0==Number(n)&&Math.random()>0&&d.getComponent("enemy").talk(0),this.enemyManager.push(d),r.x+=d.width+5}}},t.prototype.cleanRoad=function(e){var t=e.getChildByName("boxNode");null!=t&&t.removeAllChildren();var o=e.getChildByName("windNode");null!=o&&o.removeAllChildren();var n=e.getChildByName("otherNode");null!=n&&n.removeAllChildren();var a=e.getChildByName("controlNode");null!=a&&(a.group="default")},t.prototype.getRoad=function(){var e=this.roadPool.get();if(null==e){e=cc.instantiate(this.road_);var t=u.G.randRange(0,u.G.Game.roadKind);e.getComponent("road").init(t,Math.random()>.8)}return e},t.prototype.dealMapData=function(e){var t=null;for(var o in e){var n=e[o];null==t&&((t=cc.v2(0,0)).x=0-n.x,t.y=0-n.y),n.x+=t.x,n.y+=t.y}},t.prototype.initTouch=function(){var e=this,t=!0;this.node.on(cc.Node.EventType.TOUCH_START,function(){if(!e.isResurgence){e.taskShow.getComponent("taskShow").close();_.default.instance.gameState;if(_.default.instance.gameState==_.GameState.game_Plot&&_.default.instance.gameType!=_.GameType.endless){e.favoNode.active=!1,e.PetBtn.active=!1;if(0==e.plotTouch[0])e.plotTouch[0]=!0,(o=cc.moveBy(1,4e3,0)).easing(cc.easeInOut(2)),e.mapCamera.runAction(o),(n=cc.moveBy(1,4e3,0)).easing(cc.easeInOut(2)),(a=cc.moveBy(1,4e3,0)).easing(cc.easeInOut(2)),e.visionCamera.runAction(a),e.heroCamera.runAction(cc.sequence(n,cc.callFunc(function(){e.plotTouchOver[0]=!0})));else if(0==e.plotTouch[1]&&1==e.plotTouchOver[0]){var o,n,a;e.PetBtn.active=!0,e.plotTouch[1]=!0,(o=cc.moveBy(1,-4e3,0)).easing(cc.easeInOut(2)),e.mapCamera.runAction(o),(n=cc.moveBy(1,-4e3,0)).easing(cc.easeInOut(2)),(a=cc.moveBy(1,-4e3,0)).easing(cc.easeInOut(2)),e.visionCamera.runAction(a),e.heroCamera.runAction(cc.sequence(n,cc.callFunc(function(){e.plotTouchOver[1]=!0}))),e.setPlot(i.over),e.scheduleOnce(function(){e.Scene[c.main].getComponent("main_scene").gamePlot.removeFromParent(),e.openBoxLayer()},1)}}else _.default.instance.gameState==_.GameState.gameStart&&(e.favoNode.active=!1,e.skills.active=!0,e.PetBtn.active=!1,e.closeBoxLayer(),S.Rank.submitCurtSocre(e.distance),_.default.instance.gameState=_.GameState.gamePlay,e.beyond.active=!0,e.power_bar.node.active=!0,e.hatBtn.getComponent("ui_motion").triggerMotion(function(){e.BegainLayer.active=!1}),e.clickBegin.active=!1,_.default.instance.gameType!=_.GameType.endless&&(e.weaponLayer.active=!0),e.distance_lab.node.active=!0,v.AudioMgr.instance.playMusic(v.BgmType.KGameBg));if(0!=t&&(_.default.instance.gameState==_.GameState.gamePlay||_.default.instance.gameState==_.GameState.gameNovice))if(e.firstTouch&&0==u.G.GlobalData.trialClose&&0==e.novice)e.firstTouch=!1;else if(1==e.hero.getComponent("hero").sidefric)t=!1,e.hero.scaleY=.3,(o=cc.moveBy(.3,0,e.hero.getComponent("hero").s_jump_h)).easing(cc.easeOut(.3)),e.hero.runAction(cc.spawn(o,cc.scaleTo(.2,.6,.6))),e.scheduleOnce(function(){t=!0},.3),e.hero.getComponent("hero").move();else e.hero.getComponent("hero").move()}})},t.prototype.initHero=function(){this.hero=cc.instantiate(this.heroPre);var e=u.G.Game.lastHeroId;u.G.GlobalData.trialCount>0&&(e=u.G.GlobalData.trialId),this.hero.getComponent("hero").init(e);var t=0;null!=this.floorItem&&(t=this.floorItem.getComponent("floor").height),this.hero.y+=t,this.playScene.addChild(this.hero,1e3)},t.prototype.startDistance=function(){this.schedule(this.updataDistance,.5,cc.macro.REPEAT_FOREVER,2)},t.prototype.setDoorDistance=function(){this.hellDistance=this.distance+u.G.randRange(5,5),this.isAddHell=!1},t.prototype.updataDistance=function(){if(null==this.dis_start&&(this.dis_start=this.heroCamera.x),this.distance>=this.Scene[c.main].getComponent("main_scene").maxDistance)return this.unschedule(this.updataDistance),this.dis_last=this.distance,void(this.runOver=!0);var e=(this.heroCamera.x-this.dis_start)/this.dis_step;if(this.distance=Math.floor(e)+this.dis_last,this.distance_lab.string=String(this.distance),this.distance>=this.hellDistance&&0==this.isAddHell){this.isAddHell=!0;var t=this.playScene.getComponent("game").roadManager.length,o=this.playScene.getComponent("game").roadManager[t-1];null!=o&&(this.playScene.getComponent("game").cleanRoadGameItem(o),this.addDoorToRoad(o,x.doorState.to_open,c.main,c.hell))}},t.prototype.update_map_x=function(){if((_.default.instance.gameState==_.GameState.gamePlay||_.default.instance.gameState==_.GameState.gameNovice||0!=this.Scene[c.main].getComponent("main_scene").plotMove)&&null!=this.hero){this.target_x=this.hero.x+200;var e=this.target_x-this.heroCamera.x;if(Math.abs(e)<1)return this.heroCamera.x=this.target_x,this.mapCamera.x=this.target_x,void(this.visionCamera.x=this.target_x);var t=e*this.easing_x;this.heroCamera.x+=t,this.mapCamera.x+=t,this.visionCamera.x+=t}},t.prototype.update_map_y=function(){if(this.setCamerY||_.default.instance.gameState==_.GameState.gamePlay&&this.ca_run_y){var e=this.heroCamera.y-this.hero.y;if(!(e>this.ca_min_dis&&e<this.ca_max_dis)){e<=this.ca_min_dis?this.target_y=this.hero.y+this.ca_min_dis:e>=this.ca_max_dis&&(this.target_y=this.hero.y+this.ca_max_dis);var t=this.target_y-this.heroCamera.y;if(Math.abs(t)<1)return this.heroCamera.y=this.target_y,this.mapCamera.y=this.target_y,void(this.setCamerY=!1);var o=t*this.easing_y;this.heroCamera.y+=o,this.mapCamera.y+=o}}},t.prototype.CamerZoom=function(e){var t=this;this.heroCamera;var o=1,n=function(){o+=.1,t.heroCamera.getComponent(cc.Camera).zoomRatio+=.1,t.mapCamera.getComponent(cc.Camera).zoomRatio+=.1,o>=2&&t.unschedule(n)};this.schedule(n,.1)},t.prototype.initBridgePool=function(){this.bridgePool=new cc.NodePool;for(var e=0;e<30;++e){var t=cc.instantiate(this.bridgeItem);this.bridgePool.put(t)}},t.prototype.getBridgeItem=function(){var e=this.bridgePool.get();return null==e&&(e=cc.instantiate(this.bridgeItem)),e},t.prototype.openEndLayer=function(){var e=this;if(this.novice)this.resurgence();else switch(_.default.instance.gameType){case _.GameType.endless:case _.GameType.sotry:0!=this.resurgenceCount?this.endLayer.getComponent("endLayer").open(0):this.scheduleOnce(function(){e.endLayer.getComponent("endLayer").open(1)},2.5),this.beyond.active=!1,_.default.instance.report(_.default.instance.rType.distance,this.distance,1),u.G.Game.setDistance(this.distance)}},t.prototype.showEndPro=function(){if(_.default.instance.gameType!=_.GameType.endless){var e=300*((this.distance-u.G.Game.getMaxDistance(_.default.instance.gameLevel-1))/(u.G.Game.getMaxDistance(_.default.instance.gameLevel)-u.G.Game.getMaxDistance(_.default.instance.gameLevel-1))),t=cc.moveBy(.2,e,0);t.easing(cc.easeOut(1)),this.endPro.active=!0,this.endHero.spriteFrame=u.G.Game.getGRes(u.G.Game.GResType.Hero,g.default.instance.id),this.endPet.spriteFrame=u.G.Game.getGRes(u.G.Game.GResType.Pet,_.default.instance.gameLevel),this.endHero.node.x=-155,this.endHero.node.runAction(cc.sequence(cc.delayTime(1),t))}},t.prototype.resGameBoss=function(){var e=this;if(null!=this.gbStartNode_0&&null!=this.gbStartNode_1){this.freeResurgenceCount<=0&&(this.resurgenceCount--,C.default.delBanner()),this.endPro.active=!1,this.endLayer.getComponent("endLayer").close(),_.default.instance.gameState=_.GameState.gamePlay,this.isResurgence=!0,this.scheduleOnce(function(){e.isResurgence=!1},2),this.ca_run_y=!0;var t=this.gbStartNode_0,o=cc.v2(t.x,t.y+t.height/2+300);this.cleanRoad(t),this.playScene.getComponent("game").cleanRoadGameItem(t),g.default.instance.rigidBody.gravityScale=0,g.default.instance.eyes.active=!1,g.default.instance.a=1300,g.default.instance.origSY=500,g.default.instance.tw.node.active=!1,this.hero.scale=u.G.Game.hero_scale,this.hero.opacity=0,this.hero.setPosition(o),this.hero.stopAllActions(),_.default.instance.report(_.default.instance.rType.resurrection,1);var n=cc.instantiate(this.resurgAni),a=cc.v2(0,t.height/2);n.setPosition(a),n.getComponent("resurgAni").run(g.default.instance.id,function(){e.hero.y=t.y+t.height/2+10,e.hero.opacity=255,g.default.instance.tw.node.active=!0}),t.addChild(n);var i=this.gbStartNode_1.getPosition();i.y+=100,this.gBoss.getComponent(p.commonAct).reset(i)}},t.prototype.resurgence=function(){var e=this;if(this.gameBoss)this.resGameBoss();else{this.freeResurgenceCount<=0&&(this.resurgenceCount--,C.default.delBanner()),this.endPro.active=!1,this.endLayer.getComponent("endLayer").close(),_.default.instance.gameState=_.GameState.gamePlay,this.isResurgence=!0,this.scheduleOnce(function(){e.isResurgence=!1},2),this.ca_run_y=!0;for(var t=1e5,o=cc.v2(0,0),n=null,a=0;a<this.playScene.getComponent("game").roadManager.length;++a){(s=(r=this.playScene.getComponent("game").roadManager[a]).x-this.hero.x)>0&&s<t&&(t=s,o=cc.v2(r.x,r.y+r.height/2+300),n=r)}if(null==n){var i=this.playScene.getComponent("main_scene").balloonManager;for(a=0;a<i.length;++a){var r,s;(s=(r=i[a]).x-this.hero.x)>0&&s<t&&(t=s,o=cc.v2(r.x,r.y+r.height/2+300),n=r)}}this.cleanRoad(n),this.playScene.getComponent("game").cleanRoadGameItem(n),g.default.instance.rigidBody.gravityScale=0,g.default.instance.eyes.active=!1,g.default.instance.a=1300,g.default.instance.origSY=500,g.default.instance.tw.node.active=!1,this.hero.scale=u.G.Game.hero_scale,this.hero.opacity=0,this.hero.setPosition(o),this.hero.stopAllActions(),_.default.instance.report(_.default.instance.rType.resurrection,1);var l=cc.instantiate(this.resurgAni),d=cc.v2(0,n.height/2);l.setPosition(d),l.getComponent("resurgAni").run(g.default.instance.id,function(){e.hero.y=n.y+n.height/2+10,e.hero.opacity=255,g.default.instance.tw.node.active=!0}),n.addChild(l),this.playScene.getComponent("game").type==c.hell&&g.default.instance.startInvincible()}},t.prototype.onClickSocial=function(){wx.navigateToMiniProgram({appId:"wx4233cc143076bfdc",path:"pages/index/index",extraData:{openid:_.default.instance.openId,appid:u.G.appid,Ads:"sdk",AdsPos:"community",to:"circle"},success:function(e){}})},t.prototype.onClickReStart=function(){this.gameBoss?this.resGameBoss():this.resurgence()},t.prototype.cleanMemory=function(){cc.sys.garbageCollect(),cc.sys.platform==cc.sys.WECHAT_GAME&&wx.triggerGC()},t.prototype.onDestroy=function(){for(var e in o.ListenerManager){var t=o.ListenerManager[e];_.default.instance.eventManager.removeListener(t.type,t.id)}},t.prototype.setLens=function(e,t,o){void 0===o&&(o=.01),this.camera_offset=t,this.camera_scale=e,this.camera_speed=o,this.isCameraScale=a.change},t.prototype.update_camera=function(){if(this.isCameraScale!=a.normal){var e=this.camera_scale-this.heroCamera.getComponent(cc.Camera).zoomRatio,t=e/Math.abs(e);this.heroCamera.getComponent(cc.Camera).zoomRatio+=this.camera_speed*t,this.mapCamera.getComponent(cc.Camera).zoomRatio+=this.camera_speed*t,this.heroCamera.y+=this.camera_offset.y,this.heroCamera.x+=this.camera_offset.x,this.mapCamera.y+=this.camera_offset.y,this.mapCamera.x+=this.camera_offset.x,Math.abs(this.heroCamera.getComponent(cc.Camera).zoomRatio-this.camera_scale)<this.camera_speed&&(this.isCameraScale=a.normal,this.heroCamera.getComponent(cc.Camera).zoomRatio=this.camera_scale,this.mapCamera.getComponent(cc.Camera).zoomRatio=this.camera_scale)}},t.prototype.update=function(){this.update_camera(),this.update_map_x(),this.update_map_y()},t.prototype.setPowProgress=function(e,t){this.power_bar.progress=e;var o=this.power_bar.node.getChildByName("bar");t==g.PowerStep.up&&(o.color=cc.color(255,255,0)),t==g.PowerStep.parallel&&(o.color=cc.color(0,255,0)),t==g.PowerStep.down&&(o.color=cc.color(255,0,0))},t.prototype.doDoorPro=function(){this.doorP+=1/60,this.doorProgress.progress=this.doorP,this.doorP>=1&&(this.doorProgress.progress=1,this.unschedule(this.doDoorPro),this.doorProgress.node.active=!1,_.default.instance.eventManager.addEvent(y.EventType.KOpenDoor,this,{}))},t.prototype.startDoorPro=function(){this.doorP=0,this.doorProgress.progress=this.doorP,this.doorProgress.node.active=!0,this.schedule(this.doDoorPro,1/30,cc.macro.REPEAT_FOREVER)},t.prototype.stopDoorPro=function(){this.unschedule(this.doDoorPro),this.doorProgress.node.active=!1},t.prototype.shareGame=function(e,t){if(_.default.instance.switch){u.G.Game.shareData;var o=u.G.randRange(0,u.G.Game.shareData.length-1),n=JSON.parse(u.G.Game.shareData[o]),a=n.title,i="https://huandong-1257458597.cos.ap-guangzhou.myqcloud.com/HeadStrong/share/"+n.img,r=t||function(){wx.showModal({title:"\u63d0\u793a",content:"\u53d1\u9001\u5230\u4e0d\u540c\u7fa4\u624d\u80fd\u83b7\u5f97\u5956\u52b1",showCancel:!0,cancelText:"\u6b8b\u5fcd\u62d2\u7edd",cancelColor:"",confirmText:"\u518d\u8bd5\u4e00\u6b21",success:function(t){t.confirm&&C.default.shareNorm(a,i,e,r)}})};C.default.shareNorm(a,i,e,r)}else e()},t.prototype.onClickRankShare=function(){this.shareGame(function(){console.log("\u6392\u884c\u699c\u5206\u4ea8\u6210\u529f")})},t.instance=null,t.ListenerManager=[],__decorate([h(cc.Prefab)],t.prototype,"iconItem",void 0),__decorate([h(cc.Sprite)],t.prototype,"backGround",void 0),__decorate([h(cc.SpriteFrame)],t.prototype,"backGroundF",void 0),__decorate([h(cc.Node)],t.prototype,"backGround_1",void 0),__decorate([h(cc.Prefab)],t.prototype,"openTask",void 0),__decorate([h(cc.JsonAsset)],t.prototype,"noviceInfo",void 0),__decorate([h(cc.JsonAsset)],t.prototype,"enemyInfo",void 0),__decorate([h(cc.Node)],t.prototype,"heroCamera",void 0),__decorate([h(cc.Node)],t.prototype,"mapCamera",void 0),__decorate([h(cc.Node)],t.prototype,"visionCamera",void 0),__decorate([h(cc.JsonAsset)],t.prototype,"mapData",void 0),__decorate([h(cc.Prefab)],t.prototype,"road_",void 0),__decorate([h(cc.Node)],t.prototype,"startRoad",void 0),__decorate([h(cc.Prefab)],t.prototype,"explode",void 0),__decorate([h(cc.Prefab)],t.prototype,"box",void 0),__decorate([h(cc.Prefab)],t.prototype,"bridgeItem",void 0),__decorate([h(cc.Prefab)],t.prototype,"plotOver",void 0),__decorate([h(cc.Prefab)],t.prototype,"weapon",void 0),__decorate([h(cc.Node)],t.prototype,"weaponLayer",void 0),__decorate([h(cc.Node)],t.prototype,"BegainLayer",void 0),__decorate([h(cc.Node)],t.prototype,"hatBtn",void 0),__decorate([h(cc.Node)],t.prototype,"clickBegin",void 0),__decorate([h(cc.Node)],t.prototype,"StartRoad_2",void 0),__decorate([h(cc.Node)],t.prototype,"endLayer",void 0),__decorate([h(cc.Node)],t.prototype,"endPro",void 0),__decorate([h(cc.Sprite)],t.prototype,"endHero",void 0),__decorate([h(cc.Sprite)],t.prototype,"endPet",void 0),__decorate([h(cc.Label)],t.prototype,"crown_lab",void 0),__decorate([h(cc.Label)],t.prototype,"coin_lab",void 0),__decorate([h(cc.Prefab)],t.prototype,"coin_p",void 0),__decorate([h(cc.Label)],t.prototype,"distance_lab",void 0),__decorate([h(cc.ProgressBar)],t.prototype,"power_bar",void 0),__decorate([h(cc.Node)],t.prototype,"boxLayer",void 0),__decorate([h(cc.Node)],t.prototype,"PetBtn",void 0),__decorate([h(cc.Node)],t.prototype,"beyond",void 0),__decorate([h(cc.Node)],t.prototype,"drawerBtn",void 0),__decorate([h(cc.Prefab)],t.prototype,"resurgAni",void 0),__decorate([h(cc.Node)],t.prototype,"TaskLayer",void 0),__decorate([h(cc.Prefab)],t.prototype,"heroPre",void 0),__decorate([h(cc.Prefab)],t.prototype,"enemyPre",void 0),__decorate([h(cc.Prefab)],t.prototype,"endAwardDes",void 0),__decorate([h(cc.Node)],t.prototype,"tipWindow",void 0),__decorate([h(cc.Prefab)],t.prototype,"door",void 0),__decorate([h(cc.ProgressBar)],t.prototype,"doorProgress",void 0),__decorate([h([cc.Node])],t.prototype,"Scene",void 0),__decorate([h(cc.Node)],t.prototype,"taskShow",void 0),__decorate([h(cc.Node)],t.prototype,"trialLayer",void 0),__decorate([h(cc.Node)],t.prototype,"trialPetLayer",void 0),__decorate([h(cc.Prefab)],t.prototype,"floor",void 0),__decorate([h(cc.Node)],t.prototype,"favoNode",void 0),__decorate([h(cc.Node)],t.prototype,"skills",void 0),__decorate([h(cc.Prefab)],t.prototype,"tnt",void 0),t=o=__decorate([d],t)}(cc.Component);o.default=G,cc._RF.pop()},{"./SDK/aladinSDK":"AladinSDK","./UI/Rank":"Rank","./UI/door":"door","./UI/enemy":"enemy","./UI/explode":"explode","./UI/hero":"hero","./UI/weapon":"weapon","./game_logic":"game_logic","./util/audio_mgr":"audio_mgr","./util/event_mgr":"event_mgr","./util/global_def":"global_def","./util/storage":"storage","./util/wx_util":"wx_util"}],game:[function(e,t,o){"use strict";cc._RF.push(t,"409d8N+3+hAnqyRlD0kamX1","game"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./game_logic"),a=cc._decorator,i=a.ccclass,r=(a.property,e("./game_scene")),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.funs=[],t.funIndex=0,t.roadManager=[],t.isStartNodeManager=!1,t.first=!0,t.road_range_count=3,t.type=null,t}return __extends(t,e),t.prototype.stopNodeManager=function(){this.unschedule(this.doFun)},t.prototype.startNodeManager=function(){this.init(),this.isStartNodeManager||(this.isStartNodeManager=!0,this.loadRes(),this.initNodeManger());var e=1/this.funs.length;this.funIndex=0,r.default.instance.unschedule(this.doFun),r.default.instance.schedule(this.doFun,e,cc.macro.REPEAT_FOREVER)},t.prototype.doFun=function(){var e=r.default.instance.playScene.getComponent("game");n.default.instance.gameState!=n.GameState.gamePlotOver&&(e.funs[e.funIndex](),e.funIndex=(e.funIndex+1)%e.funs.length)},t.prototype.initNodeManger=function(){},t.prototype.loadRes=function(){},t.prototype.init=function(){},t.prototype.showDoorAni=function(){},t.prototype.cleanRoadGameItem=function(e){},t.prototype.cleanAllUp=function(){this.first=!0,this.road_range_count=3},t=__decorate([i],t)}(cc.Component);o.default=s,cc._RF.pop()},{"./game_logic":"game_logic","./game_scene":"game_scene"}],gear:[function(e,t,o){"use strict";cc._RF.push(t,"b56771fcTVHjIyZku1j/I7/","gear"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./../util/global_def"),a=e("./enemy"),i=e("./explode"),r=e("../game_logic"),s=cc._decorator,c=s.ccclass,l=s.property,d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onCollisionEnter=function(e,t){if(r.default.instance.gameState==r.GameState.gamePlay){var o=e.node;e.tag==n.G.Game.heroTag?o.getComponent("entity").die():e.tag==n.G.Game.enemyTag&&o.getComponent(a.commonAct).damage(100,i.ExplodeType.hit)}},t}(cc.Component),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.saw_0=null,t.saw_1=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.saw_0.addComponent(d),this.saw_1.addComponent(d);var e=cc.repeatForever(cc.rotateBy(2,360)),t=cc.repeatForever(cc.rotateBy(2,360));this.saw_0.parent.runAction(e),this.saw_1.parent.runAction(t)},__decorate([l(cc.Node)],t.prototype,"saw_0",void 0),__decorate([l(cc.Node)],t.prototype,"saw_1",void 0),t=__decorate([c],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../game_logic":"game_logic","./../util/global_def":"global_def","./enemy":"enemy","./explode":"explode"}],getPetLayer:[function(e,t,o){"use strict";cc._RF.push(t,"f7d24LMRINK36M/KhDFLXUu","getPetLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=e("./../util/global_def"),s=e("./../util/wx_util"),c=e("./../game_scene"),l=e("./skinPet"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.petImage=null,t.banNode=null,t.id=null,t}return __extends(t,e),t.prototype.open=function(e){var t=this;this.petImage.spriteFrame=r.G.Game.getGRes(r.G.Game.GResType.Pet,e),this.node.active=!0;this.content.getComponent("ui_motion").triggerMotion(function(){s.default.delBanner(),s.default.addBanner(r.G.BannerId[2],null,t.banNode,1)}),this.id=e},t.prototype.close=function(){var e=this;wx.showModal({title:"\u63d0\u793a",content:"\u53ef\u9886\u53d6\u5177\u6709\u5f3a\u5927\u653b\u51fb\u529b\u7684\u968f\u4ece\uff0c\u82e5\u653e\u5f03\u9886\u53d6\uff0c\u53ea\u80fd\u5728\u4e3b\u9875\u968f\u4ece\u9762\u677f\u89e3\u9501\u3002",showCancel:!0,cancelText:"\u6b8b\u5fcd\u62d2\u7edd",cancelColor:"",confirmText:"\u7ee7\u7eed\u9886\u53d6",success:function(t){t.confirm?e.getAward():e.closeLayer()}})},t.prototype.closeLayer=function(){s.default.delBanner(),this.node.active=!1,c.default.instance.playScene.getComponent("main_scene").playNextPlot()},t.prototype.getAward=function(){var e=this;s.default.watchVideoAds(r.G.VideoId.trialHero,function(){e.closeLayer(),c.default.instance.hero.getComponent("hero").addPet(e.id),r.G.GameData.setPetData(e.id,l.skinPetState.unlock)},function(){c.default.instance.showTip("\u672a\u89c2\u770b\u5b8c\u6574\u89c6\u9891\uff0c\u65e0\u6cd5\u83b7\u5f97\u5956\u52b1")})},__decorate([i(cc.Node)],t.prototype,"content",void 0),__decorate([i(cc.Sprite)],t.prototype,"petImage",void 0),__decorate([i(cc.Node)],t.prototype,"banNode",void 0),t=__decorate([a],t)}(cc.Component);o.default=d,cc._RF.pop()},{"./../game_scene":"game_scene","./../util/global_def":"global_def","./../util/wx_util":"wx_util","./skinPet":"skinPet"}],getSkillLayer:[function(e,t,o){"use strict";cc._RF.push(t,"8614bl/jAFGx5Zqh4+HQoUb","getSkillLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./../util/global_def"),a=e("./../game_scene"),i=e("./../util/wx_util"),r=e("./../UI/hero"),s=cc._decorator,c=s.ccclass,l=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.wpImage=null,t.lock=null,t.banNode=null,t.id=null,t.sca=[.3,.2,1],t}return __extends(t,e),t.prototype.open=function(e){var t=this;if(!n.G.GameData.towerLock&&null!=n.G.GameData.currenTower){this.wpImage.node.scale=this.sca[n.G.GameData.currenTower],this.wpImage.spriteFrame=n.G.Game.getGRes(n.G.Game.GResType.tower,n.G.GameData.currenTower),this.node.active=!0;this.content.getComponent("ui_motion").triggerMotion(function(){i.default.delBanner(),i.default.addBanner(n.G.BannerId[2],null,t.banNode,1)}),this.id=e}},t.prototype.close=function(){this.closeLayer()},t.prototype.closeLayer=function(){i.default.delBanner(),this.node.active=!1},t.prototype.getAward=function(){var e=this;i.default.watchVideoAds(n.G.VideoId.trialHero,function(){e.closeLayer(),n.G.GameData.towerLock=!0,e.lock.active=!1,a.default.instance.showTip("\u89e3\u9501\u6280\u80fd\u6210\u529f"),null!=r.default.instance.towerPet&&(r.default.instance.towerPet.active=!0)},function(){a.default.instance.showTip("\u672a\u89c2\u770b\u5b8c\u6574\u89c6\u9891\uff0c\u65e0\u6cd5\u89e3\u9501\u6280\u80fd")})},__decorate([l(cc.Node)],t.prototype,"content",void 0),__decorate([l(cc.Sprite)],t.prototype,"wpImage",void 0),__decorate([l(cc.Node)],t.prototype,"lock",void 0),__decorate([l(cc.Node)],t.prototype,"banNode",void 0),t=__decorate([c],t)}(cc.Component);o.default=d,cc._RF.pop()},{"./../UI/hero":"hero","./../game_scene":"game_scene","./../util/global_def":"global_def","./../util/wx_util":"wx_util"}],global_def:[function(e,t,o){"use strict";cc._RF.push(t,"d3c96LVdv1LvJvQuOryO+qf","global_def"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../game_logic"),a=e("./../UI/enemy"),i=e("./../game_scene"),r=e("./../UI/hero"),s=e("./../game_scene"),c=e("../util/network/http_req"),l=e("./../util/wx_util"),d=e("./Storage"),h=e("../SDK/aladinSDK"),u=function(){function e(){}return e.isEmptyObj=function(e){if(e)for(var t in e)return!1;return!0},e.isExistObj=function(e){return!this.isEmptyObj(e)},e.isEqualF=function(e,t){var o=!1;return Math.abs(e-t)<=1e-6&&(o=!0),o},e.randRange=function(e,t){return Math.round(Math.random()*(t-e))+e},e.dispatchCustomEvent=function(t,o,n){var a=new cc.Event.EventCustom(o,!0);e.isEmptyObj(n)||a.setUserData(n),t.dispatchEvent(a)},e.readJson=function(e,t){cc.loader.loadRes(e,cc.JsonAsset,function(e,o){e?cc.log(e):(t&&t(o.json),cc.loader.release(o))})},e.readAudio=function(e,t,o,n){void 0===n&&(n=!1),cc.loader.loadRes(e,cc.AudioClip,function(e,a){e?cc.log(e):t&&t(a,o,n)})},e.readImgAsSpFrm=function(e,t,o,n){cc.loader.loadRes(e,cc.SpriteFrame,function(e,a){e?cc.log(e):(t&&(t.getComponent(cc.Sprite).spriteFrame=a,t.getComponent(cc.Sprite).sizeMode=o||cc.Sprite.SizeMode.TRIMMED),n&&n(a))})},e.console=function(e,t){void 0===t&&(t=1);for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];o&&o.length>0?1==t?console.log(e,o):2==t?console.warn(e,o):3==t&&console.error(e,o):1==t?console.log(e):2==t?console.warn(e):3==t&&console.error(e)},e.dieOfDistance=function(t){t>1&&t<=25?e.reportToAld(e.Report.distance_1):t>25&&t<=60?e.reportToAld(e.Report.distance_2):t>61&&t<=120?e.reportToAld(e.Report.distance_3):t>121&&t<=220?e.reportToAld(e.Report.distance_4):t>221&&t<=320?e.reportToAld(e.Report.distance_5):t>321&&t<=420?e.reportToAld(e.Report.distance_6):t>401&&t<=520?e.reportToAld(e.Report.distance_7):t>521&&e.reportToAld(e.Report.distance_8)},e.addGameCount=function(){var t=d.default.readNum("newUser");if(null==t||0==t)if(null==t){var o=(new Date).getDate();d.default.writeNum("newUserTime",o),d.default.writeNum("newUser",0),e.reportToAld(e.Report.newCount)}else{o=(new Date).getDate();var n=cc.sys.localStorage.getItem("newUserTime");o!=Number(n)?(d.default.writeNum("newUser",1),e.reportToAld(e.Report.oldCount)):e.reportToAld(e.Report.newCount)}else e.reportToAld(e.Report.oldCount)},e.reportToAld=function(e,t){wx.aldSendEvent(e,t)},e.reportToAladin=function(t){h.AladinSDK.reportAnalytics(e.appid,t)},e.BlendBanner=function(){var t=[[0,1,2],[1,2,0],[2,0,1],[0,1,2],[1,2,0],[2,0,1]],o=e.randRange(0,5),n=[];for(var a in t[o]){var i=t[o][a];n.push(e.BannerId[i])}e.BannerId=n},e.shareGame=function(t,o,a){if(n.default.instance.switch){var i=e.randRange(0,e.Game.shareData.length-1),r=JSON.parse(e.Game.shareData[i]),s=r.title,c="https://huandong-1257458597.cos.ap-guangzhou.myqcloud.com/HeadStrong/share/"+r.img,d=o||function(){var e=a||"\u53d1\u9001\u5230\u4e0d\u540c\u7fa4\u624d\u80fd\u83b7\u5f97\u5956\u52b1";wx.showModal({title:"\u63d0\u793a",content:e,showCancel:!0,cancelText:"\u6b8b\u5fcd\u62d2\u7edd",cancelColor:"",confirmText:"\u518d\u8bd5\u4e00\u6b21",success:function(e){console.log("\u53c2\u6570",e),e.confirm&&l.default.shareNorm(s,c,t,d)}})};l.default.shareNorm(s,c,t,d)}else t()},e.reSetData=function(e,t,o){var n=(new Date).getDate(),a=d.default.readNum(e);n!=Number(a)&&d.default.writeNum(t,o),d.default.writeNum(e,n)},e.activaLayer=function(e){e.active=!0,e.active=!1},e.initHeroWeapon=function(t){e.Game.hero_weapon=[],t=t.json;for(var o in t){var n=t[o].weapon,a=this.readWeapon(n);e.Game.hero_weapon.push(a)}},e.setHeroName=function(t){t=t.json;for(var o in t){var n=t[o].name;e.Game.hero_name.push(n)}},e.setPetName=function(t){t=t.json;for(var o in t){var n=t[o].name;e.Game.pet_name.push(n)}},e.setWpName=function(t){t=t.json;for(var o=0;o<e.Game.weaponCount;++o){var n=t[String(o)+"_1"].name;e.Game.weapon_name.push(n)}},e.readWeapon=function(e){for(var t=[],o="",n=0;n<e.length;n++)if(","!=e[n])o+=e[n];else{var a=Number(o);t.push(a),o=""}return t},e.ipShield=function(e){return e<n.default.instance.BannerJump&&1==n.default.instance.BannerCfg&&(0==n.default.instance.ip_switch||1==n.default.instance.ip_banner)},e.createGameBanner=function(){wx.createGameBanner&&(e.bannerAd=wx.createGameBanner({adUnitId:"PBgAAgDEpr-kDcxo"}))},e.showGameBanner=function(){e.bannerAd&&e.bannerAd.show().catch(function(e){console.error(e)})},e.hidGameBanner=function(){e.bannerAd&&e.bannerAd.hide().catch(function(e){console.error(e)})},e.createPortalAd=function(){wx.createGamePortal?(console.log("1111111111111111111"),e.portalAd=wx.createGamePortal({adUnitId:"PBgAAgDEpr-r2tIU"})):console.log("2222222222222222222")},e.showPortalAd=function(){e.portalAd?(console.log("333333333333333"),e.portalAd.load().then(function(){e.portalAd.show()}).catch(function(e){console.error(e)})):console.log("44444444444444444444")},e.worker=null,e.GameData={skinHeroState:{lock:0,unlock:1,use:2},GameCount:0,hatData:[1,0,0,0,0,0,0,0,0,0,0,0,0],petData:[0,0,0,0,0,0,0,0,0,0,0,0,0],hatInfo:[],petInfo:[],tower:[{wpId:[0],payType:2,payNum:10},{wpId:[1,2],payType:2,payNum:10}],towerUnlook:[1,0,0,0,0,0],towerLevel:[1,0,0,0,0,0,0,0,0,0,0,0,0],floorLevel:1,currenTower:0,towerLock:!1,getHeroData:function(){if(e.GameData.hatInfo=d.default.readJSON("hatInfo"),null==e.GameData.hatInfo){var t=JSON.stringify(e.GameData.hatData);cc.sys.localStorage.setItem("hatInfo",t),e.GameData.hatInfo=e.GameData.hatData}return e.GameData.hatInfo},setHeroData:function(t,o){e.GameData.hatInfo[t]=o;var n=JSON.stringify(e.GameData.hatInfo);cc.sys.localStorage.setItem("hatInfo",n)},getPetData:function(){if(e.GameData.petInfo=d.default.readJSON("petInfo"),null==e.GameData.petInfo){var t=JSON.stringify(e.GameData.petData);cc.sys.localStorage.setItem("petInfo",t),e.GameData.petInfo=e.GameData.petData}return e.GameData.petInfo},setPetData:function(t,o){e.GameData.petInfo[t]=o;var n=JSON.stringify(e.GameData.petInfo);cc.sys.localStorage.setItem("petInfo",n)},getTower:function(){var e=d.default.readJSON("towerUnlook");return null==e&&(e=this.towerUnlook,d.default.writeJSON("towerUnlook",this.towerUnlook)),this.towerUnlook=e,this.towerUnlook},setTower:function(e,t){this.towerUnlook[e]=t,d.default.writeJSON("towerUnlook",this.towerUnlook)},getTowerData:function(e){var t=d.default.readJSON("towerLevel");return null==t&&(t=this.towerLevel,d.default.writeJSON("towerLevel",this.towerLevel)),this.towerLevel=t,this.towerLevel[e]},setTowerData:function(e,t){this.towerLevel[e]=t,d.default.writeJSON("towerLevel",this.towerLevel)},firstHurt:[10,11,2],getTowerHurt:function(e){var t=this.towerLevel[e];return 0==t?0:this.firstHurt[0]+t},firstMoney:[250,250,500],getTowerMoney:function(e){var t=this.towerLevel[e];return this.firstMoney[0]+250*t}},e.Game={roadKind:5,roadTag:100,enemyTag:200,heroTag:300,bloodTag:400,blastTag:500,tntTag:600,boxTag:700,gasTag:800,petTag:900,plotTag:1e3,weaponTag:1100,balloonTag:1200,gear:1300,door:1400,brick:1500,brickItem:1600,petLight:1700,firBall:1800,dra_bullet:1900,hero_scale:.6,enemy_max_id:4,game_bottom:-500,hatCount:9,petCount:7,EnemyHatCount:4,weaponCount:14,max_road_num:6,max_check:5,lastHeroId:null,lastPetId:null,BRIDGE_ID:6,BALLOON_ID:7,hero_color:[cc.color(61,205,214),cc.color(40,32,78),cc.color(92,98,110),cc.color(59,141,69),cc.color(53,109,157),cc.color(12,66,113),cc.color(79,53,80),cc.color(31,148,221),cc.color(238,212,54)],heroBox:[cc.size(80,86),cc.size(80,86),cc.size(80,86),cc.size(80,86),cc.size(80,86)],bossBox:[cc.size(190,232),cc.size(195,220),cc.size(200,222),cc.size(160,180),cc.size(170,180)],bossDensity:[2,2,2,2,2],hero_name:[],pet_name:[],weapon_name:[],hero_weapon:[[8,6,0],[1,4,2],[0,1,9],[4,0,8],[1,0,4]],wp_add:[!1,!1,!0,!1,!0,!1,!1,!1,!0],endlessSkills:{magnet:!1},wp_mark:[0,1,2,3,4,5,6,7,8,9,10,10,7,4],musicBoomCount:!0,rmFromArray:function(e,t){for(var o=0;o<t.length;++o)if(t[o]==e){t.splice(o,1);break}},hasItemArray:function(e,t){for(var o=0;o<t.length;++o)if(t[o]==e)return!0;return!1},dir:{up:0,down:1,right:2,left:3,right_down:4,left_down:5},getMaxDistance:function(e){return n.default.instance.gameType==n.GameType.endless?1e5:5==e?1e5:-1==e?0:100+100*e},wp_max_count:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],getWeaponInfo:function(e,t){var o=n.default.instance.wp_data.json,a=e+"_"+t,i=o[a];return null==i&&(0==this.wp_max_count[e]&&(this.wp_max_count[e]=t-1),i=o[a=e+"_"+this.wp_max_count[e]]),i},getEnemyInfo:function(e){var t=s.default.instance.enemyInfo.json,o={HP:0,reward_type:1,reward_numb:0},i=(n.default.instance.gameLevel,"11");return null!=t[i=e<a.EnemyType.boss_0?String(n.default.instance.gameLevel+1)+String(e+1):String(n.default.instance.gameLevel+1)+String(4)].HP&&(o.HP=t[i].HP),null!=t[i].reward_numb&&(o.reward_numb=t[i].reward_numb),null!=t[i].reward&&(o.reward_type=t[i].reward),o},lookInWindow:function(e,t){void 0===t&&(t=1),t-=1;r.default.instance.node.x,i.default.instance.windowSize.width;var o=i.default.instance.windowSize.width-r.STOP_SP.x+r.default.instance.node.x+t*i.default.instance.windowSize.width,n=-r.STOP_SP.x+r.default.instance.node.x;return o>e.x&&n<e.x},getBoxCount:function(t){return e.randRange(2,4)},getDir:function(t){var o=t.getWorldManifold().normal;return o.y>0&&o.x<0?e.Game.dir.right_down:o.y>0&&o.x>0?e.Game.dir.left_down:o.y>0?e.Game.dir.down:o.y<0?e.Game.dir.up:o.x<0?e.Game.dir.right:o.x>0?e.Game.dir.left:void 0},getGameResId:function(e){return e%2},getSysTime:function(){var e=new Date;return Math.floor(e.getTime()/1e3)},turnTime:function(e){var t=String(Math.floor(e/3600)),o=String(Math.floor(e%3600/60)>=10?Math.floor(e%3600/60):"0"+Math.floor(e%3600/60)),n=String(Math.floor(e%3600%60)>=10?Math.floor(e%3600%60):"0"+Math.floor(e%3600%60));return(t="0"!=t?t+":":"")+(o="0"!=o?o+":":"")+(n=""!=n?n:"")},getOrigUnlookTime:function(e){switch(e){case 0:return 60;case 1:return 1800;case 2:return 10800;case 3:return 21600}},getNeedCoin:function(e){switch(e){case 0:return 500;case 1:return 1500;case 2:return 3e3;case 3:return 6e3}},getAwardIndex:function(e){var t=Math.random();console.log("\u6982\u7387\u503c"+t);var o=0,n=0;for(var a in e)if(Number(a)!=e.length-1){if(n=e[a].probability+n,t>=o&&t<n)return Number(a);o=n}return null},levelDif:255,getLevelDif:function(){if(255==e.Game.levelDif){var t=cc.sys.localStorage.getItem("distanceArr"),o=0,n=(t=""==t||null==t?[0,0,0,0,0]:JSON.parse(t)).length;for(var a in t){o+=t[a]}var i=o/n;e.Game.levelDif=i<70?0:i>=70&&i<200?1:i>=200&&i<400?2:3}return e.Game.levelDif},setDistance:function(t){e.Game.levelDif=255;var o=cc.sys.localStorage.getItem("distanceIndex");o=Number(o);var n=cc.sys.localStorage.getItem("distanceArr");(n=""==n||null==n?[0,0,0,0,0]:JSON.parse(n))[o]=t;var a=JSON.stringify(n);cc.sys.localStorage.setItem("distanceArr",a),o=(o+1)%n.length,cc.sys.localStorage.setItem("distanceIndex",o)},fArr:function(e,t){for(var o=e.length-1;o>=0;o--){var n=e[o];t&&t(n)}},getData:function(e,t,o){var n=cc.sys.localStorage.getItem(e),a=Number(cc.sys.localStorage.getItem(e+"clean"));return""==n||null==n||a!=o?(cc.sys.localStorage.setItem(e+"clean",o),cc.sys.localStorage.setItem(e,t),JSON.parse(t)):JSON.parse(n)},setData:function(e,t){cc.sys.localStorage.setItem(e,t)},getObjectLen:function(e){var t=0;for(var o in e)t++;return t},GResF:[],GResP:[{name:"map/award_box_",count:4},{name:"map/award_box_open_",count:4},{name:"fight/hero/hero_",count:12},{name:"fight/hero/weapon_",count:15},{name:"WeaponLayer/ui_wp_btn",count:11},{name:"WeaponLayer/ui_weapon_",count:11},{name:"fight/enemy/enemy_",count:1},{name:"fight/pet/pet_",count:9},{name:"map/cloud_",count:3},{name:"fight/enemy/weapon_",count:4},{name:"fight/enemy/hat_",count:5},{name:"fight/enemy/boos_",count:5},{name:"fight/towerWp/towerWp_",count:3}],GResType:{Box:0,OpenBox:1,Hero:2,Weapon:3,WeaponTag:4,WeaponBg:5,Enemy:6,Pet:7,Cloud:8,EnemyWp:9,EnemyHat:10,Boss:11,tower:12},loadGRes:function(){this.GResF=[];var e=function(e){for(var o=t.GResP[e].count,n=[],a=function(o){var a=t.GResP[e].name+String(o);cc.loader.loadRes(a,cc.SpriteFrame,function(e,t){if(!e){var a={key:o,value:t};n.push(a)}}),t.GResF[e]=n},i=0;i<o;++i)a(i)},t=this;for(var o in this.GResP)e(o)},getGRes:function(e,t){var o=this.GResF[e];for(var n in o){var a=o[n];if(a.key==t)return a.value}},vibrate:!0,vibrateShort:function(){e.Game.vibrate&&wx.vibrateShort()},vibrateLong:function(){e.Game.vibrate&&wx.vibrateLong()},getShareCountCom:function(){var e=(new Date).getDate(),t=d.default.readNum("lastDateShareCount");return e!=Number(t)&&d.default.writeNum("shareCountCom",0),cc.sys.localStorage.setItem("lastDateShareCount",e),d.default.readNum("shareCountCom")},addShareCountCom:function(){var e=d.default.readNum("shareCountCom");e++,d.default.writeNum("shareCountCom",e)},needShareToGame:2,getGameCount:function(){var e=(new Date).getDate(),t=d.default.readNum("lastDateGameCount");return e!=Number(t)&&d.default.writeNum("gameCount",0),cc.sys.localStorage.setItem("lastDateGameCount",e),d.default.readNum("gameCount")},addGameCount:function(){var e=d.default.readNum("gameCount");e++,d.default.writeNum("gameCount",e)},shareData:[],requestShareData:function(){c.default.getShareTitle(function(t){var o=JSON.parse(t),n=JSON.parse(o.res);e.Game.shareData=n.share;l.default.showForward(function(){var t=e.randRange(0,e.Game.shareData.length-1),o=JSON.parse(e.Game.shareData[t]);return{title:o.title,imageUrl:"https://huandong-1257458597.cos.ap-guangzhou.myqcloud.com/HeadStrong/share/"+o.img,query:"xx"}})},function(){})}},e.AwardType={coin:1,crown:2,hat:3},e.GlobalData={trialId:null,trialCount:null,trialClose:!1,petTrialClose:!1,addAwardShared:1,openSudokuCount:4,novice:1},e.appid="wxeb30ab498a079095",e.appVersion="1.6.7",e.Report={trialLayer:"\u89d2\u8272\u8bd5\u7528\u9875\u9762\u89e6\u53d1",trialShare:"\u89d2\u8272\u8bd5\u7528\u5206\u4eab\u70b9\u51fb",trialVideo:"\u89d2\u8272\u8bd5\u7528\u89c6\u9891\u70b9\u51fb",petTrialLayer:"\u968f\u4ece\u8bd5\u7528\u9875\u9762\u89e6\u53d1",petTrialShare:"\u968f\u4ece\u8bd5\u7528\u5206\u4eab\u70b9\u51fb",petTrialVideo:"\u968f\u4ece\u8bd5\u7528\u89c6\u9891\u70b9\u51fb",endLayer_0:"\u7ed3\u675f\u590d\u6d3b\u9875\u9762",endLayer_0_Share:"\u7ed3\u675f\u590d\u6d3b\u9875\u9762\u5206\u4eab\u6b21\u6570",endLayer_0_Video:"\u7ed3\u675f\u590d\u6d3b\u9875\u9762\u89c6\u9891\u6b21\u6570",endLayer_0_Crown:"\u7ed3\u675f\u590d\u6d3b\u9875\u9762\u738b\u51a0\u6b21\u6570",endLayer_1:"\u7ed3\u675f\u91d1\u5e01\u9886\u53d6\u9875\u9762",endLayer_1_Video:"\u7ed3\u675f\u91d1\u5e01\u9886\u53d6\u9875\u9762\u89c6\u9891\u6b21\u6570",tipWindow:"\u91d1\u5e01\u7687\u51a0\u4e0d\u8db3\u9875\u9762",tipWindow_Video:"\u91d1\u5e01\u7687\u51a0\u4e0d\u8db3\u89c6\u9891\u70b9\u51fb\u6b21\u6570",endLayer_2:"\u7ed3\u675f\u5173\u95ed\u9875\u9762",endLayer_2_Share:"\u7ed3\u675f\u5173\u95ed\u5206\u4eab\u6b21\u6570",LoadLayer_Share:"\u5927\u5385\u5206\u4eab\u6b21\u6570",LoadLayer_Video:"\u5927\u5385\u89c6\u9891\u6b21\u6570",HellScene:"\u5730\u72f1\u8fdb\u5165\u6b21\u6570",signLayer:"\u53cc\u500d\u7b7e\u5230\u9875\u9762",signBtn:"\u53cc\u500d\u7b7e\u5230\u6309\u94ae\u70b9\u51fb",dial:"\u8f6c\u76d8\u9875\u9762",dialShare:"\u8f6c\u76d8\u5206\u4eab\u70b9\u51fb",dialVideo:"\u8f6c\u76d8\u89c6\u9891\u70b9\u51fb",dialDouble:"\u8f6c\u76d8\u53cc\u500d\u9875\u9762",dialDoubleShare:"\u8f6c\u76d8\u53cc\u500d\u5206\u4eab\u70b9\u51fb",dialDoubleVideo:"\u8f6c\u76d8\u53cc\u500d\u89c6\u9891\u70b9\u51fb",distance_1:"1-25\u7c73",distance_2:"26-60\u7c73",distance_3:"61-120\u7c73",distance_4:"121-220\u7c73",distance_5:"221-320\u7c73",distance_6:"321-420\u7c73",distance_7:"401-520\u7c73",distance_8:"521\u4ee5\u4e0a",newCount:"\u65b0\u7528\u6237\u4eba\u5747\u5c40\u6570",oldCount:"\u8001\u7528\u6237\u4eba\u5747\u5c40\u6570",dieWind:"\u6b7b\u4e8e\u98ce\u8f66",boxLayer:"\u5b9d\u7bb1\u89e3\u9501\u5e95\u90e8\u5f39\u7a97",boxLayerUnlook:"\u89c6\u9891\u89e3\u9501\u5b9d\u7bb1",boxLayerCold:"\u89c6\u9891\u8df3\u8fc7\u5b9d\u7bb1",rankClick:"\u6392\u884c\u699c\u70b9\u51fb",aceClick:"\u738b\u724c\u8bd5\u7528",newPet:"\u65b0\u5ba0\u7269\u8bd5\u7528"},e.aladinType={toLoad_2:1,toLoad_4:2,toLoad_6:3,toLoad_8:4,toLoad_10:5,toWxLogin:6,toGame:7,toNovice:8},e.BannerId=["adunit-b2823612aafbf6c2","adunit-9a14e4d1bb90c7fa","adunit-13d03b752286a297"],e.PreBannerId=["adunit-dee648f9701b6605"],e.showBanner={endLayer_1:{time:1,run:!1},endLayer_2:{time:1,run:!1},trialHero:{time:1,run:!1},trialPet:{time:1,run:!1}},e.runSchedulBanner=!0,e.delayTime=.3,e.maxTime=2,e.startBanner=function(e){e.time=0,e.run=!0},e.stopBanner=function(e){e.run=!1},e.stopAllBanner=function(){for(var t in e.showBanner){e.showBanner[t].run=!1}},e.VideoId={boxAward:"adunit-1fd8f2da55b7e8c2",crown_lack:"adunit-079d90649b021388",coin_lack:"adunit-a5ac8a83b15224bb",end_coin_double:"adunit-63cbd9ea13e4d6e7",unLookBox:"adunit-e295a19f081f5bed",end_resurgence:"adunit-1832b99ecbfc0b18",trialHero:"adunit-3faed066423da868"},e.bannerAd=null,e.portalAd=null,e}();o.G=u,cc._RF.pop()},{"../SDK/aladinSDK":"AladinSDK","../game_logic":"game_logic","../util/network/http_req":"http_req","./../UI/enemy":"enemy","./../UI/hero":"hero","./../game_scene":"game_scene","./../util/wx_util":"wx_util","./Storage":"storage"}],guide:[function(e,t,o){"use strict";cc._RF.push(t,"c10b9o/wpFJeLhVVTv3wpjV","guide"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("../../util/global_def"),i=e("../../util/storage"),r=cc._decorator,s=r.ccclass,c=r.property;(function(e){e[e.kEnd=0]="kEnd"})(n=o.GuideType||(o.GuideType={}));var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bg_=null,t.finger_=null,t.txt_=null,t.guide_=null,t.desc_=null,t.txtBg_=null,t.skip_=null,t.descCpy_=null,t.guideOrder_=[],t.dialogIdx_=0,t.openGuide_=1,t.waitingTimes_=0,t.currGuide_=n.kEnd,t.bPause_=!1,t.bPend_=!1,t}var o;return __extends(t,e),o=t,t.prototype.onLoad=function(){o.instance=this,this.readData(),this.node.active=!1,this.skip_.active=!1},t.prototype.onScreenTouch=function(){},t.prototype.disableOpenGuide=function(){this.openGuide_=0},t.prototype.isOpenGuide=function(){return 1==this.openGuide_},t.prototype.isGuidePause=function(){return this.bPause_},t.prototype.setGuidePause=function(e){this.bPause_=e},t.prototype.isGuidePend=function(){return this.bPend_},t.prototype.setGuidePend=function(e){this.bPend_=e},t.prototype.guideType=function(){return this.currGuide_},t.prototype.setGuideType=function(e){this.currGuide_=e},t.prototype.wait=function(){var e=!1;return--this.waitingTimes_,this.waitingTimes_<=0&&(e=!0,this.waitingTimes_=0),e},t.prototype.excuteGuide=function(e){if(this.node.active=!0,a.G.isEmptyObj(this.descCpy_)){var t=cc.instantiate(this.desc_.node);this.descCpy_=t.getComponent(cc.RichText),this.node.addChild(t)}},t.prototype.saveData=function(){for(var e={openGuide:this.openGuide_,order:[]},t=0;t<this.guideOrder_.length;++t)e.order[t]=this.guideOrder_[t];i.default.writeJSON(i.SaveDef.kGuide,e)},t.prototype.readData=function(){var e=i.default.readJSON(i.SaveDef.kGuide);if(a.G.isExistObj(e)){if(this.openGuide_=e.openGuide,e.order)for(var t=0;t<e.order.length;++t)this.guideOrder_[t]=e.order[t]}else{this.openGuide_=1;for(t=0;t<n.kEnd;++t)this.guideOrder_[t]=1;this.saveData()}},t.prototype.resetDescCpy=function(){a.G.isExistObj(this.descCpy_)&&(this.descCpy_.node.opacity=255,this.descCpy_.node.y=this.desc_.node.y,this.descCpy_.node.active=!1,this.descCpy_.string=this.desc_.string)},t.prototype.descMoveAct=function(e){this.descCpy_.node.stopAllActions();var t=cc.delayTime(.4),o=cc.moveTo(.2,cc.v2(this.descCpy_.node.x,this.descCpy_.node.y+this.desc_.lineHeight)),n=cc.fadeOut(.2),a=cc.spawn(o,n);this.descCpy_.node.active=!0,this.descCpy_.node.runAction(cc.sequence(t,a,e)),this.desc_.node.active=!1},t.prototype.bubbleText=function(e){this.txt_.string=e,this.txtBg_.width=this.txt_.node.width+10,this.txtBg_.height=this.txt_.node.height+5},t.instance=null,__decorate([c(cc.Node)],t.prototype,"bg_",void 0),__decorate([c(cc.Node)],t.prototype,"finger_",void 0),__decorate([c(cc.Label)],t.prototype,"txt_",void 0),__decorate([c(cc.Node)],t.prototype,"guide_",void 0),__decorate([c(cc.RichText)],t.prototype,"desc_",void 0),__decorate([c(cc.Node)],t.prototype,"txtBg_",void 0),__decorate([c(cc.Node)],t.prototype,"skip_",void 0),t=o=__decorate([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../../util/global_def":"global_def","../../util/storage":"storage"}],hatMenu:[function(e,t,o){"use strict";cc._RF.push(t,"3cf75cd/SlB3Z9K2djIFISR","hatMenu"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../game_scene"),a=e("./../UI/hero"),i=e(".././game_logic"),r=e("./../util/global_def"),s=[1,0,0,0,0,0,0,0,0,0,0,0,0],c=cc._decorator,l=c.ccclass,d=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hatMenuContent=null,t.hatScrollView=null,t.helmet=null,t.hatMenu=null,t.btnMenu=null,t.closeBtn=null,t.wpLayer=null,t.nameLabe=null,t.hatInfo=[],t}return __extends(t,e),t.prototype.onLoad=function(){this.getData()},t.prototype.initHatMenu=function(e){void 0===e&&(e=0),this.hatScrollView.scrollToOffset(cc.v2(0,0));for(var t=this.getData(),o=0;o<r.G.Game.hatCount;++o){var n=cc.instantiate(this.helmet);n.getComponent("helmet").init(e,this);var i=t[o];n.getComponent("helmet").setUnlook(i),e=++e%5,this.hatMenuContent.addChild(n);var s=cc.sys.localStorage.getItem("lastHeroId");(s=Number(s))==o&&(this.showWeapon(s),a.default.instance.init(s))}var c=new cc.Node;c.anchorY=0;var l=c.addComponent(cc.Label);l.string="\u656c\u8bf7\u671f\u5f85...",l.fontSize=35,this.hatMenuContent.addChild(c)},t.prototype.showWeapon=function(e){var t=r.G.Game.hero_weapon[e];this.wpLayer.removeAllChildren();for(var o in t){var n=t[o],a=new cc.Node;a.addComponent(cc.Sprite).spriteFrame=r.G.Game.getGRes(r.G.Game.GResType.WeaponBg,n),a.setContentSize(100,100),this.wpLayer.addChild(a)}this.nameLabe.string=r.G.Game.hero_name[e]},t.prototype.open=function(){i.default.instance.gameState=i.GameState.gameSelect,n.default.instance.hatBtn.getComponent("ui_motion").triggerMotion(),this.hatMenu.getComponent("ui_motion").triggerMotion(),n.default.instance.setLens(1.5,cc.v2(-3,-2)),this.initHatMenu(0),n.default.instance.clickBegin.active=!1,n.default.instance.closeBoxLayer()},t.prototype.close=function(){var e=this;i.default.instance.gameState=i.GameState.gameStart;var t=cc.sys.localStorage.getItem("lastHeroId");t=Number(t),a.default.instance.init(t),this.closeBtn.getComponent("ui_motion").triggerMotion(function(){e.hatMenuContent.removeAllChildren()}),this.btnMenu.getComponent("ui_motion").triggerMotion(),n.default.instance.setLens(1,cc.v2(3,2)),n.default.instance.clickBegin.active=!0,n.default.instance.openBoxLayer()},t.prototype.select=function(){var e=this;i.default.instance.gameState=i.GameState.gameStart,this.closeBtn.getComponent("ui_motion").triggerMotion(function(){e.hatMenuContent.removeAllChildren()}),this.btnMenu.getComponent("ui_motion").triggerMotion(),n.default.instance.setLens(1,cc.v2(3,2)),n.default.instance.clickBegin.active=!0,n.default.instance.openBoxLayer(),cc.sys.localStorage.setItem("lastHeroId",a.default.instance.id)},t.prototype.getData=function(){var e=cc.sys.localStorage.getItem("hatInfo");return""!=e&&null!=e||(e=JSON.stringify(s),cc.sys.localStorage.setItem("hatInfo",e)),this.hatInfo=JSON.parse(e),this.hatInfo},t.prototype.setData=function(e,t){this.hatInfo[e]=t;var o=JSON.stringify(this.hatInfo);cc.sys.localStorage.setItem("hatInfo",o)},__decorate([d(cc.Node)],t.prototype,"hatMenuContent",void 0),__decorate([d(cc.ScrollView)],t.prototype,"hatScrollView",void 0),__decorate([d(cc.Prefab)],t.prototype,"helmet",void 0),__decorate([d(cc.Node)],t.prototype,"hatMenu",void 0),__decorate([d(cc.Node)],t.prototype,"btnMenu",void 0),__decorate([d(cc.Node)],t.prototype,"closeBtn",void 0),__decorate([d(cc.Node)],t.prototype,"wpLayer",void 0),__decorate([d(cc.Label)],t.prototype,"nameLabe",void 0),t=__decorate([l],t)}(cc.Component);o.default=h,cc._RF.pop()},{".././game_logic":"game_logic","../game_scene":"game_scene","./../UI/hero":"hero","./../util/global_def":"global_def"}],hd_map:[function(e,t,o){"use strict";cc._RF.push(t,"e17d6ZBj7xNj4AzlW/zgzfH","hd_map"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.keys_=null,this.values_=null,this.keys_=new Array,this.values_=new Object}return e.prototype.toString=function(){for(var e="{ ",t=0,o=this.keys_.length;t<o;++t,e+=", "){var n=this.keys_[t];e+=n+" = "+this.values_[n]}return e=e.substring(0,e.length-1),e+=" }"},e.prototype.size=function(){return this.keys_.length},e.prototype.put=function(e,t){var o=e.toString();null==this.values_[o]?(this.values_[o]=t,this.keys_.push(o)):this.values_[o]=t},e.prototype.get=function(e){var t=e.toString();return this.values_[t]},e.prototype.remove=function(e){var t=e.toString(),o=this.indexOf(t);-1!=o&&this.keys_.splice(o,1),this.values_[t]=null},e.prototype.clear=function(){for(var e=0,t=this.keys_.length;e<t;++e)this.values_[this.keys_[e]]=null;this.keys_=[]},e.prototype.containsKey=function(e){var t=e.toString();return null!=this.values_[t]},e.prototype.isEmpty=function(){return 0===this.keys_.length},e.prototype.each=function(e){if(e)for(var t=0;t<this.keys_.length;++t){var o=this.keys_[t];e(t,o,this.values_[o])}},e.prototype.indexOf=function(e){var t=-1,o=this.size();if(o>0)for(var n=e.toString(),a=0,i=o;a<i;++a)if(this.keys_[a]==n){t=a;break}return t},e.prototype.values=function(){for(var e=new Array,t=0;t<this.keys_.length;++t)e.push(this.values_[this.keys_[t]]);return e},e}();o.default=n,cc._RF.pop()},{}],hell_scene:[function(e,t,o){"use strict";cc._RF.push(t,"01fe6U2/SlEKZCuhGNExTa0","hell_scene"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./game"),a=e("./util/global_def"),i=e("./game_scene"),r=e("./UI/hero"),s=e("./game_logic"),c=e("./UI/door"),l=e("./UI/enemy"),d=e("./util/event_mgr"),h=e("./UI/bridge"),u=e("./UI/box"),p=cc._decorator,f=p.ccclass,m=p.property,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.enemyManager=[],t.upRoadManager=[],t.upRoadPool=null,t.enterDis=0,t.mapDis=40,t.roadF=[],t.upRoadF=[],t.magma_bg_f=null,t.magma_node=null,t.magmaPool=null,t.magma_manager=[],t.brick=null,t.brickPool=null,t.brickManager=[],t.brickExplode=null,t.brickExplodePool=null,t.entranceData=null,t.exportData=null,t.mapData=null,t.isAddExitDoor=!1,t.stopCreateRoad=!1,t.lastMagmaPos=cc.v2(0,0),t.lastUpRoadPos=0,t.road_min_dis=100,t.road_max_dis=200,t.createEndRoad=!1,t.subRoad=0,t.ground_offset=[],t.gr_c=0,t.stopLastData=null,t.lastIndex=0,t}return __extends(t,e),t.prototype.startFallCheck=function(){var e=this;this.schedule(function(){if(null!=i.default.instance.hero&&!(e.roadManager.length<=0||s.default.instance.gameState!=s.GameState.gamePlay&&s.default.instance.gameState!=s.GameState.gameNovice)){for(var t=1e4,o=null,n=new cc.Rect,a=0;a<e.roadManager.length;++a){var c=e.roadManager[a],l=c.x-c.width/2-i.default.instance.hero.x;l>0&&l<t&&(t=l,o=c);i.default.instance.hero.x,i.default.instance.hero.width;null!=o&&(n=o.getComponent(cc.PhysicsBoxCollider))}if(null!=o){var d=o.y+o.height/2-n.size.height-i.default.instance.hero.height-50;i.default.instance.hero.y<d&&i.default.instance.hero.getComponent("hero").die(r.DieType.fall)}}},.5)},t.prototype.initNodeManger=function(){this.funs.push(this.startRoadManager.bind(this)),this.funs.push(this.startEnemyManager.bind(this)),this.funs.push(this.startUpRoadManager.bind(this)),this.funs.push(this.startMagmaNodeManager.bind(this)),this.funs.push(this.startBrickManager.bind(this))},t.prototype.startBrickManager=function(){var e=this;a.G.Game.fArr(this.brickManager,function(t){t.x+i.default.instance.windowSize.width/2+t.width/2<i.default.instance.mapCamera.x&&(e.brickPool.put(t),a.G.Game.rmFromArray(t,e.brickManager))})},t.prototype.startEnemyManager=function(){var e=this;a.G.Game.fArr(this.enemyManager,function(t){if(t.x+i.default.instance.windowSize.width/2+t.width/2<i.default.instance.mapCamera.x){t.getComponent("enemy").id;t.getComponent("enemy").info.HP>0&&t.y<-2e3&&s.default.instance.eventManager.addEvent(d.EventType.KTaskPush,e,{}),t.getComponent("enemy").clean(),i.default.instance.enemyPool.put(t),a.G.Game.rmFromArray(t,e.enemyManager)}})},t.prototype.startRoadManager=function(){var e=this;if(0==this.roadF.length)return 0;for(a.G.Game.fArr(this.roadManager,function(t){t.x+t.width/2+i.default.instance.windowSize.width/2+300<i.default.instance.mapCamera.x&&(i.default.instance.roadPool.put(t),a.G.Game.rmFromArray(t,e.roadManager))}),this.subRoad=a.G.Game.max_road_num-this.roadManager.length;this.subRoad>0&&0==this.stopCreateRoad;)this.createRoad();console.log("\u5730\u72f1\u9053\u8def\u6570\u91cf"+this.roadManager.length)},t.prototype.startUpRoadManager=function(){var e=this;if(0!=this.upRoadPool.size()){a.G.Game.fArr(this.upRoadManager,function(t){t.x+t.width/2+i.default.instance.windowSize.width/2+300<i.default.instance.mapCamera.x&&(e.upRoadPool.put(t),a.G.Game.rmFromArray(t,e.upRoadManager))});for(var t=10-this.upRoadManager.length;t>0;){t-=this.createUpRoad()}}},t.prototype.startMagmaNodeManager=function(){var e=this;a.G.Game.fArr(this.magma_manager,function(t){t.x+t.width/2+i.default.instance.windowSize.width/2+300<i.default.instance.mapCamera.x&&(e.magmaPool.put(t),a.G.Game.rmFromArray(t,e.magma_manager))});for(var t=7-this.magma_manager.length;t>0;){t-=this.createMagmaNode()}},t.prototype.createMagmaNode=function(){var e=this.getMagma(),t=a.G.randRange(0,1);return e.getComponent("magma_node").run(t),e.x=this.lastMagmaPos.x+a.G.randRange(300,800),e.y=i.default.instance.mapCamera.y+a.G.randRange(200,400),this.lastMagmaPos.x=e.x+e.width,this.node.addChild(e,2e3),1},t.prototype.createUpRoad=function(){var e=this.getUpRoad();e.setPosition(this.lastUpRoadPos,i.default.instance.windowSize.height/2);var t=a.G.randRange(20,50);return this.lastUpRoadPos+=e.width-t,this.node.addChild(e),1},t.prototype.loadRes=function(){var e=this;if(null==this.node.getChildByName("magma_bg")){var t=new cc.Node;t.opacity=240,t.group="layer",this.node.addChild(t,1e4,"magma_bg"),t.anchorY=0,t.setPosition(0,-640);var o=t.addComponent(cc.Sprite);o.type=cc.Sprite.Type.SLICED,o.sizeMode=cc.Sprite.SizeMode.CUSTOM,t.width=750,t.height=283,o.spriteFrame=this.magma_bg_f}cc.loader.loadResDir("map/road/road_hell",function(t,o){if(null==t){for(var n in o)if(o[n]instanceof cc.SpriteFrame){var a=o[n].name,r=a.indexOf("r"),s=a.indexOf("u");0==r?e.roadF.push(o[n]):0==s&&e.upRoadF.push(o[n])}i.default.instance.sortRes(e.roadF),i.default.instance.sortRes(e.upRoadF),e.initUpRoad()}}),this.initPool(),this.loadMapData()},t.prototype.loadMapData=function(){var e=this;if(null==this.mapData){this.mapData=[];cc.loader.loadResDir("data/round/hell/com",function(t,o){if(null==t)for(var n in o){var a=o[n];e.mapData.push(a)}})}},t.prototype.initPool=function(){this.initMagmaNodePool(),this.initBrickPool(),this.initBrickExplodePool(),this.startFallCheck()},t.prototype.createRoad=function(){if(i.default.instance.distance-this.enterDis>=this.mapDis&&0==this.isAddExitDoor){if(null!=this.stopLastData)return void this.createRoundByData(this.stopLastData);var e=this.exportData.json;this.createRoundByData(e),this.createEndRoad=!0}else{if(this.first){if(null!=this.stopLastData)return void this.createRoundByData(this.stopLastData);e=this.entranceData.json;return this.createRoundByData(e),e.length}if(0!=this.road_range_count)this.createRandMap();else{if(null!=this.stopLastData)return void this.createRoundByData(this.stopLastData);var t=a.G.randRange(0,this.mapData.length-1);e=this.mapData[t].json;this.createRoundByData(e)}}},t.prototype.createRandMap=function(){this.subRoad-=1;var e=i.default.instance.getRoad();i.default.instance.cleanRoad(e);var t=this.roadF.length,o=a.G.randRange(0,t-1),n=Math.random()>.9,r=e.width/2+a.G.randRange(this.road_min_dis,this.road_max_dis);Math.random()>.7&&(r=e.width/2,n=!1);var s=this.roadF[o];e.getComponent("road").setDataEx(s,n);var c=i.default.instance.lastRoadPos.x+r,l=i.default.instance.lastRoadPos.y-e.height/2;e.setPosition(cc.v2(c,l)),e.getComponent("road").startFloat(),0==this.first&&Math.random()>0&&this.addBrickToRoad(e,a.G.randRange(1,4)),this.first=!1,i.default.instance.lastRoadPos.x=e.x+e.width/2,i.default.instance.lastRoadPos.y=e.y+e.height/2,this.node.addChild(e),this.roadManager.push(e)},t.prototype.createRoundByData=function(e){i.default.instance.dealMapData(e);var t=null;for(this.lastIndex;this.lastIndex<e.length;this.lastIndex++){if(this.subRoad<=0)return void(this.stopLastData=e);var o=e[this.lastIndex],n=null;if(o.id==a.G.Game.BRIDGE_ID){var r=new h.bridge,s=1==o.vertical?1:0;if(r.create(o.creatnumber,s),n=r,r.setPosition(o.x,o.y),null==this.ground_offset[this.gr_c]){var l=cc.v2(0,i.default.instance.lastRoadPos.y-r.height/2-o.y);this.ground_offset[this.gr_c]=l}}else{n=i.default.instance.getRoad(),i.default.instance.cleanRoad(n);this.roadF.length;var d=o.id,p=this.roadF[d];if(n.getComponent("road").setDataEx(p,o.dou),n.getComponent("road").startFloat(),null==t)t=o.y+n.height/2;else{var f=o.y+n.height/2;Math.abs(f-t)<10&&(o.y+=t-f)}if(n.setPosition(o.x,o.y),null==this.ground_offset[this.gr_c]){l=cc.v2(n.width/2,i.default.instance.lastRoadPos.y-n.height/2-o.y);this.ground_offset[this.gr_c]=l}this.roadManager.push(n)}n.x+=i.default.instance.lastRoadPos.x+this.ground_offset[this.gr_c].x,n.y+=this.ground_offset[this.gr_c].y,this.node.addChild(n);for(var m in o.chest){var _=o.chest[m].pos;i.default.instance.addBoxToRoad(u.BoxType.weapon,n,_)}if(0==this.first&&Math.random()>0&&this.addBrickToRoad(n,a.G.randRange(1,4)),this.subRoad-=1,this.lastIndex==e.length-1){o.id==a.G.Game.BRIDGE_ID?(i.default.instance.lastRoadPos.x=n.x+n.width,i.default.instance.lastRoadPos.y=n.y+n.height/2):(i.default.instance.lastRoadPos.x=n.x+n.width/2,i.default.instance.lastRoadPos.y=n.y+n.height/2),this.first&&(this.first=!1),this.createEndRoad&&(this.stopCreateRoad=!0,this.createEndRoad=!1,this.isAddExitDoor=!1,i.default.instance.addDoorToRoad(n,c.doorState.to_open,i.SceneType.hell,i.SceneType.main)),this.lastIndex=0,this.stopLastData=null,this.road_range_count=a.G.randRange(2,4);break}}this.gr_c++},t.prototype.addEnemyToRoad=function(e,t,o){if(void 0===t&&(t=!1),t)for(var n in o){if(o[n].id>a.G.Game.enemy_max_id)break;(u=i.default.instance.getEnemy()).getComponent("enemy").init(o[n].id);var r=o[n].pos.x+e.x,s=e.y+e.height/2+10;u.setPosition(r,s),this.node.addChild(u,1e3),0==Number(n)&&Math.random()>0&&u.getComponent("enemy").talk(0),this.enemyManager.push(u)}else{var c=cc.v2(e.x-e.width/2+a.G.randRange(50,120),e.y+e.height/2+10),d=1,h=Math.random();if(h>0&&h<.65){l.EnemyType.enemy_0;d=2}else if(h>=.65&&h<.9){l.EnemyType.enemy_1;d=1}else{l.EnemyType.enemy_2;d=1}for(n=0;n<d;++n){var u;(u=i.default.instance.getEnemy()).getComponent("enemy").init(0),u.setPosition(c),this.node.addChild(u,1e3),0==Number(n)&&Math.random()>0&&u.getComponent("enemy").talk(0),this.enemyManager.push(u),c.x+=u.width+5}}},t.prototype.addBrickToRoad=function(e,t){void 0===t&&(t=4);for(var o=e.x+a.G.randRange(-e.width/2+60,e.width/2-60),n=0;n<t;++n){var i=this.getBrick(),r=e.y+e.height/2+n%2*51;i.setPosition(o+63*Math.floor(n/2),r),this.node.addChild(i)}},t.prototype.showDoorAni=function(){a.G.reportToAld(a.G.Report.HellScene),s.default.instance.report(s.default.instance.rType.hellScene,1);var e=this.roadManager[0];i.default.instance.addDoorToRoad(e,c.doorState.open,i.SceneType.hell,i.SceneType.main);var t=cc.instantiate(i.default.instance.resurgAni),o=cc.v2(0,e.height/2);t.setPosition(o),t.getComponent("resurgAni").run(r.default.instance.id,function(){r.default.instance.node.removeFromParent(!1),r.default.instance.node.y=e.y+e.height/2+10,r.default.instance.node.x=e.x,r.default.instance.hero_pause=!1,r.default.instance.node.active=!0;var t=cc.v2(0,0);r.default.instance.rigidBody.linearVelocity=t,i.default.instance.playScene.addChild(r.default.instance.node)},0),e.addChild(t)},t.prototype.initUpRoad=function(){var e=this.upRoadF.length;this.upRoadPool=new cc.NodePool;for(var t=0;t<2;++t)for(var o=0;o<e;++o){var n=new cc.Node;n.setAnchorPoint(0,1),n.addComponent(cc.Sprite).spriteFrame=this.upRoadF[o],this.upRoadPool.put(n)}},t.prototype.initMagmaNodePool=function(){this.magmaPool=new cc.NodePool;for(var e=0;e<10;++e){var t=cc.instantiate(this.magma_node);t.setPosition(0,0),t.getComponent("magma_node").init(),this.magmaPool.put(t)}},t.prototype.initBrickPool=function(){this.brickPool=new cc.NodePool;for(var e=0;e<10;++e){var t=cc.instantiate(this.brick);this.brickPool.put(t)}},t.prototype.getBrick=function(){var e=this.brickPool.get();return null==e&&(e=cc.instantiate(this.brick)),this.brickManager.push(e),e},t.prototype.initBrickExplodePool=function(){this.brickExplodePool=new cc.NodePool;for(var e=0;e<10;++e){var t=cc.instantiate(this.brickExplode);t.getComponent("brickExplode").init(),this.brickExplodePool.put(t)}},t.prototype.getBrickExplode=function(){var e=this.brickExplodePool.get();return null==e&&(e=cc.instantiate(this.brickExplode)).getComponent("brickExplode").init(),e},t.prototype.getMagma=function(){var e=this.magmaPool.get();return null==e&&((e=cc.instantiate(this.magma_node)).setPosition(0,0),e.getComponent("magma_node").init()),this.magma_manager.push(e),e},t.prototype.getUpRoad=function(){var e=this.upRoadPool.get();if(null==e){var t=(e=new cc.Node).addComponent(cc.Sprite),o=this.upRoadF.length,n=a.G.randRange(0,o-1);t.spriteFrame=this.upRoadF[n]}return e.group="vision",this.upRoadManager.push(e),e},t.prototype.cleanAllUp=function(){var e=this;this.isAddExitDoor=!1,this.createEndRoad=!1,this.stopCreateRoad=!1,a.G.Game.fArr(this.roadManager,function(t){i.default.instance.roadPool.put(t),a.G.Game.rmFromArray(t,e.roadManager)}),a.G.Game.fArr(this.magma_manager,function(t){e.magmaPool.put(t),a.G.Game.rmFromArray(t,e.magma_manager)}),a.G.Game.fArr(this.upRoadManager,function(t){e.upRoadPool.put(t),a.G.Game.rmFromArray(t,e.upRoadManager)})},t.prototype.init=function(){this.type=i.SceneType.hell,this.enterDis=i.default.instance.distance,this.lastMagmaPos.x=i.default.instance.lastRoadPos.x+200},t.prototype.cleanRoadGameItem=function(e){var t=this,o=e.x+e.width/2,n=e.x-e.width/2;a.G.Game.fArr(this.brickManager,function(e){e.x<o&&e.x>n&&(t.brickPool.put(e),a.G.Game.rmFromArray(e,t.brickManager))})},__decorate([m(cc.SpriteFrame)],t.prototype,"magma_bg_f",void 0),__decorate([m(cc.Prefab)],t.prototype,"magma_node",void 0),__decorate([m(cc.Prefab)],t.prototype,"brick",void 0),__decorate([m(cc.Prefab)],t.prototype,"brickExplode",void 0),__decorate([m(cc.JsonAsset)],t.prototype,"entranceData",void 0),__decorate([m(cc.JsonAsset)],t.prototype,"exportData",void 0),t=__decorate([f],t)}(n.default);o.default=_,cc._RF.pop()},{"./UI/box":"box","./UI/bridge":"bridge","./UI/door":"door","./UI/enemy":"enemy","./UI/hero":"hero","./game":"game","./game_logic":"game_logic","./game_scene":"game_scene","./util/event_mgr":"event_mgr","./util/global_def":"global_def"}],helmet:[function(e,t,o){"use strict";cc._RF.push(t,"36667S9v/ZPfKNg1ZcFvKfs","helmet"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=e("./../util/global_def"),s=e("./hero"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.image=null,t.id=null,t.lock=null,t.weapon_id=[],t.hatMenu=null,t.isUnlook=null,t}return __extends(t,e),t.prototype.init=function(e,t){this.id=e,this.setTexture(e),this.hatMenu=t},t.prototype.setUnlook=function(e){this.isUnlook=e,0==this.isUnlook?this.lock.active=!0:this.lock.active=!1},t.prototype.setTexture=function(e){this.image.spriteFrame=r.G.Game.getGRes(r.G.Game.GResType.Hero,e)},t.prototype.onClick=function(e){0!=this.isUnlook&&(s.default.instance.init(this.id),this.hatMenu.showWeapon(this.id))},__decorate([i(cc.Sprite)],t.prototype,"image",void 0),__decorate([i(cc.Node)],t.prototype,"lock",void 0),t=__decorate([a],t)}(cc.Component);o.default=c,cc._RF.pop()},{"./../util/global_def":"global_def","./hero":"hero"}],hero:[function(e,t,o){"use strict";cc._RF.push(t,"90a05FoAJJOHILo5rDUbqo9","hero"),Object.defineProperty(o,"__esModule",{value:!0});var n,a,i,r,s=cc._decorator,c=s.ccclass,l=s.property,d=e("./../util/global_def"),h=e("./../game_scene"),u=e("./entity"),p=e("./../UI/weapon"),f=e("../game_logic"),m=e("../util/event_mgr"),_=e("./../util/audio_mgr"),g=e("./pet"),y=e("./pet_wp"),v=e("./Rank"),w=e("./tower");(function(e){e[e.princess=0]="princess",e[e.shooter=1]="shooter",e[e.bird=2]="bird",e[e.wizard=3]="wizard",e[e.elf=4]="elf",e[e.dragon=5]="dragon",e[e.devil=6]="devil",e[e.pkq=7]="pkq",e[e.pkq_=8]="pkq_",e[e.dragonfly=9]="dragonfly"})(n=o.PetType||(o.PetType={})),function(e){e[e.sword=0]="sword",e[e.arrow=1]="arrow"}(o.PetWeapon||(o.PetWeapon={})),function(e){e[e.extrusion=0]="extrusion",e[e.impact=1]="impact",e[e.fall=2]="fall",e[e.killing=3]="killing"}(a=o.DieType||(o.DieType={})),function(e){e[e.pause=0]="pause",e[e.consume=1]="consume",e[e.recover=2]="recover"}(i=o.PowerState||(o.PowerState={})),function(e){e[e.up=0]="up",e[e.parallel=1]="parallel",e[e.down=2]="down",e[e.fall=3]="fall"}(r=o.PowerStep||(o.PowerStep={})),o.MAX_SP=cc.v2(4e3,0),o.STOP_SP=cc.v2(200,0),o.DAMPING=20;var C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.weaponP=null,t.wpNode=null,t.currentWeapon=null,t.weaponManager=[null,null,null,null,null,null,null,null,null],t.backpack=null,t.show=null,t.eyes=null,t.die_star=null,t.tail=null,t.tailCool=!0,t.tw=null,t.isDie=!1,t.dieRoad=null,t.petP=null,t.pet=null,t.towerPet=null,t.tower=null,t.towerWp=null,t.weapon_id=[],t.hammer_gas_s=null,t.lastPos=cc.v2(-200,0),t.power=100,t.powerState=i.pause,t.invicibleSp=null,t.backPackData=null,t.showData=null,t.runcheckDown=!0,t.boomCount=0,t.invicible=!1,t.isShow=[!0,!0,!1,!0,!1,!0,!1,!0,!1,!1,!0,!0,!0],t.cs_sp=40,t.re_sp=400,t.hero_pause=!1,t}var s;return __extends(t,e),s=t,t.prototype.init=function(e){if(s.instance=this,this.id=e,this.type=u.EntityType.hero,this.setTexture(e),this.node.x=this.lastPos.x,this.rigidBody=this.node.getComponent(cc.RigidBody),this.rigidBody.linearDamping=o.DAMPING,this.rigidBody.bullet=!0,this.dieRoad=null,this.tail.color=d.G.Game.hero_color[this.id],this.tw.color=d.G.Game.hero_color[this.id],this.setData(this.id),this.setBackPack(),this.setShow(),this.pet,this.addTower(d.G.GameData.currenTower),this.cleanWeapon(),this.currentWeapon=null,this.id>=5){var t=d.G.Game.hero_weapon[this.id][0];this.addWeapon(t),this.setWeapon(t),h.default.instance.weaponLayer.getComponent("weaponLayer").unLockWeapon(null,{index:"0"})}null!=d.G.Game.lastPetId&&f.default.instance.gameType!=f.GameType.endless&&this.addPet(d.G.Game.lastPetId)},t.prototype.setData=function(e){this.a=1300,this.origSY=500,this.weapon_id=d.G.Game.hero_weapon[this.id],h.default.instance.initWeaponLayer()},t.prototype.move=function(){var e=this;h.default.instance.weaponLayer.getComponent("weaponLayer").addPow(),null!=this.pet&&this.pet.getComponent("pet").run(),null!=this.towerPet&&this.towerPet.getComponent("pet").run(),this.powerState=i.consume,_.AudioMgr.instance.playMove(),null!=this.currentWeapon&&this.currentWeapon.getComponent("weapon").run(),this.down=!1;var t=cc.v2(o.MAX_SP.x,o.MAX_SP.y);if(this.rigidBody.linearVelocity=t,this.image.node.scaleY=.8,this.tailCool){this.tailCool=!1,this.tail.active=!0;var n=cc.moveBy(.1,-63,0);n.easing(cc.easeOut(.1));var a=cc.moveBy(.1,63,0);a.easing(cc.easeOut(.1)),this.tail.runAction(cc.sequence(n,a,cc.callFunc(function(){e.tail.active=!1,e.tailCool=!0})))}this.runcheckDown=!0},t.prototype.checkDown=function(e){this.runcheckDown&&(h.default.instance.ca_run_y=!0,this.rigidBody.linearVelocity.x<=o.STOP_SP.x&&(this.runcheckDown=!1,this.down=!0,this.speedY<0&&this.speedY!=-this.origSY&&(this.speedY=0),this.image.node.scaleY=1))},t.prototype.setBox=function(){var e=this.node.getComponent(cc.PhysicsBoxCollider);e.size=cc.size(80,86),e.offset.y=43,e.apply()},t.prototype.jump=function(e,t){void 0===t&&(t=.3),null==this.jumpComp&&(this.jumpComp=this.image.node.addComponent(u.Jump)),this.jumpComp.run(u.jumpType.Hight,e,t)},t.prototype.onCollisionEnter=function(e,t){f.default.instance.gameState!=f.GameState.gamePlotOver&&e.tag==d.G.Game.plotTag&&h.default.instance.Scene[h.SceneType.main].getComponent("main_scene").playPlot()},t.prototype.onEndContact=function(e,t,o){},t.prototype.onBeginContact=function(t,o,n){e.prototype.onBeginContact.call(this,t,o,n);var a=d.G.Game.getDir(t);if(a==d.G.Game.dir.up?h.default.instance.ca_run_y=!1:n.tag==d.G.Game.enemyTag&&a==d.G.Game.dir.left&&d.G.Game.vibrateShort(),this.powerState=i.recover,n.tag==d.G.Game.roadTag&&f.default.instance.gameState==f.GameState.gameOver&&(this.dieRoad=n.node,this.node.stopAllActions(),this.a=0,this.origSY=0),n.tag==d.G.Game.enemyTag&&a==d.G.Game.dir.left&&_.AudioMgr.instance.playHit(),null!=this.currentWeapon&&n.tag==d.G.Game.enemyTag&&a==d.G.Game.dir.left&&this.currentWeapon.getComponent(p.wpAction).colTrigger&&n.tag==d.G.Game.enemyTag)if(this.currentWeapon.getComponent("weapon").id==p.WeaponType.bomb){var r=n.node;this.currentWeapon.getComponent(p.bombAction).executeBoom(r,a)}else this.currentWeapon.getComponent(p.wpAction).execute()},t.prototype.creatStar=function(){for(var e=function(e){var o=new cc.Node;o.group="hero",o.scale=d.G.randRange(.8,1.5),o.addComponent(cc.Sprite).spriteFrame=t.die_star,o.setPosition(t.node.x,t.node.y+t.node.height),h.default.instance.node.addChild(o);var n=cc.moveBy(1.5,d.G.randRange(-50,50),d.G.randRange(-50,50));n.easing(cc.easeOut(1.5));var a=cc.fadeOut(1.5),i=cc.scaleBy(1.5,.5);o.runAction(cc.sequence(cc.spawn(n,a,i),cc.callFunc(function(){o.destroy()})))},t=this,o=0;o<15;++o)e()},t.prototype.openEndLayer=function(){h.default.instance.openEndLayer()},t.prototype.startInvincible=function(){var e=this;this.invicible=!0;var t=new cc.Node;t.setAnchorPoint(.5,0),t.scale=2,t.addComponent(cc.Sprite).spriteFrame=this.invicibleSp,t.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(2,100),cc.fadeTo(2,255)))),this.node.addChild(t),this.scheduleOnce(function(){e.invicible=!1,t.destroy()},4)},t.prototype.die=function(e){var t=this;if(void 0===e&&(e=a.extrusion),f.default.instance.gameType==f.GameType.endless){var o=h.default.instance.Scene[h.SceneType.endless].getComponent("endlessLayer");o.skillLock.active=!0,o.skillTime.node.active=!1}if(d.G.Game.endlessSkills.magnet=!1,h.default.instance.storageWealth(),!this.invicible&&(d.G.dieOfDistance(h.default.instance.distance),_.AudioMgr.instance.playDie(),d.G.GlobalData.trialCount--,f.default.instance.gameState!=f.GameState.gameOver)){f.default.instance.gameState=f.GameState.gameOver,0==h.default.instance.novice&&h.default.instance.freeResurgenceCount<=0&&(v.Rank.submitScoreButtonFunc(Number(h.default.instance.distance)),v.Rank.gameOverButtonFunc()),h.default.instance.showEndPro();var n=cc.v2(0,0);switch(this.rigidBody.linearVelocity=n,this.rigidBody.gravityScale=10,e){case a.killing:case a.extrusion:d.G.Game.vibrateShort(),this.scheduleOnce(function(){t.openEndLayer()},0),this.creatStar(),this.eyes.active=!0,this.node.runAction(cc.sequence(cc.scaleTo(2,.6,.4),cc.callFunc(function(){var e=cc.scaleTo(.3,1,.2),o=cc.scaleTo(.3,1,1.2),n=cc.delayTime(1);t.eyes.runAction(cc.repeatForever(cc.sequence(e,o,e,o,n)))}))),f.default.instance.eventManager.addEvent(m.EventType.KGameSlow,this,{});break;case a.impact:d.G.Game.vibrateShort(),this.creatStar(),this.scheduleOnce(function(){t.openEndLayer()},0);var i=this.node.getPosition(),r=cc.v2(this.node.x-300,-1e3),s=cc.v2(0,0);s.x=.25*(r.x-i.x)+i.x-100,s.y=.25*(r.y-i.y)+i.y+100;var c=[i,s,r],l=cc.bezierTo(1.8,c);l.easing(cc.easeOut(.8)),this.eyes.active=!0,this.node.runAction(cc.sequence(l,cc.callFunc(function(){})));var u=cc.scaleTo(.3,1,.2),p=cc.scaleTo(.3,1,1.2),g=cc.delayTime(1);this.eyes.runAction(cc.repeatForever(cc.sequence(u,p,u,p,g))),f.default.instance.eventManager.addEvent(m.EventType.KGameSlow,this,{});break;case a.fall:var y=cc.moveBy(.5,0,-1e3);y.easing(cc.easeBackIn()),this.node.runAction(y),this.scheduleOnce(function(){t.openEndLayer()},0)}}},t.prototype.showBackPack=function(e){var t="weapon_"+e;this.backpack.getChildByName(t).active=!0},t.prototype.setBackPack=function(){var e=d.G.Game.hero_weapon[this.id];this.backpack.removeAllChildren();for(var t in e){var o=e[t],n=new cc.Node,a=this.backPackData.json[o];n.x=a.Position_x,n.y=a.Position_y,n.rotation=a.Rotation,n.scaleX=a.Scale_x,n.scaleY=a.Scale_y,n.anchorX=a.Anchor_x,n.anchorY=a.Anchor_y,n.active=!1,n.addComponent(cc.Sprite).spriteFrame=d.G.Game.getGRes(d.G.Game.GResType.Weapon,o);var i="weapon_"+o;this.backpack.addChild(n,1e3,i)}},t.prototype.setShow=function(){var e=d.G.Game.hero_weapon[this.id];this.show.removeAllChildren();for(var t in e){var o=e[t],n=this.showData.json[o],a=new cc.Node;a.x=n.Position_x,a.y=n.Position_y,a.rotation=n.Rotation,a.scaleX=n.Scale_x,a.scaleY=n.Scale_y,a.anchorX=n.Anchor_x,a.anchorY=n.Anchor_y,a.active=!1,a.addComponent(cc.Sprite).spriteFrame=d.G.Game.getGRes(d.G.Game.GResType.Weapon,o);var i="weapon_"+o;this.show.addChild(a,1e3,i)}},t.prototype.addWeapon=function(e){if(null==this.weaponManager[e]){var t=h.default.instance.wpFactory.create(e);this.wpNode.addChild(t),t.active=!1,this.weaponManager[e]=t,e==p.WeaponType.fly_spear&&(t.getChildByName("streak").active=!1),this.showBackPack(e)}else this.weaponManager[e].getComponent("weapon").addCount()},t.prototype.cleanWeapon=function(){for(var e in this.weaponManager){var t=this.weaponManager[e];if(null!=t){t.active=!1;var o=t.getComponent("weapon").id;t.setRotation(p.START_ROAT[o]),t.setPosition(p.POS[o].x,p.POS[o].y)}}for(var e in this.show.children){this.show.children[e].active=!1}},t.prototype.setWeapon=function(e){if(this.cleanWeapon(),null!=this.currentWeapon){var t="weapon_"+this.currentWeapon.getComponent("weapon").id;this.backpack.getChildByName(t).active=!0}var o="weapon_"+e;if(this.backpack.getChildByName(o).active=!1,this.currentWeapon=this.weaponManager[e],this.currentWeapon.active=this.isShow[e],!this.isShow[e]){var n="weapon_"+e;this.show.getChildByName(n).active=!0}},t.prototype.cancelPet=function(){null!=this.pet&&(this.pet.destroy(),this.pet=null,cc.sys.localStorage.setItem("petId",""),h.default.instance.setPetBtn(255))},t.prototype.addTower=function(e){switch(e){case w.TowerType.tower_sword:this.towerWp=cc.instantiate(this.tower),this.towerWp.getComponent("tower").init(w.TowerType.tower_sword),this.backpack.addChild(this.towerWp,1e4),h.default.instance.weaponLayer.getComponent("weaponLayer").initTowerWp();break;case w.TowerType.tower_speer:this.towerWp=cc.instantiate(this.tower),this.towerWp.getComponent("tower").init(w.TowerType.tower_speer),this.backpack.addChild(this.towerWp,1e4),h.default.instance.weaponLayer.getComponent("weaponLayer").initTowerWp();break;case w.TowerType.tower_dragonfly:this.towerPet=cc.instantiate(this.petP),this.towerPet.active=!1,this.towerPet.getComponent("pet").init(n.dragonfly),this.towerPet.getChildByName("image").active=!1,this.towerPet.getChildByName("streak").active=!1,this.towerPet.addComponent(g.dragonfly),this.towerPet.getComponent("pet").addWeapon(y.pet_wp_type.bullet);var t=cc.v2(this.node.x-100,this.node.y+150);this.towerPet.setPosition(t),h.default.instance.node.addChild(this.towerPet,1e3)}},t.prototype.addPet=function(e){switch(null!=this.pet&&this.pet.destroy(),this.pet=cc.instantiate(this.petP),this.pet.getComponent("pet").init(e),e){case n.princess:this.pet.getComponent("pet").addWeapon(y.pet_wp_type.sword),this.pet.addComponent(g.WalkNear);break;case n.shooter:this.pet.getComponent("pet").addWeapon(y.pet_wp_type.arrow),this.pet.addComponent(g.WalkFar);break;case n.bird:this.pet.scale=1,this.pet.addComponent(g.FlyImpact);break;case n.wizard:this.pet.getComponent("pet").addWeapon(y.pet_wp_type.fireball),this.pet.addComponent(g.Wizard);break;case n.elf:this.pet.getComponent("pet").addWeapon(y.pet_wp_type.light),this.pet.getChildByName("image").active=!1,this.pet.addComponent(g.Hang);break;case n.dragon:this.pet.getChildByName("image").active=!1,this.pet.getChildByName("streak").active=!1,this.pet.addComponent(g.dragon),this.pet.getComponent("pet").addWeapon(y.pet_wp_type.flame);break;case n.pkq:this.pet.getChildByName("image").opacity=0,this.pet.getChildByName("streak").active=!1,this.pet.addComponent(g.pkq);break;case n.devil:this.pet.getChildByName("image").active=!1,this.pet.getChildByName("streak").active=!1,this.pet.addComponent(g.devil),this.pet.getComponent("pet").addWeapon(y.pet_wp_type.wave);break;case n.pkq_:this.pet.getChildByName("image").opacity=0,this.pet.getChildByName("streak").active=!1,this.pet.addComponent(g.pkq);break;case n.dragonfly:}h.default.instance.setPetBtn(e);var t=cc.v2(this.node.x-100,this.node.y+150);this.pet.setPosition(t),h.default.instance.node.addChild(this.pet,1e3)},t.prototype.getPowerStep=function(e){return this.power>60?r.parallel:this.power>50&&this.power<=60?r.up:this.power>0&&this.power<50?r.down:r.fall},t.prototype.powerUpdate=function(e){if(f.default.instance.gameState==f.GameState.gamePlay)switch(this.powerState){case i.pause:break;case i.consume:this.power-=this.cs_sp*e;var t=this.getPowerStep(this.power);h.default.instance.setPowProgress(this.power/100,this.getPowerStep(this.power)),t==r.up&&this.rigidBody.linearVelocity.x>o.STOP_SP.x&&!this.isJumping?this.node.y+=1:t==r.down?this.node.y-=1:t==r.fall&&(this.down=!0);break;case i.recover:this.power+=this.re_sp*e,this.power>=100&&(this.power=100),h.default.instance.setPowProgress(this.power/100,this.getPowerStep(this.power))}},t.prototype.subUpdate=function(t){f.default.instance.gameState==f.GameState.gameOver||this.hero_pause||(this.powerUpdate(t),this.checkDown(t),e.prototype.subUpdate.call(this,t))},t.instance=null,__decorate([l(cc.Prefab)],t.prototype,"weaponP",void 0),__decorate([l(cc.Node)],t.prototype,"wpNode",void 0),__decorate([l(cc.Node)],t.prototype,"backpack",void 0),__decorate([l(cc.Node)],t.prototype,"show",void 0),__decorate([l(cc.Node)],t.prototype,"eyes",void 0),__decorate([l(cc.SpriteFrame)],t.prototype,"die_star",void 0),__decorate([l(cc.Node)],t.prototype,"tail",void 0),__decorate([l(cc.MotionStreak)],t.prototype,"tw",void 0),__decorate([l(cc.Prefab)],t.prototype,"petP",void 0),__decorate([l(cc.Prefab)],t.prototype,"tower",void 0),__decorate([l(cc.SpriteFrame)],t.prototype,"hammer_gas_s",void 0),__decorate([l(cc.SpriteFrame)],t.prototype,"invicibleSp",void 0),__decorate([l(cc.JsonAsset)],t.prototype,"backPackData",void 0),__decorate([l(cc.JsonAsset)],t.prototype,"showData",void 0),t=s=__decorate([c],t)}(u.default);o.default=C,cc._RF.pop()},{"../game_logic":"game_logic","../util/event_mgr":"event_mgr","./../UI/weapon":"weapon","./../game_scene":"game_scene","./../util/audio_mgr":"audio_mgr","./../util/global_def":"global_def","./Rank":"Rank","./entity":"entity","./pet":"pet","./pet_wp":"pet_wp","./tower":"tower"}],http_req:[function(e,t,o){"use strict";cc._RF.push(t,"98ce8nbjP1CKosWUaHSoR3X","http_req"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../game_logic"),a="https://login.joyfulh.com/comLogin",i="http://119.23.108.126:8900/comLogin",r="https://statistic.joyfulh.com/statistic",s="http://120.55.46.25:8900/statistic",c="/usr/reqTimerReset",l="/invite/checkInvitation",d="/invite/agreeInvition",h="/data/getTimeMillis",u="/user/getTitles",p="/user/getTimeSwitch",f="/user/getShareSwitch",m="/user/getUid",_="/data/updStatistic",g="/data/batchUpdStat",y="/IPScreen/getScreen",v=function(){return function(){this.url="",this.data=""}}();o.SendData=v;var w=function(){function e(){}return e.common=function(e,t,o,n){if(null!=t){var a=new v;if(a.url=e,"object"==typeof t){for(var i in t)if(t.hasOwnProperty(i)){var r=t[i];if(null==r)continue;if(""!=a.data&&(a.data+="&"),"object"==typeof r){var s=JSON.stringify(r);a.data+=i+"="+escape(s)}else"string"==typeof r||"number"==typeof r||"boolean"==typeof r?a.data+=i+"="+r.toString():(a.data+=i+"="+r.toString(),cc.error("[HttpRequest] please check your data type,only support object,string,number or boolean"))}}else a.data=t;this._send(a,o,n),a=null}else cc.error("[HttpRequest] failed")},e.reqTimerReset=function(e,t){var o=a+c;this.common(o,e,t)},e.checkInvitation=function(e,t){var o=a+l;this.common(o,e,t)},e.agreeInvition=function(e,t){var o=a+d;this.common(o,e,t)},e.getTimestamp=function(e){var t=a+h;this.common(t,"",e)},e.checkIP=function(e,t){var o=this,r=a+y;0==n.default.instance.useIpShield&&(r+="1"),1==n.default.instance.config.testServer&&(r=i+y);var s;s={proName:n.default.instance.config.proName};var c=null,l=e;this.ipProtect_=!1,c=t||function(t){if(!o.ipProtect_&&0!=n.default.instance.switch_useOtherIp){o.ipProtect_=!0,r="https://pv.sohu.com/cityjson?ie=utf-8",l=function(t){if(console.log("fail check ip",t),t){for(var n=!1,a=0;a<o.ipHideCityArr_.length;++a)if(-1!=t.indexOf(o.ipHideCityArr_[a])){n=!0;break}if(!n)for(a=0;a<o.ipHideProvinceArr_.length;++a)if(-1!=t.indexOf(o.ipHideProvinceArr_[a])){n=!0;break}e&&e(JSON.stringify({res:n?1:0}))}};var a=new XMLHttpRequest;a.onreadystatechange=function(){console.log("xhr",a.status,a.readyState),4==a.readyState&&a.status>=200&&a.status<400&&l&&l(a.responseText)},a.open("GET",r,!0),a.send()}},console.log("CHECK IP",r,s),this.common(r,s,l,c)},e._send=function(e,t,o){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&n.status>=200&&n.status<400?(cc.log("[HttpRequest] req succ",n.responseText),t&&t(n.responseText)):1!=n.readyState&&(n.status<200||n.status>=400)&&(cc.log("[HttpRequest] conn",n.readyState,n.status),o&&o(1))},n.onabort=function(){cc.log("[HttpRequest] abort",n.status),o&&o(2)},n.ontimeout=function(){cc.log("[HttpRequest] timeout",n.status),o&&o(3)},n.onerror=function(){cc.log("[HttpRequest] error",n.status),o&&o(4)};var a=e.url+"?"+e.data;n.open("GET",a,!0),n.send()},e.getUserId=function(e,t,o,a){var i=r+m;1==n.default.instance.config.testServer&&(i=s+m);var c={proName:n.default.instance.config.proName,openId:e,unionId:t};this.common(i,c,o,a)},e.updateStatistic=function(e,t,o,a,i,c){var l=r+_;1==n.default.instance.config.testServer&&(l=s+_);var d={proName:n.default.instance.config.proName,uid:e,key:t,value:o,choose:a||0};this.common(l,d,i,c)},e.batchUpdateStat=function(e,t,o){var a=r+g;1==n.default.instance.config.testServer&&(a=s+g);var i={proName:n.default.instance.config.proName,uid:n.default.instance.gameId,data:e};this.common(a,i,t,o)},e.getFuncSwitch=function(e,t,o){var r=a+f;1==n.default.instance.config.testServer&&(r=i+f);var s={proName:n.default.instance.config.proName,version:e};this.common(r,s,t,o)},e.getShareTitle=function(e,t){var o=a+u;1==n.default.instance.config.testServer&&(o=i+u);var r={proName:n.default.instance.config.proName};this.common(o,r,e,t)},e.getTimeSwtich=function(e,t,o){var r=a+p;1==n.default.instance.config.testServer&&(r=i+p);var s={proName:n.default.instance.config.proName,keys:e};this.common(r,s,t,o)},e.ipHideProvinceArr_=[],e.ipHideCityArr_=["\u6210\u90fd","\u82cf\u5dde","\u676d\u5dde","\u5317\u4eac","\u4e0a\u6d77","\u5e7f\u5dde","\u6df1\u5733"],e.ipProtect_=!1,e}();o.default=w,cc._RF.pop()},{"../../game_logic":"game_logic"}],load:[function(e,t,o){"use strict";cc._RF.push(t,"81b1d+fBSpDGK+bGW8Ug/l+","load"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../util/wx_util"),a=e("../data/task_data"),i=e("../game_logic"),r=e("../util/global_def"),s=e("../SDK/aladinSDK"),c=e("./../game_scene"),l=e("./../util/storage"),d=e("./../util/audio_mgr"),h=e("./task"),u=e("./towerLayer"),p=e("../SDK/ALGuessLike"),f=cc._decorator,m=f.ccclass,_=f.property,g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.iconItem=null,t.bg=null,t.updateTipLbl_=null,t.loading=null,t.storyGameBtn=null,t.endlessGameBtn=null,t.moreGameNode=null,t.favoNode=null,t.drawerBtn=null,t.testToken=0,t.tokens=[],t.crown_lab=null,t.crown=0,t.coin_lab=null,t.coin=0,t.coinNode=null,t.crownNode=null,t.setTag=null,t.setMenu=null,t.isOpenSet=!1,t.musicBtn=null,t.effectBtn=null,t.vibrateBtn=null,t.TaskLayer=null,t.SkinLayer=null,t.tipWindow=null,t.tip=null,t.RankLayer=null,t.trialLayer=null,t.award_tag=null,t.dialLayer=null,t.SignLayer=null,t.shareBtn=null,t.videoBtn=null,t.taskRed=null,t.heroWeaponJson=null,t.weaponInfo=null,t.aceHeroLayer=null,t.aceId=null,t.aceHeroNode=null,t.heroImage=[],t.loadContent=null,t.loadAni=null,t.ani=null,t.towerLayer=null,t.towerInit=!1,t.moreNode=null,t.favo=null,t.drawer=null,t}var o;return __extends(t,e),o=t,t.prototype.getShardCount=function(){var e=(new Date).getDate(),t=l.default.readNum("lastDateShare"),o=l.default.readNum("shareCount");return e==t&&null!=o||l.default.writeNum("shareCount",0),cc.sys.localStorage.setItem("lastDateShare",e),l.default.readNum("shareCount")},t.prototype.onLoad=function(){var e=this;r.G.createGameBanner(),r.G.createPortalAd(),r.G.GameData.getHeroData(),r.G.GameData.getPetData(),r.G.initHeroWeapon(this.heroWeaponJson);var t=this.SkinLayer.getComponent("skinLayer").skinHeroInfo,n=this.SkinLayer.getComponent("skinLayer").skinPetInfo;r.G.setHeroName(t),r.G.setPetName(n),r.G.setWpName(this.weaponInfo),r.G.activaLayer(this.SignLayer),cc.director.getCollisionManager().enabled=!0,cc.director.getPhysicsManager().enabled=!0,o.instance=this,this.initWealth(),this.TaskLayer.getComponent("taskLayer").init(!0),r.G.Game.lastHeroId=l.default.readNum("lastHeroId"),null==r.G.Game.lastHeroId&&(l.default.writeNum("lastHeroId",0),r.G.Game.lastHeroId=0),r.G.Game.lastPetId=l.default.readNum("lastPetId"),this.scheduleOnce(function(){e.trialLayer.getComponent("trialLayer").init(0)},1.5),this.SignLayer.getComponent("signLayer").init(),this.setMenu.scaleY=0,this.award_tag.active=!1,this.reSetVideoCount();var a=l.default.readNum("todaySign"),s=this.getFreeCount(),c=l.default.readNum("dialVideoCount");if(null!=r.G.GlobalData.novice&&this.scheduleOnce(function(){e.shareBtn.active=!1,e.videoBtn.active=!1;var t=e.getShardCount();1==i.default.instance.ip_switch&&0==i.default.instance.ip_share||t>=i.default.instance.shareCount?e.videoBtn.active=!0:e.shareBtn.active=!0},.5),null==r.G.GlobalData.novice){this.loadContent.active=!1,this.loadAni.active=!0;var d=0;this.schedule(function(){0==d?e.ani.string=".":1==d?e.ani.string="..":2==d&&(e.ani.string="..."),d=(d+1)%3},.1,cc.macro.REPEAT_FOREVER)}else{this.scheduleOnce(function(){i.default.instance.startGame&&0==a&&e.openSignLayer(null),(s>0||c<3)&&i.default.instance.startGame?i.default.instance.openDial=!0:i.default.instance.openDial=!1},.5),this.refreshRedToTask();var h=r.G.randRange(0,1);this.aceId=[7,8][h],r.G.GameData.getTowerData(0);var p=l.default.readNum("currenTower");r.G.GameData.currenTower=p||0;var f=l.default.readNum("floorLevel");r.G.GameData.floorLevel=f||1,u.default.items=[],u.default.towerContents=[]}0==r.G.GameData.petInfo[0]&&(this.storyGameBtn.active=!0)},t.prototype.openTower=function(){this.towerLayer.active=!0,0==this.towerInit&&(this.towerLayer.getComponent("towerLayer").init(),this.towerInit=!0),this.towerLayer.getComponent("towerLayer").open()},t.prototype.openAceLayer=function(){this.aceHeroLayer.getComponent("aceHeroLayer").open(this.aceId)},t.prototype.refreshRedToTask=function(){var e=l.default.readJSON("taskStor");if(null!=e){var t=!1;for(var o in e){if(e[o].state==h.TaskState.open){t=!0;break}}this.taskRed.active=!!t}},t.prototype.reSetVideoCount=function(){r.G.reSetData("lastDateDialVideo","dialVideoCount",0)},t.prototype.getFreeCount=function(){var e=(new Date).getDate(),t=l.default.readNum("lastDateDial");e!=Number(t)&&l.default.writeNum("dialFreeCount",1);var o=l.default.readNum("dialFreeCount");return l.default.writeNum("lastDateDial",e),Number(o)},t.prototype.openSignLayer=function(e){0!=i.default.instance.switch?(e&&(i.default.instance.openDial=!1),this.SignLayer.getComponent("signLayer").open(),r.G.showGameBanner()):o.instance.showTip("1000\u7687\u51a0\u5f00\u653e")},t.prototype.openDial=function(){this.dialLayer.getComponent("dial").open()},t.prototype.initWealth=function(){this.coin=Number(cc.sys.localStorage.getItem("coin")),this.coin_lab.string=String(this.coin),this.crown=Number(cc.sys.localStorage.getItem("crown")),this.crown_lab.string=String(this.crown)},t.prototype.initSetLayer=function(){var e=l.default.readNum("musicSwitch");null==e&&(e=1,l.default.writeNum("musicSwitch",e)),this.musicBtn.isChecked=1==e,this.setMusic();var t=l.default.readNum("effectSwitch");null==t&&(t=1,cc.sys.localStorage.setItem("effectSwitch",t)),this.effectBtn.isChecked=1==t,this.setEffect();var o=l.default.readNum("vibrateSwitch");null==o&&(o=1,cc.sys.localStorage.setItem("vibrateSwitch",o)),this.vibrateBtn.isChecked=1==o,this.setVibratet()},t.prototype.openRank=function(){this.RankLayer.getComponent("RankLayer").open(),r.G.reportToAld(r.G.Report.rankClick)},t.prototype.setMusic=function(){var e=this.musicBtn.isChecked;d.AudioMgr.instance.setIfMuteMusic(e);var t=Number(e);cc.sys.localStorage.setItem("musicSwitch",t)},t.prototype.setEffect=function(){var e=this.effectBtn.isChecked;d.AudioMgr.instance.setIfMuteSound(e);var t=Number(e);cc.sys.localStorage.setItem("effectSwitch",t)},t.prototype.setVibratet=function(){var e=!this.vibrateBtn.isChecked;r.G.Game.vibrate=e;var t=Number(e);cc.sys.localStorage.setItem("vibrateSwitch",t)},t.prototype.openSet=function(){this.setTag.stopAllActions(),this.setMenu.stopAllActions(),0==this.isOpenSet?(this.isOpenSet=!0,this.setTag.runAction(cc.rotateTo(.1,180)),this.setMenu.runAction(cc.scaleTo(.1,1,1))):(this.isOpenSet=!1,this.setTag.runAction(cc.rotateTo(.1,0)),this.setMenu.runAction(cc.scaleTo(.1,1,0)))},t.prototype.openTaskLayer=function(){this.TaskLayer.active=!0,this.TaskLayer.getChildByName("panle").getComponent("ui_motion").triggerMotion(),r.G.showGameBanner()},t.prototype.closeTaskLayer=function(){this.TaskLayer.active=!1,this.refreshRedToTask(),r.G.hidGameBanner()},t.prototype.openSkinLayer=function(e,t){if(0!=i.default.instance.switch){var n=Number(t);this.SkinLayer.active=!0,this.SkinLayer.getChildByName("content").getComponent("ui_motion").triggerMotion(),this.SkinLayer.getComponent("skinLayer").showHero(n),r.G.showGameBanner()}else o.instance.showTip("1000\u7687\u51a0\u5f00\u653e")},t.prototype.closeSkinLayer=function(){this.SkinLayer.active=!1,r.G.hidGameBanner()},t.prototype.buy=function(e,t,o){switch(e){case c.WealthType.coin:this.coin<t?this.tipWindow.getComponent("tipWindow").open(0,this):(this.coin-=t,this.coin_lab.string=String(this.coin),cc.sys.localStorage.setItem("coin",this.coin),o());break;case c.WealthType.crown:this.crown<t?this.tipWindow.getComponent("tipWindow").open(1,this):(this.crown-=t,this.crown_lab.string=String(this.crown),cc.sys.localStorage.setItem("crown",this.crown),o())}},t.prototype.updateWealth=function(e,t){switch(e){case c.WealthType.coin:this.coin+=t,this.coin_lab.string=String(this.coin),cc.sys.localStorage.setItem("coin",this.coin);break;case c.WealthType.crown:this.crown+=t,this.crown_lab.string=String(this.crown),cc.sys.localStorage.setItem("crown",this.crown)}},t.prototype.showTip=function(e){var t=this.tip;t.y=0;var o=t.getChildByName("des").getComponent(cc.Label);o.string=e,o.fontSize=40;cc.moveBy(1,0,200);var n=cc.fadeOut(1.5),a=cc.fadeIn(.5);t.stopAllActions(),t.runAction(cc.sequence(a,cc.delayTime(.5),n))},t.prototype.initSDK=function(){var e=this,t=["wx52966cd958bcd65b","wxf6d1b732f6f5d44c","wx61f0dfbc39870da1","wx801fe783f5f0888b","wx99d564ca2464fa4d","wx0a23b2c207508347","wx149f124b2051d0e4","wxaf5bd1faea5c9a99","wx2a3dbecc43cf744b","wxfa8b612abfc14f0b"],o=0;null==p.ALGuessLike.getIconData()&&(o=2),this.scheduleOnce(function(){var o=p.ALGuessLike.createIcon(e.iconItem,t[i.default.instance.appid_0]);o.x=296,o.y=180,e.node.addChild(o);var n=p.ALGuessLike.createIcon(e.iconItem,t[i.default.instance.appid_1]);n.x=296,n.y=30,e.node.addChild(n)},o),this.moreNode=s.AladinSDK.getMoreNode(),this.moreGameNode.addChild(this.moreNode),s.AladinSDK.showMoreNode(),this.favo=s.AladinSDK.getFavoNode(),this.favoNode.addChild(this.favo),this.drawer=s.AladinSDK.getDrawerNode(),this.node.addChild(this.drawer),s.AladinSDK.hideDrawerNode(),this.drawerBtn.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.1,.8,.8),cc.scaleTo(.1,1.1,1.1),cc.scaleTo(.1,.8,.8),cc.scaleTo(.1,1.1,1.1),cc.scaleTo(.1,.9,.9),cc.scaleTo(.1,1,1),cc.delayTime(2.7)))),this.aceHeroNode.runAction(cc.repeatForever(cc.sequence(cc.rotateTo(.1,40),cc.rotateTo(.1,0),cc.rotateTo(.1,-40),cc.rotateTo(.1,0),cc.rotateTo(.1,40),cc.rotateTo(.1,0),cc.rotateTo(.1,-40),cc.rotateTo(.1,0),cc.delayTime(2)))),null==r.G.GlobalData.novice&&this.enterGame()},t.prototype.destroySDK=function(){s.AladinSDK.destroyDrawerNode(),s.AladinSDK.destroyFavoNode(),s.AladinSDK.destroyMoreNode()},t.prototype.sdkBackBtnClick=function(){s.AladinSDK.ShowGameBoxNode()},t.prototype.drawerBtnClick=function(){s.AladinSDK.showDrawerNode()},t.prototype.start=function(){if(this.initSDK(),d.AudioMgr.instance.playMusic(d.BgmType.KHall),0==i.default.instance.gameBegain)i.default.instance.gameBegain=!0,cc.sys.platform==cc.sys.WECHAT_GAME?(n.default.fetchSdkInfo(),n.default.checkVersionUpdate(this._updateApp.bind(this),this._excuteLoad.bind(this))):this._excuteLoad();else{this.storyGameBtn.active=!0;var e=cc.sys.localStorage.getItem("novice");null!=e&&""!=e||(this.endlessGameBtn.active=!1,this.storyGameBtn.active=!0)}},t.prototype.inviteTest=function(){for(var e={},t=0;t<4;++t)e["k"+t]="t"+t;n.default.invitePeriod(e,0,function(t){r.G.console(t);for(var o in t)if(t.hasOwnProperty(o)&&"1"===t[o]){var a=this.testToken;this.tokens.push(a.toString()),n.default.inviteFriend("xxx","","t0",i.default.instance.openId),r.G.console("30"),n.default.invitePeriod(e,30);break}}.bind(this))},t.prototype.agreeTest=function(){for(var e={},t=0;t<this.tokens.length;++t)e["t"+t]=this.tokens[t];r.G.isExistObj(e)&&n.default.checkInvitation(e,function(e){console.log("check invitation",e)})},t.prototype.reqTest=function(){n.default.reqTimerResetUnion("test",0)},t.prototype.saveTest=function(){n.default.reqTimerResetUnion("test",1)},t.prototype._updateApp=function(){this.updateTipLbl_.string="\u6b63\u5728\u4e0b\u8f7d\u65b0\u5185\u5bb9"},t.prototype._excuteLoad=function(){if(this.updateTipLbl_.node.active=!1,a.default.fetchTaskData("data/test"),cc.sys.platform==cc.sys.WECHAT_GAME){n.default.login(function(e){r.G.reportToAladin(r.G.aladinType.toWxLogin);r.G.console(e),i.default.instance.openId=e.openId,i.default.instance.sessionKey=e.sessionKey},null,!0,!1)}else i.default.instance.openId="oH7OW5Gz_2mREtfIOvUb9JEMGto4",i.default.instance.uid="1",i.default.instance.gameId="1"},t.prototype.getOpenCount=function(){var e=(new Date).getDate(),t=l.default.readNum("lastDateOpenTrial");e!=Number(t)&&l.default.writeNum("trialOpen",0);var o=l.default.readNum("trialOpen");return l.default.writeNum("lastDateOpenTrial",e),Number(o)},t.prototype.storyGame=function(){var e=this,t=function(){r.G.Game.addGameCount();var t=e.getOpenCount();r.G.GlobalData.trialClose||t>=i.default.instance.trialCount||0==i.default.instance.switch?e.enterGame():e.trialLayer.getComponent("trialLayer").open()};r.G.randRange(0,99)<i.default.instance.startGameNeedShare&&(0==i.default.instance.ip_switch||1==i.default.instance.ip_share)&&r.G.Game.getGameCount()>=r.G.Game.needShareToGame?r.G.shareGame(t,null,"\u53d1\u9001\u5230\u4e0d\u540c\u7fa4\u624d\u80fd\u5f00\u59cb\u6e38\u620f"):t()},t.prototype.enterGame=function(){var e=this;(function(){e.destroySDK(),i.default.instance.startGame=!1,l.default.writeNum("weather",0);c.WeatherState.daytime;l.default.writeNum("weatherState",c.WeatherState.daytime),i.default.instance.gameType=i.GameType.sotry,i.default.instance.changeScene("game_scene",null,function(e){var t=cc.sys.localStorage.getItem("novice");0!=(t=Number(t))&&(c.default.instance.firstEnterGame=!0)})})()},t.prototype.endlessGame=function(){i.default.instance.gameType=i.GameType.endless,this.destroySDK(),i.default.instance.changeScene("game_scene",null,function(e){})},t.prototype.shareGame=function(e,t){if(i.default.instance.switch){r.G.Game.shareData;var o=r.G.randRange(0,r.G.Game.shareData.length-1),a=JSON.parse(r.G.Game.shareData[o]),s=a.title,c="https://huandong-1257458597.cos.ap-guangzhou.myqcloud.com/HeadStrong/share/"+a.img,l=t||function(){wx.showModal({title:"\u63d0\u793a",content:"\u53d1\u9001\u5230\u4e0d\u540c\u7fa4\u624d\u80fd\u83b7\u5f97\u5956\u52b1",showCancel:!0,cancelText:"\u6b8b\u5fcd\u62d2\u7edd",cancelColor:"",confirmText:"\u518d\u8bd5\u4e00\u6b21",success:function(t){console.log("\u53c2\u6570",t),t.confirm&&n.default.shareNorm(s,c,e,l)}})};n.default.shareNorm(s,c,e,l)}else e()},t.prototype.onClickShared=function(){var e=this;r.G.reportToAld(r.G.Report.LoadLayer_Share),this.shareGame(function(){var t=l.default.readNum("shareCount");t++,console.log("\u5206\u4ea8\u6b21\u6570cou"+t),cc.sys.localStorage.setItem("shareCount",t),e.showTip("\u672c\u5c40\u91d1\u5e01\u6536\u76ca\u52a0\u621050%"),r.G.GlobalData.addAwardShared=1.5,e.award_tag.active=!0})},t.prototype.onClickVideo=function(){var e=this;r.G.reportToAld(r.G.Report.LoadLayer_Video),n.default.watchVideoAds(r.G.VideoId.trialHero,function(){e.showTip("\u672c\u5c40\u91d1\u5e01\u6536\u76ca\u52a0\u621050%"),r.G.GlobalData.addAwardShared=1.5,e.award_tag.active=!0})},t.instance=null,__decorate([_(cc.Prefab)],t.prototype,"iconItem",void 0),__decorate([_(cc.Sprite)],t.prototype,"bg",void 0),__decorate([_(cc.Label)],t.prototype,"updateTipLbl_",void 0),__decorate([_(cc.ProgressBar)],t.prototype,"loading",void 0),__decorate([_(cc.Node)],t.prototype,"storyGameBtn",void 0),__decorate([_(cc.Node)],t.prototype,"endlessGameBtn",void 0),__decorate([_(cc.Node)],t.prototype,"moreGameNode",void 0),__decorate([_(cc.Node)],t.prototype,"favoNode",void 0),__decorate([_(cc.Node)],t.prototype,"drawerBtn",void 0),__decorate([_(cc.Label)],t.prototype,"crown_lab",void 0),__decorate([_(cc.Label)],t.prototype,"coin_lab",void 0),__decorate([_(cc.Node)],t.prototype,"coinNode",void 0),__decorate([_(cc.Node)],t.prototype,"crownNode",void 0),__decorate([_(cc.Node)],t.prototype,"setTag",void 0),__decorate([_(cc.Node)],t.prototype,"setMenu",void 0),__decorate([_(cc.Toggle)],t.prototype,"musicBtn",void 0),__decorate([_(cc.Toggle)],t.prototype,"effectBtn",void 0),__decorate([_(cc.Toggle)],t.prototype,"vibrateBtn",void 0),__decorate([_(cc.Node)],t.prototype,"TaskLayer",void 0),__decorate([_(cc.Node)],t.prototype,"SkinLayer",void 0),__decorate([_(cc.Node)],t.prototype,"tipWindow",void 0),__decorate([_(cc.Node)],t.prototype,"tip",void 0),__decorate([_(cc.Node)],t.prototype,"RankLayer",void 0),__decorate([_(cc.Node)],t.prototype,"trialLayer",void 0),__decorate([_(cc.Node)],t.prototype,"award_tag",void 0),__decorate([_(cc.Node)],t.prototype,"dialLayer",void 0),__decorate([_(cc.Node)],t.prototype,"SignLayer",void 0),__decorate([_(cc.Node)],t.prototype,"shareBtn",void 0),__decorate([_(cc.Node)],t.prototype,"videoBtn",void 0),__decorate([_(cc.Node)],t.prototype,"taskRed",void 0),__decorate([_(cc.JsonAsset)],t.prototype,"heroWeaponJson",void 0),__decorate([_(cc.JsonAsset)],t.prototype,"weaponInfo",void 0),__decorate([_(cc.Node)],t.prototype,"aceHeroLayer",void 0),__decorate([_(cc.Node)],t.prototype,"aceHeroNode",void 0),__decorate([_([cc.SpriteFrame])],t.prototype,"heroImage",void 0),__decorate([_(cc.Node)],t.prototype,"loadContent",void 0),__decorate([_(cc.Node)],t.prototype,"loadAni",void 0),__decorate([_(cc.Label)],t.prototype,"ani",void 0),__decorate([_(cc.Node)],t.prototype,"towerLayer",void 0),t=o=__decorate([m],t)}(cc.Component);o.default=g,cc._RF.pop()},{"../SDK/ALGuessLike":"ALGuessLike","../SDK/aladinSDK":"AladinSDK","../data/task_data":"task_data","../game_logic":"game_logic","../util/global_def":"global_def","../util/wx_util":"wx_util","./../game_scene":"game_scene","./../util/audio_mgr":"audio_mgr","./../util/storage":"storage","./task":"task","./towerLayer":"towerLayer"}],magma_node:[function(e,t,o){"use strict";cc._RF.push(t,"8cba6cZEqBF74KKgmJRpQf9","magma_node"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./../UI/hero"),i=e("../game_logic"),r=cc._decorator,s=r.ccclass,c=r.property;(function(e){e[e.intermittent=0]="intermittent",e[e.continuous=1]="continuous"})(n||(n={}));var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onCollisionEnter=function(e,t){var o=e;i.default.instance.gameState==i.GameState.gamePlay&&o.getComponent("hero").die(a.DieType.extrusion)},t}(cc.Component),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.top=null,t.exit=null,t.magmaF=null,t.magma_manager=[],t}return __extends(t,e),t.prototype.init=function(){for(var e=0;e<5;e++){var t=new cc.Node;t.setAnchorPoint(.5,0),t.addComponent(cc.Sprite).spriteFrame=this.magmaF,t.group="magma",t.addComponent(cc.BoxCollider).size=cc.size(60,105),this.exit.addChild(t),t.addComponent(l),this.magma_manager.push(t)}},t.prototype.run=function(e){this.top.stopAllActions(),this.top.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(4,100),cc.fadeTo(4,255))));var t=1;e==n.continuous&&(t=.4);var o=function(e){var o=cc.moveBy(4,cc.v2(0,-1e3));o.easing(cc.easeIn(4));var n=a.magma_manager[e];n.stopAllActions(),n.y=0,n.runAction(cc.sequence(cc.delayTime(t*Number(e)),cc.callFunc(function(){n.runAction(cc.repeatForever(cc.sequence(o,cc.callFunc(function(){n.y=0}),cc.delayTime(0))))})))},a=this;for(var i in this.magma_manager)o(i)},__decorate([c(cc.Node)],t.prototype,"top",void 0),__decorate([c(cc.Node)],t.prototype,"exit",void 0),__decorate([c(cc.SpriteFrame)],t.prototype,"magmaF",void 0),t=__decorate([s],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../game_logic":"game_logic","./../UI/hero":"hero"}],main_scene:[function(e,t,o){"use strict";cc._RF.push(t,"08a66r+0+9Na5DQ+xosf7S9","main_scene"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./game"),i=e("./util/global_def"),r=e("./game_scene"),s=e("./UI/enemy"),c=e("./ui/pet"),l=e("./game_logic"),d=e("./UI/myCoin"),h=e("./UI/box"),u=e("./UI/bridge"),p=e("./util/audio_mgr"),f=e("./UI/hero"),m=e("./util/event_mgr"),_=e("./UI/door"),g=e("./UI/Boss"),y=e("./UI/skinPet"),v=cc._decorator,w=v.ccclass,C=v.property;(function(e){e[e.tnt=0]="tnt",e[e.windmill=1]="windmill",e[e.gear=2]="gear"})(n||(n={}));var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.enemyManager=[],t.coinManager=[],t.noviceRoadManager=[],t.testRoad=[],t.boosRoad=null,t.balloon=null,t.balloonPool=null,t.balloonManager=[],t.vertBrgManager=[],t.mapIndex=0,t.plot=null,t.gamePlot=null,t.plotOver=null,t.gameOverPet=null,t.BossPre=null,t.tnt=null,t.tntManager=[],t.windmill=null,t.gear=null,t.cloudF=[],t.cloudPool=new cc.NodePool,t.lastCloudPos=cc.v2(0,0),t.cloudManager=[],t.getSkillLayer=null,t.roadF=[],t.plantF=[],t.maxDistance=0,t.VisionLayer=null,t.visionPool=null,t.vision_road=null,t.visionManager=[],t.fence=null,t.getPetLayer=null,t.subRoad=0,t.lastVisionPos=cc.v2(0,0),t.road_min_dis=100,t.road_max_dis=200,t.isBorder=!1,t.createBoosRoad=!1,t.testIndex=0,t.firstBox=!0,t.boxDistance=0,t.boxDisOff=30,t.hatAct=[s.unicornAct,s.axeAct,s.shieldAct,s.speerAct,s.boomAct],t.ground_offset=[],t.gr_c=0,t.stopLastData=null,t.lastIndex=0,t.lastTop=null,t.GamePlot=[],t.plotMove=!1,t}return __extends(t,e),t.prototype.startFallCheck=function(){var e=this;this.schedule(function(){if(null!=r.default.instance.hero&&!(e.roadManager.length<=0||l.default.instance.gameState!=l.GameState.gamePlay&&l.default.instance.gameState!=l.GameState.gameNovice)){for(var t=1e4,o=null,n=new cc.Rect,a=0;a<e.roadManager.length;++a){var i=e.roadManager[a];(c=i.x-i.width/2-r.default.instance.hero.x)>0&&c<t&&(t=c,o=i);r.default.instance.hero.x,r.default.instance.hero.width;null!=o&&(n=o.getComponent(cc.PhysicsBoxCollider))}for(a=0;a<e.balloonManager.length;++a){var s=e.balloonManager[a];(c=s.x-s.width/2-r.default.instance.hero.x)>0&&c<t&&(t=c,o=s),n.size=cc.size(339,87)}for(a=0;a<e.vertBrgManager.length;++a){var c,d=e.vertBrgManager[a];(c=d.x-d.width/2-r.default.instance.hero.x)>0&&c<t&&(t=c,o=d),n.size=cc.size(d.width,d.height)}if(null!=o){var h=o.y+o.height/2-n.size.height-r.default.instance.hero.height-50;r.default.instance.mapCamera.y;r.default.instance.hero.y<h&&r.default.instance.hero.getComponent("hero").die(f.DieType.fall)}else r.default.instance.mapCamera.y<-5e3&&r.default.instance.hero.getComponent("hero").die(f.DieType.fall)}},.5)},t.prototype.init=function(){this.startFallCheck(),this.initVisionPool(),this.initCloudPool(),this.initBalloonPool()},t.prototype.initBalloonPool=function(){this.balloonPool=new cc.NodePool;for(var e=0;e<6;++e){var t=cc.instantiate(this.balloon);this.balloonPool.put(t)}},t.prototype.initVisionPool=function(){this.visionPool=new cc.NodePool;for(var e=0;e<10;e++){var t=cc.instantiate(this.vision_road);t.getComponent("vision_road").init(),this.visionPool.put(t)}for(e=0;e<4;++e)this.creatVisionRoad()},t.prototype.initCloudPool=function(){for(var e=0;e<6;++e){var t=(e+1)%3,o=new cc.Node,n=o.addComponent(cc.Sprite);n.spriteFrame=i.G.Game.getGRes(i.G.Game.GResType.Cloud,t),o.width=n.spriteFrame.getRect().width,o.height=n.spriteFrame.getRect().height,this.cloudPool.put(o)}for(e=0;e<6;++e)this.createCloud()},t.prototype.initNodeManger=function(){this.funs.push(this.startRoadManager.bind(this)),this.funs.push(this.startCoinManager.bind(this)),this.funs.push(this.startEnemyManager.bind(this)),this.funs.push(this.startVisionManager.bind(this)),this.funs.push(this.startCloudManager.bind(this)),this.funs.push(this.startTntManager.bind(this)),this.funs.push(this.startBridgeManager.bind(this))},t.prototype.startRoadManager=function(){var e=this;if(!r.default.instance.stopRoadManager&&l.default.instance.gameState!=l.GameState.gameNovice)for(0==r.default.instance.gameBoss&&(i.G.Game.fArr(this.roadManager,function(t){t.x+t.width/2+r.default.instance.windowSize.width/2+300<r.default.instance.mapCamera.x&&(r.default.instance.roadPool.put(t),i.G.Game.rmFromArray(t,e.roadManager))}),i.G.Game.fArr(this.balloonManager,function(t){t.x+t.width/2+r.default.instance.windowSize.width/2+300<r.default.instance.mapCamera.x&&(e.balloonPool.put(t),i.G.Game.rmFromArray(t,e.balloonManager))})),0==r.default.instance.gameBoss?this.subRoad=i.G.Game.max_road_num-(this.roadManager.length+this.balloonManager.length):this.subRoad=8-(this.roadManager.length+this.balloonManager.length);this.subRoad>0;)this.createRoad()},t.prototype.startCoinManager=function(){var e=this;i.G.Game.fArr(this.coinManager,function(t){if(t.x+t.width+r.default.instance.windowSize.width/2<r.default.instance.mapCamera.x){var o=t.coinManager;for(var n in o){var a=o[n];r.default.instance.coinPool.put(a)}i.G.Game.rmFromArray(t,e.coinManager)}})},t.prototype.startEnemyManager=function(){var e=this;r.default.instance.gameBoss||i.G.Game.fArr(this.enemyManager,function(t){if(t.x+r.default.instance.windowSize.width/2+t.width/2<r.default.instance.mapCamera.x){var o=t.getComponent("enemy").id,n=t.getComponent("enemy").info.HP;o>=s.EnemyType.boss_0&&n>0&&(r.default.instance.storageWealth(),p.AudioMgr.instance.changeBgmWithFade(p.BgmType.KGameBg,2)),n>0&&t.y<-2e3&&l.default.instance.eventManager.addEvent(m.EventType.KTaskPush,e,{}),t.getComponent("enemy").clean(),r.default.instance.enemyPool.put(t),i.G.Game.rmFromArray(t,e.enemyManager)}})},t.prototype.startVisionManager=function(){if(!r.default.instance.stopRoadManager)for(var e in this.visionManager){var t=this.visionManager[e];t.x+r.default.instance.windowSize.width/2+t.width/2<r.default.instance.mapCamera.x&&(i.G.Game.rmFromArray(t,this.visionManager),this.visionPool.put(t),this.creatVisionRoad())}},t.prototype.startCloudManager=function(){for(var e in this.cloudManager){var t=this.cloudManager[e];t.x+r.default.instance.windowSize.width/2+t.width/2<r.default.instance.mapCamera.x&&(i.G.Game.rmFromArray(t,this.cloudManager),this.cloudPool.put(t),this.createCloud())}},t.prototype.startTntManager=function(){for(var e in this.tntManager){var t=this.tntManager[e];t.x+t.width+r.default.instance.windowSize.width/2<r.default.instance.mapCamera.x&&(i.G.Game.rmFromArray(t,this.tntManager),t.destroy())}},t.prototype.startBridgeManager=function(){for(var e in r.default.instance.bridgeManager){var t=r.default.instance.bridgeManager[e];t.x+t.width+r.default.instance.windowSize.width/2+300<r.default.instance.mapCamera.x&&(t.run(),i.G.Game.rmFromArray(t,r.default.instance.bridgeManager))}},t.prototype.createCloud=function(){var e=this.getCloud(),t=r.default.instance.windowSize.height/2;e.setPosition(this.lastCloudPos.x+i.G.randRange(200,400),i.G.randRange(t-200,t-100)),this.VisionLayer.addChild(e),this.lastCloudPos=cc.v2(e.position.x+e.width/2,e.position.y),this.cloudManager.push(e)},t.prototype.getCloud=function(){var e=this.cloudPool.get();if(e.group="vision",null==e){var t=new cc.Node,o=t.addComponent(cc.Sprite),n=i.G.randRange(0,2);o.spriteFrame=this.cloudF[n],t.width=this.cloudF[n].getRect().width,t.height=this.cloudF[n].getRect().height}return e},t.prototype.creatVisionRoad=function(){var e=this.getVisionRoad();e.getComponent("vision_road").setData(),e.setPosition(this.lastVisionPos.x+i.G.randRange(500,800),r.default.instance.mapCamera.y+i.G.randRange(0,300)),this.VisionLayer.addChild(e,1e3),this.lastVisionPos=cc.v2(e.position.x+e.width/2,e.position.y),this.visionManager.push(e)},t.prototype.getVisionRoad=function(){var e=this.visionPool.get();return null==e&&(e=cc.instantiate(this.vision_road)).getComponent("vision_road").init(),e.group="road",e},t.prototype.createBoosRoadOver=function(){var e=this;0==i.G.GameData.petInfo[l.default.instance.gameLevel]?this.addPlotOver():r.default.instance.loadRoadRes(l.default.instance.gameLevel+1,function(){l.default.instance.gameLevel++,e.maxDistance=i.G.Game.getMaxDistance(l.default.instance.gameLevel),r.default.instance.dis_start=null,r.default.instance.startDistance()})},t.prototype.createRoad=function(){if(this.createBoosRoad){var e=l.default.instance.gameLevel,t=r.default.instance.roundBoss[e].json;this.createRoundByData(t,!0)}else{if(this.isBorder=!0,null!=this.stopLastData)return void this.createRoundByData(this.stopLastData);e=i.G.randRange(0,r.default.instance.roundData[l.default.instance.gameLevel].length-1),t=r.default.instance.roundData[l.default.instance.gameLevel][e].json;this.createRoundByData(t)}},t.prototype.createRandMap=function(e){this.subRoad-=1,1==r.default.instance.runOver&&(this.createBoosRoad=!0);var t=cc.v2(i.G.randRange(50,300)+r.default.instance.lastRoadPos.x,r.default.instance.lastRoadPos.y+i.G.randRange(50,100));Math.random()>.8&&this.addCoin(t);var o=r.default.instance.getRoad();r.default.instance.cleanRoad(o);var n=i.G.Game.getGameResId(l.default.instance.gameLevel),a=r.default.instance.roadF[n].length,s=i.G.randRange(0,a-1);this.first&&(s=0);var c=Math.random()>.9,d=o.width/2+i.G.randRange(this.road_min_dis,this.road_max_dis);Math.random()>.7&&0==e&&(d=o.width/2,c=!1),o.getComponent("road").setData(s,c);var u=r.default.instance.lastRoadPos.x+d,p=r.default.instance.lastRoadPos.y-o.height/2;o.setPosition(cc.v2(u,p)),o.getComponent("road").startFloat(),(this.firstBox||r.default.instance.distance>=this.boxDistance)&&(r.default.instance.addBoxToRoad(h.BoxType.weapon,o),this.boxDistance+=this.boxDisOff,this.firstBox=!1),this.addEnemyToRoad(o),Math.random()>.5&&!this.first?this.addEnemyToRoad(o):(Math.random()>.8&&!this.first&&this.addTntToRoad(o),Math.random(),Math.random()>.8&&0!=this.roadManager.length&&0!=l.default.instance.gameLevel&&!this.first&&this.addWindmillToRoad(o)),r.default.instance.lastRoadPos.x=o.x+o.width/2,r.default.instance.lastRoadPos.y=o.y+o.height/2,this.node.addChild(o),this.roadManager.push(o),this.first=!1},t.prototype.addWindmillToRoad=function(e,t){var o=cc.instantiate(this.windmill),n=o.width,a=(e.width-n)/2,r=cc.v2(i.G.randRange(0,a),e.height/2);null!=t&&(r.x=t.x),o.setPosition(r),o.getComponent("windmill").run(),e.getChildByName("windNode").addChild(o)},t.prototype.getTnt=function(){var e=cc.instantiate(this.tnt);return e.getComponent("tnt").init(),e},t.prototype.getBalloon=function(){var e=this.balloonPool.get();return null==e&&(e=cc.instantiate(this.balloon)),this.balloonManager.push(e),e},t.prototype.addTntToRoad=function(e,t){var o=this.getTnt(),n=(e.width-o.width)/2,a=cc.v2(e.x-e.width/2+i.G.randRange(-n,n),e.y+e.height/2);null!=t&&(a.x=t.x+e.x),o.setPosition(a),this.node.addChild(o,1e3),this.tntManager.push(o)},t.prototype.addEnemyToRoad=function(e,t,o){if(void 0===t&&(t=!1),t)for(var n in o){var a=o[n].id,c=o[n].hatId,l=o[n].pos.x+e.x,d=e.y+e.height/2+10;if(a>=3){var h=cc.instantiate(this.BossPre);h.getComponent(g.default).init(a-3),h.setPosition(l,d),this.node.addChild(h,1e3),r.default.instance.gBoss=h,r.default.instance.gbStartNode_1=e}else{if((m=r.default.instance.getEnemy()).getComponent("enemy").init(a),-1==c||null==c?r.default.instance.setEnemyAct(m,s.jumpThree):r.default.instance.setEnemyAct(m,this.hatAct[c]),m.setPosition(l,d),this.node.addChild(m,1e3),null==m.getComponent(s.commonAct));0==Number(n)&&Math.random()>0&&m.getComponent(s.commonAct).talk(0),this.enemyManager.push(m)}}else{var u=cc.v2(e.x-e.width/2+i.G.randRange(50,120),e.y+e.height/2+10),p=(a=0,1),f=Math.random();if(f>0&&f<.65){s.EnemyType.enemy_0;p=2}else if(f>=.65&&f<.9){s.EnemyType.enemy_1;p=1}else{s.EnemyType.enemy_2;p=1}for(n=0;n<p;++n){var m;(m=r.default.instance.getEnemy()).getComponent("enemy").init(a),r.default.instance.setEnemyAct(m,s.jumpThree),m.setPosition(u),this.node.addChild(m,1e3),0==Number(n)&&Math.random()>0&&m.getComponent(s.commonAct).talk(0),this.enemyManager.push(m),u.x+=m.width+5}}},t.prototype.addCoin=function(e,t){var o=new d.MultiCoin;o.create(t),o.setPosition(e),this.node.addChild(o,1e3),this.coinManager.push(o)},t.prototype.addGearToRoad=function(e,t){e.getChildByName("image").getComponent(cc.Sprite).spriteFrame;var o=cc.instantiate(this.gear);o.setPosition(t),e.getChildByName("otherNode").addChild(o)},t.prototype.addPlotOver=function(){r.default.instance.stopRoadManager=!0;var e=cc.instantiate(r.default.instance.plotOver);this.gameOverPet=e.getChildByName("pet"),r.default.instance.Scene[r.SceneType.main].addChild(e);var t=e.getChildByName("road_0"),o=e.getChildByName("road_1");t.getComponent("road").init(0,!1),o.getComponent("road").init(0,!1);var n=e.getChildByName("pet");n.getComponent("pet").init(l.default.instance.gameLevel),n.addComponent(c.Stand),e.width=t.width+o.width,e.height=o.height;var a=r.default.instance.lastRoadPos.x+e.width/2,i=r.default.instance.lastRoadPos.y-e.height/2;for(var s in e.children){var d=e.children[s];d.x+=a,d.y+=i}r.default.instance.lastRoadPos.x=a+e.width/2+200,r.default.instance.lastRoadPos.y=i+e.height/2},t.prototype.createNoviceData=function(){var e=r.default.instance.noviceInfo.json;r.default.instance.dealMapData(e);var t=null;for(var o in e){var n=e[o],a=null;if(n.id==i.G.Game.BRIDGE_ID);else if(n.id==i.G.Game.BALLOON_ID);else{if(a=r.default.instance.getRoad(),r.default.instance.cleanRoad(a),Number(o)==e.length-1){a.getComponent("road").setControl(function(){l.default.instance.gameState=l.GameState.gameNoviceOver,r.default.instance.Scene[r.SceneType.main].getComponent("main_scene").noviceOver(),i.G.reportToAladin(i.G.aladinType.toNovice)})}if(this.noviceRoadManager.push(a),a.getComponent("road").setData(n.id,n.dou),a.getComponent("road").startFloat(),null==t)t=n.y+a.height/2;else{var s=n.y+a.height/2;Math.abs(s-t)<10&&(n.y+=t-s)}if(a.setPosition(n.x,n.y),null==this.ground_offset[this.gr_c]){var c=cc.v2(a.width/2,r.default.instance.lastRoadPos.y-a.height/2-n.y);this.ground_offset[this.gr_c]=c}this.roadManager.push(a)}a.x+=r.default.instance.lastRoadPos.x+this.ground_offset[this.gr_c].x,a.y+=this.ground_offset[this.gr_c].y,this.node.addChild(a),this.first||this.addEnemyToRoad(a,!0,n.enemy);for(var d in n.chest){var u=n.chest[d].pos;r.default.instance.addBoxToRoad(h.BoxType.weapon,a,u)}Number(o)==e.length-1&&(n.id==i.G.Game.BRIDGE_ID||(r.default.instance.lastRoadPos.x=a.x+a.width/2,r.default.instance.lastRoadPos.y=a.y+a.height/2)),this.first=!1}this.gr_c++},t.prototype.createRoundByData=function(e,t){var o=this;void 0===t&&(t=!1),r.default.instance.dealMapData(e);var a=function(){if(s.subRoad<=0)return s.stopLastData=e,{value:void 0};var a=e[s.lastIndex];a.y=Math.floor(a.y);var c=null;if(a.id==i.G.Game.BRIDGE_ID){var d=new u.bridge,m=1==a.vertical?1:0;if(d.create(a.creatnumber,m),c=d,d.setPosition(a.x,a.y),null==s.ground_offset[s.gr_c]){var _=cc.v2(0,r.default.instance.lastRoadPos.y-d.height/2-a.y);s.ground_offset[s.gr_c]=_}}else if(a.id==i.G.Game.BALLOON_ID){if((c=s.getBalloon()).setPosition(a.x,a.y),null==s.ground_offset[s.gr_c]){_=cc.v2(c.width/2+i.G.randRange(50,100),r.default.instance.lastRoadPos.y-c.height/2-a.y);s.ground_offset[s.gr_c]=_}}else{if(c=r.default.instance.getRoad(),r.default.instance.cleanRoad(c),c.getComponent("road").setData(a.id,a.dou),c.getComponent("road").startFloat(),null==s.lastTop)s.lastTop=a.y+c.height/2;else{var g=a.y+c.height/2;Math.abs(g-s.lastTop)<10&&(a.y+=s.lastTop-g)}if(c.setPosition(a.x,a.y),null==s.ground_offset[s.gr_c]){_=cc.v2(c.width/2,r.default.instance.lastRoadPos.y-c.height/2-a.y);s.ground_offset[s.gr_c]=_}s.roadManager.push(c),t&&Number(s.lastIndex)<3&&c.getComponent("road").addBossSymbol(),(s.firstBox||r.default.instance.distance>=s.boxDistance)&&(r.default.instance.addBoxToRoad(h.BoxType.weapon,c),s.boxDistance+=s.boxDisOff,s.firstBox=!1)}if(c.x+=r.default.instance.lastRoadPos.x+s.ground_offset[s.gr_c].x,c.y+=s.ground_offset[s.gr_c].y,s.node.addChild(c),t)if(0==s.lastIndex){c.getComponent("road").setControl(function(){l.default.instance.gameState=l.GameState.gameNoTouch;var e=cc.v2(0,0);f.default.instance.rigidBody.linearVelocity=e,o.scheduleOnce(function(){f.default.instance.hero_pause=!1,r.default.instance.fenceLeft=cc.instantiate(o.fence);var e=c.width/2-33;r.default.instance.fenceLeft.setPosition(c.x-e,1e3),r.default.instance.node.addChild(r.default.instance.fenceLeft,3e3)},.5),o.scheduleOnce(function(){l.default.instance.gameState=l.GameState.gamePlay,r.default.instance.gameBoss=!0},1),o.getSkillLayer.getComponent("getSkillLayer").open()}),r.default.instance.gbStartNode_0=c}else s.lastIndex==e.length-1&&(r.default.instance.fenceRight=cc.instantiate(s.fence),r.default.instance.fenceRight.setPosition(c.x+100,1e3),r.default.instance.node.addChild(r.default.instance.fenceRight,3e3));if(!s.first){s.addEnemyToRoad(c,!0,a.enemy);for(var y in a.Obstruction){switch(a.Obstruction[y].id){case n.tnt:var v=a.Obstruction[y].pos;s.addTntToRoad(c,v);break;case n.windmill:v=a.Obstruction[y].pos;s.addWindmillToRoad(c,v);break;case n.gear:v=a.Obstruction[y].pos;s.addGearToRoad(c,v)}}}for(var y in a.chest);return s.lastIndex==e.length-1&&(a.id==i.G.Game.BRIDGE_ID?(r.default.instance.lastRoadPos.x=c.x+c.width,r.default.instance.lastRoadPos.y=c.y+c.height/2):(r.default.instance.lastRoadPos.x=c.x+c.width/2,r.default.instance.lastRoadPos.y=c.y+c.height/2),s.lastTop=null),s.first=!1,s.subRoad-=1,s.lastIndex==e.length-1?(s.lastIndex=0,s.stopLastData=null,t?(s.createBoosRoad=!1,r.default.instance.runOver=!1,t&&p.AudioMgr.instance.changeBgmWithFade(p.BgmType.KBoss,2),s.createBoosRoadOver()):1==r.default.instance.runOver&&(s.createBoosRoad=!0),s.road_range_count=i.G.randRange(2,3),"break"):void 0},s=this;for(this.lastIndex;this.lastIndex<e.length;this.lastIndex++){var c=a();if("object"==typeof c)return c.value;if("break"===c)break}this.gr_c++},t.prototype.addboss=function(){var e=r.default.instance.getEnemy();e.getComponent(g.default).init(l.default.instance.gameLevel),e.getComponent("enemy").origSY=500,e.getComponent("enemy").speedY=500,e.getComponent("enemy").a=1500;var t=cc.v2(r.default.instance.lastRoadPos.x-1700,r.default.instance.lastRoadPos.y+1e3);e.setPosition(t),this.node.addChild(e),this.enemyManager.push(e),p.AudioMgr.instance.changeBgmWithFade(p.BgmType.KBoss,2)},t.prototype.cleanRoadGameItem=function(e){var t=this,o=e.x+e.width/2,n=e.x-e.width/2;i.G.Game.fArr(this.enemyManager,function(e){e.x<o&&e.x>n&&(e.getComponent("enemy").clean(),r.default.instance.enemyPool.put(e),i.G.Game.rmFromArray(e,t.enemyManager))}),i.G.Game.fArr(this.tntManager,function(e){e.x<o&&e.x>n&&(i.G.Game.rmFromArray(e,t.tntManager),e.destroy())})},t.prototype.createPlot=function(e){if(void 0===e&&(e=4e3),0==i.G.GameData.petInfo[l.default.instance.gameLevel]){this.gamePlot=cc.instantiate(this.plot);var t=this.gamePlot.getChildByName("enemy"),o=this.gamePlot.getChildByName("road");o.getComponent("road").init(0,!1);var n=this.gamePlot.getChildByName("cage"),a=n.getChildByName("pet"),c=n.getChildByName("talk");0!=l.default.instance.gameLevel&&(c.active=!1),a.getComponent(cc.Sprite).spriteFrame=i.G.Game.getGRes(i.G.Game.GResType.Pet,l.default.instance.gameLevel),t.getComponent(g.default).init(l.default.instance.gameLevel),r.default.instance.setEnemyAct(t,s.jumpOne),t.getComponent(s.commonAct).talk(0);var d=cc.v2(r.default.instance.mapCamera.x+e,-100+r.default.instance.mapCamera.y);t.x+=d.x,t.y+=d.y,o.x+=d.x,o.y+=d.y,n.x+=d.x,n.y+=d.y,this.node.addChild(this.gamePlot)}},t.prototype.playNextPlot=function(){var e=this;if(0!=i.G.GameData.petInfo[l.default.instance.gameLevel]||l.default.instance.gameLevel==i.G.Game.max_check)l.default.instance.gameState=l.GameState.gamePlay,r.default.instance.dis_start=null,r.default.instance.startDistance();else{this.createPlot(1e4);var t=cc.moveBy(2,1e4,0);t.easing(cc.easeInOut(2)),r.default.instance.mapCamera.runAction(t);var o=cc.moveBy(2,1e4,0);o.easing(cc.easeInOut(2));var n=cc.moveBy(2,1e4,0);n.easing(cc.easeInOut(2)),r.default.instance.visionCamera.runAction(n),r.default.instance.heroCamera.runAction(cc.sequence(o,cc.callFunc(function(){e.extendMap()}),cc.delayTime(3),cc.callFunc(function(){var t=cc.moveBy(2,-1e4,0);t.easing(cc.easeInOut(2)),r.default.instance.mapCamera.runAction(t);var o=cc.moveBy(2,-1e4,0);o.easing(cc.easeInOut(2));var n=cc.moveBy(2,-1e4,0);n.easing(cc.easeInOut(2)),r.default.instance.visionCamera.runAction(n),r.default.instance.heroCamera.runAction(cc.sequence(o,cc.callFunc(function(){e.gamePlot.removeFromParent(),l.default.instance.gameState=l.GameState.gamePlay,r.default.instance.dis_start=null,r.default.instance.startDistance()})))})))}},t.prototype.playPlot=function(){var e=this;if(null==this.GamePlot[l.default.instance.gameLevel]){this.GamePlot[l.default.instance.gameLevel]=!0,l.default.instance.gameState=l.GameState.gamePlotOver;var t=this.gameOverPet.getPosition();t.x-=40;var o=cc.moveTo(5,t);this.plotMove=!0,r.default.instance.hero.runAction(cc.sequence(cc.delayTime(1),o,cc.callFunc(function(){e.plotMove=!1,e.gameOverPet.runAction(cc.sequence(cc.fadeOut(1),cc.callFunc(function(){e.gameOverPet.destroy(),e.getPetLayer.getComponent("getPetLayer").open(l.default.instance.gameLevel),i.G.GameData.setPetData(l.default.instance.gameLevel,y.skinPetState.toUnLook),r.default.instance.loadRoadRes(l.default.instance.gameLevel+1,function(){l.default.instance.gameLevel++,e.maxDistance=i.G.Game.getMaxDistance(l.default.instance.gameLevel),r.default.instance.setLens(1,cc.v2(0,0)),r.default.instance.stopRoadManager=!1})})))}))),r.default.instance.setLens(.7,cc.v2(0,0),.005)}},t.prototype.extendMap=function(){for(var e in this.roadManager){var t=this.roadManager[e];r.default.instance.roadPool.put(t),i.G.Game.rmFromArray(t,this.roadManager)}for(var e in this.visionManager){var o=this.visionManager[e];this.visionPool.put(o),i.G.Game.rmFromArray(o,this.visionManager)}for(var n=0;n<4;++n)this.createRoad();for(n=0;n<4;++n)this.creatVisionRoad()},t.prototype.noviceOver=function(){var e=this;cc.sys.localStorage.setItem("novice",1),r.default.instance.novice=!1,i.G.GlobalData.novice=1,this.roadManager=[],this.scheduleOnce(function(){var t=0;null!=r.default.instance.floorItem&&(t=r.default.instance.floorItem.getComponent("floor").height);var o=r.default.instance.floorItem.y+t;r.default.instance.hero.setPosition(f.default.instance.lastPos.x,o),r.default.instance.hero.opacity=0,f.default.instance.tw.node.active=!1;var n=cc.instantiate(r.default.instance.resurgAni),a=cc.v2(0,t);n.setPosition(a),e.scheduleOnce(function(){n.getComponent("resurgAni").run(f.default.instance.id,function(){r.default.instance.hero.x=f.default.instance.lastPos.x,r.default.instance.hero.y=o,r.default.instance.hero.opacity=255,f.default.instance.tw.node.active=!0,r.default.instance.openTaskLayer()})},.5),r.default.instance.floorItem.addChild(n),i.G.Game.fArr(e.noviceRoadManager,function(t){r.default.instance.roadPool.put(t),i.G.Game.rmFromArray(t,e.noviceRoadManager)}),i.G.Game.fArr(e.enemyManager,function(t){t.getComponent("enemy").clean(),r.default.instance.enemyPool.put(t),i.G.Game.rmFromArray(t,e.enemyManager)}),r.default.instance.node.getChildByName("noviceLab").removeFromParent();var s=cc.moveTo(1,0,0);s.easing(cc.easeInOut(2));var c=cc.moveTo(1,0,0);c.easing(cc.easeInOut(2));var d=cc.moveTo(1,0,0);d.easing(cc.easeInOut(2)),r.default.instance.heroCamera.runAction(s),r.default.instance.mapCamera.runAction(c),r.default.instance.visionCamera.runAction(d),e.scheduleOnce(function(){var e=r.default.instance.startRoad.getPosition();r.default.instance.startPos=cc.v2(e.x+r.default.instance.startRoad.width/2,e.y+r.default.instance.startRoad.height/2),r.default.instance.lastRoadPos=cc.v2(e.x+r.default.instance.startRoad.width/2,e.y+r.default.instance.startRoad.height/2),r.default.instance.setPlot(r.PlotStep.start),l.default.instance.gameState=l.GameState.game_Plot,r.default.instance.distance=0,r.default.instance.distance_lab.string=String(r.default.instance.distance)},3)},1)},t.prototype.showDoorAni=function(){var e=this.roadManager[0];r.default.instance.addDoorToRoad(e,_.doorState.open,r.SceneType.hell,r.SceneType.main);var t=cc.instantiate(r.default.instance.resurgAni),o=cc.v2(0,e.height/2);t.setPosition(o),t.getComponent("resurgAni").run(f.default.instance.id,function(){f.default.instance.node.removeFromParent(!1),f.default.instance.node.y=e.y+e.height/2+10,f.default.instance.node.x=e.x,f.default.instance.hero_pause=!1,f.default.instance.node.active=!0;var t=cc.v2(0,0);f.default.instance.rigidBody.linearVelocity=t,r.default.instance.playScene.addChild(f.default.instance.node)},0),e.addChild(t)},t.prototype.cleanAllUp=function(){var e=this;this.stopLastData=null,this.lastIndex=0,this.first=!0,i.G.Game.fArr(this.roadManager,function(t){r.default.instance.roadPool.put(t),i.G.Game.rmFromArray(t,e.roadManager)}),i.G.Game.fArr(this.balloonManager,function(t){e.balloonPool.put(t),i.G.Game.rmFromArray(t,e.balloonManager)}),i.G.Game.fArr(this.enemyManager,function(t){r.default.instance.enemyPool.put(t),i.G.Game.rmFromArray(t,e.enemyManager)}),i.G.Game.fArr(this.tntManager,function(t){t.destroy(),i.G.Game.rmFromArray(t,e.tntManager)})},__decorate([C([cc.JsonAsset])],t.prototype,"testRoad",void 0),__decorate([C(cc.JsonAsset)],t.prototype,"boosRoad",void 0),__decorate([C(cc.Prefab)],t.prototype,"balloon",void 0),__decorate([C(cc.Prefab)],t.prototype,"plot",void 0),__decorate([C(cc.Prefab)],t.prototype,"plotOver",void 0),__decorate([C(cc.Prefab)],t.prototype,"BossPre",void 0),__decorate([C(cc.Prefab)],t.prototype,"tnt",void 0),__decorate([C(cc.Prefab)],t.prototype,"windmill",void 0),__decorate([C(cc.Prefab)],t.prototype,"gear",void 0),__decorate([C([cc.SpriteFrame])],t.prototype,"cloudF",void 0),__decorate([C(cc.Node)],t.prototype,"getSkillLayer",void 0),__decorate([C(cc.Node)],t.prototype,"VisionLayer",void 0),__decorate([C(cc.Prefab)],t.prototype,"vision_road",void 0),__decorate([C(cc.Prefab)],t.prototype,"fence",void 0),__decorate([C(cc.Node)],t.prototype,"getPetLayer",void 0),t=__decorate([w],t)}(a.default);o.default=b,cc._RF.pop()},{"./UI/Boss":"Boss","./UI/box":"box","./UI/bridge":"bridge","./UI/door":"door","./UI/enemy":"enemy","./UI/hero":"hero","./UI/myCoin":"myCoin","./UI/skinPet":"skinPet","./game":"game","./game_logic":"game_logic","./game_scene":"game_scene","./ui/pet":"pet","./util/audio_mgr":"audio_mgr","./util/event_mgr":"event_mgr","./util/global_def":"global_def"}],myCoin:[function(e,t,o){"use strict";cc._RF.push(t,"043b73qEDVJz4NJCDktfrjY","myCoin"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=(n.property,e("./../util/global_def")),r=e("./../game_scene"),s=e("./../util/audio_mgr"),c=e("./hero"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.automatic=!1,t.easing=.2,t}return __extends(t,e),t.prototype.onCollisionEnter=function(e,t){var o=this,n=i.G.randRange(150,200),a=cc.jumpBy(.5,cc.v2(0,n),n,1),c=cc.rotateBy(.5,360);this.node.runAction(cc.sequence(cc.spawn(a,c),cc.callFunc(function(){o.node.active=!1})));r.default.instance.updateWealth(r.WealthType.coin,1,!1),s.AudioMgr.instance.playNewCoin()},t.prototype.update=function(){this.check(),this.move()},t.prototype.move=function(){if(0!=this.automatic){var e=c.default.instance.node.convertToWorldSpaceAR(cc.v2(0,0)),t=this.node.parent.convertToNodeSpaceAR(e),o=t.x-this.node.x,n=t.y-this.node.y,a=Math.sqrt(o*o+n+n);Math.abs(a)<5&&(this.automatic=!1,this.node.active=!1);var i=this.easing*o,r=this.easing*n;this.node.x+=i,this.node.y+=r}},t.prototype.check=function(){if(0!=i.G.Game.endlessSkills.magnet&&!this.automatic){var e=c.default.instance.node.convertToWorldSpaceAR(cc.v2(0,0)),t=this.node.parent.convertToNodeSpaceAR(e).x-this.node.x;Math.abs(t)<200&&(this.automatic=!0)}},t=__decorate([a],t)}(cc.Component);o.default=l;var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.max_line=3,t.max_count=8,t.coinManager=[],t}return __extends(t,e),t.prototype.create=function(e){if(this.anchorX=0,this.anchorY=0,e){var t=-1e4,o=1e4;for(var n in e){var a=e[n];(l=r.default.instance.getCoin()).getComponent("myCoin").automatic=!1,l.active=!0,l.stopAllActions(),l.rotation=0,this.addChild(l),l.setPosition(a),this.coinManager.push(l),a.x>t&&(t=a.x),a.x<o&&(o=a.x)}this.width=t}else{this.max_count=i.G.randRange(4,8),this.max_line=i.G.randRange(1,3);for(var s=0;s<this.max_line;++s)for(var c=0;c<this.max_count;++c){var l;(l=r.default.instance.getCoin()).getComponent("myCoin").automatic=!1,l.active=!0,l.stopAllActions(),l.rotation=0,this.addChild(l),l.setPosition(40*c,40*s),this.coinManager.push(l)}this.width=40*this.max_count+100}},t}(cc.Node);o.MultiCoin=d;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.act=!1,t}return __extends(t,e),t.prototype.onCollisionEnter=function(e,t){if(1==i.G.Game.endlessSkills.magnet&&0==this.act){this.act=!0;var o=this.node.coinManager;for(var n in o){o[n].getComponent("myCoin").automatic=!0}}},t}(cc.Component);o.MultiCoinCom=h,cc._RF.pop()},{"./../game_scene":"game_scene","./../util/audio_mgr":"audio_mgr","./../util/global_def":"global_def","./hero":"hero"}],newAwardLayer:[function(e,t,o){"use strict";cc._RF.push(t,"ccd78fKTAFBM5pG6SZRjFvb","newAwardLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../util/effect/shaker"),a=e("./../util/global_def"),i=e("../game_scene"),r=e("./../util/wx_util"),s=cc._decorator,c=s.ccclass,l=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.shaker=null,t.box=null,t.hero=null,t.light=null,t.coin=null,t.crown=null,t.coinEnd=null,t.crownEnd=null,t.coinF=null,t.crownF=null,t.coinLabel=null,t.crownLabel=null,t.coinNum=1e3,t.crownNum=10,t.heroId=null,t.boxId=null,t.boxData=null,t.openF=null,t.closeF=null,t.coinManager=[],t.crownManager=[],t.awardBtn=null,t}return __extends(t,e),t.prototype.open=function(e){this.boxId=e,this.node.active=!0,this.content.active=!1,this.getAward(),this.run(),this.clean()},t.prototype.clean=function(){this.box.getComponent(cc.Sprite).spriteFrame=this.closeF,this.light.active=!1,this.awardBtn.active=!1;for(var e in this.coinManager){this.coinManager[e].destroy()}this.coinManager=[];for(var e in this.crownManager){this.crownManager[e].destroy()}this.crownManager=[]},t.prototype.getAward=function(){var e=[],t=[],o=[];for(var n in this.boxData.json){Number(n[0])==this.boxId&&(1==this.boxData.json[n].type?e.push(this.boxData.json[n]):2==this.boxData.json[n].type?t.push(this.boxData.json[n]):o.push(this.boxData.json[n]))}var i=a.G.Game.getAwardIndex(e),r=a.G.Game.getAwardIndex(t),s=a.G.Game.getAwardIndex(o);null!=i&&(this.coinNum=e[i].open_numb),null!=r&&(this.crownNum=t[r].open_numb),null!=s&&(this.heroId=o[s].awardId)},t.prototype.close=function(){this.node.active=!1},t.prototype.run=function(){var e=this;this.shaker=new n.default,this.shaker.init([this.box],5,10,.025,2,n.ShakeType.kHor),this.shaker.shake(),this.box.active=!0,this.light.active=!1,this.scheduleOnce(function(){e.content.active=!0,e.coinLabel.string=String(e.coinNum),e.crownLabel.string=String(e.crownNum),e.crown.active=!1,e.box.getComponent(cc.Sprite).spriteFrame=e.openF;for(var t=Math.floor(e.coinNum/250),o=function(o){var n=new cc.Node;e.node.addChild(n);var a=n.addComponent(cc.Sprite);e.coinEnd.getPosition();a.spriteFrame=e.coinF,n.x=0,n.y=-65;var r=-70*(t-1)/2;e.coinManager.push(n),n.runAction(cc.sequence(cc.jumpTo(.4,cc.p(r+70*o,216),281,1),cc.delayTime(1+.2*o),cc.callFunc(function(){o==t-1&&i()})))},n=0;n<t;++n)o(n);e.coin.active=!0;var i=function(){e.crown.active=!0;for(var t=Math.floor(e.crownNum/5),o=function(o){var n=new cc.Node;n.scale=0,e.node.addChild(n);var a=n.addComponent(cc.Sprite);e.crownEnd.getPosition();a.spriteFrame=e.crownF,n.x=0,n.y=-65;var i=-70*(t-1)/2;e.crownManager.push(n),n.runAction(cc.sequence(cc.scaleTo(0,1),cc.jumpTo(.4,cc.p(i+70*o,136),201,1),cc.delayTime(1+.2*o),cc.callFunc(function(){o==t-1&&(r(),e.box.active=!1)})))},n=0;n<t;++n)o(n);e.awardBtn.active=!0},r=function(){null!=e.heroId?(e.light.active=!0,e.light.opacity=0,e.hero.getComponent(cc.Sprite).spriteFrame=a.G.Game.getGRes(a.G.Game.GResType.Hero,e.heroId),e.hero.y=-150,e.hero.runAction(cc.sequence(cc.callFunc(function(){e.light.opacity=255}),cc.jumpBy(.4,cc.p(0,150),150,1)))):e.light.active=!1}},2)},t.prototype.onClickAward=function(){var e=this;r.default.watchVideoAds(a.G.VideoId.trialHero,function(){i.default.instance.endLayer.getComponent("endLayer").luckySuc(),e.awardBtn.active=!1,i.default.instance.updateWealth(i.WealthType.coin,e.coinNum),i.default.instance.updateWealth(i.WealthType.crown,e.crownNum),i.default.instance.showTip("\u91d1\u5e01"+e.coinNum+"   \u738b\u51a0"+e.crownNum),a.G.Game.addShareCountCom();var t=function(t){var o=e.coinManager[t],a=cc.moveTo(.3,e.coinEnd.getPosition());o.runAction(cc.sequence(cc.delayTime(.1*Number(t)),a,cc.callFunc(function(){o.destroy(),Number(t)==e.coinManager.length-1&&(e.coinManager=[],n())})))};for(var o in e.coinManager)t(o);var n=function(){var t=function(t){var o=e.crownManager[t],n=cc.moveTo(.3,e.crownEnd.getPosition());o.runAction(cc.sequence(cc.delayTime(.1*Number(t)),n,cc.callFunc(function(){Number(t)==e.crownManager.length-1&&(e.crownManager=[]),o.destroy()})))};for(var o in e.crownManager)t(o)};a.G.GameData.setHeroData(e.heroId,a.G.GameData.skinHeroState.unlock)},function(){i.default.instance.showTip("\u672a\u89c2\u770b\u5b8c\u6574\u89c6\u9891\uff0c\u65e0\u6cd5\u83b7\u5f97\u5956\u52b1")})},t.prototype.update=function(e){null!=this.shaker&&this.shaker.update(e)},__decorate([l(cc.Node)],t.prototype,"content",void 0),__decorate([l(cc.Node)],t.prototype,"box",void 0),__decorate([l(cc.Node)],t.prototype,"hero",void 0),__decorate([l(cc.Node)],t.prototype,"light",void 0),__decorate([l(cc.Node)],t.prototype,"coin",void 0),__decorate([l(cc.Node)],t.prototype,"crown",void 0),__decorate([l(cc.Node)],t.prototype,"coinEnd",void 0),__decorate([l(cc.Node)],t.prototype,"crownEnd",void 0),__decorate([l(cc.SpriteFrame)],t.prototype,"coinF",void 0),__decorate([l(cc.SpriteFrame)],t.prototype,"crownF",void 0),__decorate([l(cc.Label)],t.prototype,"coinLabel",void 0),__decorate([l(cc.Label)],t.prototype,"crownLabel",void 0),__decorate([l(cc.JsonAsset)],t.prototype,"boxData",void 0),__decorate([l(cc.SpriteFrame)],t.prototype,"openF",void 0),__decorate([l(cc.SpriteFrame)],t.prototype,"closeF",void 0),__decorate([l([cc.Node])],t.prototype,"coinManager",void 0),__decorate([l([cc.Node])],t.prototype,"crownManager",void 0),__decorate([l(cc.Node)],t.prototype,"awardBtn",void 0),t=__decorate([c],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../game_scene":"game_scene","../util/effect/shaker":"shaker","./../util/global_def":"global_def","./../util/wx_util":"wx_util"}],openTask:[function(e,t,o){"use strict";cc._RF.push(t,"9ed26ms18FCPJ3ixV00kbue","openTask"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./../game_scene"),a=e("../util/effect/shaker"),i=cc._decorator,r=i.ccclass,s=i.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.box=null,t.openImage=null,t.target=null,t.coin=null,t.crown=null,t.coinLabel=null,t.rewardNode=null,t.awardBtn=null,t.shaker=null,t.awardNum=null,t}return __extends(t,e),t.prototype.run=function(e,t){var o=this;this.awardNum=t,this.awardBtn.active=!1,this.shaker=new a.default,this.shaker.init([this.box],5,10,.025,2,a.ShakeType.kHor),this.shaker.shake(),this.scheduleOnce(function(){o.box.getComponent(cc.Sprite).spriteFrame=o.openImage;var a=[];if(o.rewardNode.active=!0,o.coinLabel.string=String(t),1==e){o.coin.active=!0,o.coin.y-=219;var i=cc.jumpBy(.6,cc.v2(0,219),219,1);o.coin.runAction(i),a=o.coin.children}else{o.crown.active=!0,o.crown.y-=219;i=cc.jumpBy(.6,cc.v2(0,219),219,1);o.crown.runAction(i),a=o.crown.children}o.scheduleOnce(function(){o.awardBtn.active=!0;for(var i in a){var r=a[i],s=o.target.getPosition(),c=cc.moveTo(.5,s);if(c.easing(cc.easeOut(.5)),r.runAction(cc.sequence(cc.delayTime(.05*Number(i)),c,cc.fadeOut(.2))),Number(i)==a.length-1){var l=n.WealthType.coin;if(2==e)n.WealthType.crown;n.default.instance.updateWealth(l,t)}}},1.5)},2)},t.prototype.onClickClose=function(){this.node.destroy()},t.prototype.update=function(e){null!=this.shaker&&this.shaker.update(e)},t.prototype.onClickAwardBtn=function(){var e=this;n.default.instance.shareGame(function(){e.awardBtn.active=!1;var t=e.awardNum;n.default.instance.updateWealth(n.WealthType.coin,t),n.default.instance.showTip("\u606d\u559c\u83b7\u5f97\u91d1\u5e01:"+2*t),e.onClickClose()})},__decorate([s(cc.Node)],t.prototype,"box",void 0),__decorate([s(cc.SpriteFrame)],t.prototype,"openImage",void 0),__decorate([s(cc.Node)],t.prototype,"target",void 0),__decorate([s(cc.Node)],t.prototype,"coin",void 0),__decorate([s(cc.Node)],t.prototype,"crown",void 0),__decorate([s(cc.Label)],t.prototype,"coinLabel",void 0),__decorate([s(cc.Node)],t.prototype,"rewardNode",void 0),__decorate([s(cc.Node)],t.prototype,"awardBtn",void 0),t=__decorate([r],t)}(cc.Component);o.default=c,cc._RF.pop()},{"../util/effect/shaker":"shaker","./../game_scene":"game_scene"}],petLayer:[function(e,t,o){"use strict";cc._RF.push(t,"ebaf5/avNRL85YAkvNFa3Fi","petLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=e("./../UI/hero"),s=[1,0,0,0,0,0,0,0,0,0,0,0,0],c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.petId=null,t.petBtn=null,t.petCard=null,t.scrollview=null,t.targetIndex=0,t.totalIndex=0,t.petInfo=[],t}return __extends(t,e),t.prototype.init=function(){var e=this,t=this.getData();this.content.removeAllChildren();for(var o=0;o<5;++o){var n=cc.instantiate(this.petCard);n.getComponent("petCard").init(o),this.content.addChild(n),0==t[o]?n.getComponent("petCard").setLock(!0):n.getComponent("petCard").setLock(!1)}this.totalIndex=this.content.children.length-1,this.scheduleOnce(function(){var t=0;null!=r.default.instance.pet&&(t=r.default.instance.pet.getComponent("pet").id),e.scroll(t)},.1)},t.prototype.touchEnd=function(e){var t=e.content.children,o=e.content.parent,n=1e5,a=0;for(var i in t){var r=t[i],s=r.convertToWorldSpaceAR(cc.v2(0,0));s=o.convertToNodeSpaceAR(s),n>Math.abs(s.x-0)&&(n=Math.abs(s.x-0),a=Number(i)),r.setScale(1)}this.scroll(a)},t.prototype.open=function(){this.init(),this.node.active=!0,this.petBtn.getComponent("ui_motion").triggerMotion()},t.prototype.usePet=function(){this.close(),0!=this.getData()[this.targetIndex]&&(r.default.instance.addPet(this.targetIndex),cc.sys.localStorage.setItem("petId",this.targetIndex))},t.prototype.close=function(){this.node.active=!1},t.prototype.sliding=function(e,t){},t.prototype.clean=function(){var e=this.content.children;for(var t in e){var o=e[t];o.setScale(1),o.getComponent("petCard").setSelect(!1)}},t.prototype.scroll=function(e){this.targetIndex=e;var t=this.content.children;for(var o in t){var n=t[o];n.setScale(1),n.getComponent("petCard").setSelect(!1)}var a=t[e];a.setScale(1.2);var i=160*Number(e);this.scrollview.scrollToOffset(cc.v2(i,0)),a.getComponent("petCard").setSelect(!0)},t.prototype.turnToLeft=function(){this.targetIndex--,this.targetIndex<=0&&(this.targetIndex=0),this.scroll(this.targetIndex)},t.prototype.turnToRight=function(){this.targetIndex++,this.targetIndex>=this.totalIndex&&(this.targetIndex=this.totalIndex),this.scroll(this.targetIndex)},t.prototype.getData=function(){var e=cc.sys.localStorage.getItem("petInfo");return""!=e&&null!=e||(e=JSON.stringify(s),cc.sys.localStorage.setItem("petInfo",e)),this.petInfo=JSON.parse(e),this.petInfo},t.prototype.setData=function(e,t){this.petInfo[e]=t;var o=JSON.stringify(this.petInfo);cc.sys.localStorage.setItem("petInfo",o)},t.prototype.resetData=function(e){var t=(new Date).getDate(),o=cc.sys.localStorage.getItem("lastDate");if(t!=Number(o)){this.getData(),this.setData(e,0);var n=cc.sys.localStorage.getItem("petId");Number(n)==e&&cc.sys.localStorage.setItem("petId","")}cc.sys.localStorage.setItem("lastDate",t)},__decorate([i(cc.Node)],t.prototype,"content",void 0),__decorate([i(cc.Node)],t.prototype,"petBtn",void 0),__decorate([i(cc.Prefab)],t.prototype,"petCard",void 0),__decorate([i(cc.ScrollView)],t.prototype,"scrollview",void 0),t=__decorate([a],t)}(cc.Component);o.default=c,cc._RF.pop()},{"./../UI/hero":"hero"}],petTrialLayer:[function(e,t,o){"use strict";cc._RF.push(t,"929b1po1kBJd7nKFUEXQ+9G","petTrialLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./hero"),a=e("./../util/global_def"),i=e("../game_logic"),r=e("./../util/wx_util"),s=e("./../game_scene"),c=cc._decorator,l=c.ccclass,d=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.tag=null,t.items=[],t.petId=[],t.rand=0,t.exitBtn=null,t.banNode=null,t.firstClick=!1,t}return __extends(t,e),t.prototype.getPetId=function(){for(var e=[],t=[],o=0;o<a.G.Game.petCount;o++){0==a.G.GameData.petInfo[o]?t.push(o):e.push(o)}for(;3!=this.petId.length;)if(0!=t.length){o=t[n=a.G.randRange(0,t.length-1)];this.petId.push(o),t.splice(n,1)}else{var n;o=e[n=a.G.randRange(0,e.length-1)];this.petId.push(o),e.splice(n,1)}},t.prototype.init=function(){this.getPetId();for(var e in this.items){var t=this.petId[Number(e)],o=this.items[e],n=o.getChildByName("pet");n.getComponent(cc.Sprite).spriteFrame=a.G.Game.getGRes(a.G.Game.GResType.Pet,t),n.scale=130/n.getContentSize().width;var i=o.getChildByName("num");i.getComponent(cc.Label).string="\u7b2c"+String(t+1)+"\u5173\u83b7\u5f97",t>4&&(i.getComponent(cc.Label).string="\u8d2d\u4e70\u83b7\u5f97")}},t.prototype.open=function(e){var t=this;if(i.default.instance.gameType!=i.GameType.endless){this.init(),a.G.reportToAld(a.G.Report.petTrialLayer),this.node.active=!0;var o=null;o=wx.getSystemInfoSync().screenWidth-60,this.rand=a.G.randRange(0,100),this.firstClick=!0,a.G.ipShield(this.rand)?this.exitBtn.y=-454:(this.exitBtn.y=-334,this.firstClick=!1);this.content.getComponent("ui_motion").triggerMotion(function(){if(r.default.delBanner(),a.G.ipShield(t.rand)){var e=null;e=wx.getSystemInfoSync().screenWidth-60;var n=a.G.showBanner.trialPet.time-a.G.delayTime;n<=0?n=0:n>=a.G.maxTime&&(n=a.G.maxTime),a.G.startBanner(a.G.showBanner.trialPet),t.exitBtn.noTouch=!0,t.exitBtn.runAction(cc.sequence(cc.delayTime(n),cc.moveBy(0,0,120),cc.callFunc(function(){r.default.addBanner(a.G.BannerId[0],e,t.banNode),t.exitBtn.noTouch=!1})))}else r.default.addBanner(a.G.BannerId[0],o,t.banNode)})}},t.prototype.close=function(){a.G.stopBanner(a.G.showBanner.trialPet),this.exitBtn.noTouch||(r.default.delBanner(),this.closeLayer())},t.prototype.closeLayer=function(){r.default.delBanner(),this.node.active=!1,s.default.instance.favoNode.active=!0},t.prototype.onClickTrial=function(e,t){var o=this;a.G.stopBanner(a.G.showBanner.trialPet);var s=Number(t),c=this.petId[s],l=function(){n.default.instance.addPet(c),o.closeLayer(),a.G.Game.addShareCountCom(),c>=5&&a.G.reportToAld(a.G.Report.distance_1)};a.G.Game.getShareCountCom()>=i.default.instance.shareCount_com||1==i.default.instance.ip_switch&&0==i.default.instance.ip_share?r.default.watchVideoAds(a.G.VideoId.trialHero,function(){l(),a.G.reportToAld(a.G.Report.petTrialVideo)}):a.G.shareGame(function(){l(),a.G.reportToAld(a.G.Report.petTrialShare)})},t.prototype.onClickNoShowBtn=function(){0==a.G.GlobalData.petTrialClose?(this.tag.active=!0,a.G.GlobalData.petTrialClose=!0):(this.tag.active=!1,a.G.GlobalData.petTrialClose=!1)},__decorate([d(cc.Node)],t.prototype,"content",void 0),__decorate([d(cc.Node)],t.prototype,"tag",void 0),__decorate([d([cc.Node])],t.prototype,"items",void 0),__decorate([d(cc.Node)],t.prototype,"exitBtn",void 0),__decorate([d(cc.Node)],t.prototype,"banNode",void 0),t=__decorate([l],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../game_logic":"game_logic","./../game_scene":"game_scene","./../util/global_def":"global_def","./../util/wx_util":"wx_util","./hero":"hero"}],pet_arrow:[function(e,t,o){"use strict";cc._RF.push(t,"414c1GmSb1HyLw406azQGKP","pet_arrow"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=(n.property,e("./explode")),r=e("./hero"),s=e("./enemy"),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.a=.5,t.speedX=null,t.speedY=null,t.running=!1,t}return __extends(t,e),t.prototype.onCollisionEnter=function(e,t){e.node.getComponent(s.commonAct).damage(1,i.ExplodeType.hit),r.default.instance.pet.getComponent("pet_wp").arrowPool.put(t.node)},t.prototype.update=function(){if(0!=this.running){this.speedY-=this.a;var e=180*Math.atan2(this.speedY,this.speedX)/Math.PI;this.node.rotation=-e,this.node.x+=this.speedX,this.node.y+=this.speedY}},t=__decorate([a],t)}(cc.Component);o.default=c,cc._RF.pop()},{"./enemy":"enemy","./explode":"explode","./hero":"hero"}],pet_sword:[function(e,t,o){"use strict";cc._RF.push(t,"ba287UooY5PbajdKzP4XqGP","pet_sword"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=(n.property,e("./explode")),r=e("./enemy"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.running=!1,t}return __extends(t,e),t.prototype.onCollisionEnter=function(e,t){0!=this.running&&e.node.getComponent(r.commonAct).damage(1,i.ExplodeType.hit)},t=__decorate([a],t)}(cc.Component);o.default=s,cc._RF.pop()},{"./enemy":"enemy","./explode":"explode"}],pet_wp:[function(e,t,o){"use strict";cc._RF.push(t,"8b434dRAjlBh64qBtccHODQ","pet_wp"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=cc._decorator,i=a.ccclass,r=a.property,s=e("./../game_scene"),c=e("./hero"),l=e("./../util/global_def");(function(e){e[e.sword=0]="sword",e[e.arrow=1]="arrow",e[e.light=2]="light",e[e.fireball=3]="fireball",e[e.flame=4]="flame",e[e.wave=5]="wave",e[e.bullet=6]="bullet"})(n=o.pet_wp_type||(o.pet_wp_type={}));cc.v2(1,.5),cc.v2(-80,0),cc.size(100,40);var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pet_sword=null,t.sword=null,t.pet_arrow=null,t.arrowManager=[],t.arrowPool=null,t.light_0=null,t.light_1=null,t.fireball=null,t.wave=null,t.bullet=null,t.id=null,t.cool=!0,t}return __extends(t,e),t.prototype.init=function(e){switch(this.id=e,e){case n.sword:this.sword=cc.instantiate(this.pet_sword),this.sword.scale=1.5,this.node.getChildByName("wpNode").addChild(this.sword);break;case n.arrow:this.arrowPool=new cc.NodePool;for(var t=0;t<4;++t){var o=cc.instantiate(this.pet_arrow);this.arrowPool.put(o)}}},t.prototype.run=function(){var e=this;switch(this.id){case n.sword:if(!this.cool)return;this.cool=!1,this.sword.getComponent("pet_sword").running=!0,this.sword.runAction(cc.sequence(cc.rotateBy(.4,720),cc.callFunc(function(){e.cool=!0,e.sword.getComponent("pet_sword").running=!1})));break;case n.arrow:var t=this.arrowPool.get();if(null!=t){t.getComponent("pet_arrow").running=!0,t.getComponent("pet_arrow").a=1,t.getComponent("pet_arrow").speedX=28,t.getComponent("pet_arrow").speedY=14;var o=this.node.getPosition();s.default.instance.node.addChild(t),t.scale=.6,t.setPosition(o.x,o.y+10),t.stopAllActions(),t.runAction(cc.sequence(cc.delayTime(3),cc.callFunc(function(){e.arrowPool.put(t)})))}break;case n.light:for(var a=function(e){var t=new cc.Node;t.group="weapon",t.anchorY=1,t.scaleY=1.1;var o=t.addComponent(cc.BoxCollider);o.tag=l.G.Game.petLight,o.size=cc.size(100,984),o.offset=cc.v2(0,-405),t.addComponent(cc.Sprite).spriteFrame=i.light_0,t.x=i.node.x+350+100*e,t.y=i.node.y+s.default.instance.windowSize.height/2,t.opacity=0,s.default.instance.node.addChild(t);var n=new cc.Node;n.group="weapon";var a=n.addComponent(cc.BoxCollider);a.size=cc.size(100,984),a.offset=cc.v2(0,-405),a.tag=l.G.Game.petLight,n.anchorY=1,n.scaleY=1.1,n.addComponent(cc.Sprite).spriteFrame=i.light_1,n.x=i.node.x+350+100*e,n.y=i.node.y+s.default.instance.windowSize.height/2,n.opacity=0,s.default.instance.node.addChild(n),t.runAction(cc.sequence(cc.fadeTo(.1,255),cc.callFunc(function(){n.runAction(cc.sequence(cc.fadeTo(.5,255),cc.fadeTo(.8,0),cc.callFunc(function(){t.destroy(),n.destroy()})))}),cc.fadeTo(.8,0)))},i=this,r=0;r<2;++r)a(r);break;case n.fireball:(c=cc.instantiate(this.fireball)).addComponent(h),c.x=this.node.x+10,c.y=this.node.y+20,s.default.instance.node.addChild(c,1e3);break;case n.flame:break;case n.wave:(c=cc.instantiate(this.wave)).addComponent(h).fly_speed=15,c.x=this.node.x+10,c.y=this.node.y-33,s.default.instance.node.addChild(c,1e3);break;case n.bullet:var c;(c=cc.instantiate(this.bullet)).addComponent(u);c.x=this.node.x,c.y=this.node.y,s.default.instance.node.addChild(c,1e3)}},__decorate([r(cc.Prefab)],t.prototype,"pet_sword",void 0),__decorate([r(cc.Prefab)],t.prototype,"pet_arrow",void 0),__decorate([r(cc.SpriteFrame)],t.prototype,"light_0",void 0),__decorate([r(cc.SpriteFrame)],t.prototype,"light_1",void 0),__decorate([r(cc.Prefab)],t.prototype,"fireball",void 0),__decorate([r(cc.Prefab)],t.prototype,"wave",void 0),__decorate([r(cc.Prefab)],t.prototype,"bullet",void 0),t=__decorate([i],t)}(cc.Component);o.default=d;var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fly_speed=20,t.fly_speed_y=0,t}return __extends(t,e),t.prototype.update=function(){this.node.x+=this.fly_speed,this.node.y+=this.fly_speed_y,this.node.x-this.node.width/2>s.default.instance.heroCamera.x+s.default.instance.windowSize.width/2+50&&this.node.destroy()},t}(cc.Component),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fly_speed_x=10,t.fly_speed_y=3,t.ay=-.15,t}return __extends(t,e),t.prototype.update=function(){this.node.x+=this.fly_speed_x,this.fly_speed_y+=this.ay,this.node.y+=this.fly_speed_y;var e=Math.atan2(this.fly_speed_x,this.fly_speed_y)/6.28*360;this.node.rotation=e-90,this.node.y<=c.default.instance.node.y-1e3&&this.node.destroy()},t}(cc.Component);cc._RF.pop()},{"./../game_scene":"game_scene","./../util/global_def":"global_def","./hero":"hero"}],pet:[function(e,t,o){"use strict";cc._RF.push(t,"8f665jKHQlFh7E/wWhS+DK/","pet"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=cc._decorator,i=a.ccclass,r=a.property,s=e("./hero"),c=e("./../util/global_def"),l=e("./entity"),d=e("./../game_scene"),h=e("./enemy"),u=e("../game_logic"),p=e("./explode");(function(e){e[e.none=0]="none",e[e.idle=1]="idle",e[e.run_slow=2]="run_slow",e[e.run_fast=3]="run_fast",e[e.fight=4]="fight",e[e.fight_back=5]="fight_back"})(n=o.PetState||(o.PetState={}));var f=[cc.color(255,128,193),cc.color(240,238,93),cc.color(124,82,210),cc.color(254,220,84),cc.color(187,150,194),cc.color(187,150,194),cc.color(187,150,194)],m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.image=null,t.rigidBody=null,t.bridAni=null,t.fairyAni=null,t.dragonAni=null,t.dragonflyAni=null,t.devilAni=null,t.weapon=null,t.streak=null,t.state=n.idle,t.enemyTarget=null,t.magic_stick=null,t.id=null,t.imagePath=null,t.runFun=null,t}return __extends(t,e),t.prototype.init=function(e){if(this.imagePath="fight/pet/pet_",this.id=e,this.setTexture(e),e==s.PetType.bird){var t=cc.instantiate(this.bridAni);this.node.addChild(t),this.streak.node.active=!1}else if(e==s.PetType.elf){t=cc.instantiate(this.fairyAni);this.node.addChild(t);var o=new cc.Node;o.anchorY=0,o.scale=1.7,o.addComponent(cc.Sprite).spriteFrame=this.magic_stick,o.rotation=20,o.x=30,o.y=23,this.node.addChild(o,1e3,"magic_stick")}else if(e==s.PetType.dragon){t=cc.instantiate(this.dragonAni);this.node.addChild(t,1e3,"ani")}else if(e==s.PetType.pkq);else if(e==s.PetType.devil){(t=cc.instantiate(this.devilAni)).y=30,this.node.addChild(t,1e3,"ani")}else if(e==s.PetType.pkq_);else if(e==s.PetType.dragonfly){t=cc.instantiate(this.dragonflyAni);this.node.addChild(t,1e3,"ani")}this.streak.color=f[this.id],this.setRigidBody()},t.prototype.setTexture=function(e){var t=this,o=this.imagePath+String(e);this.image;cc.loader.loadRes(o,cc.SpriteFrame,function(e,o){if(!e){t.image;t.image.spriteFrame=o,t.node.width=o.getRect().width,t.node.height=o.getRect().height,t.setBox()}})},t.prototype.setBox=function(){var e=this.node.getComponent(cc.PhysicsBoxCollider);e.size=cc.size(this.node.width,this.node.height),e.offset.y=this.node.height/2,e.apply()},t.prototype.addWeapon=function(e){this.weapon=this.node.getComponent("pet_wp"),this.weapon.init(e)},t.prototype.setState=function(e){this.state=e},t.prototype.run=function(){null!=this.runFun&&this.runFun()},t.prototype.fight=function(){null!=this.weapon&&d.default.instance.playScene.getComponent("game").type!=d.SceneType.hell&&u.default.instance.gameState==u.GameState.gamePlay&&this.weapon.getComponent("pet_wp").run()},t.prototype.setRigidBody=function(){this.rigidBody.linearDamping=20},__decorate([r(cc.Sprite)],t.prototype,"image",void 0),__decorate([r(cc.RigidBody)],t.prototype,"rigidBody",void 0),__decorate([r(cc.Prefab)],t.prototype,"bridAni",void 0),__decorate([r(cc.Prefab)],t.prototype,"fairyAni",void 0),__decorate([r(cc.Prefab)],t.prototype,"dragonAni",void 0),__decorate([r(cc.Prefab)],t.prototype,"dragonflyAni",void 0),__decorate([r(cc.Prefab)],t.prototype,"devilAni",void 0),__decorate([r(cc.MotionStreak)],t.prototype,"streak",void 0),__decorate([r(cc.SpriteFrame)],t.prototype,"magic_stick",void 0),t=__decorate([i],t)}(cc.Component);o.default=m;var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pet=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.pet=this.node.getComponent(m)},t.prototype.onBeginContact=function(e,t,o){o.tag==c.G.Game.roadTag&&(c.G.Game.getDir(e)==c.G.Game.dir.up&&this.jump())},t.prototype.jump=function(){null==this.jumpComp&&(this.jumpComp=this.pet.image.node.addComponent(l.Jump)),this.jumpComp.run(l.jumpType.Hight)},t}(l.default);o.Stand=_;var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pet=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.pet=this.node.getComponent(m),this.pet.runFun=this.move.bind(this),this.checkDown()},t.prototype.run=function(){this.pet.setState(n.run_slow)},t.prototype.checkDown=function(){var e=this;this.schedule(function(){if(e.node.y<-d.default.instance.windowSize.height/2+d.default.instance.mapCamera.y){var t=cc.v2(s.default.instance.node.x-10,s.default.instance.node.y+150);e.node.position=t,e.speedY=0,e.speedX=0,e.pet.state=n.none}},.2)},t.prototype.onBeginContact=function(e,t,o){o.tag==c.G.Game.roadTag&&(this.speedX=0,c.G.Game.getDir(e)==c.G.Game.dir.up&&this.jump())},t.prototype.jump=function(){null==this.jumpComp&&(this.jumpComp=this.pet.image.node.addComponent(l.Jump)),this.pet.state==n.idle?this.jumpComp.run(l.jumpType.Hight):this.pet.state==n.none?this.jumpComp.run(l.jumpType.Hight):this.pet.state==n.run_slow&&this.jumpComp.run(l.jumpType.Left,0,.3,4)},t.prototype.move=function(e){var t=this;this.scheduleOnce(function(){if(s.default.instance.node.x-t.node.x>200){var e=cc.v2(s.MAX_SP.x,s.MAX_SP.y);t.pet.rigidBody.linearVelocity=e,t.pet.state=n.run_fast}else t.pet.state=n.run_slow},.1)},t.prototype.fail=function(){var e=s.default.instance.node.x-this.node.x;if(!(this.pet.rigidBody.linearVelocity.x<=s.STOP_SP.x))return e<100?(this.pet.rigidBody.linearVelocity=cc.v2(0,0),this.node.scaleY=.5,void(this.pet.state=n.run_slow)):void 0;this.pet.state=n.run_slow},t.prototype.findEnemy=function(){var e=d.default.instance.playScene.getComponent("game").enemyManager;for(var t in e){var o=e[t];if(!(o.getComponent("enemy").info.HP<=0)&&(c.G.Game.lookInWindow(o,.7)&&o.x>this.node.x))return this.pet.enemyTarget=o,o}return null},t.prototype.subUpdate=function(t){switch(this.node.scaleY=.5,this.pet.state){case n.none:this.pet.enemyTarget=null,e.prototype.subUpdate.call(this,t);break;case n.idle:if(e.prototype.subUpdate.call(this,t),null!=this.pet.enemyTarget)this.pet.enemyTarget.getComponent("enemy").info.HP<=0?this.pet.enemyTarget=null:this.pet.fight();else null!=this.findEnemy()&&(this.pet.state=n.run_slow);break;case n.run_slow:var o=s.default.instance.node.x+160;if(null!=this.pet.enemyTarget&&(Math.abs(this.pet.enemyTarget.y-this.node.y)>200?this.pet.enemyTarget=null:o=this.pet.enemyTarget.x-this.pet.enemyTarget.width/2-40),this.node.x>o)return this.pet.state=n.idle,void(this.speedX=0);e.prototype.subUpdate.call(this,t),null==this.pet.enemyTarget&&this.findEnemy();break;case n.run_fast:this.pet.enemyTarget=null,this.node.scaleY=.3,this.fail()}},t}(l.default);o.WalkNear=g;var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.a=2e3,t.origSY=600,t.pet=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.checkDown(),this.pet=this.node.getComponent(m),this.pet.runFun=this.move.bind(this)},t.prototype.checkDown=function(){var e=this;this.schedule(function(){if(e.node.y<-d.default.instance.windowSize.height/2+d.default.instance.mapCamera.y){var t=cc.v2(s.default.instance.node.x-10,s.default.instance.node.y+150);e.node.position=t,e.speedY=0,e.speedX=0,e.pet.state=n.none}},.2)},t.prototype.onBeginContact=function(e,t,o){o.tag==c.G.Game.roadTag&&(this.speedX=0,c.G.Game.getDir(e)==c.G.Game.dir.up&&this.jump())},t.prototype.jump=function(){null==this.jumpComp&&(this.jumpComp=this.pet.image.node.addComponent(l.Jump)),this.pet.state==n.idle?this.jumpComp.run(l.jumpType.Hight):this.pet.state==n.none?this.jumpComp.run(l.jumpType.Hight):this.pet.state==n.run_slow&&this.jumpComp.run(l.jumpType.Left,0,.3,3)},t.prototype.move=function(){var e=this;this.scheduleOnce(function(){if(s.default.instance.node.x-e.node.x>200){e.scheduleOnce(function(){e.pet.fight()},.1);var t=cc.v2(s.MAX_SP.x,s.MAX_SP.y);e.pet.rigidBody.linearVelocity=t,e.pet.state=n.run_fast}else e.pet.fight(),e.pet.state=n.run_slow},.1)},t.prototype.fail=function(){var e=s.default.instance.node.x-this.node.x;if(!(this.pet.rigidBody.linearVelocity.x<s.STOP_SP.x))return e<100?(this.pet.rigidBody.linearVelocity=cc.v2(0,0),void(this.pet.state=n.run_slow)):void 0;this.pet.state=n.run_slow},t.prototype.subUpdate=function(t){switch(this.node.scaleY=.5,this.pet.state){case n.none:case n.idle:e.prototype.subUpdate.call(this,t);break;case n.run_slow:s.default.instance.node.x;var o=s.default.instance.node.x-100;if(this.node.x>o)return this.pet.state=n.idle,void(this.speedX=0);e.prototype.subUpdate.call(this,t);break;case n.run_fast:this.fail(),this.node.scaleY=.3}},t}(l.default);o.WalkFar=y;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.checkDown(),this.pet=this.node.getComponent(m),this.pet.runFun=this.move.bind(this),this.schedule(function(){e.pet.fight()},3)},t.prototype.move=function(){var e=this;this.scheduleOnce(function(){if(s.default.instance.node.x-e.node.x>200){var t=cc.v2(s.MAX_SP.x,s.MAX_SP.y);e.pet.rigidBody.linearVelocity=t,e.pet.state=n.run_fast}else e.pet.state=n.run_slow},.1)},t}(y);o.Wizard=v;var w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pet=null,t.target=cc.v2(0,0),t.eaing=.1,t.time=120,t.runUpate=!1,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.node.group="flyImpact",this.pet=this.node.getComponent(m),this.pet.getComponent(cc.PhysicsBoxCollider).sensor=!0,this.pet.state=n.idle,this.pet.runFun=this.move.bind(this),this.runUpate=!0,this.schedule(function(){e.pet.state=n.fight,e.scheduleOnce(function(){e.pet.state=n.fight_back},2)},5)},t.prototype.onCollisionEnter=function(e,t){e.node.getComponent(h.commonAct).damage(1,p.ExplodeType.hit)},t.prototype.move=function(){this.pet.state!=n.fight&&(this.pet.state=n.run_fast)},t.prototype.fly=function(){var e=this.target.x-this.node.x,t=this.target.y-this.node.y;Math.sqrt(e*e+t*t)<1&&(this.node.x=this.target.x,this.node.y=this.target.y,this.pet.state==n.fight_back||this.pet.state==n.run_fast?this.pet.state=n.idle:this.pet.state==n.fight&&(this.pet.state=n.fight_back)),this.node.x+=e*this.eaing,this.node.y+=t*this.eaing},t.prototype.update=function(){switch(this.pet.state){case n.idle:this.target.x=s.default.instance.node.x-100,this.target.y=s.default.instance.node.y+100,this.eaing=.03;break;case n.run_fast:this.target.x=s.default.instance.node.x-100,this.target.y=s.default.instance.node.y+100,this.eaing=.1;break;case n.fight:this.target.x=s.default.instance.node.x+1e3,this.target.y=this.node.y,this.eaing=.05;break;case n.fight_back:this.target.x=s.default.instance.node.x-100,this.target.y=this.node.y,this.eaing=.07}this.fly()},t}(cc.Component);o.FlyImpact=w;var C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pet=null,t.target=cc.v2(0,0),t.eaing=.1,t.time=120,t.runUpate=!1,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.pet=this.node.getComponent(m),this.pet.state=n.idle,this.pet.runFun=this.move.bind(this),this.runUpate=!0,this.schedule(function(){e.pet.state=n.fight},3)},t.prototype.move=function(){this.pet.state=n.run_fast},t.prototype.fly=function(){var e=this.target.x-this.node.x,t=this.target.y-this.node.y;Math.sqrt(e*e+t*t)<1&&(this.node.x=this.target.x,this.node.y=this.target.y,this.pet.state==n.run_fast&&(this.pet.state=n.idle)),this.node.x+=e*this.eaing,this.node.y+=t*this.eaing},t.prototype.update=function(){var e=this;switch(this.pet.state){case n.idle:this.target.x=s.default.instance.node.x-100,this.target.y=s.default.instance.node.y+100,this.eaing=.03;break;case n.run_fast:this.target.x=s.default.instance.node.x-100,this.target.y=s.default.instance.node.y+100,this.eaing=.1;break;case n.fight:this.node.getChildByName("magic_stick").runAction(cc.sequence(cc.rotateBy(.2,70),cc.callFunc(function(){e.pet.fight()}),cc.delayTime(.7),cc.rotateBy(.2,-70))),this.pet.state=n.idle}this.fly()},t}(cc.Component);o.Hang=C;var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pet=null,t.dra=null,t.fire=null,t.target=cc.v2(0,0),t.eaing=.1,t.time=120,t.runUpate=!1,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.pet=this.node.getComponent(m),this.pet.state=n.idle,this.pet.runFun=this.move.bind(this),this.runUpate=!0;var t=this.node.getChildByName("ani");this.dra=t.getComponent(dragonBones.ArmatureDisplay),this.fire=t.getChildByName("fire"),this.dra.playAnimation("qianjin",-1),this.schedule(function(){e.pet.state=n.fight,e.dra.playAnimation("gongji_1",-1),e.scheduleOnce(function(){e.pet.state=n.fight_back,e.dra.playAnimation("qianjin",-1)},2)},5)},t.prototype.move=function(){this.pet.state!=n.fight&&(this.pet.state=n.run_fast,this.dra.playAnimation("qianjin",-1))},t.prototype.fly=function(){var e=this.target.x-this.node.x,t=this.target.y-this.node.y;Math.sqrt(e*e+t*t)<1&&(this.node.x=this.target.x,this.node.y=this.target.y,this.pet.state==n.fight_back||this.pet.state==n.run_fast?(this.pet.state=n.idle,this.dra.playAnimation("qianji",-1)):this.pet.state==n.fight&&(this.pet.state=n.fight_back)),this.node.x+=e*this.eaing,this.node.y+=t*this.eaing},t.prototype.update=function(){switch(this.pet.state){case n.idle:this.target.x=s.default.instance.node.x-100,this.target.y=s.default.instance.node.y+100,this.eaing=.03;break;case n.run_fast:this.target.x=s.default.instance.node.x-100,this.target.y=s.default.instance.node.y+100,this.eaing=.1;break;case n.fight:this.fire.active=!0,this.target.x=s.default.instance.node.x+800,this.target.y=this.node.y,this.eaing=.01;break;case n.fight_back:this.fire.active=!1,this.target.x=s.default.instance.node.x-100,this.target.y=this.node.y,this.eaing=.07}this.fly()},t}(cc.Component);o.dragon=b;var x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dra=null,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.checkDown(),this.pet=this.node.getComponent(m),this.pet.runFun=this.move.bind(this);var t=this.node.getChildByName("ani");this.dra=t.getComponent(dragonBones.ArmatureDisplay),this.dra.playAnimation("jingzhi",-1),this.schedule(function(){e.pet.fight()},3)},t.prototype.checkDown=function(){var e=this;this.schedule(function(){if(e.node.y<-d.default.instance.windowSize.height/2+d.default.instance.mapCamera.y){var t=cc.v2(s.default.instance.node.x-10,s.default.instance.node.y+150);e.node.position=t,e.speedY=0,e.speedX=0,e.pet.state=n.idle,e.dra.playAnimation("jingzhi",-1)}},.2)},t.prototype.move=function(){var e=this;this.scheduleOnce(function(){if(s.default.instance.node.x-e.node.x>200){var t=cc.v2(s.MAX_SP.x,s.MAX_SP.y);e.pet.rigidBody.linearVelocity=t,e.pet.state=n.run_fast,e.dra.playAnimation("qianjin",-1)}else e.pet.state=n.run_slow,e.dra.playAnimation("jingzhi",-1)},.1)},t.prototype.jump=function(){null==this.jumpComp&&(this.jumpComp=this.pet.image.node.addComponent(l.Jump)),this.pet.state==n.idle?this.jumpComp.run(l.jumpType.Hight,-500):this.pet.state==n.run_slow&&this.jumpComp.run(l.jumpType.Left,-500,.3,3)},t.prototype.subUpdate=function(t){switch(this.pet.state){case n.idle:e.prototype.subUpdate.call(this,t);break;case n.run_slow:var o=s.default.instance.node.x-100;if(this.node.x>o)return this.pet.state=n.idle,this.speedX=0,void this.dra.playAnimation("jingzhi",-1);e.prototype.subUpdate.call(this,t);break;case n.run_fast:this.fail()}},t}(y);o.pkq=x;var S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.pet=null,t.target=cc.v2(0,0),t.eaing=.1,t.time=120,t.runUpate=!1,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.pet=this.node.getComponent(m),this.pet.state=n.idle,this.pet.runFun=this.move.bind(this),this.runUpate=!0,this.schedule(function(){e.pet.state=n.fight},3)},t.prototype.move=function(){this.pet.state=n.run_fast},t.prototype.fly=function(){var e=this.target.x-this.node.x,t=this.target.y-this.node.y;Math.sqrt(e*e+t*t)<1&&(this.node.x=this.target.x,this.node.y=this.target.y,this.pet.state==n.run_fast&&(this.pet.state=n.idle)),this.node.x+=e*this.eaing,this.node.y+=t*this.eaing},t.prototype.update=function(){switch(this.pet.state){case n.idle:this.target.x=s.default.instance.node.x-100,this.target.y=s.default.instance.node.y+100,this.eaing=.03;break;case n.run_fast:this.target.x=s.default.instance.node.x-100,this.target.y=s.default.instance.node.y+100,this.eaing=.1;break;case n.fight:this.pet.fight(),this.pet.state=n.idle}this.fly()},t}(cc.Component);o.devil=S;var G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.pet=this.node.getComponent(m),this.pet.state=n.idle,this.pet.runFun=this.move.bind(this),this.runUpate=!0,this.schedule(function(){e.pet.state=n.fight},4)},t.prototype.update=function(){switch(this.pet.state){case n.idle:this.target.x=s.default.instance.node.x-50,this.target.y=s.default.instance.node.y+100,this.eaing=.03;break;case n.run_fast:this.target.x=s.default.instance.node.x-50,this.target.y=s.default.instance.node.y+100,this.eaing=.15;break;case n.fight:this.pet.fight(),this.pet.state=n.idle}this.fly()},t}(S);o.dragonfly=G,cc._RF.pop()},{"../game_logic":"game_logic","./../game_scene":"game_scene","./../util/global_def":"global_def","./enemy":"enemy","./entity":"entity","./explode":"explode","./hero":"hero"}],resurgAni:[function(e,t,o){"use strict";cc._RF.push(t,"886580a0fBPUrbv/z9rSQt6","resurgAni"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./../util/global_def"),a=cc._decorator,i=a.ccclass,r=a.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sm_bg=null,t.wing_0=null,t.wing_1=null,t.hero=null,t}return __extends(t,e),t.prototype.run=function(e,t,o){var a=this;void 0===o&&(o=.5),this.hero.spriteFrame=n.G.Game.getGRes(n.G.Game.GResType.Hero,e),this.sm_bg.scaleY=.1,this.wing_0.opacity=0,this.wing_1.opacity=0,this.scheduleOnce(function(){var e=cc.scaleTo(.5,1,1);a.sm_bg.runAction(e);var o=cc.moveTo(.5,0,0);o.easing(cc.easeOut(.5)),a.hero.node.runAction(cc.sequence(o,cc.callFunc(function(){a.wing_0.runAction(cc.fadeTo(.5,255)),a.wing_1.runAction(cc.fadeTo(.5,255)),t&&t(),a.hero.node.destroy(),a.node.runAction(cc.sequence(cc.delayTime(0),cc.fadeOut(2),cc.callFunc(function(){a.node.destroy()})))})))},o)},__decorate([r(cc.Node)],t.prototype,"sm_bg",void 0),__decorate([r(cc.Node)],t.prototype,"wing_0",void 0),__decorate([r(cc.Node)],t.prototype,"wing_1",void 0),__decorate([r(cc.Sprite)],t.prototype,"hero",void 0),t=__decorate([i],t)}(cc.Component);o.default=s,cc._RF.pop()},{"./../util/global_def":"global_def"}],road:[function(e,t,o){"use strict";cc._RF.push(t,"09a06U20OlNZL4/Wysoiq1J","road"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=e("./../util/global_def"),s=e("./../game_scene"),c=e("./../game_logic"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.callFun=null,t}return __extends(t,e),t.prototype.onCollisionEnter=function(e,o){this.callFun&&(this.callFun(),this.node.removeComponent(t))},t}(cc.Component),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.image=null,t.plantNode=null,t.plantPool=null,t.symbol=[],t.controlNode=null,t.id=null,t.boxHeight=100,t.isFloat=!1,t}return __extends(t,e),t.prototype.init=function(e,t){void 0===t&&(t=!1),this.initPlantPool(),this.setData(e,t)},t.prototype.setControl=function(e){this.controlNode.group="control",this.controlNode.addComponent(l).callFun=e},t.prototype.initPlantPool=function(){this.plantPool=new cc.NodePool;for(var e=0;e<10;++e){var t=new cc.Node;t.setAnchorPoint(cc.v2(0,0));t.addComponent(cc.Sprite);this.plantPool.put(t)}},t.prototype.setData=function(e,t){void 0===t&&(t=!1),this.id=e,this.isFloat=t,this.setTexture(e)},t.prototype.setDataEx=function(e,t){void 0===t&&(t=!1),this.isFloat=t,this.image.spriteFrame=e,this.node.width=e.getRect().width,this.node.height=e.getRect().height;var o=this.node.getComponent(cc.PhysicsBoxCollider);o.size=cc.size(this.node.width,this.boxHeight),o.offset.y=this.node.height/2-this.boxHeight/2,o.apply();var n=this.node.getComponent(cc.BoxCollider);n.size=cc.size(this.node.width,this.boxHeight),n.offset.y=this.node.height/2-this.boxHeight/2,this.cleanPlant()},t.prototype.startFloat=function(){if(this.node.stopAllActions(),this.isFloat){var e=r.G.randRange(40,60);this.node.runAction(cc.repeatForever(cc.sequence(cc.moveBy(2,0,e),cc.moveBy(2,0,-e))))}},t.prototype.addBossSymbol=function(){for(var e=0;e<3;++e){var t=r.G.randRange(0,4),o=new cc.Node;o.setAnchorPoint(.5,0),o.addComponent(cc.Sprite).spriteFrame=this.symbol[t],o.setPosition(60*e-100,0),this.plantNode.addChild(o,3e3)}},t.prototype.setTexture=function(e){var t=r.G.Game.getGameResId(c.default.instance.gameLevel),o=s.default.instance.roadF[t][e];this.image.spriteFrame=o,this.node.width=o.getRect().width,this.node.height=o.getRect().height;var n=this.node.getComponent(cc.PhysicsBoxCollider);n.size=cc.size(this.node.width,this.boxHeight),n.offset.y=this.node.height/2-this.boxHeight/2,n.apply();var a=this.node.getComponent(cc.BoxCollider);a.size=cc.size(this.node.width,this.boxHeight),a.offset.y=this.node.height/2-this.boxHeight/2,this.createPlant()},t.prototype.cleanPlant=function(){for(var e=this.plantNode.children,t=e.length;t>=0;t--){var o=e[t];this.plantPool.put(o)}},t.prototype.createPlant=function(){var e=this.node.width,t=-e/2;this.cleanPlant();for(var o=r.G.Game.getGameResId(c.default.instance.gameLevel),n=0;n<10;++n){var a=s.default.instance.plantF[o].length,i=r.G.randRange(0,a-1),l=this.plantPool.get();l.setAnchorPoint(cc.v2(0,0));var d=l.addComponent(cc.Sprite),h=s.default.instance.plantF[o][i];if(d.spriteFrame=h,l.width=h.getRect().width,t+l.width>e/2){this.plantPool.put(l);break}l.x=t,this.plantNode.addChild(l),t+=l.width+r.G.randRange(5,100)}},t.prototype.onBeginContact=function(e,t,o){if(o.tag==r.G.Game.heroTag||o.tag==r.G.Game.enemyTag||o.tag==r.G.Game.boxTag){var n=o,a=r.G.Game.getDir(e);if(o.tag==r.G.Game.heroTag&&a==r.G.Game.dir.right){var i=!0,c=s.default.instance.playScene.getComponent("game").roadManager;if(r.G.Game.fArr(c,function(e){var t=e.y+e.height/2,o=Math.abs(n.node.y-t),a=n.node.x,r=e.x-e.width/2,s=e.x+e.width/2;o<30&&o>0&&a>r&&a<s&&(i=!1)}),!i)return;n.node.getComponent("entity").sidefric=!0,n.node.getComponent("entity").side_jump=!1,n.node.getComponent("entity").s_speed=1,n.node.getComponent("entity").s_jump_h=100,n.node.getComponent("entity").s_min_y=t.node.y+t.node.height/2-t.size.height/2,n.node.getComponent("entity").s_max_y=t.node.y+t.node.height/2+5}}},t.prototype.onEndContact=function(e,t,o){},__decorate([i(cc.Sprite)],t.prototype,"image",void 0),__decorate([i(cc.Node)],t.prototype,"plantNode",void 0),__decorate([i([cc.SpriteFrame])],t.prototype,"symbol",void 0),__decorate([i(cc.Node)],t.prototype,"controlNode",void 0),t=__decorate([a],t)}(cc.Component);o.default=d,cc._RF.pop()},{"./../game_logic":"game_logic","./../game_scene":"game_scene","./../util/global_def":"global_def"}],shader_com:[function(e,t,o){"use strict";cc._RF.push(t,"5fd05u0aoRPH5CFbIehMxtx","shader_com"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./shader_mgr"),a=cc._decorator,i=a.ccclass,r=a.property,s=a.requireComponent,c=a.executeInEditMode,l=[n.ShaderType.Fluxay,n.ShaderType.FluxaySuper],d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._shader=n.ShaderType.Default,t._color=cc.color(),t._start=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"shader",{get:function(){return this._shader},set:function(e){this._shader=e,this._applyShader()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"material",{get:function(){return this._material},enumerable:!0,configurable:!0}),t.prototype.start=function(){this.getComponent(cc.Sprite).setState(0),this._applyShader()},t.prototype.update=function(e){this._material&&(this._setShaderColor(),this._setShaderTime(e))},t.prototype._applyShader=function(){var e=this._shader,t=this.getComponent(cc.Sprite),o=n.default.useShader(t,e);if(o){this._material=o,this._start=0;var a=this._color;if(a.setR(255),a.setG(255),a.setB(255),a.setA(255),!o)return;switch(e){case n.ShaderType.Blur:case n.ShaderType.GaussBlur:o.setNum(.03)}this._setShaderColor(),cc.log("shader",e)}},t.prototype._setShaderColor=function(){var e=this.node,t=e.color,o=this._color,n=t.getR(),a=t.getG(),i=t.getB(),r=e.opacity,s=!1;o.getR()!==n&&(o.setR(n),s=!0),o.getG()!==a&&(o.setG(a),s=!0),o.getB()!==i&&(o.setB(i),s=!0),o.getA()!==r&&(o.setA(r),s=!0),s&&this._material.setColor(n/255,a/255,i/255,r/255)},t.prototype._setShaderTime=function(e){if(l.indexOf(this._shader)>=0){var t=this._start;t>65535&&(t=0),t+=e,this._material.setTime(t),this._start=t}},__decorate([r({type:cc.Enum(n.ShaderType),visible:!1})],t.prototype,"_shader",void 0),__decorate([r({type:cc.Enum(n.ShaderType)})],t.prototype,"shader",null),t=__decorate([i,c,s(cc.Sprite)],t)}(cc.Component);o.default=d,cc._RF.pop()},{"./shader_mgr":"shader_mgr"}],shader_hue:[function(e,t,o){"use strict";cc._RF.push(t,"51bd9U7ZORDKJNtXHQwBQih","shader_hue"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../shader_com"),a=cc._decorator,i=a.ccclass,r=(a.property,a.requireComponent),s=(a.executeInEditMode,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timer_=0,t.time_=0,t.step_=0,t.destHue_=0,t.curHue_=0,t.bChange_=!1,t}return __extends(t,e),t.prototype.changeHue=function(e,t){if(void 0===t&&(t=0),this.bChange_=!0,e=cc.misc.clampf(e,-180,180),t>0){var o=Math.abs(e-this.curHue_),n=e>this.curHue_?1:-1,a=cc.game.getFrameRate();this.step_=n*o/(t*a),this.destHue_=e,this.time_=t,this.timer_=0}else this._material&&this._material.setHue(e),this.curHue_=e;cc.log("changeHue",e,t,this.step_)},t.prototype._applyShader=function(){e.prototype._applyShader.call(this),this._material&&this._material.setHue(0),this.timer_=0,this.time_=0,this.curHue_=0,this.destHue_=0,this.step_=0},t.prototype.update=function(t){e.prototype.update.call(this,t),this.bChange_&&(this.timer_<=this.time_?(this.timer_+=t,this.curHue_+=this.step_,this._material&&this._material.setHue(this.curHue_)):(this._material&&this._material.setHue(this.destHue_),cc.log("change hue over"),this.bChange_=!1))},t=__decorate([i,r(cc.Sprite)],t)}(n.default));o.HueShader=s,cc._RF.pop()},{"../shader_com":"shader_com"}],shader_lab:[function(e,t,o){"use strict";cc._RF.push(t,"bdf52Z2t2lGfJc1qf+grhdB","shader_lab"),Object.defineProperty(o,"__esModule",{value:!0});var n="\nuniform mat4 viewProj;\nattribute vec3 a_position;\nattribute vec2 a_uv0;\nvarying vec2 uv0;\nvoid main () {\n    vec4 pos = viewProj * vec4(a_position, 1);\n    gl_Position = pos;\n    uv0 = a_uv0;\n}",a={GrayScaling:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 c = color * texture2D(texture, uv0);\n    float gray = dot(c.rgb, vec3(0.299 * 0.5, 0.587 * 0.5, 0.114 * 0.5));\n    gl_FragColor = vec4(gray, gray, gray, c.a * 0.5);\n}\n"},Stone:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 c = color * texture2D(texture, uv0);\n    float clrbright = (c.r + c.g + c.b) * (1. / 3.);\n    float gray = (0.6) * clrbright;\n    gl_FragColor = vec4(gray, gray, gray, c.a);\n}\n"},Ice:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 clrx = color * texture2D(texture, uv0);\n    float brightness = (clrx.r + clrx.g + clrx.b) * (1. / 3.);\n\tfloat gray = (1.5)*brightness;\n\tclrx = vec4(gray, gray, gray, clrx.a)*vec4(0.8,1.2,1.5,1);\n    gl_FragColor =clrx;\n}\n"},Frozen:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 c = color * texture2D(texture, uv0);\n    c *= vec4(0.8, 1, 0.8, 1);\n\tc.b += c.a * 0.2;\n    gl_FragColor = c;\n}\n"},Mirror:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 c = color * texture2D(texture, uv0);\n    c.r *= 0.5;\n    c.g *= 0.8;\n    c.b += c.a * 0.2;\n    gl_FragColor = c;\n}\n"},Poison:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 c = color * texture2D(texture, uv0);\n    c.r *= 0.8;\n\tc.r += 0.08 * c.a;\n\tc.g *= 0.8;\n    c.g += 0.2 * c.a;\n\tc.b *= 0.8;\n    gl_FragColor = c;\n}\n"},Banish:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 c = color * texture2D(texture, uv0);\n    float gg = (c.r + c.g + c.b) * (1.0 / 3.0);\n    c.r = gg * 0.9;\n    c.g = gg * 1.2;\n    c.b = gg * 0.8;\n    c.a *= (gg + 0.1);\n    gl_FragColor = c;\n}\n"},Vanish:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nvarying vec2 uv0;\nvoid main () {\n    vec4 c = color * texture2D(texture, uv0);\n    float gray = (c.r + c.g + c.b) * (1. / 3.);\n    float rgb = gray * 0.8;\n    gl_FragColor = vec4(rgb, rgb, rgb, c.a * (gray + 0.1));\n}\n"},Invisible:{vert:n,frag:"\nvoid main () {\n    gl_FragColor = vec4(0,0,0,0);\n}\n"},Blur:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nuniform float num;\nvarying vec2 uv0;\nvoid main () {\n    vec4 sum = vec4(0.0);\n    vec2 size = vec2(num,num);\n    sum += texture2D(texture, uv0 - 0.4 * size) * 0.05;\n\tsum += texture2D(texture, uv0 - 0.3 * size) * 0.09;\n\tsum += texture2D(texture, uv0 - 0.2 * size) * 0.12;\n\tsum += texture2D(texture, uv0 - 0.1 * size) * 0.15;\n\tsum += texture2D(texture, uv0             ) * 0.16;\n\tsum += texture2D(texture, uv0 + 0.1 * size) * 0.15;\n\tsum += texture2D(texture, uv0 + 0.2 * size) * 0.12;\n\tsum += texture2D(texture, uv0 + 0.3 * size) * 0.09;\n    sum += texture2D(texture, uv0 + 0.4 * size) * 0.05;\n    \n    vec4 vectemp = vec4(0,0,0,0);\n    vec4 substract = vec4(0,0,0,0);\n    vectemp = (sum - substract) * color;\n\n    float alpha = texture2D(texture, uv0).a;\n    if(alpha < 0.05) { gl_FragColor = vec4(0 , 0 , 0 , 0); }\n\telse { gl_FragColor = vectemp; }\n}\n"},GaussBlur:{vert:n,frag:"\n#define repeats 5.\nuniform sampler2D texture;\nuniform vec4 color;\nuniform float num;\nvarying vec2 uv0;\n\nvec4 draw(vec2 uv) {\n    return color * texture2D(texture,uv).rgba; \n}\nfloat grid(float var, float size) {\n    return floor(var*size)/size;\n}\nfloat rand(vec2 co){\n    return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\nvoid main()\n{\n    vec4 blurred_image = vec4(0.);\n    for (float i = 0.; i < repeats; i++) { \n        vec2 q = vec2(cos(degrees((i/repeats)*360.)),sin(degrees((i/repeats)*360.))) * (rand(vec2(i,uv0.x+uv0.y))+num); \n        vec2 uv2 = uv0+(q*num);\n        blurred_image += draw(uv2)/2.;\n        q = vec2(cos(degrees((i/repeats)*360.)),sin(degrees((i/repeats)*360.))) * (rand(vec2(i+2.,uv0.x+uv0.y+24.))+num); \n        uv2 = uv0+(q*num);\n        blurred_image += draw(uv2)/2.;\n    }\n    blurred_image /= repeats;\n    gl_FragColor = vec4(blurred_image);\n}\n"},Dissolve:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nuniform float time;\nvarying vec2 uv0;\n\nvoid main()\n{\n    vec4 c = color * texture2D(texture,uv0);\n    float height = c.r;\n    if(height < time)\n    {\n        discard;\n    }\n    if(height < time+0.04)\n    {\n        // \u6eb6\u89e3\u989c\u8272\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\n        c = vec4(.9,.6,0.3,c.a);\n    }\n    gl_FragColor = c;\n}\n"},Fluxay:{vert:n,frag:"\nuniform sampler2D texture;\nuniform vec4 color;\nuniform float time;\nvarying vec2 uv0;\n\nvoid main()\n{\n    vec4 src_color = color * texture2D(texture, uv0).rgba;\n\n    float width = 0.08;       //\u6d41\u5149\u7684\u5bbd\u5ea6\u8303\u56f4 (\u8c03\u6574\u8be5\u503c\u6539\u53d8\u6d41\u5149\u7684\u5bbd\u5ea6)\n    float start = tan(time/1.414);  //\u6d41\u5149\u7684\u8d77\u59cbx\u5750\u6807\n    float strength = 0.008;   //\u6d41\u5149\u589e\u4eae\u5f3a\u5ea6   (\u8c03\u6574\u8be5\u503c\u6539\u53d8\u6d41\u5149\u7684\u589e\u4eae\u5f3a\u5ea6)\n    float offset = 0.5;      //\u504f\u79fb\u503c         (\u8c03\u6574\u8be5\u503c\u6539\u53d8\u6d41\u5149\u7684\u503e\u659c\u7a0b\u5ea6)\n    if(uv0.x < (start - offset * uv0.y) &&  uv0.x > (start - offset * uv0.y - width))\n    {\n        vec3 improve = strength * vec3(255, 255, 255);\n        vec3 result = improve * vec3( src_color.r, src_color.g, src_color.b);\n        gl_FragColor = vec4(result, src_color.a);\n\n    }else{\n        gl_FragColor = src_color;\n    }\n}\n"},FluxaySuper:{vert:n,frag:"\n#define TAU 6.12\n#define MAX_ITER 5\nuniform sampler2D texture;\nuniform vec4 color;\nuniform float time;\nvarying vec2 uv0;\n\nvoid main()\n{\n    float time = time * .5+5.;\n    // uv should be the 0-1 uv of texture...\n    vec2 uv = uv0.xy;//fragCoord.xy / iResolution.xy;\n    \n    vec2 p = mod(uv*TAU, TAU)-250.0;\n\n    vec2 i = vec2(p);\n    float c = 1.0;\n    float inten = .0045;\n\n    for (int n = 0; n < MAX_ITER; n++) \n    {\n        float t =  time * (1.0 - (3.5 / float(n+1)));\n        i = p + vec2(cos(t - i.x) + sin(t + i.y), sin(t - i.y) + cos(1.5*t + i.x));\n        c += 1.0/length(vec2(p.x / (cos(i.x+t)/inten),p.y / (cos(i.y+t)/inten)));\n    }\n    c /= float(MAX_ITER);\n    c = 1.17-pow(c, 1.4);\n    vec4 tex = texture2D(texture,uv);\n    vec3 colour = vec3(pow(abs(c), 20.0));\n    colour = clamp(colour + vec3(0.0, 0.0, .0), 0.0, tex.a);\n\n    // \u6df7\u5408\u6ce2\u5149\n    float alpha = c*tex[3];  \n    tex[0] = tex[0] + colour[0]*alpha; \n    tex[1] = tex[1] + colour[1]*alpha; \n    tex[2] = tex[2] + colour[2]*alpha; \n    gl_FragColor = color * tex;\n}\n"},HSL:{vert:n,frag:"\n#ifdef GL_ES\nprecision mediump float;\n#endif\n\nvarying vec2 uv0;\n\nuniform sampler2D texture;\n\nuniform float hue;\nuniform float sat;\nuniform float light;\n\nvoid main() {\n    vec4 texColor=texture2D(texture, uv0);\n    float r=texColor.r;\n    float g=texColor.g;\n    float b=texColor.b;\n    float a=texColor.a;\n    //convert rgb to hsl\n    float h;\n    float s;\n    float l;\n    {\n        float max=max(max(r,g),b);\n        float min=min(min(r,g),b);\n        //----h\n        if(max==min){\n            \n            h=0.0;\n        }else if(max==r&&g>=b){\n            h=60.0*(g-b)/(max-min)+0.0;\n        }else if(max==r&&g<b){\n            h=60.0*(g-b)/(max-min)+360.0;\n        }else if(max==g){\n            h=60.0*(b-r)/(max-min)+120.0;\n        }else if(max==b){\n            h=60.0*(r-g)/(max-min)+240.0;\n        }\n        //----l\n        l=0.5*(max+min);\n        //----s\n        if(l==0.0||max==min){\n            s=0.0;\n        }else if(0.0<=l&&l<=0.5){\n            s=(max-min)/(2.0*l);\n        }else if(l>0.5){\n            s=(max-min)/(2.0-2.0*l);\n        }\n    }\n    //(h,s,l)+(dH,dS,dL) -> (h,s,l)\n    h=h+hue;\n    s=min(1.0,max(0.0,s+sat));\n    l=l;//do not use HSL model to adjust lightness, because the effect is not good\n    //convert (h,s,l) to rgb and got final color\n    vec4 finalColor;\n    {\n        float q;\n        if(l<0.5){\n            q=l*(1.0+s);\n        }else if(l>=0.5){\n            q=l+s-l*s;\n        }\n        float p=2.0*l-q;\n        float hk=h/360.0;\n        float t[3];\n        t[0]=hk+1.0/3.0;t[1]=hk;t[2]=hk-1.0/3.0;\n        for(int i=0;i<3;i++){\n            if(t[i]<0.0)t[i]+=1.0;\n            if(t[i]>1.0)t[i]-=1.0;\n        }//got t[i]\n        float c[3];\n        for(int i=0;i<3;i++){\n            if(t[i]<1.0/6.0){\n                c[i]=p+((q-p)*6.0*t[i]);\n            }else if(1.0/6.0<=t[i]&&t[i]<0.5){\n                c[i]=q;\n            }else if(0.5<=t[i]&&t[i]<2.0/3.0){\n                c[i]=p+((q-p)*6.0*(2.0/3.0-t[i]));\n            }else{\n                c[i]=p;\n            }\n        }\n        finalColor=vec4(c[0],c[1],c[2],a);\n    }\n    //actually, it is not final color. the lightness has not been adjusted\n    //adjust lightness use the simplest method\n    finalColor+=vec4(light,light,light,0.0);\n    \n    gl_FragColor=finalColor;\n}  \n"}};o.default=a,cc._RF.pop()},{}],shader_material:[function(e,t,o){"use strict";cc._RF.push(t,"a54afHAwMRMCLhQ4yrJ6kqq","shader_material"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc.renderer.renderEngine,a=function(e){function t(t,o,n,a){var i=e.call(this,!1)||this,r=cc.renderer._forward._programLib;return!r._templates[t]&&r.define(t,o,n,a),i._init(t),i}return __extends(t,e),t.prototype._init=function(e){var t=n.renderer,o=n.gfx,a=new t.Pass(e);a.setDepth(!1,!1),a.setCullMode(o.CULL_NONE),a.setBlend(o.BLEND_FUNC_ADD,o.BLEND_SRC_ALPHA,o.BLEND_ONE_MINUS_SRC_ALPHA,o.BLEND_FUNC_ADD,o.BLEND_SRC_ALPHA,o.BLEND_ONE_MINUS_SRC_ALPHA);var i=new t.Technique(["transparent"],[{name:"texture",type:t.PARAM_TEXTURE_2D},{name:"color",type:t.PARAM_COLOR4},{name:"pos",type:t.PARAM_FLOAT3},{name:"size",type:t.PARAM_FLOAT2},{name:"time",type:t.PARAM_FLOAT},{name:"num",type:t.PARAM_FLOAT},{name:"hue",type:t.PARAM_FLOAT}],[a]);this._texture=null,this._color={r:1,g:1,b:1,a:1},this._pos={x:0,y:0,z:0},this._size={x:0,y:0},this._time=0,this._num=0,this._hue=0,this._effect=this.effect=new t.Effect([i],{color:this._color,pos:this._pos,size:this._size,time:this._time,num:this._num,hue:this._hue},[]),this._mainTech=i},t.prototype.setTexture=function(e){this._texture=e,this._texture.update({flipY:!1,mipmap:!1}),this._effect.setProperty("texture",e.getImpl()),this._texIds.texture=e.getId()},t.prototype.setColor=function(e,t,o,n){this._color.r=e,this._color.g=t,this._color.b=o,this._color.a=n,this._effect.setProperty("color",this._color)},t.prototype.setPos=function(e,t,o){this._pos.x=e,this._pos.y=t,this._pos.z=o,this._effect.setProperty("pos",this._pos)},t.prototype.setSize=function(e,t){this._size.x=e,this._size.y=t,this._effect.setProperty("size",this._size)},t.prototype.setTime=function(e){this._time=e,this._effect.setProperty("time",this._time)},t.prototype.setNum=function(e){this._num=e,this._effect.setProperty("num",this._num)},t.prototype.setHue=function(e){this._hue=e,this._effect.setProperty("hue",this._hue)},t}(n.Material);o.default=a,cc._RF.pop()},{}],shader_mgr:[function(e,t,o){"use strict";cc._RF.push(t,"810cbErpMBLhZeOdXHP4zF6","shader_mgr"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./shader_lab"),i=e("./shader_material"),r=cc.renderer.renderEngine,s=r.SpriteMaterial,c=r.GraySpriteMaterial;(function(e){e[e.Default=0]="Default",e[e.Gray=1]="Gray",e[e.GrayScaling=100]="GrayScaling",e[e.Stone=101]="Stone",e[e.Ice=102]="Ice",e[e.Frozen=103]="Frozen",e[e.Mirror=104]="Mirror",e[e.Poison=105]="Poison",e[e.Banish=106]="Banish",e[e.Vanish=107]="Vanish",e[e.Invisible=108]="Invisible",e[e.Blur=109]="Blur",e[e.GaussBlur=110]="GaussBlur",e[e.Dissolve=111]="Dissolve",e[e.Fluxay=112]="Fluxay",e[e.FluxaySuper=113]="FluxaySuper",e[e.HSL=114]="HSL"})(n=o.ShaderType||(o.ShaderType={}));var l=function(){function e(){}return e.useShader=function(e,t){if(cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS){if(e&&e.spriteFrame&&e.getState()!==t){if(t>n.Gray){var o=n[t],r=a.default[o];if(!r)return void console.warn("Shader not defined",o);cc.log("ShaderMaterial create");var l=new i.default(o,r.vert,r.frag,r.defines||[]),d=e.spriteFrame.getTexture();return l.setTexture(d),l.updateHash(),(h=e)._material=l,h._spriteMaterial=l,h._renderData?h._renderData._material=l:(h._updateAssembler(),h._renderData._material=l),h._state=t,l}e.setState(t);var h=e;e.getState()===n.Default?h._spriteMaterial=new s:e.getState()==n.Gray&&(h._spriteMaterial=new c)}}else console.warn("Shader not surpport for canvas")},e}();o.default=l,cc._RF.pop()},{"./shader_lab":"shader_lab","./shader_material":"shader_material"}],shaker:[function(e,t,o){"use strict";cc._RF.push(t,"c1d64o1K71OZ7a7Hx6FnA0M","shaker"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("../global_def");(function(e){e[e.kHor=0]="kHor",e[e.kHorReg=1]="kHorReg",e[e.kVer=2]="kVer",e[e.kVerReg=3]="kVerReg",e[e.kRand=4]="kRand"})(n=o.ShakeType||(o.ShakeType={}));var i=cc._decorator,r=i.ccclass,s=(i.property,function(){function e(){this.minRange_=0,this.maxRange_=0,this.attenuation_=0,this.atteFreq_=0,this.atteFreqVar_=0,this.atteFreqVarF_=0,this.freq_=0,this.freqVar_=0,this.freqVarF_=0,this.dura_=0,this.type_=0,this.shakeDura_=0,this.shakeTimer_=0,this.atteTimer_=0,this.atteFvTimer_=0,this.freqFvTimer_=0,this.attenuationCp_=0,this.atteFreqCp_=0,this.minRangeCp_=0,this.maxRangeCp_=0,this.freqCp_=0,this.horSign_=0,this.verSign_=0,this.origXs_=[],this.origYs_=[],this.nodes_=null,this.callback_=null,this.cbParams_=null,this.bRun_=!1}return e.prototype.init=function(e,t,o,a,i,r){void 0===r&&(r=n.kRand),this.nodes_=e,this.minRange_=t,this.maxRange_=o,this.freq_=a,this.dura_=i,this.type_=r,this.minRangeCp_=t,this.maxRangeCp_=o,this.freqCp_=a;for(var s=0;s<this.nodes_.length;++s)this.origXs_[s]=this.nodes_[s].x,this.origYs_[s]=this.nodes_[s].y},e.prototype.appendAttenuation=function(e,t,o,n){void 0===o&&(o=0),void 0===n&&(n=0),this.attenuation_=e,this.atteFreq_=t,this.atteFreqVar_=o,this.atteFreqVarF_=n,this.attenuationCp_=e,this.atteFreqCp_=t},e.prototype.appendFreqVariable=function(e,t){this.freqVar_=e,this.freqVarF_=t},e.prototype.appendOverCallback=function(e,t){void 0===t&&(t=null),this.callback_=e,this.cbParams_=t},e.prototype.shake=function(){if(a.G.isExistObj(this.nodes_)){this.bRun_=!0,this.shakeDura_=0,this.horSign_=0,this.verSign_=0,this.attenuation_=this.attenuationCp_,this.atteFreq_=this.atteFreqCp_,this.minRange_=this.minRangeCp_,this.maxRange_=this.maxRangeCp_,this.freq_=this.freqCp_,this.shakeTimer_=0,this.atteFvTimer_=0,this.atteTimer_=0,this.freqFvTimer_=0;for(var e=0;e<this.nodes_.length;++e)this.nodes_[e].x=this.origXs_[e],this.nodes_[e].y=this.origYs_[e]}else cc.error("[Shaker shake func] - There's no valid node specified")},e.prototype.update=function(e){if(this.bRun_){if(this.shakeDura_+=e,this.shakeDura_>=this.dura_){for(var t=0;t<this.nodes_.length;++t)this.nodes_[t].x=this.origXs_[t],this.nodes_[t].y=this.origYs_[t];return this.callback_&&this.callback_(this.cbParams_),void(this.bRun_=!1)}if(this.shakeTimer_-=e,this.shakeTimer_<=0){this.shakeTimer_=this.freq_;var o=this._calOffset();for(t=0;t<this.nodes_.length;++t)this.nodes_[t].x=this.origXs_[t]+o.x,this.nodes_[t].y=this.origYs_[t]+o.y}0!=this.freqVar_&&(this.freqFvTimer_-=e,this.freqFvTimer_<=0&&(this.freqFvTimer_=this.freqVarF_,this.freq_+=this.freqVar_)),0!=this.attenuation_&&(this.atteTimer_-=e,this.atteTimer_<=0&&(this.atteTimer_=this.atteFreq_,this.minRange_-=this.attenuation_,this.minRange_<=0&&(this.minRange_=0),this.maxRange_-=this.attenuation_,this.maxRange_<=0&&(this.maxRange_=0)),0!=this.atteFreqVar_&&(this.atteFvTimer_-=e,this.atteFvTimer_<=0&&(this.atteFvTimer_=this.atteFreqVarF_,this.atteFreq_+=this.atteFreqVar_)))}},e.prototype._calOffset=function(){var e=0,t=0;return this.type_==n.kHor?(e=a.G.randRange(this.minRange_,this.maxRange_),a.G.randRange(1,100)>50&&(e=-e)):this.type_==n.kHorReg?(e=a.G.randRange(this.minRange_,this.maxRange_)*this.horSign_,0==this.horSign_?a.G.randRange(1,100)>50?this.horSign_=1:this.horSign_=-1:this.horSign_=-this.horSign_):this.type_==n.kVer?(t=a.G.randRange(this.minRange_,this.maxRange_),a.G.randRange(1,100)>50&&(t=-t)):this.type_==n.kVerReg?(t=a.G.randRange(this.minRange_,this.maxRange_)*this.verSign_,0==this.verSign_?a.G.randRange(1,100)>50?this.verSign_=1:this.verSign_=-1:this.verSign_=-this.verSign_):(e=a.G.randRange(this.minRange_,this.maxRange_),a.G.randRange(1,100)>50&&(e=-e),t=a.G.randRange(this.minRange_,this.maxRange_),a.G.randRange(1,100)>50&&(t=-t)),{x:e,y:t}},e=__decorate([r],e)}());o.default=s,cc._RF.pop()},{"../global_def":"global_def"}],signLayer:[function(e,t,o){"use strict";cc._RF.push(t,"659135IHy1Ivo8kJVj3hmOj","signLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./../util/global_def"),i=e("../util/Storage"),r=e("./load"),s=e("../game_scene"),c=e("../util/wx_util"),l=e("../game_logic"),d=cc._decorator,h=d.ccclass,u=d.property;(function(e){e[e.not_sign=0]="not_sign",e[e.wait_sing=1]="wait_sing",e[e.has_sign=2]="has_sign"})(n||(n={}));var p=[0,0,0,0,0,0,0],f=[{reward_id:2,reward_numb:20},{reward_id:3,reward_numb:4},{reward_id:1,reward_numb:1e3},{reward_id:2,reward_numb:20},{reward_id:3,reward_numb:5},{reward_id:2,reward_numb:30},{reward_id:4,reward_numb:5}],m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.doubleBtn=null,t.getAward=null,t.items=[],t.des_1=null,t.des_2=null,t.boxSprite=null,t.signTag=0,t.signItem=null,t.heroImage=null,t.heroName=null,t.bannerNode=null,t.info=[],t.hatInfo=[],t}return __extends(t,e),t.prototype.init=function(){this.getSignTag(),this.resetTodaySign(),this.recoveryBox();var e=i.default.readNum("todaySign");for(var t in f){var o=Number(t);o<this.signTag?this.setState(o,n.has_sign):o>this.signTag?this.setState(o,n.not_sign):0==e?(this.setState(o,n.wait_sing),this.signItem=this.items[t],this.doubleBtn.isChecked?this.setTag(!0):this.setTag(!1)):(this.setState(o,n.not_sign),this.signItem=this.items[t],this.setTag(!1));var a=f[o].reward_id;if(1==a||2==a)this.items[t].getChildByName("num").getComponent(cc.Label).string=String(f[t].reward_numb)}},t.prototype.recoveryBox=function(){},t.prototype.setTag=function(e){var t=this.signItem.getChildByName("tag");t&&(t.active=e)},t.prototype.setState=function(e,t){var o=this.items[e],a=o.getChildByName("signMask"),i=o.getChildByName("noSign");a.active=!1,i.active=!1,o.getComponent(cc.Button).interactable=!1,t==n.has_sign?a.active=!0:t==n.wait_sing&&(i.active=!0,o.getComponent(cc.Button).interactable=!0)},t.prototype.getSignTag=function(){this.info=i.default.readJSON("signInfo"),null==this.info&&(this.info=p,i.default.writeJSON("signInfo",p));var e=!0;for(var t in this.info)if(0==this.info[t])return this.signTag=Number(t),void(e=!1);e&&(i.default.writeJSON("signInfo",p),this.signTag=0,this.info=p)},t.prototype.open=function(){a.G.reportToAld(a.G.Report.signLayer),l.default.instance.startGame,this.init(),this.node.active=!0,this.content.getComponent("ui_motion").triggerMotion()},t.prototype.close=function(){a.G.hidGameBanner(),c.default.delBanner(),this.node.active=!1,l.default.instance.openDial},t.prototype.onClickDoubleBtn=function(){this.des_1.active=!1,this.des_2.active=!1,this.doubleBtn.isChecked?(this.des_2.active=!0,this.setTag(!0)):(this.des_1.active=!0,this.setTag(!1))},t.prototype.resetTodaySign=function(){var e=(new Date).getDate(),t=i.default.readNum("lastDateSign");e!=Number(t)&&i.default.writeNum("todaySign",0),i.default.writeNum("lastDateSign",e)},t.prototype.onClickGetAward=function(){var e=this;if(1!=i.default.readNum("todaySign")){var t=function(){i.default.writeNum("todaySign",1),e.info[e.signTag]=1,i.default.writeJSON("signInfo",e.info),e.setState(e.signTag,n.has_sign)},o=f[this.signTag],l=o.reward_numb;1==this.doubleBtn.isChecked&&(l*=2);c.default.watchVideoAds(a.G.VideoId.trialHero,function(){a.G.reportToAld(a.G.Report.signBtn),t(),1==o.reward_id?(r.default.instance.updateWealth(s.WealthType.coin,l),r.default.instance.showTip("\u83b7\u5f97\u91d1\u5e01"+l)):2==o.reward_id?(r.default.instance.updateWealth(s.WealthType.crown,l),r.default.instance.showTip("\u83b7\u5f97\u7687\u51a0"+l)):3==o.reward_id?(a.G.GameData.setHeroData(o.reward_numb,1),r.default.instance.showTip("\u65b0\u89d2\u8272\u89e3\u9501\u6210\u529f")):4==o.reward_id&&(a.G.GameData.setPetData(o.reward_numb,1),r.default.instance.showTip("\u65b0\u5ba0\u7269\u89e3\u9501\u6210\u529f")),e.close()})}},__decorate([u(cc.Node)],t.prototype,"content",void 0),__decorate([u(cc.Toggle)],t.prototype,"doubleBtn",void 0),__decorate([u(cc.Node)],t.prototype,"getAward",void 0),__decorate([u([cc.Node])],t.prototype,"items",void 0),__decorate([u(cc.Node)],t.prototype,"des_1",void 0),__decorate([u(cc.Node)],t.prototype,"des_2",void 0),__decorate([u(cc.SpriteFrame)],t.prototype,"boxSprite",void 0),__decorate([u(cc.Sprite)],t.prototype,"heroImage",void 0),__decorate([u(cc.Label)],t.prototype,"heroName",void 0),__decorate([u(cc.Node)],t.prototype,"bannerNode",void 0),t=__decorate([h],t)}(cc.Component);o.default=m,cc._RF.pop()},{"../game_logic":"game_logic","../game_scene":"game_scene","../util/Storage":"storage","../util/wx_util":"wx_util","./../util/global_def":"global_def","./load":"load"}],skinHero:[function(e,t,o){"use strict";cc._RF.push(t,"b8df4VmQEdN4b7sKV2PqPaP","skinHero"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./../util/global_def"),i=e("./load"),r=e("../game_scene"),s=e("../util/wx_util");(function(e){e[e.lock=0]="lock",e[e.unlock=1]="unlock",e[e.use=2]="use"})(n=o.skinHeroState||(o.skinHeroState={}));var c=cc._decorator,l=c.ccclass,d=c.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lock=null,t.unlock=null,t.use=null,t.cooling=null,t.red=null,t.image=null,t.mask=null,t.heroName=null,t.coin_num_label=null,t.coin_num=null,t.crown_num_label=null,t.crown_num=null,t.video_num_label=null,t.video_num=0,t.video_total_num=null,t.unLookCoin=null,t.unLookCrown=null,t.unLookVideo=null,t.timeLabel=null,t.time=8,t.skinLayer=null,t.skinHeroInfo=null,t.videoHeroInfo=null,t.id=null,t.state=null,t}return __extends(t,e),t.prototype.init=function(e,t,o){this.skinLayer=o,this.skinHeroInfo=o.skinHeroInfo.json,this.videoHeroInfo=o.videoHeroInfo,this.setUnlook(e,this.skinHeroInfo[e].get_type),this.id=e,this.image.spriteFrame=a.G.Game.getGRes(a.G.Game.GResType.Hero,e),this.heroName.string=this.skinHeroInfo[e].name,this.setState(t),this.id>=5&&(this.red.active=!0)},t.prototype.setUnlook=function(e,t){switch(this.unLookCoin.active=!1,this.unLookCrown.active=!1,this.unLookVideo.active=!1,t){case 1:this.unLookCoin.active=!0,this.coin_num=this.skinHeroInfo[e].cost,this.coin_num_label.string=String(this.coin_num);break;case 2:this.unLookCrown.active=!0,this.crown_num=this.skinHeroInfo[e].cost,this.crown_num_label.string=String(this.crown_num);break;case 3:this.unLookVideo.active=!0,this.video_num=this.videoHeroInfo[e],this.video_total_num=this.skinHeroInfo[e].cost;var o=this.video_num+"/"+this.video_total_num;this.video_num_label.string=o}},t.prototype.setState=function(e,t){switch(this.state=e,this.lock.active=!1,this.unlock.active=!1,this.use.active=!1,this.cooling.active=!1,this.mask.active=!1,e){case n.lock:this.mask.active=!0,this.lock.active=!0;break;case n.unlock:this.unlock.active=!0;break;case n.use:this.use.active=!0}},t.prototype.onClickUse=function(){this.skinLayer.setHero(this.id)},t.prototype.onClickUnLookCoin=function(){var e=this;this.skinLayer.setHero(this.id),i.default.instance.buy(r.WealthType.coin,this.coin_num,function(){e.setState(n.unlock),i.default.instance.showTip("\u89e3\u9501\u6210\u529f"),a.G.GameData.setHeroData(e.id,n.unlock)})},t.prototype.onClickUnLookCrwon=function(){var e=this;this.skinLayer.setHero(this.id),i.default.instance.buy(r.WealthType.crown,this.crown_num,function(){e.setState(n.unlock),i.default.instance.showTip("\u89e3\u9501\u6210\u529f"),a.G.GameData.setHeroData(e.id,n.unlock)})},t.prototype.onClickUnLookVideo=function(){var e=this;this.skinLayer.setHero(this.id);s.default.watchVideoAds(a.G.VideoId.trialHero,function(){if(e.video_num++,e.video_num>=e.video_total_num&&(e.video_num=e.video_total_num),e.skinLayer.addVideoHeroData(e.id,e.video_num),e.video_num>=e.video_total_num)e.setState(n.unlock),i.default.instance.showTip("\u89e3\u9501\u6210\u529f"),a.G.GameData.setHeroData(e.id,n.unlock);else{i.default.instance.showTip("\u82f1\u96c4\u89e3\u9501+1");var t=e.video_num+"/"+e.video_total_num;e.video_num_label.string=t,e.cooling.active=!0,e.time=8;var o=function(){e.time--,e.timeLabel.string=String(e.time),e.time<=0&&(e.unschedule(o),e.cooling.active=!1)};e.schedule(o,1)}})},t.prototype.onClickUseBtn=function(){this.skinLayer.setLastHero(this.id)},__decorate([d(cc.Node)],t.prototype,"lock",void 0),__decorate([d(cc.Node)],t.prototype,"unlock",void 0),__decorate([d(cc.Node)],t.prototype,"use",void 0),__decorate([d(cc.Node)],t.prototype,"cooling",void 0),__decorate([d(cc.Node)],t.prototype,"red",void 0),__decorate([d(cc.Sprite)],t.prototype,"image",void 0),__decorate([d(cc.Node)],t.prototype,"mask",void 0),__decorate([d(cc.Label)],t.prototype,"heroName",void 0),__decorate([d(cc.Label)],t.prototype,"coin_num_label",void 0),__decorate([d(cc.Label)],t.prototype,"crown_num_label",void 0),__decorate([d(cc.Label)],t.prototype,"video_num_label",void 0),__decorate([d(cc.Node)],t.prototype,"unLookCoin",void 0),__decorate([d(cc.Node)],t.prototype,"unLookCrown",void 0),__decorate([d(cc.Node)],t.prototype,"unLookVideo",void 0),__decorate([d(cc.Label)],t.prototype,"timeLabel",void 0),t=__decorate([l],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../game_scene":"game_scene","../util/wx_util":"wx_util","./../util/global_def":"global_def","./load":"load"}],skinLayer:[function(e,t,o){"use strict";cc._RF.push(t,"80a73oVMdtDHooWTpkdYe+6","skinLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./pet"),a=e("./../util/global_def"),i=e("./../util/storage"),r=e("./../ui/skinHero"),s=e("./../ui/skinPet"),c=[0,0,0,0,0,0,0,0,0,0,0,0,0],l=[0,0,0,0,0,0,0,0,0,0,0,0,0],d=cc._decorator,h=d.ccclass,u=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.hero=null,t.pet=null,t.content=null,t.content_hero=null,t.content_pet=null,t.skinHero=null,t.skinPet=null,t.petBtn=null,t.heroBtn=null,t.wps=[],t.skinHeroInfo=null,t.skinPetInfo=null,t.heroContent=null,t.petContent=null,t.skinHeroManager=[],t.skinPetManager=[],t.backPackData=null,t.showData=null,t.petInfo=[],t.videoHeroInfo=[],t.videoPetInfo=[],t}return __extends(t,e),t.prototype.onLoad=function(){this.pet.addComponent(n.Stand)},t.prototype.showHero=function(e){var t=this;this.hero.active=!1,this.pet.active=!1,this.content_hero.active=!1,this.content_pet.active=!1,0==e?(this.content_hero.active=!0,this.isChecked(this.petBtn,!1),this.isChecked(this.heroBtn,!0)):(this.content_pet.active=!0,this.isChecked(this.petBtn,!0),this.isChecked(this.heroBtn,!1)),this.scheduleOnce(function(){(t.hero.active=!0,1==e&&(t.pet.active=!0),t.setHero(a.G.Game.lastHeroId),null==a.G.Game.lastPetId)?t.pet.active=!1:t.pet.getChildByName("image").getComponent(cc.Sprite).spriteFrame=a.G.Game.getGRes(a.G.Game.GResType.Pet,a.G.Game.lastPetId);t.init(),t.setWeapon(a.G.Game.lastHeroId),0==e?t.onClickHeroBtn():t.onClickPetBtn()},.5)},t.prototype.setHero=function(e){this.hero.getChildByName("image").getComponent(cc.Sprite).spriteFrame=a.G.Game.getGRes(a.G.Game.GResType.Hero,e),this.setBackPack(e),this.setShow(e),this.setWeapon(e)},t.prototype.init=function(){this.initVideoHeroData(),this.initVideoPetData();var e=cc.p(-207,-101),t=a.G.GameData.hatInfo;this.heroContent.removeAllChildren(),this.skinHeroManager=[],this.heroContent.height=200*Math.ceil(a.G.Game.hatCount/4),this.heroContent.width=600;for(var o=0;o<a.G.Game.hatCount;o++){var n=cc.instantiate(this.skinHero),i=t[o];o==a.G.Game.lastHeroId&&(i=r.skinHeroState.use),n.getComponent("skinHero").init(o,i,this),n.setPosition(e.x+o%4*142,e.y-167*Math.floor(o/4)),this.heroContent.addChild(n),this.skinHeroManager.push(n)}var c=a.G.GameData.petInfo;this.petContent.removeAllChildren(),this.petContent.height=200*Math.ceil(a.G.Game.petCount/4),this.petContent.width=600,this.skinPetManager=[];for(o=0;o<a.G.Game.petCount;o++){n=cc.instantiate(this.skinPet),i=c[o];o==a.G.Game.lastPetId&&(i=s.skinPetState.use),n.getComponent("skinPet").init(o,i,this),n.setPosition(e.x+o%4*142,e.y-167*Math.floor(o/4)),this.petContent.addChild(n),this.skinPetManager.push(n)}},t.prototype.isChecked=function(e,t){e.getChildByName("Background");e.getChildByName("checkmark").active=!t},t.prototype.onClickHeroBtn=function(){this.isChecked(this.petBtn,!1),this.isChecked(this.heroBtn,!0),this.content_hero.active=!1,this.content_pet.active=!1,this.content_hero.active=!0,this.pet.active=!1},t.prototype.onClickPetBtn=function(){this.isChecked(this.heroBtn,!1),this.isChecked(this.petBtn,!0),this.content_hero.active=!1,this.content_pet.active=!1,this.content_pet.active=!0,null!=a.G.Game.lastPetId&&(this.pet.active=!0)},t.prototype.setBackPack=function(e){var t=a.G.Game.hero_weapon[e],o=this.hero.getChildByName("backpack");o.removeAllChildren();for(var n in t){var i=t[n],r=new cc.Node,s=this.backPackData.json[i];r.x=s.Position_x,r.y=s.Position_y,r.rotation=s.Rotation,r.scaleX=s.Scale_x,r.scaleY=s.Scale_y,r.anchorX=s.Anchor_x,r.anchorY=s.Anchor_y,r.active=!0,r.addComponent(cc.Sprite).spriteFrame=a.G.Game.getGRes(a.G.Game.GResType.Weapon,i);var c="weapon_"+i;o.addChild(r,1e3,c)}},t.prototype.setShow=function(e){var t=a.G.Game.hero_weapon[e][0],o=this.hero.getChildByName("show");o.removeAllChildren();var n=this.showData.json[t],i=new cc.Node;i.x=n.Position_x,i.y=n.Position_y,i.rotation=n.Rotation,i.scaleX=n.Scale_x,i.scaleY=n.Scale_y,i.anchorX=n.Anchor_x,i.anchorY=n.Anchor_y,i.addComponent(cc.Sprite).spriteFrame=a.G.Game.getGRes(a.G.Game.GResType.Weapon,t);var r="weapon_"+t;o.addChild(i,1e3,r)},t.prototype.setLastHero=function(e){this.setHero(e),cc.sys.localStorage.setItem("lastHeroId",e),a.G.Game.lastHeroId=e;for(var t in this.skinHeroManager){var o=this.skinHeroManager[t];o.getComponent("skinHero").state==r.skinHeroState.use&&o.getComponent("skinHero").setState(r.skinHeroState.unlock)}this.skinHeroManager[e].getComponent("skinHero").setState(r.skinHeroState.use),this.setWeapon(e)},t.prototype.initVideoHeroData=function(){return this.videoHeroInfo=i.default.readJSON("videoHero"),null!=this.videoHeroInfo&&this.videoHeroInfo instanceof Array||(i.default.writeJSON("videoHero",c),this.videoHeroInfo=c),this.videoHeroInfo},t.prototype.initVideoPetData=function(){return this.videoPetInfo=i.default.readJSON("videoPet"),null!=this.videoPetInfo&&this.videoPetInfo instanceof Array||(i.default.writeJSON("videoPet",l),this.videoPetInfo=l),this.videoPetInfo},t.prototype.addVideoHeroData=function(e,t){this.videoHeroInfo[e]=t;var o=JSON.stringify(this.videoHeroInfo);cc.sys.localStorage.setItem("videoHero",o)},t.prototype.addVideoPetData=function(e,t){this.videoPetInfo[e]=t;var o=JSON.stringify(this.videoPetInfo);cc.sys.localStorage.setItem("videoPet",o)},t.prototype.setLastPet=function(e){cc.sys.localStorage.setItem("lastPetId",e),this.pet.active=!0;var t=this.pet.getChildByName("image");a.G.Game.lastPetId=e,t.getComponent(cc.Sprite).spriteFrame=a.G.Game.getGRes(a.G.Game.GResType.Pet,e);for(var o in this.skinPetManager){var n=this.skinPetManager[o];n.getComponent("skinPet").state==s.skinPetState.use&&n.getComponent("skinPet").setState(s.skinPetState.unlock)}this.skinPetManager[e].getComponent("skinPet").setState(s.skinPetState.use)},t.prototype.resetPetData=function(e){var t=(new Date).getDate(),o=cc.sys.localStorage.getItem("lastDatePet");if(t!=Number(o)){a.G.GameData.getPetData(),a.G.GameData.setPetData(e,0);var n=i.default.readNum("lastPetId");Number(n)==e&&cc.sys.localStorage.setItem("lastPetId","")}cc.sys.localStorage.setItem("lastDatePet",t)},t.prototype.setWeapon=function(e){a.G.Game.hero_weapon[e];for(var t in this.wps){var o=this.wps[t],n=a.G.Game.wp_mark[a.G.Game.hero_weapon[e][t]];o.getComponent(cc.Sprite).spriteFrame=a.G.Game.getGRes(a.G.Game.GResType.WeaponBg,n)}},__decorate([u(cc.Node)],t.prototype,"hero",void 0),__decorate([u(cc.Node)],t.prototype,"pet",void 0),__decorate([u(cc.Node)],t.prototype,"content",void 0),__decorate([u(cc.Node)],t.prototype,"content_hero",void 0),__decorate([u(cc.Node)],t.prototype,"content_pet",void 0),__decorate([u(cc.Prefab)],t.prototype,"skinHero",void 0),__decorate([u(cc.Prefab)],t.prototype,"skinPet",void 0),__decorate([u(cc.Node)],t.prototype,"petBtn",void 0),__decorate([u(cc.Node)],t.prototype,"heroBtn",void 0),__decorate([u([cc.Node])],t.prototype,"wps",void 0),__decorate([u(cc.JsonAsset)],t.prototype,"skinHeroInfo",void 0),__decorate([u(cc.JsonAsset)],t.prototype,"skinPetInfo",void 0),__decorate([u(cc.Node)],t.prototype,"heroContent",void 0),__decorate([u(cc.Node)],t.prototype,"petContent",void 0),__decorate([u(cc.JsonAsset)],t.prototype,"backPackData",void 0),__decorate([u(cc.JsonAsset)],t.prototype,"showData",void 0),t=__decorate([h],t)}(cc.Component);o.default=p,cc._RF.pop()},{"./../ui/skinHero":"skinHero","./../ui/skinPet":"skinPet","./../util/global_def":"global_def","./../util/storage":"storage","./pet":"pet"}],skinPet:[function(e,t,o){"use strict";cc._RF.push(t,"aaae7dyJd5Khagg9FgB6OkE","skinPet"),Object.defineProperty(o,"__esModule",{value:!0});var n,a,i=e("./../util/global_def"),r=e("./load"),s=e("../game_scene"),c=e("../util/wx_util");(function(e){e[e.lock=0]="lock",e[e.unlock=1]="unlock",e[e.use=2]="use",e[e.toUnLook=3]="toUnLook"})(n=o.skinPetState||(o.skinPetState={})),function(e){e[e.no=0]="no",e[e.coin=1]="coin",e[e.crown=2]="crown",e[e.sign=3]="sign",e[e.video=4]="video",e[e.share=5]="share"}(a||(a={}));var l=cc._decorator,d=l.ccclass,h=l.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lock=null,t.unlock=null,t.use=null,t.cooling=null,t.image=null,t.mask=null,t.petName=null,t.coin_num_label=null,t.crown_num_label=null,t.skinLayer=null,t.desF=[],t.desTxt=null,t.video_num_label=null,t.video_num=0,t.video_total_num=null,t.timeLabel=null,t.time=8,t.lock_video=null,t.lock_crown=null,t.lock_coin=null,t.video_unlook=null,t.price=null,t.id=null,t.state=null,t.videoPetInfo=null,t.skinPetInfo=null,t}return __extends(t,e),t.prototype.init=function(e,t,o){this.skinLayer=o,this.videoPetInfo=o.videoPetInfo,this.skinPetInfo=o.skinPetInfo.json,this.desTxt.spriteFrame=this.desF[e],this.id=e,this.image.spriteFrame=i.G.Game.getGRes(i.G.Game.GResType.Pet,e);var n=this.skinLayer.skinPetInfo.json[e].name,a=this.skinLayer.skinPetInfo.json[e].skin_type;this.price=this.skinLayer.skinPetInfo.json[e].cost,this.coin_num_label.string=String(this.price),this.crown_num_label.string=String(this.price),this.petName.string=n,this.setState(t,a),this.image.node.scale=70/this.image.node.getContentSize().width},t.prototype.setState=function(e,t){switch(this.state=e,this.lock.active=!1,this.unlock.active=!1,this.use.active=!1,this.video_unlook.active=!1,this.mask.active=!1,e){case n.lock:if(this.mask.active=!0,this.lock.active=!0,this.lock_coin.active=!1,this.lock_crown.active=!1,this.lock_video.active=!1,t==a.coin)this.lock_coin.active=!0;else if(t==a.crown)this.lock_crown.active=!0;else if(t==a.video){this.video_num=this.videoPetInfo[this.id],this.video_total_num=this.skinPetInfo[this.id].cost,this.lock_video.active=!0;var o=this.video_num+"/"+this.video_total_num;this.video_num_label.string=o}break;case n.unlock:this.unlock.active=!0;break;case n.use:this.use.active=!0;break;case n.toUnLook:this.video_unlook.active=!0}},t.prototype.onClickUseBtn=function(){this.skinLayer.setLastPet(this.id)},t.prototype.onClickLockCoin=function(){var e=this;r.default.instance.buy(s.WealthType.coin,this.price,function(){e.setState(n.unlock),r.default.instance.showTip("\u89e3\u9501\u6210\u529f"),i.G.GameData.setPetData(e.id,n.unlock)})},t.prototype.onClickLockCrown=function(){var e=this;r.default.instance.buy(s.WealthType.crown,this.price,function(){e.setState(n.unlock),r.default.instance.showTip("\u89e3\u9501\u6210\u529f"),i.G.GameData.setPetData(e.id,n.unlock)})},t.prototype.onClickLockVideo=function(){var e=this;c.default.watchVideoAds(i.G.VideoId.trialHero,function(){if(e.video_num++,e.video_num>=e.video_total_num&&(e.video_num=e.video_total_num),e.skinLayer.addVideoPetData(e.id,e.video_num),e.video_num>=e.video_total_num)e.setState(n.unlock),r.default.instance.showTip("\u89e3\u9501\u6210\u529f"),i.G.GameData.setHeroData(e.id,n.unlock);else{r.default.instance.showTip(e.petName.string+"\u89e3\u9501+1");var t=e.video_num+"/"+e.video_total_num;e.video_num_label.string=t,e.cooling.active=!0,e.time=8;var o=function(){e.time--,e.timeLabel.string=String(e.time),e.time<=0&&(e.unschedule(o),e.cooling.active=!1)};e.schedule(o,1)}})},t.prototype.onClickVideo_unlook=function(){var e=this;c.default.watchVideoAds(i.G.VideoId.trialHero,function(){i.G.GameData.setPetData(e.id,n.unlock),e.setState(n.unlock),r.default.instance.showTip("\u89e3\u9501\u6210\u529f")},function(){s.default.instance.showTip("\u672a\u89c2\u770b\u5b8c\u6574\u89c6\u9891\uff0c\u65e0\u6cd5\u83b7\u5f97\u5956\u52b1")})},__decorate([h(cc.Node)],t.prototype,"lock",void 0),__decorate([h(cc.Node)],t.prototype,"unlock",void 0),__decorate([h(cc.Node)],t.prototype,"use",void 0),__decorate([h(cc.Node)],t.prototype,"cooling",void 0),__decorate([h(cc.Sprite)],t.prototype,"image",void 0),__decorate([h(cc.Node)],t.prototype,"mask",void 0),__decorate([h(cc.Label)],t.prototype,"petName",void 0),__decorate([h(cc.Label)],t.prototype,"coin_num_label",void 0),__decorate([h(cc.Label)],t.prototype,"crown_num_label",void 0),__decorate([h([cc.SpriteFrame])],t.prototype,"desF",void 0),__decorate([h(cc.Sprite)],t.prototype,"desTxt",void 0),__decorate([h(cc.Label)],t.prototype,"video_num_label",void 0),__decorate([h(cc.Label)],t.prototype,"timeLabel",void 0),__decorate([h(cc.Node)],t.prototype,"lock_video",void 0),__decorate([h(cc.Node)],t.prototype,"lock_crown",void 0),__decorate([h(cc.Node)],t.prototype,"lock_coin",void 0),__decorate([h(cc.Node)],t.prototype,"video_unlook",void 0),t=__decorate([d],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../game_scene":"game_scene","../util/wx_util":"wx_util","./../util/global_def":"global_def","./load":"load"}],statistic_tool:[function(e,t,o){"use strict";cc._RF.push(t,"3b19071OBtF7LjUw/YKalzW","statistic_tool"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../game_logic"),a=e("./structure/hd_map"),i=e("./network/http_req"),r=function(){function e(){}return e.add=function(e,t,o){var n={k:e,v:t,o:o||0};if(this.bucket_.containsKey(e))if(o&&1===o)this.bucket_.put(e,n);else{var a=this.bucket_.get(e);a.v+=t,this.bucket_.put(e,a)}else this.bucket_.put(e,n)},e.upload=function(){if(""!==n.default.instance.gameId&&0!=this.bucket_.size()){console.log("upload stat data");var e=this.bucket_.values();i.default.batchUpdateStat(e),this.bucket_.clear()}},e.schedule=function(e){this.timer_+=e,this.timer_>=5&&(this.upload(),this.timer_=0)},e.bucket_=new a.default,e.timer_=0,e}();o.default=r,cc._RF.pop()},{"../game_logic":"game_logic","./network/http_req":"http_req","./structure/hd_map":"hd_map"}],storage:[function(e,t,o){"use strict";cc._RF.push(t,"98c12P33kxA4KeNjqk6QGot","storage"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./global_def"),a=function(){function e(){}return e.kPlayerProp="playerProp",e.kGameData="gameDat",e.kSetting="setting",e.kAudio="audio",e.kTask="archivement",e.kWeapon="weapon",e.kItem="item",e.kGuide="guide",e.kWxStatus="wxStatus",e.kBattle="battle",e}();o.SaveDef=a;var i=function(){function e(){}return e.clearAllStorage=function(){cc.sys.localStorage.clear()},e.writeBoolean=function(e,t){var o=t?1:0;cc.sys.localStorage.setItem(e,o)},e.readBoolean=function(e){var t=!1,o=cc.sys.localStorage.getItem(e);return n.G.isExistObj(o)&&(t=1==o),t},e.writeNum=function(e,t){cc.sys.localStorage.setItem(e,t)},e.writeJSON=function(e,t){var o=JSON.stringify(t);cc.sys.localStorage.setItem(e,o)},e.readJSON=function(e){var t=null,o=cc.sys.localStorage.getItem(e);return n.G.isExistObj(o)&&(t=JSON.parse(o)),t},e.remove=function(e){cc.sys.localStorage.removeItem(e)},e.readNum=function(e){var t=null,o=cc.sys.localStorage.getItem(e);return 0===o?t=0:null==o||""===o||isNaN(o)||(t=parseInt(o)),t},e}();o.default=i,cc._RF.pop()},{"./global_def":"global_def"}],taskLayer:[function(e,t,o){"use strict";cc._RF.push(t,"c1e34JntGpLArGNKYxBnj6I","taskLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./task"),a=e("./../util/global_def"),i=e("./load"),r=cc._decorator,s=r.ccclass,c=r.property,l=[{taskIndex:1,state:0,proCurNum:0,curTime:0},{taskIndex:2,state:0,proCurNum:0,curTime:0},{taskIndex:3,state:0,proCurNum:0,curTime:0}],d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.taskInfo=null,t.task=null,t.taskItems=[],t.storDate=[],t.loadScene=null,t}return __extends(t,e),t.prototype.init=function(e){this.loadScene=e;var t=a.G.Game.getData("taskStor",JSON.stringify(l),0);this.storDate=t,this.content.removeAllChildren();for(var o in t){var i=t[Number(o)].taskIndex,r=this.taskInfo.json[i],s=new n.TaskData;s.des=r.name,s.proTolNum=r.schedule,s.skip=r.skip,s.refresh=r.Refresh,s.reward=r.reward,s.reward_numb=r.reward_numb,s.target_id=r.target_id,s.state=t[Number(o)].state,s.proCurNum=t[Number(o)].proCurNum,s.curTime=t[Number(o)].curTime,s.taskIndex=Number(i);var c=cc.instantiate(this.task);if(c.getComponent("task").init(s,Number(o),e),this.content.addChild(c),this.taskItems.push(c),e){var d=Number(o);c.y=-160*d}}},t.prototype.setData=function(e,t,o){this.storDate[e][t]=o;a.G.Game.setData("taskStor",JSON.stringify(this.storDate))},t.prototype.refresh=function(){var e=a.G.Game.getData("taskStor",JSON.stringify(l),0);for(var t in e){var o=e[Number(t)].taskIndex,i=this.taskInfo.json[o],r=new n.TaskData;r.des=i.name,r.proTolNum=i.schedule,r.skip=i.skip,r.refresh=i.Refresh,r.reward=i.reward,r.reward_numb=i.reward_numb,r.target_id=i.target_id,r.state=e[Number(t)].state,r.proCurNum=e[Number(t)].proCurNum,r.curTime=e[Number(t)].curTime,r.taskIndex=Number(o),this.taskItems[Number(t)].getComponent("task").init(r)}},t.prototype.refreshItem=function(e){var t=[];for(var o in this.taskInfo.json){var i=!0;for(var r in this.storDate)if(Number(this.storDate[r].taskIndex)==Number(o)){i=!1;break}i&&t.push(Number(o))}var s=a.G.Game.getObjectLen(t),c=t[a.G.randRange(0,s-1)],l=this.taskInfo.json[c],d=new n.TaskData;d.des=l.name,d.proTolNum=l.schedule,d.skip=l.skip,d.refresh=l.Refresh,d.reward=l.reward,d.reward_numb=l.reward_numb,d.target_id=l.target_id,d.state=0,this.setData(e,"state",0),d.taskIndex=Number(c),this.setData(e,"taskIndex",Number(c)),d.proCurNum=0,this.setData(e,"proCurNum",0),d.curTime=0,this.setData(e,"curTime",0),this.taskItems[e].getComponent("task").init(d,null,this.loadScene)},t.prototype.open=function(){this.refresh(),this.node.active=!0},t.prototype.close=function(){this.node.active=!1;var e=a.G.Game.getSysTime();cc.sys.localStorage.setItem("taskLastTime",e),i.default.instance.refreshRedToTask()},__decorate([c(cc.Node)],t.prototype,"content",void 0),__decorate([c(cc.JsonAsset)],t.prototype,"taskInfo",void 0),__decorate([c(cc.Prefab)],t.prototype,"task",void 0),t=__decorate([s],t)}(cc.Component);o.default=d,cc._RF.pop()},{"./../util/global_def":"global_def","./load":"load","./task":"task"}],taskShow:[function(e,t,o){"use strict";cc._RF.push(t,"bd3aaYiVTlM4JBwcHHFGRjl","taskShow"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./../util/global_def"),a=e("./task"),i=[{taskIndex:1,state:0,proCurNum:0,curTime:0},{taskIndex:2,state:0,proCurNum:0,curTime:0},{taskIndex:3,state:0,proCurNum:0,curTime:0}],r=cc._decorator,s=r.ccclass,c=r.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.taskShowItems=[],t.taskInfo=null,t}return __extends(t,e),t.prototype.init=function(){var e=n.G.Game.getData("taskStor",JSON.stringify(i),0);for(var t in e){var o=Number(t),r=e[o].state,s=this.taskShowItems[o],c=s.getChildByName("toggle"),l=s.getChildByName("des"),d="("+String(e[o].proCurNum)+"/"+String(this.taskInfo.json[e[t].taskIndex].schedule)+")";l.getComponent(cc.Label).string=this.taskInfo.json[e[t].taskIndex].name+d,r==a.TaskState.open?(c.getComponent(cc.Toggle).isChecked=!0,l.color=cc.color(255,255,0)):(c.getComponent(cc.Toggle).isChecked=!1,l.color=cc.color(255,255,255))}},t.prototype.open=function(){this.node.active=!0},t.prototype.close=function(){this.node.active=!1},__decorate([c([cc.Node])],t.prototype,"taskShowItems",void 0),__decorate([c(cc.JsonAsset)],t.prototype,"taskInfo",void 0),t=__decorate([s],t)}(cc.Component);o.default=l,cc._RF.pop()},{"./../util/global_def":"global_def","./task":"task"}],task_data:[function(e,t,o){"use strict";cc._RF.push(t,"a73a89i3VBOVYhKn06IEqyC","task_data"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../util/structure/hd_map"),a=e("../util/global_def"),i=e("../util/storage"),r=function(){return function(){this.id=0,this.name="",this.desc="",this.award=0,this.lv=0,this.count=0,this.type=0}}();o.TaskDetail=r;var s=function(){function e(){}return e.fetchTaskData=function(t){null==e.itemMap_&&(e.itemMap_=new n.default),null==e.taskProcMap_&&(e.taskProcMap_=new n.default),a.G.readJson(t,e._parseData)},e.getDataById=function(t){return e.itemMap_.get(t)},e.getDataByLessLv=function(t){var o=new Array;return e.itemMap_.each(function(e,n,a){a.lv<=t&&o.push(a)}),o},e.getProcById=function(t){var o=0,n=e.itemMap_.get(t);return a.G.isExistObj(n)&&(o=e.taskProcMap_.get(t)),o},e.setProcById=function(t,o){var n=e.itemMap_.get(t);a.G.isExistObj(n)&&(o>=n.count&&(o=n.count),e.taskProcMap_.put(t,o))},e.updateProcById=function(t){var o=e.getProcById(t);null!=o&&-1!=o&&(e.setProcById(t,o+1),e.saveData())},e.saveData=function(){var t={procMapKey:[],procMapValue:[]};e.taskProcMap_.each(function(e,o,n){t.procMapKey[e]=o,t.procMapValue[e]=n}.bind(e)),i.default.writeJSON(i.SaveDef.kTask,t)},e.readData=function(){var t=i.default.readJSON(i.SaveDef.kTask);if(a.G.isExistObj(t))if(t.procMapKey&&t.procMapValue)for(var o=0;o<t.procMapKey.length;++o)e.taskProcMap_.put(t.procMapKey[o],t.procMapValue[o]);else cc.error("Can not read any valid data from SaveDef.kTask");else e.itemMap_.each(function(t,o,n){e.taskProcMap_.put(o,0)}.bind(e)),e.saveData()},e._parseData=function(t){if(!a.G.isEmptyObj(t)){for(var o in t)if(t.hasOwnProperty(o)){var n=t[o],i=new r;i.id=parseInt(o),i.name=n.name,i.desc=n.desc,i.lv=n.lv,i.award=n.award,i.count=n.count,i.type=n.type,e.itemMap_.put(i.id,i)}e.readData()}},e.itemMap_=null,e.taskProcMap_=null,e}();o.default=s,cc._RF.pop()},{"../util/global_def":"global_def","../util/storage":"storage","../util/structure/hd_map":"hd_map"}],task:[function(e,t,o){"use strict";cc._RF.push(t,"b32edf1/hBMCoHJRehbhETr","task"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./../game_logic"),i=e("../util/event_mgr"),r=e("./../game_scene"),s=e("./load"),c=e("./../util/global_def"),l=cc._decorator,d=l.ccclass,h=l.property,u=function(){return function(){this.taskIndex=null,this.state=null,this.des=null,this.proCurNum=null,this.proTolNum=null,this.curTime=null,this.reward=null,this.reward_numb=null,this.skip=null,this.refresh=null,this.target_id=null}}();o.TaskData=u,function(e){e[e.task=0]="task",e[e.cool=1]="cool",e[e.open=2]="open"}(n=o.TaskState||(o.TaskState={}));var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.states=[],t.proCurNumLab=null,t.proCurNum=0,t.proTolNumLab=null,t.proTolNum=0,t.taskPro=null,t.skipLable=null,t.skipNum=null,t.timeLab=null,t.time=null,t.totalTime=10800,t.timePro=null,t.refreshLable=null,t.refreshNum=null,t.awardImage=null,t.awardLabel=null,t.des=null,t.taskImage=null,t.taskImage_fs=[],t.coinImage=null,t.crownImage=null,t.state=null,t.taskIndex=null,t.reward=null,t.reward_num=null,t.tag=null,t.listenerId=null,t.target_id=null,t.isLoadScene=!1,t.taskLayer=null,t.coinEnd=cc.v2(-308,592),t.crownEnd=cc.v2(-97,592),t}return __extends(t,e),t.prototype.init=function(e,t,o){var c=this;if(1==o)this.isLoadScene=o,this.taskLayer=s.default.instance.TaskLayer;else{if(null==r.default.instance);this.taskLayer=r.default.instance.TaskLayer}switch(null!=t&&(this.tag=t),this.setState(e.state),this.taskIndex=Number(e.taskIndex),this.des.string=e.des,this.time=e.curTime,this.refreshNum=e.refresh,this.proTolNum=e.proTolNum,this.proCurNum=e.proCurNum,this.skipNum=e.skip,this.reward=e.reward,this.reward_num=e.reward_numb,this.target_id=e.target_id,1==this.reward?this.awardImage.spriteFrame=this.coinImage:this.awardImage.spriteFrame=this.crownImage,this.awardLabel.string=String(this.reward_num),this.taskImage.spriteFrame=this.taskImage_fs[this.target_id-1],e.state){case n.task:this.proTolNumLab.string=String(this.proTolNum),this.proCurNumLab.string=String(this.proCurNum),this.skipLable.string=String(this.skipNum),this.setPro(this.taskPro,this.proCurNum,this.proTolNum,!1,function(){c.setState(n.open,!0)}),null==this.listenerId&&a.default.instance.gameType!=a.GameType.endless&&null==o&&(this.listenerId=a.default.instance.eventManager.addListener(this.taskIndex+i.EventType.KTask,function(e,t){c.proCurNum++,c.setData("proCurNum",c.proCurNum),c.setPro(c.taskPro,c.proCurNum,c.proTolNum,!1,function(){c.setState(n.open,!0)})}),r.default.ListenerManager.push({type:this.taskIndex+i.EventType.KTask,id:this.listenerId}));break;case n.cool:this.des.node.active=!1,this.setCoolTime(),this.refreshLable.string=String(this.refreshNum),this.setPro(this.timePro,this.time,this.totalTime,!0,function(){c.refresh(),c.setState(n.task,!0)});break;case n.open:}},t.prototype.setData=function(e,t){this.taskLayer.getComponent("taskLayer").setData(this.tag,e,t)},t.prototype.refresh=function(){this.taskLayer.getComponent("taskLayer").refreshItem(this.tag)},t.prototype.setCoolTime=function(){var e=cc.sys.localStorage.getItem("taskLastTime"),t=c.G.Game.getSysTime(),o=0;null!=e&&""!=e&&(o=t-e),cc.sys.localStorage.setItem("taskLastTime",t),this.time+=o,this.time<=0&&(this.time=0);var n=this.totalTime-this.time;this.timeLab.string=c.G.Game.turnTime(n),this.setData("curTime",this.time)},t.prototype.setState=function(e,t){var o=this;void 0===t&&(t=!1),this.state=e,this.setData("state",e);for(var a in this.states){this.states[a].active=!1}if(this.states[e].active=!0,t)switch(this.state){case n.task:this.proCurNum=0,this.taskPro.progress=0,this.des.node.active=!0;break;case n.cool:this.time=0,this.timeLab.string=c.G.Game.turnTime(this.totalTime),this.timePro.progress=0,this.des.node.active=!1,this.setPro(this.timePro,this.time,this.totalTime,!0,function(){o.refresh(),o.setState(n.task,!0)});break;case n.open:this.des.node.active=!0}},t.prototype.setPro=function(e,t,o,n,a){var i=this,r=t/o;if(e.progress=r,n){var s=function(n){t+=1,i.setData("curTime",t);var r=t/o;e.progress=r;var l=o-t;i.timeLab.string=c.G.Game.turnTime(l),t>=o&&(i.unschedule(s),a&&a())};this.unscheduleAllCallbacks(),this.schedule(s,1,cc.macro.REPEAT_FOREVER)}else t>=o&&a&&a()},t.prototype.onclickOpen=function(){this.setState(n.cool,!0);var e=s.default.instance.coinNode,t=s.default.instance.crownNode,o=this.awardImage.node.convertToWorldSpaceAR(cc.v2(0,0));o=this.taskLayer.convertToNodeSpaceAR(o);var a=c.G.randRange(5,6);if(this.isLoadScene?s.default.instance.updateWealth(r.WealthType.coin,this.reward_num):r.default.instance.updateWealth(r.WealthType.crown,this.reward_num),1==this.reward)for(var i=function(t){var n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=l.coinImage,n.setPosition(o);var a=cc.moveTo(.2,l.coinEnd);l.taskLayer.addChild(n),n.runAction(cc.sequence(cc.delayTime(.1*t),a,cc.callFunc(function(){e.runAction(cc.sequence(cc.scaleTo(.2,1.2),cc.scaleTo(.2,1)))}),cc.fadeOut(.2),cc.callFunc(function(){n.destroy()})))},l=this,d=0;d<a;++d)i(d);else{var h=function(e){var n=new cc.Node;n.addComponent(cc.Sprite).spriteFrame=u.crownImage,n.setPosition(o);var a=cc.moveTo(.2,u.crownEnd);u.taskLayer.addChild(n),n.runAction(cc.sequence(cc.delayTime(.1*e),a,cc.callFunc(function(){t.runAction(cc.sequence(cc.scaleTo(.2,1.2),cc.scaleTo(.2,1)))}),cc.fadeOut(.2),cc.callFunc(function(){n.destroy()})))},u=this;for(d=0;d<a;++d)h(d)}},t.prototype.skipTask=function(){this.isLoadScene,this.taskLayer.getComponent("taskLayer").close()},t.prototype.skipCool=function(){var e=this;this.isLoadScene?s.default.instance.buy(r.WealthType.crown,this.refreshNum,function(){e.refresh(),e.setState(n.task,!0)}):r.default.instance.buy(r.WealthType.crown,this.refreshNum,function(){e.refresh(),e.setState(n.task,!0)})},__decorate([h([cc.Node])],t.prototype,"states",void 0),__decorate([h(cc.Label)],t.prototype,"proCurNumLab",void 0),__decorate([h(cc.Label)],t.prototype,"proTolNumLab",void 0),__decorate([h(cc.ProgressBar)],t.prototype,"taskPro",void 0),__decorate([h(cc.Label)],t.prototype,"skipLable",void 0),__decorate([h(cc.Label)],t.prototype,"timeLab",void 0),__decorate([h(cc.ProgressBar)],t.prototype,"timePro",void 0),__decorate([h(cc.Label)],t.prototype,"refreshLable",void 0),__decorate([h(cc.Sprite)],t.prototype,"awardImage",void 0),__decorate([h(cc.Label)],t.prototype,"awardLabel",void 0),__decorate([h(cc.Label)],t.prototype,"des",void 0),__decorate([h(cc.Sprite)],t.prototype,"taskImage",void 0),__decorate([h(cc.SpriteFrame)],t.prototype,"taskImage_fs",void 0),__decorate([h(cc.SpriteFrame)],t.prototype,"coinImage",void 0),__decorate([h(cc.SpriteFrame)],t.prototype,"crownImage",void 0),t=__decorate([d],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../util/event_mgr":"event_mgr","./../game_logic":"game_logic","./../game_scene":"game_scene","./../util/global_def":"global_def","./load":"load"}],tipWindow:[function(e,t,o){"use strict";cc._RF.push(t,"bb608ql8B1JYYLix3Sw9uiI","tipWindow"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=e("./../util/wx_util"),i=e("./../game_scene"),r=e("./../util/global_def"),s=cc._decorator,c=s.ccclass,l=s.property;(function(e){e[e.coin=0]="coin",e[e.crown=1]="crown"})(n||(n={}));var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.coin_node=null,t.crown_node=null,t.coinNum=1e3,t.crownNum=10,t.coinNumLabel=null,t.crownNumLabel=null,t.windScene=null,t}return __extends(t,e),t.prototype.open=function(e,t){switch(this.coinNumLabel.string=String(this.coinNum),this.crownNumLabel.string=String(this.crownNum),this.windScene=t,this.node.active=!0,this.coin_node.active=!1,this.crown_node.active=!1,e){case n.coin:this.coin_node.active=!0;break;case n.crown:this.crown_node.active=!0}this.content.getComponent("ui_motion").triggerMotion()},t.prototype.close=function(){this.node.active=!1},t.prototype.onClickGetCoin=function(){var e=this;a.default.watchVideoAds(r.G.VideoId.coin_lack,function(){e.windScene.updateWealth(i.WealthType.coin,e.coinNum),e.windScene.showTip("\u606d\u559c\u83b7\u5f97\u91d1\u5e01:"+e.coinNum),e.close()},null,null,null,null,!1)},t.prototype.onClickGetCrown=function(){var e=this;a.default.watchVideoAds(r.G.VideoId.crown_lack,function(){e.windScene.updateWealth(i.WealthType.crown,e.crownNum),e.windScene.showTip("\u606d\u559c\u83b7\u5f97\u7687\u51a0:"+e.crownNum),e.close()},null,null,null,null,!1)},t.prototype.onClickBack=function(){this.node.active=!1},__decorate([l(cc.Node)],t.prototype,"content",void 0),__decorate([l(cc.Node)],t.prototype,"coin_node",void 0),__decorate([l(cc.Node)],t.prototype,"crown_node",void 0),__decorate([l(cc.Label)],t.prototype,"coinNumLabel",void 0),__decorate([l(cc.Label)],t.prototype,"crownNumLabel",void 0),t=__decorate([c],t)}(cc.Component);o.default=d,cc._RF.pop()},{"./../game_scene":"game_scene","./../util/global_def":"global_def","./../util/wx_util":"wx_util"}],tipWind:[function(e,t,o){"use strict";cc._RF.push(t,"59485B/LdZAQrvsq+Hdvq/G","tipWind"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=cc._decorator,i=a.ccclass,r=a.property,s=e("./../util/wx_util"),c=e("./../game_scene"),l=e("./../util/global_def");(function(e){e[e.coin=0]="coin",e[e.crown=1]="crown"})(n||(n={}));var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.des=null,t.videoCoinBtn=null,t.videoCrownBtn=null,t.backBtn=null,t.coinLabel=null,t.crownLabel=null,t.coinNum=2e3,t.crownNum=20,t}return __extends(t,e),t.prototype.init=function(e){switch(this.videoCoinBtn.active=!1,this.videoCrownBtn.active=!1,e){case n.coin:this.des.string="\u91d1\u5e01\u4e0d\u8db3",this.crownLabel.string=String(this.coinNum),this.videoCoinBtn.active=!0;break;case n.crown:this.des.string="\u7687\u51a0\u4e0d\u8db3",this.crownLabel.string=String(this.crownNum),this.videoCrownBtn.active=!0}},t.prototype.open=function(e){this.init(e),this.node.active=!0,this.content.getComponent("ui_motion").triggerMotion(),l.G.reportToAld(l.G.Report.tipWindow)},t.prototype.close=function(){this.node.active=!1,s.default.delBanner()},t.prototype.onClickCoinBtn=function(){var e=this;s.default.watchVideoAds(l.G.VideoId.coin_lack,function(){c.default.instance.updateWealth(c.WealthType.coin,e.coinNum),c.default.instance.showTip("\u606d\u559c\u83b7\u5f97\u91d1\u5e01:"+e.coinNum),e.close()}),l.G.reportToAld(l.G.Report.tipWindow_Video)},t.prototype.onClickCrownBtn=function(){var e=this;s.default.watchVideoAds(l.G.VideoId.crown_lack,function(){c.default.instance.updateWealth(c.WealthType.crown,e.crownNum),c.default.instance.showTip("\u606d\u559c\u83b7\u5f97\u7687\u51a0:"+e.crownNum),e.close()}),l.G.reportToAld(l.G.Report.tipWindow_Video)},__decorate([r(cc.Node)],t.prototype,"content",void 0),__decorate([r(cc.Label)],t.prototype,"des",void 0),__decorate([r(cc.Node)],t.prototype,"videoCoinBtn",void 0),__decorate([r(cc.Node)],t.prototype,"videoCrownBtn",void 0),__decorate([r(cc.Node)],t.prototype,"backBtn",void 0),__decorate([r(cc.Label)],t.prototype,"coinLabel",void 0),__decorate([r(cc.Label)],t.prototype,"crownLabel",void 0),__decorate([r(cc.Node)],t.prototype,"banNode",void 0),t=__decorate([i],t)}(cc.Component);o.default=d,cc._RF.pop()},{"./../game_scene":"game_scene","./../util/global_def":"global_def","./../util/wx_util":"wx_util"}],tips:[function(e,t,o){"use strict";cc._RF.push(t,"f6d4bSzJY9Gbp3AKs7ENgye","tips"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.txt_=null,t}return __extends(t,e),t.prototype.display=function(e){this.node.stopAllActions(),this.node.active=!0,this.node.opacity=0;var t=cc.fadeIn(.2),o=cc.delayTime(1),n=cc.fadeOut(.3),a=cc.callFunc(function(){this.node.active=!1},this);this.txt_.string=e.toString(),this.node.runAction(cc.sequence(t,o,n,a))},__decorate([i(cc.RichText)],t.prototype,"txt_",void 0),t=__decorate([a],t)}(cc.Component);o.default=r,cc._RF.pop()},{}],tnt:[function(e,t,o){"use strict";cc._RF.push(t,"db3503wphlDaLgdW9MpV7Ls","tnt"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=e("./../UI/explode"),s=e("./../game_scene"),c=e("./../util/global_def"),l=e("../game_logic"),d=e("../util/event_mgr"),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.image=null,t.isLaunch=!1,t.isBoom=!1,t.touch_count=0,t.lit=!1,t}return __extends(t,e),t.prototype.init=function(){this.touch_count=0,this.node.rotation=0,this.isLaunch=!1,this.isBoom=!1;var e=this.node.getComponent(cc.RigidBody);e.angularVelocity=0,e.linearVelocity=cc.v2(0,0),this.node.getChildByName("blink").stopAllActions()},t.prototype.run=function(){var e=this;this.isLaunch||(this.isLaunch=!0,this.node.getChildByName("blink").runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.1,130),cc.fadeTo(.1,20)))),this.node.runAction(cc.sequence(cc.delayTime(1.3),cc.callFunc(function(){e.boom(),l.default.instance.eventManager.addEvent(d.EventType.KTaskDestroyTnt,e,{})}))))},t.prototype.boom=function(){if(!this.isBoom){this.isBoom=!0;var e=s.default.instance.getExplode(r.ExplodeType.tnt),t=(e.getComponent("explode").type,this.node.getPosition());e.setPosition(t.x,t.y),s.default.instance.node.addChild(e),e.getComponent("explode").run(),c.G.Game.rmFromArray(this.node,s.default.instance.Scene[s.SceneType.main].getComponent("main_scene").tntManager),this.node.active=!1}},t.prototype.onPreSolve=function(e,t,o){},t.prototype.onPostSolve=function(e,t,o){if(o.tag==c.G.Game.heroTag&&0==this.touch_count){var n=this.node.getComponent(cc.RigidBody);n.angularVelocity=0,n.linearVelocity=cc.v2(0,0)}},t.prototype.onBeginContact=function(e,t,o){if(o.tag==c.G.Game.heroTag){if(0==this.touch_count)o.node.getComponent(cc.RigidBody).linearVelocity=cc.v2(-100,0),c.G.Game.vibrateShort();else if(0!=this.touch_count){if(c.G.Game.getDir(e)!=c.G.Game.dir.down){var n=this.node.getComponent(cc.RigidBody);n.angularVelocity=1e3,n.gravityScale=20,n.linearVelocity=cc.v2(3e3,2e3),o.node.getComponent(cc.RigidBody).linearVelocity=cc.v2(-2e3,0)}}this.touch_count++,this.run()}},t.prototype.onCollisionEnter=function(e,t){e.tag==c.G.Game.weaponTag&&0==this.lit&&(this.lit=!0,this.run(),this.touch_count++)},__decorate([i(cc.Sprite)],t.prototype,"image",void 0),t=__decorate([a],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../game_logic":"game_logic","../util/event_mgr":"event_mgr","./../UI/explode":"explode","./../game_scene":"game_scene","./../util/global_def":"global_def"}],towerCard:[function(e,t,o){"use strict";cc._RF.push(t,"73dc0XAl+9NSZZLnPn9Wuzx","towerCard"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=e("./Load"),s=e("../util/global_def"),c=e("../util/Storage"),l=e("./towerLayer"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.noUseState=null,t.unLookState=null,t.coinState=null,t.crownState=null,t.select=null,t.towerWp=null,t.hurt=null,t.num=null,t.wealth=null,t.wealthSpr=[],t.level=null,t.id=null,t.wealthNum=null,t.wealthType=0,t.sca=[.25,.2,.8],t}return __extends(t,e),t.prototype.init=function(e){this.id=e,this.level=s.G.GameData.getTowerData(e),this.setUnLook(this.level),this.towerWp.spriteFrame=s.G.Game.getGRes(s.G.Game.GResType.tower,e),this.towerWp.node.scale=this.sca[this.id],this.setData(),e==s.G.GameData.currenTower&&this.setSelect(!0)},t.prototype.setData=function(){this.wealthNum=s.G.GameData.getTowerMoney(this.id),this.hurt.string=s.G.GameData.getTowerHurt(this.id),this.num.string=String(this.wealthNum)},t.prototype.setState=function(e){this.coinState.active=!1,this.crownState.active=!1,1==e?(this.coinState.active=!0,this.wealth.spriteFrame=this.wealthSpr[0]):2==e&&(this.crownState.active=!0,this.wealth.spriteFrame=this.wealthSpr[1])},t.prototype.setUnLook=function(e){this.unLookState.active=0==e},t.prototype.onClickUnLook=function(){var e=this;r.default.instance.buy(this.wealthType,this.wealthNum,function(){e.setUnLook(1),e.upGrade()})},t.prototype.onClickupgrade=function(){var e=this;r.default.instance.buy(this.wealthType,this.wealthNum,function(){e.upGrade()})},t.prototype.upGrade=function(){this.level++,s.G.GameData.setTowerData(this.id,this.level),this.setData()},t.prototype.setSelect=function(e){this.select.active=e,e&&(s.G.GameData.currenTower=this.id,c.default.writeNum("currenTower",this.id))},t.prototype.onClickSelect=function(){if(0!=this.level){for(var e in l.default.items){l.default.items[e].getComponent("towerCard").setSelect(!1)}this.setSelect(!0)}},__decorate([i(cc.Node)],t.prototype,"noUseState",void 0),__decorate([i(cc.Node)],t.prototype,"unLookState",void 0),__decorate([i(cc.Node)],t.prototype,"coinState",void 0),__decorate([i(cc.Node)],t.prototype,"crownState",void 0),__decorate([i(cc.Node)],t.prototype,"select",void 0),__decorate([i(cc.Sprite)],t.prototype,"towerWp",void 0),__decorate([i(cc.Label)],t.prototype,"hurt",void 0),__decorate([i(cc.Label)],t.prototype,"num",void 0),__decorate([i(cc.Sprite)],t.prototype,"wealth",void 0),__decorate([i([cc.SpriteFrame])],t.prototype,"wealthSpr",void 0),t=__decorate([a],t)}(cc.Component);o.default=d,cc._RF.pop()},{"../util/Storage":"storage","../util/global_def":"global_def","./Load":"load","./towerLayer":"towerLayer"}],towerContent:[function(e,t,o){"use strict";cc._RF.push(t,"7287a40vnJKi4Yu+ePtPnHX","towerContent"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./load"),a=e("../util/global_def"),i=e("../util/Storage"),r=e("./towerLayer"),s=cc._decorator,c=s.ccclass,l=s.property,d=[10,10,10],h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.level=null,t.unLook=null,t.content=null,t.itemNode=null,t.towerCard=null,t.numLab=null,t.image=null,t.imageSpr=[],t.des=null,t.unLookBtn=null,t.id=null,t.wealthNum=10,t.WealthType=1,t.items=[],t}return __extends(t,e),t.prototype.isCanLook=function(){this.id<a.G.GameData.floorLevel+1&&(this.unLookBtn.active=!0)},t.prototype.init=function(e){this.id=e;var t=a.G.GameData.getTower();this.level.string=String(e+1),this.wealthNum=d[e],this.numLab.string=String(this.wealthNum);var o=a.G.GameData.tower[e].wpId,n=-200*((o.length-1)/2);for(var i in o){var s=o[i];(c=cc.instantiate(this.towerCard)).getComponent("towerCard").init(s),this.itemNode.addChild(c),c.x=n,n+=200,r.default.items.push(c),this.items.push(c)}if(1==t[e]){this.unLook.active=!1,this.des.active=!0;for(var i in this.items){var c;(c=this.items[i]).getComponent("towerCard").noUseState.active=!1}}this.isCanLook()},t.prototype.onClickUnLook=function(){var e=this;n.default.instance.buy(this.WealthType,this.wealthNum,function(){e.unLook.active=!1,n.default.instance.showTip("\u89e3\u9501\u5854\u697c\u6210\u529f"),a.G.GameData.setTower(e.id,1),i.default.writeNum("floorLevel",e.id+1),a.G.GameData.floorLevel=e.id+1,e.des.active=!0;for(var t in e.items)e.items[t].getComponent("towerCard").noUseState.active=!1;for(var t in r.default.towerContents)r.default.towerContents[t].getComponent("towerContent").isCanLook()})},__decorate([l(cc.Label)],t.prototype,"level",void 0),__decorate([l(cc.Node)],t.prototype,"unLook",void 0),__decorate([l(cc.Node)],t.prototype,"content",void 0),__decorate([l(cc.Node)],t.prototype,"itemNode",void 0),__decorate([l(cc.Prefab)],t.prototype,"towerCard",void 0),__decorate([l(cc.Label)],t.prototype,"numLab",void 0),__decorate([l(cc.Sprite)],t.prototype,"image",void 0),__decorate([l([cc.SpriteFrame])],t.prototype,"imageSpr",void 0),__decorate([l(cc.Node)],t.prototype,"des",void 0),__decorate([l(cc.Node)],t.prototype,"unLookBtn",void 0),t=__decorate([c],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../util/Storage":"storage","../util/global_def":"global_def","./load":"load","./towerLayer":"towerLayer"}],towerLayer:[function(e,t,o){"use strict";cc._RF.push(t,"96ff4n1swdJf59/vzg7T+Eo","towerLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=e("../util/global_def"),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.content=null,t.towerContent=null,t.viewConten=null,t}var o;return __extends(t,e),o=t,t.prototype.init=function(){for(var e in r.G.GameData.tower){var t=cc.instantiate(this.towerContent);t.getComponent("towerContent").init(Number(e)),this.viewConten.addChild(t),o.towerContents.push(t)}},t.prototype.open=function(){this.node.active=!0,this.content.getComponent("ui_motion").triggerMotion()},t.prototype.close=function(){this.node.active=!1},t.items=[],t.towerContents=[],__decorate([i(cc.Node)],t.prototype,"content",void 0),__decorate([i(cc.Prefab)],t.prototype,"towerContent",void 0),__decorate([i(cc.Node)],t.prototype,"viewConten",void 0),t=o=__decorate([a],t)}(cc.Component);o.default=s,cc._RF.pop()},{"../util/global_def":"global_def"}],tower:[function(e,t,o){"use strict";cc._RF.push(t,"7d95dnlJWhMv4SQE9fhzZvU","tower"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=cc._decorator,i=a.ccclass,r=a.property,s=e("./../game_scene"),c=e("./hero"),l=e("./../util/global_def"),d=e("./enemy"),h=e("./explode"),u=[{anchor:cc.v2(.5,.2),boxSize:cc.size(100,360),boxOffset:cc.v2(100,200)},{anchor:cc.v2(.22,.5),boxSize:cc.size(700,160),boxOffset:cc.v2(200,0)}];(function(e){e[e.tower_sword=0]="tower_sword",e[e.tower_speer=1]="tower_speer",e[e.tower_dragonfly=2]="tower_dragonfly"})(n=o.TowerType||(o.TowerType={}));var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.image=null,t.box=null,t.imageFr=[],t.bladeFr=null,t}return __extends(t,e),t.prototype.init=function(e){switch(this.image.spriteFrame=this.imageFr[e],this.setTowerInfo(e),e){case n.tower_sword:c.default.instance.towerWp.addComponent(_).init();break;case n.tower_speer:c.default.instance.towerWp.addComponent(g).init()}},t.prototype.setTowerInfo=function(e){this.image.node.setAnchorPoint(u[e].anchor),this.box.offset=u[e].boxOffset,this.box.size=u[e].boxSize},__decorate([r(cc.Sprite)],t.prototype,"image",void 0),__decorate([r(cc.BoxCollider)],t.prototype,"box",void 0),__decorate([r([cc.SpriteFrame])],t.prototype,"imageFr",void 0),__decorate([r(cc.SpriteFrame)],t.prototype,"bladeFr",void 0),t=__decorate([i],t)}(cc.Component);o.default=p;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.entity=null,t}return __extends(t,e),t.prototype.init=function(){this.entity=this.node.getComponent(p)},t.prototype.upgrade=function(){},t.prototype.prepare=function(){},t.prototype.excute=function(){},t}(cc.Component);o.towerAct=f;var m,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startRoat=-60,t.showRoat=167,t.endRoat=200,t.dRoat=12,t.aRoat=1.5,t.run=!1,t.blade=null,t}return __extends(t,e),t.prototype.init=function(){e.prototype.init.call(this),this.node.scale=1.5,this.node.active=!1,this.blade=new cc.Node,this.blade.group="weapon",this.blade.addComponent(cc.Sprite).spriteFrame=this.entity.bladeFr,this.blade.setPosition(cc.v2(165,147)),this.blade.opacity=100,this.blade.scaleX=1,this.blade.scaleY=1,this.blade.active=!1,s.default.instance.node.addChild(this.blade,1e3)},t.prototype.prepare=function(){this.node.rotation=this.startRoat,this.node.active=!0,this.node.opacity=255},t.prototype.excute=function(){this.blade.setPosition(c.default.instance.node.getPosition()),this.run=!0,this.dRoat=12},t.prototype.update=function(){var e=this;this.run&&(this.dRoat+=this.aRoat,this.node.rotation+=this.dRoat,this.node.rotation>=this.showRoat&&this.node.rotation<this.endRoat?this.blade.active=!0:this.node.rotation>this.endRoat&&(this.node.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){e.blade.active=!1,e.node.active=!1}))),this.run=!1))},t.prototype.onCollisionEnter=function(e,t){if(e.tag==l.G.Game.enemyTag){var o=e.node;null!=o&&o.getComponent(d.commonAct).damage(10,h.ExplodeType.hit)}},__decorate([r(cc.Node)],t.prototype,"blade",void 0),t}(f);o.swoardAct=_,function(e){e[e.start=0]="start",e[e.end=1]="end",e[e.back=2]="back"}(m||(m={}));var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.startScaleY=.7,t.endScaleY=1,t.ax=.2,t.targetX=null,t.state=null,t.s=0,t}return __extends(t,e),t.prototype.init=function(){e.prototype.init.call(this),this.node.active=!1,this.node.scale=.7,this.node.scaleY=.7*.7,this.node.y-=20},t.prototype.prepare=function(){this.node.active=!0,this.state=m.start,this.targetX=-100,this.ax=.1,this.entity.image.node.opacity=255,this.node.active=!0,this.node.setPosition(cc.p(0,20))},t.prototype.callBack=function(e,t){},t.prototype.excute=function(){this.state=m.end,this.targetX=1e3,this.s=.0021,this.ax=.2},t.prototype.update=function(){var e=this,t=(this.targetX-this.node.x)*this.ax;if(this.node.x+=t,Math.abs(this.targetX-this.node.x)<2)return this.node.x=this.targetX,this.state==m.end&&this.scheduleOnce(function(){e.state=m.back,e.ax=.1,e.targetX=-100},0),void(this.state==m.back&&(this.entity.image.node.opacity=0,this.node.active=!1));this.state==m.back&&this.node.x<300&&(this.entity.image.node.opacity-=5,this.entity.image.node.opacity<=0&&(this.entity.image.node.opacity=0))},t.prototype.onCollisionEnter=function(e,t){if(e.tag==l.G.Game.enemyTag){var o=e.node;if(null!=o){var n=l.G.GameData.getTowerHurt(l.G.GameData.currenTower);o.getComponent(d.commonAct).damage(n,h.ExplodeType.hit)}}},t}(f);o.pickAct=g,cc._RF.pop()},{"./../game_scene":"game_scene","./../util/global_def":"global_def","./enemy":"enemy","./explode":"explode","./hero":"hero"}],trialLayer:[function(e,t,o){"use strict";cc._RF.push(t,"f1416DobExKkZfDdSzFeivP","trialLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./../util/global_def"),a=e("./../game_scene"),i=e("./hero"),r=e("./../util/wx_util"),s=e("./load"),c=e("./../util/storage"),l=e("../game_logic"),d=cc._decorator,h=d.ccclass,u=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.contnet=null,t.items=[],t.aceItem=null,t.noShowBtn=null,t.exitBtn=null,t.tag=null,t.banNode=null,t.ids=[],t.aceId=null,t.type=null,t.scene=null,t.rand=null,t}return __extends(t,e),t.prototype.initBanner=function(){r.default.addBanner(n.G.BannerId[0],null,this.banNode),r.default.delBanner()},t.prototype.getHeroId=function(){for(var e=[],t=[],o=0;o<n.G.Game.hatCount;o++){0==n.G.GameData.hatInfo[o]&&7!=o&&8!=o?t.push(o):e.push(o)}for(;3!=this.ids.length;)if(0!=t.length){o=t[a=n.G.randRange(0,t.length-1)];this.ids.push(o),t.splice(a,1)}else{var a;o=e[a=n.G.randRange(0,e.length-1)];this.ids.push(o),e.splice(a,1)}var i=[7,8],r=n.G.randRange(0,i.length-1);this.aceId=i[r]},t.prototype.init=function(e){this.getHeroId(),this.type=e,this.scene=0==e?s.default.instance:a.default.instance;var t=0;for(var o in this.ids){var i=this.ids[o],r=this.items[t];r.getChildByName("image").getComponent(cc.Sprite).spriteFrame=n.G.Game.getGRes(n.G.Game.GResType.Hero,i),r.getChildByName("name").getComponent(cc.Label).string=n.G.Game.hero_name[i],t++}this.aceItem.getChildByName("image").getComponent(cc.Sprite).spriteFrame=n.G.Game.getGRes(n.G.Game.GResType.Hero,this.aceId),this.aceItem.getChildByName("name").getComponent(cc.Label).string=n.G.Game.hero_name[this.aceId]},t.prototype.getOpenCount=function(){var e=(new Date).getDate(),t=c.default.readNum("lastDateOpenTrial");e!=Number(t)&&c.default.writeNum("trialOpen",0);var o=c.default.readNum("trialOpen");return c.default.writeNum("lastDateOpenTrial",e),Number(o)},t.prototype.addOpenCount=function(){var e=c.default.readNum("trialOpen");e++,c.default.writeNum("trialOpen",e)},t.prototype.open=function(){var e=this;if(0!=l.default.instance.switch){if(this.rand=n.G.randRange(0,99),!(this.getOpenCount()>=l.default.instance.trialCount)){this.addOpenCount();var t=null;t=wx.getSystemInfoSync().screenWidth-60,n.G.ipShield(this.rand)?this.exitBtn.y=-454:this.exitBtn.y=-334;this.node.active=!0,this.contnet.getComponent("ui_motion").triggerMotion(function(){if(r.default.delBanner(),n.G.ipShield(e.rand)){var o=null;o=wx.getSystemInfoSync().screenWidth-60;var a=n.G.showBanner.trialHero.time-n.G.delayTime;a<=0?a=0:a>=n.G.maxTime&&(a=n.G.maxTime),e.exitBtn.noTouch=!0,n.G.startBanner(n.G.showBanner.trialHero),e.exitBtn.runAction(cc.sequence(cc.delayTime(a),cc.moveBy(0,0,120),cc.callFunc(function(){r.default.addBanner(n.G.BannerId[0],o,e.banNode),e.exitBtn.noTouch=!1})))}else r.default.addBanner(n.G.BannerId[0],t,e.banNode)}),n.G.reportToAld(n.G.Report.trialLayer)}}else this.scene.showTip("1000\u7687\u51a0\u5f00\u653e")},t.prototype.close=function(){n.G.stopBanner(n.G.showBanner.trialHero),this.exitBtn.noTouch||this.enterGame()},t.prototype.enterGame=function(){0==this.type?s.default.instance.enterGame():(null!=n.G.GlobalData.trialId&&n.G.GlobalData.trialCount>0&&i.default.instance.init(n.G.GlobalData.trialId),a.default.instance.openPetTrialLayer(null)),r.default.delBanner(),this.node.active=!1},t.prototype.getNewUserTrialCount=function(){var e=c.default.readNum("newUsertrialCount");return null==e?(c.default.writeNum("newUsertrialCount",1),1):e},t.prototype.onClickAceTrial=function(){var e=this;n.G.stopBanner(n.G.showBanner.trialHero);r.default.watchVideoAds(n.G.VideoId.trialHero,function(){n.G.GlobalData.trialId=e.aceId,n.G.GlobalData.trialCount=1,e.scene.trialLayer.getComponent("trialLayer").enterGame(),n.G.Game.addShareCountCom(),n.G.reportToAld(n.G.Report.trialVideo)})},t.prototype.onClickTrial=function(e,t){var o=this;n.G.stopBanner(n.G.showBanner.trialHero);var a=Number(t),i=function(){n.G.GlobalData.trialId=o.ids[a],n.G.GlobalData.trialCount=1,o.scene.trialLayer.getComponent("trialLayer").enterGame(),n.G.Game.addShareCountCom()},s=this.getNewUserTrialCount();s>0?(i(),s--,c.default.writeNum("newUsertrialCount",s)):n.G.Game.getShareCountCom()>=l.default.instance.shareCount_com||1==l.default.instance.ip_switch&&0==l.default.instance.ip_share?r.default.watchVideoAds(n.G.VideoId.trialHero,function(){i(),n.G.reportToAld(n.G.Report.trialVideo)}):this.scene.shareGame(function(){i(),n.G.reportToAld(n.G.Report.trialShare)})},t.prototype.onClickRandTrial=function(){var e=this,t=function(){var t=n.G.randRange(0,3);n.G.GlobalData.trialId=e.ids[t],n.G.GlobalData.trialCount=1,e.scene.trialLayer.getComponent("trialLayer").enterGame(),n.G.Game.addShareCountCom()},o=this.getNewUserTrialCount();console.log("\u65b0\u7528\u6237\u6b21\u6570"+o),o>0?(t(),o--,c.default.writeNum("newUsertrialCount",o)):n.G.Game.getShareCountCom()>=l.default.instance.shareCount_com||1==l.default.instance.ip_switch&&0==l.default.instance.ip_share?r.default.watchVideoAds(n.G.VideoId.trialHero,function(){t()}):this.scene.shareGame(t),n.G.reportToAld(n.G.Report.trialShare)},t.prototype.onClickNoShowBtn=function(){0==n.G.GlobalData.trialClose?(this.tag.active=!0,n.G.GlobalData.trialClose=!0):(this.tag.active=!1,n.G.GlobalData.trialClose=!1)},__decorate([u(cc.Node)],t.prototype,"contnet",void 0),__decorate([u([cc.Node])],t.prototype,"items",void 0),__decorate([u(cc.Node)],t.prototype,"aceItem",void 0),__decorate([u(cc.Node)],t.prototype,"noShowBtn",void 0),__decorate([u(cc.Node)],t.prototype,"exitBtn",void 0),__decorate([u(cc.Node)],t.prototype,"tag",void 0),__decorate([u(cc.Node)],t.prototype,"banNode",void 0),t=__decorate([h],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../game_logic":"game_logic","./../game_scene":"game_scene","./../util/global_def":"global_def","./../util/storage":"storage","./../util/wx_util":"wx_util","./hero":"hero","./load":"load"}],ui_motion:[function(e,t,o){"use strict";cc._RF.push(t,"fa71duCUDVDNaD8XnsYg86t","ui_motion"),Object.defineProperty(o,"__esModule",{value:!0});var n,a,i,r=e("../global_def"),s=cc._decorator,c=s.ccclass,l=s.property;(function(e){e[e.kNone=0]="kNone",e[e.kMove=1]="kMove",e[e.kScale=2]="kScale",e[e.kRot=3]="kRot",e[e.kFade=4]="kFade",e[e.kMoveFade=5]="kMoveFade",e[e.kScaleFade=6]="kScaleFade",e[e.kScaleRot=7]="kScaleRot"})(n=o.MotionType||(o.MotionType={})),function(e){e[e.kNone=0]="kNone",e[e.kCubic=1]="kCubic",e[e.kBack=2]="kBack",e[e.kBounce=3]="kBounce",e[e.kElastic=4]="kElastic",e[e.kCircle=5]="kCircle",e[e.kSine=6]="kSine"}(a||(a={})),function(e){e[e.kIn=0]="kIn",e[e.kOut=1]="kOut",e[e.kInOut=2]="kInOut"}(i||(i={}));var d=function(){function e(){this.type=0,this.begin=new cc.Vec2(0,0),this.begin2=null,this.end=new cc.Vec2(0,0),this.end2=null,this.ease=new cc.Vec2(0,1),this.ease2=null,this.elasticFactor=.3,this.dura=0,this.delay=0}return __decorate([l(cc.Integer)],e.prototype,"type",void 0),__decorate([l(cc.Vec2)],e.prototype,"begin",void 0),__decorate([l(cc.Vec2)],e.prototype,"begin2",void 0),__decorate([l(cc.Vec2)],e.prototype,"end",void 0),__decorate([l(cc.Vec2)],e.prototype,"end2",void 0),__decorate([l(cc.Vec2)],e.prototype,"ease",void 0),__decorate([l(cc.Vec2)],e.prototype,"ease2",void 0),__decorate([l(cc.Float)],e.prototype,"elasticFactor",void 0),__decorate([l(cc.Float)],e.prototype,"dura",void 0),__decorate([l(cc.Float)],e.prototype,"delay",void 0),e=__decorate([c("MotionPara")],e)}(),h=function(){function e(){this.node=null,this.param=new d}return __decorate([l(cc.Node)],e.prototype,"node",void 0),__decorate([l(d)],e.prototype,"param",void 0),e=__decorate([c("MotionNode")],e)}(),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.motionNode_=[],t.cbDelay_=0,t.callback_=null,t}return __extends(t,e),t.prototype.run=function(e,t,o,n,a,i,r,s){var c=new h;c.node=e,c.param=new d,c.param.type=t,c.param.begin=o,c.param.end=n,c.param.delay=i,c.param.dura=a,this._parseParam(c)},t.prototype.triggerMotion=function(e){this.callback_&&(this.unschedule(this.callback_),this.callback_=null),this.cbDelay_=0,this.callback_=e;for(var t=0;t<this.motionNode_.length;++t)this._parseParam(this.motionNode_[t]);e&&(this.cbDelay_+=.1,this.scheduleOnce(this.callback_,this.cbDelay_))},t.prototype._parseParam=function(e){var t=e.param.delay+e.param.dura;t>this.cbDelay_&&(this.cbDelay_=t),e.node.stopAllActions(),e.param.type==n.kMove?this._move(e):e.param.type==n.kScale?this._scale(e):e.param.type==n.kRot?this._rotation(e):e.param.type==n.kFade?this._fade(e):e.param.type==n.kMoveFade?this._moveAndFade(e):e.param.type==n.kScaleFade?this._scaleAndFade(e):e.param.type==n.kScaleRot&&this._scaleAndRot(e)},t.prototype._move=function(e){e.node.setPosition(e.param.begin);var t=cc.moveTo(e.param.dura,e.param.end);this._ease(t,e.param.ease,e.param.elasticFactor),this._excuteAction(t,e.node,e.param.delay)},t.prototype._scale=function(e){e.node.setScale(e.param.begin.x,e.param.begin.y);var t=cc.scaleTo(e.param.dura,e.param.end.x,e.param.end.y);this._ease(t,e.param.ease,e.param.elasticFactor),this._excuteAction(t,e.node,e.param.delay)},t.prototype._rotation=function(e){e.node.rotation=e.param.begin.x;var t=cc.rotateTo(e.param.dura,e.param.end.x);this._ease(t,e.param.ease,e.param.elasticFactor),this._excuteAction(t,e.node,e.param.delay)},t.prototype._fade=function(e){e.node.opacity=e.param.begin.x;var t=cc.fadeTo(e.param.dura,e.param.end.x);this._ease(t,e.param.ease,e.param.elasticFactor),this._excuteAction(t,e.node,e.param.delay)},t.prototype._moveAndFade=function(e){e.node.setPosition(e.param.begin);var t=cc.moveTo(e.param.dura,e.param.end);if(this._ease(t,e.param.ease,e.param.elasticFactor),e.param.begin2){e.node.opacity=e.param.begin2.x;var o=cc.fadeTo(e.param.dura,e.param.end2.x);this._ease(o,e.param.ease2,e.param.elasticFactor);var n=cc.spawn(t,o);this._excuteAction(n,e.node,e.param.delay)}else cc.error("param lost,please check the param begin2, end2 and ease2 is existed")},t.prototype._scaleAndFade=function(e){e.node.setScale(e.param.begin.x,e.param.begin.y);var t=cc.scaleTo(e.param.dura,e.param.end.x,e.param.end.y);if(this._ease(t,e.param.ease,e.param.elasticFactor),e.param.begin2){e.node.opacity=e.param.begin2.x;var o=cc.fadeTo(e.param.dura,e.param.end2.x);this._ease(o,e.param.ease2,e.param.elasticFactor);var n=cc.spawn(t,o);this._excuteAction(n,e.node,e.param.delay)}else cc.error("param lost,please check the param begin2, end2 and ease2 is existed")},t.prototype._scaleAndRot=function(e){e.node.setScale(e.param.begin.x,e.param.begin.y);var t=cc.scaleTo(e.param.dura,e.param.end.x,e.param.end.y);if(this._ease(t,e.param.ease,e.param.elasticFactor),e.param.begin2){e.node.rotation=e.param.begin2.x;var o=cc.rotateTo(e.param.dura,e.param.end2.x);this._ease(o,e.param.ease2,e.param.elasticFactor);var n=cc.spawn(t,o);this._excuteAction(n,e.node,e.param.delay)}else cc.error("param lost,please check the param begin2, end2 and ease2 is existed")},t.prototype._excuteAction=function(e,t,o){if(o>0){var n=cc.delayTime(o);t.runAction(cc.sequence(n,e))}else t.runAction(e)},t.prototype._ease=function(e,t,o){if(null==t||t.x!=a.kNone){var n=null,r=t.x,s=t.y;r==a.kCubic?s==i.kIn?n=cc.easeCubicActionIn():s==i.kOut?n=cc.easeCubicActionOut():s==i.kInOut&&(n=cc.easeCubicActionInOut()):r==a.kBack?s==i.kIn?n=cc.easeBackIn():s==i.kOut?n=cc.easeBackOut():s==i.kInOut&&(n=cc.easeBackInOut()):r==a.kBounce?s==i.kIn?n=cc.easeBounceIn():s==i.kOut?n=cc.easeBounceOut():s==i.kInOut&&(n=cc.easeBounceInOut()):r==a.kElastic?s==i.kIn?n=cc.easeElasticIn(o):s==i.kOut?n=cc.easeElasticOut(o):s==i.kInOut&&(n=cc.easeElasticInOut(o)):r==a.kCircle?s==i.kIn?n=cc.easeCircleActionIn():s==i.kOut?n=cc.easeCircleActionOut():s==i.kInOut&&(n=cc.easeCircleActionInOut()):r==a.kSine&&(s==i.kIn?n=cc.easeSineIn():s==i.kOut?n=cc.easeSineOut():s==i.kInOut&&(n=cc.easeSineInOut())),n&&e.easing(n)}},t.prototype.typoEffect=function(e,t,o,n){void 0===n&&(n=.05);var a="",i=t.split(""),s=i.length,c=0,l=function(){a+=i[c],e.string=a,++c>=s&&r.G.isExistObj(o)&&o()}.bind(this);this.schedule(l,n,s-1,0)},__decorate([l(h)],t.prototype,"motionNode_",void 0),t=__decorate([c],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../global_def":"global_def"}],unlock:[function(e,t,o){"use strict";cc._RF.push(t,"ab14c2O9u5D2L7fXgCiZuYJ","unlock"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=cc._decorator,i=a.ccclass,r=a.property,s=e("./../game_scene"),c=e("./BoxLayer"),l=e("./../util/global_def"),d=e("../game_logic"),h=e("./../util/wx_util");(function(e){e[e.to_unlock=0]="to_unlock",e[e.countdown=1]="countdown",e[e.to_on=2]="to_on",e[e.empty=3]="empty"})(n=o.BoxState||(o.BoxState={}));var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state_node=[],t.box=null,t.coin_lable=null,t.timeLable=null,t.lookVideo=null,t.addSpeed=null,t.coin=null,t.state=null,t.boxType=null,t.unlookTime=99999,t.startTime=null,t.index=null,t}return __extends(t,e),t.prototype.setIndex=function(e){this.index=e},t.prototype.init=function(e,t,o){this.boxType=e,this.box.spriteFrame=l.G.Game.getGRes(l.G.Game.GResType.Box,e),this.state=t,this.startTime=o,this.setState(this.state),this.coin_lable.string=String(l.G.Game.getNeedCoin(e)),this.lookVideo.active=!0,this.addSpeed.active=!0,d.default.instance.gameState==d.GameState.gamePlay&&(this.lookVideo.active=!1,this.addSpeed.active=!1)},t.prototype.setState=function(e){this.state=e;for(var t in this.state_node){this.state_node[Number(t)].active=!1}this.state_node[e].active=!0,e==n.countdown&&this.startCountdown()},t.prototype.startCountdown=function(){this.unlookTime=l.G.Game.getOrigUnlookTime(this.boxType);var e=l.G.Game.getSysTime()-this.startTime;this.unlookTime-=e,this.unlookTime<=0?(this.setState(n.to_on),this.unschedule(this.downTime)):this.schedule(this.downTime,1)},t.prototype.downTime=function(){this.unlookTime--;var e=l.G.Game.turnTime(this.unlookTime);this.timeLable.string=e,this.unlookTime<=0&&(this.unschedule(this.downTime),this.setState(n.to_on))},t.prototype.updateData=function(e){var t=new c.boxStruct;e==n.countdown&&(t.startTime=l.G.Game.getSysTime(),this.startTime=l.G.Game.getSysTime()),t.boxId=this.boxType,t.state=e,s.default.instance.boxLayer.getComponent("BoxLayer").setData(this.index,t)},t.prototype.openShowLayer=function(){if(d.default.instance.gameState!=d.GameState.gamePlay)if(this.state==n.to_unlock)s.default.instance.node.getChildByName("BoxShowLayer").getComponent("BoxShowLayer").openBoxShowLayer(this.boxType,this.node);else if(this.state==n.to_on){d.default.instance.report(d.default.instance.rType.openBox,1),s.default.instance.node.getChildByName("AwardLayer").getComponent("newAwardLayer").open(this.boxType),this.updateData(n.empty),this.setState(n.empty)}},t.prototype.onClickLookVideo=function(){var e=this;h.default.watchVideoAds(l.G.VideoId.unLookBox,function(){e.updateData(n.countdown),e.setState(n.countdown),l.G.reportToAld(l.G.Report.boxLayerUnlook)})},t.prototype.addCoolSpeed=function(){var e=this;h.default.watchVideoAds(l.G.VideoId.unLookBox,function(){e.updateData(n.to_on),e.setState(n.to_on),l.G.reportToAld(l.G.Report.boxLayerCold)})},__decorate([r([cc.Node])],t.prototype,"state_node",void 0),__decorate([r(cc.Sprite)],t.prototype,"box",void 0),__decorate([r(cc.Label)],t.prototype,"coin_lable",void 0),__decorate([r(cc.Label)],t.prototype,"timeLable",void 0),__decorate([r(cc.Node)],t.prototype,"lookVideo",void 0),__decorate([r(cc.Node)],t.prototype,"addSpeed",void 0),t=__decorate([i],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../game_logic":"game_logic","./../game_scene":"game_scene","./../util/global_def":"global_def","./../util/wx_util":"wx_util","./BoxLayer":"BoxLayer"}],vision_road:[function(e,t,o){"use strict";cc._RF.push(t,"47984Nm36tLLoDfgrzNv/Hm","vision_road"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=e("./../util/global_def"),s=e("./../game_scene"),c=e("../game_logic"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.image=null,t.plantNode=null,t.plantPool=null,t}return __extends(t,e),t.prototype.init=function(){this.initPlantPool()},t.prototype.setData=function(){var e=r.G.Game.getGameResId(c.default.instance.gameLevel),t=s.default.instance.roadF[e].length,o=r.G.randRange(0,t-1);this.setTexture(o),this.node.scale=r.G.randRange(5,8)/10,this.node.opacity=r.G.randRange(50,80)},t.prototype.initPlantPool=function(){this.plantPool=new cc.NodePool;for(var e=0;e<10;++e){var t=new cc.Node;t.setAnchorPoint(cc.v2(0,0));t.addComponent(cc.Sprite);this.plantPool.put(t)}},t.prototype.setTexture=function(e){var t=r.G.Game.getGameResId(c.default.instance.gameLevel),o=s.default.instance.roadF[t][e];this.image.spriteFrame=o,this.node.width=o.getRect().width,this.node.height=o.getRect().height},t.prototype.createPlant=function(){for(var e=this.node.width,t=-e/2,o=this.plantNode.children,n=o.length;n>=0;n--){var a=o[n];this.plantPool.put(a)}for(var i=0;i<10;++i){var l=r.G.Game.getGameResId(c.default.instance.gameLevel),d=s.default.instance.plantF[l].length,h=(n=r.G.randRange(0,d-1),this.plantPool.get());h.setAnchorPoint(cc.v2(0,0));var u=h.addComponent(cc.Sprite),p=s.default.instance.plantF[l][n];if(u.spriteFrame=p,h.width=p.getRect().width,t+h.width>e/2){this.plantPool.put(h);break}h.x=t,this.plantNode.addChild(h),t+=h.width+r.G.randRange(5,100)}},__decorate([i(cc.Sprite)],t.prototype,"image",void 0),__decorate([i(cc.Node)],t.prototype,"plantNode",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"../game_logic":"game_logic","./../game_scene":"game_scene","./../util/global_def":"global_def"}],weaponLayer:[function(e,t,o){"use strict";cc._RF.push(t,"b2e59HY/wBFDaPjqEY1ayg+","weaponLayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=e("../game_logic"),s=e("./../util/global_def"),c=e("../util/event_mgr"),l=e("../game_scene"),d=e("./../UI/tower"),h=e("./../UI/hero"),u=e("../util/wx_util"),p=e("./../util/storage"),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.wp_btn=null,t.weapon=[],t.mask=null,t.image=null,t.wp_node=null,t.towerBtn=null,t.towerMask=null,t.towerPower=100,t.towerFree=!1,t.towerImage=null,t.towerLight=null,t.lock=null,t.name_labl=null,t.open=!1,t.close=!1,t.data=[],t.sca=[.25,.2,.8],t}return __extends(t,e),t.prototype.onLoad=function(){var e=r.default.instance.eventManager.addListener(c.EventType.kOpenBox,this.unLockWeapon.bind(this));l.default.ListenerManager.push({type:c.EventType.kOpenBox,id:e}),null!=s.G.GameData.currenTower?(this.towerBtn.active=!0,this.towerImage.spriteFrame=s.G.Game.getGRes(s.G.Game.GResType.tower,s.G.GameData.currenTower),this.towerImage.node.setScale(this.sca[s.G.GameData.currenTower])):this.towerBtn.active=!1},t.prototype.initTowerWp=function(){var e=this,t=h.default.instance.towerWp.getComponent(d.towerAct);t.init(),this.towerBtn.on(cc.Node.EventType.TOUCH_START,function(){e.towerPower>=50&&(t.prepare(),e.towerFree=!0)});var o=function(){e.towerFree&&(t.excute(),e.towerFree=!1,e.towerPower-=50,e.addPow())};this.towerBtn.on(cc.Node.EventType.TOUCH_END,o),this.towerBtn.on(cc.Node.EventType.TOUCH_CANCEL,o)},t.prototype.addTowerCount=function(){var e=p.default.readNum("towerCount");e++,p.default.writeNum("towerCount",e)},t.prototype.getTowerCount=function(){var e=(new Date).getDate(),t=p.default.readNum("lastTowerCount");e!=Number(t)&&p.default.writeNum("towerCount",0);var o=p.default.readNum("towerCount");return p.default.writeNum("lastTowerCount",e),Number(o)},t.prototype.onClickLock=function(){var e=this,t=function(){s.G.GameData.towerLock=!0,e.lock.active=!1,l.default.instance.showTip("\u89e3\u9501\u6280\u80fd\u6210\u529f"),null!=h.default.instance.towerPet&&(h.default.instance.towerPet.active=!0),e.addTowerCount()};this.getTowerCount()>=1?u.default.watchVideoAds(s.G.VideoId.trialHero,t,function(){l.default.instance.showTip("\u8bf7\u89c2\u770b\u5b8c\u6574\u89c6\u9891\u89e3\u9501\u6280\u80fd")}):t()},t.prototype.addPow=function(){if(!l.default.instance.novice&&s.G.GameData.towerLock){if(this.towerPower+=1,this.towerPower>=100&&(this.towerPower=100),this.towerPower>=50){this.towerLight.active=!0,this.towerLight.stopAllActions();var e=cc.spawn(cc.fadeTo(.5,100),cc.scaleTo(.5,1)),t=cc.spawn(cc.fadeTo(.5,255),cc.scaleTo(.5,1.2));this.towerLight.runAction(cc.repeatForever(cc.sequence(e,t)))}else this.towerLight.active=!1;this.towerMask.height=this.towerPower/100*174}},t.prototype.init=function(e){this.wp_node.removeAllChildren(),this.weapon=[],this.data=e;for(var t in e){var o=cc.instantiate(this.wp_btn);o.getComponent("wp_btn").init(Number(t),e[t]),o.setPosition(150*Number(t)-225+150,100),this.wp_node.addChild(o),this.weapon.push(o)}},t.prototype.showTip=function(e){this.name_labl.string=s.G.Game.weapon_name[e],this.image.spriteFrame=s.G.Game.getGRes(s.G.Game.GResType.WeaponTag,e),this.open=!0},t.prototype.unLockWeapon=function(e,t){var o=this.weapon[t.index];o.getComponent("wp_btn").unlock(),o.getComponent("wp_btn").set_select();var n=o.getComponent("wp_btn").wp_id;this.showTip(n)},t.prototype.update=function(){var e=this;this.close&&(this.mask.height-=3,this.mask.height<=0&&(this.close=!1,this.mask.height=0)),this.open&&(this.mask.height+=4,this.mask.height>=112&&(this.open=!1,this.mask.height=112,this.scheduleOnce(function(){e.close=!0},.5)))},__decorate([i(cc.Prefab)],t.prototype,"wp_btn",void 0),__decorate([i(cc.Node)],t.prototype,"mask",void 0),__decorate([i(cc.Sprite)],t.prototype,"image",void 0),__decorate([i(cc.Node)],t.prototype,"wp_node",void 0),__decorate([i(cc.Node)],t.prototype,"towerBtn",void 0),__decorate([i(cc.Node)],t.prototype,"towerMask",void 0),__decorate([i(cc.Sprite)],t.prototype,"towerImage",void 0),__decorate([i(cc.Node)],t.prototype,"towerLight",void 0),__decorate([i(cc.Node)],t.prototype,"lock",void 0),__decorate([i(cc.Label)],t.prototype,"name_labl",void 0),t=__decorate([a],t)}(cc.Component);o.default=f,cc._RF.pop()},{"../game_logic":"game_logic","../game_scene":"game_scene","../util/event_mgr":"event_mgr","../util/wx_util":"wx_util","./../UI/hero":"hero","./../UI/tower":"tower","./../util/global_def":"global_def","./../util/storage":"storage"}],weapon:[function(e,t,o){"use strict";cc._RF.push(t,"649d1iM+b1AC4uB5C21rGYb","weapon"),Object.defineProperty(o,"__esModule",{value:!0});var n,a=cc._decorator,i=a.ccclass,r=a.property,s=e("./../game_scene"),c=e("./hero"),l=e("./../util/global_def"),d=e("./explode"),h=e("./../util/audio_mgr"),u=e("./enemy");(function(e){e[e.spear=0]="spear",e[e.hammer=1]="hammer",e[e.rocket=2]="rocket",e[e.axe=3]="axe",e[e.darts=4]="darts",e[e.chains=5]="chains",e[e.bomb=6]="bomb",e[e.sword=7]="sword",e[e.fly_knife=8]="fly_knife",e[e.fly_spear=9]="fly_spear",e[e.rota_darts=10]="rota_darts",e[e.shield=11]="shield",e[e.shock_knife=12]="shock_knife",e[e.bat_darts=13]="bat_darts",e[e.stick=14]="stick"})(n=o.WeaponType||(o.WeaponType={}));var p=[cc.v2(.5,.5),cc.v2(0,.5),cc.v2(.5,.5),cc.v2(.1,.7),cc.v2(.5,.5),cc.v2(0,.5),cc.v2(.5,.5),cc.v2(0,.5),cc.v2(.5,.5),cc.v2(.5,.5),cc.v2(.5,.5),cc.v2(.5,.5),cc.v2(1,.5),cc.v2(.5,.5),cc.v2(.8,.5)];o.START_ROAT=[-5,-168,0,-90,0,0,0,-180,0,-20,202,0,0,16,0];var f=[{offset:cc.v2(110,0),size:cc.size(50,20)},{offset:cc.v2(115,0),size:cc.size(30,70)},{offset:cc.v2(0,0),size:cc.size(75,40)},{offset:cc.v2(100,-10),size:cc.size(50,55)},{offset:cc.v2(0,0),size:cc.size(50,50)},{offset:cc.v2(185,0),size:cc.size(70,40)},{offset:cc.v2(0,0),size:cc.size(75,40)},{offset:cc.v2(140,0),size:cc.size(150,40)},{offset:cc.v2(.5,.5),size:cc.size(60,20)},{offset:cc.v2(88,0),size:cc.size(44,20)},{offset:cc.v2(0,0),size:cc.size(110,60)},{offset:cc.v2(0,0),size:cc.size(52,52)},{offset:cc.v2(-110,0),size:cc.size(100,30)},{offset:cc.v2(0,0),size:cc.size(70,30)},{offset:cc.v2(-80,0),size:cc.size(269,30)}];o.FIGHT_TYPE=[0,0,1,0,1,0,1,0,1,0,0,0,0,1,0],o.POS=[cc.v2(2,15),cc.v2(0,10),cc.v2(0,0),cc.v2(-38,5),cc.v2(0,0),cc.v2(0,20),cc.v2(0,0),cc.v2(0,10),cc.v2(0,0),cc.v2(0,80),cc.v2(-55,22),cc.v2(-37,26),cc.v2(-26,26),cc.v2(-38,16),cc.v2(-14,24)];var m=[1,1,1,.9,1,1,1,1,1,1,1,1.5,1,1,.8],_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.image=null,t.wp=null,t.bottom=null,t.smoke=null,t.sowrd_gas_s=null,t.fly_knife_manager=[],t.rocks=[],t.rigidBody=null,t.gas=null,t.count=1,t.info={hurt:0,range:0,throw_numb:0,type:1},t.cur_count=0,t.act=null,t}return __extends(t,e),t.prototype.init=function(e){switch(this.id=e,this.setTexture(this.id),this.node.rotation=o.START_ROAT[this.id],this.image.node.anchorX=p[this.id].x,this.image.node.anchorY=p[this.id].y,this.node.scale=m[this.id],this.node.position=o.POS[this.id],this.info=l.G.Game.getWeaponInfo(this.id,this.count),this.cur_count=this.info.throw_numb,this.id){case n.spear:this.addSteak(.1,8,cc.v2(210,0),cc.color(255,0,0));break;case n.chains:this.run();break;case n.sword:var t=new cc.Node;t.addComponent(cc.Sprite).spriteFrame=this.sowrd_gas_s,t.setPosition(116,77),t.rotation=20,t.scaleX=1.2,t.active=!1,this.node.addChild(t,1e3,"sword_gas");break;case n.fly_knife:this.addSteak(.1,8,cc.v2(0,0));break;case n.fly_spear:this.cur_count=3,this.addSteak(.1,6,cc.v2(200,10),cc.color(255,255,255));break;case n.darts:this.addSteak(.1,8,cc.v2(50,0),cc.color(255,255,255),!0);break;case n.hammer:break;case n.rocket:var a=cc.instantiate(this.smoke);a.x=-20,this.node.addChild(a,1e3,"smoke");break;case n.axe:this.addSteak(.2,8,cc.v2(100,0)),(i=this.node.getChildByName("streak")).active=!1;break;case n.rota_darts:this.addSteak(.2,5,cc.v2(-52,-34),cc.color(255,255,255),!1,"streak"),this.addSteak(.2,5,cc.v2(52,-34),cc.color(255,255,255),!1,"streak1");var i=this.node.getChildByName("streak"),r=this.node.getChildByName("streak1");i.active=!1,r.active=!1;break;case n.shield:var s=new cc.Node;s.addComponent(cc.Sprite).spriteFrame=c.default.instance.hammer_gas_s,s.x=8,s.scale=1.2,s.active=!1,this.node.addChild(s,1e3,"light")}},t.prototype.addSteak=function(e,t,o,n,a,i){void 0===n&&(n=cc.color(255,255,255)),void 0===a&&(a=!1),void 0===i&&(i="streak");var r=cc.v2(0,0);null!=o&&(r=o);var s=this.node.width*this.node.anchorX,c=cc.v2(-s+r.x,0+r.y),l=this.node.getChildByName(i);l.active=!0;var d=l.getComponent(cc.MotionStreak);return d.fadeTime=e,d.stroke=t,d.color=n,l.setPosition(c),a&&(l.removeFromParent(!1),this.bottom.addChild(l)),l},t.prototype.setTexture=function(e){var t=l.G.Game.getGRes(l.G.Game.GResType.Weapon,e);this.image.spriteFrame=t,this.node.width=t.getRect().width,this.node.height=t.getRect().height,this.setBox()},t.prototype.setBox=function(){var e=this.node.getComponent(cc.BoxCollider);e.size=f[this.id].size,e.offset=f[this.id].offset},t.prototype.addCount=function(){this.count++,this.info=l.G.Game.getWeaponInfo(this.id,this.count),this.act.info=this.info,this.cur_count=this.info.throw_numb,this.act.addCount()},t.prototype.run=function(){this.act.colTrigger||this.act.execute()},t.prototype.update=function(){var e=this.node.getComponent(y);null!=e&&e.updateAction()},__decorate([r(cc.Sprite)],t.prototype,"image",void 0),__decorate([r(cc.Prefab)],t.prototype,"wp",void 0),__decorate([r(cc.Node)],t.prototype,"bottom",void 0),__decorate([r(cc.Prefab)],t.prototype,"smoke",void 0),__decorate([r(cc.SpriteFrame)],t.prototype,"sowrd_gas_s",void 0),__decorate([r(cc.Prefab)],t.prototype,"gas",void 0),t=__decorate([i],t)}(cc.Component);o.default=_;var g=function(){function e(){}return e.prototype.addAction=function(e,t){e.getComponent("weapon").act=e.addComponent(t),e.getComponent(y).setInfo()},e.prototype.create=function(e){var t=cc.instantiate(s.default.instance.weapon);switch(t.getComponent("weapon").init(e),t.active=!1,e){case n.spear:this.addAction(t,C);break;case n.hammer:this.addAction(t,b);break;case n.rocket:this.addAction(t,x);break;case n.axe:this.addAction(t,S);break;case n.darts:this.addAction(t,G);break;case n.chains:this.addAction(t,A);break;case n.bomb:this.addAction(t,L);break;case n.sword:this.addAction(t,k);break;case n.fly_knife:this.addAction(t,N);break;case n.fly_spear:this.addAction(t,I);break;case n.rota_darts:this.addAction(t,D);break;case n.shield:this.addAction(t,R);break;case n.shock_knife:this.addAction(t,P);break;case n.bat_darts:this.addAction(t,M);break;case n.stick:this.addAction(t,B)}return t},e}();o.wpFactory=g;var y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.target=null,t.runing=!1,t.id=null,t.info=null,t.colTrigger=!1,t}return __extends(t,e),t.prototype.addCount=function(){},t.prototype.execute=function(){},t.prototype.setInfo=function(){this.id=this.node.getComponent("weapon").id,this.info=this.node.getComponent("weapon").info},t.prototype.updateAction=function(){},t}(cc.Component);o.wpAction=y;var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isFly=!1,t.fly_speed=20,t.fly_speed_y=0,t}return __extends(t,e),t.prototype.updata_fly=function(){if(0!=this.isFly&&(this.node.x+=this.fly_speed,this.node.y+=this.fly_speed_y,this.node.x-this.node.width/2>s.default.instance.heroCamera.x+s.default.instance.windowSize.width/2+50)){this.isFly=!1;var e=s.default.instance.weaponPool[this.id];null!=e&&e.put(this.node),c.default.instance.currentWeapon.getComponent("weapon").cur_count++}},t.prototype.onCollisionEnter=function(e,t){if(e.tag==l.G.Game.enemyTag||e.tag==l.G.Game.tntTag){var o=c.default.instance.currentWeapon.getComponent("weapon").info,n=null;e.tag==l.G.Game.enemyTag&&(n=e.node);var a=s.default.instance.weaponPool[this.id];null!=a&&a.put(t.node),c.default.instance.currentWeapon.getComponent("weapon").cur_count++,null!=n&&n.getComponent(u.commonAct).damage(o.hurt,d.ExplodeType.hit)}},t}(y),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onCollisionEnter=function(e,t){var o=c.default.instance.currentWeapon.getComponent("weapon").info;if(e.tag==l.G.Game.enemyTag||e.tag==l.G.Game.tntTag){var n=null;e.tag==l.G.Game.enemyTag&&(n=e.node),null!=n&&n.getComponent(u.commonAct).damage(o.hurt,d.ExplodeType.hit)}},t}(y),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.easing_spear=.3,t}return __extends(t,e),t.prototype.updateAction=function(){if(c.default.instance.down)this.target=o.POS[this.id];else{var e=-this.node.rotation*(3.14/180),t=80+20*this.info.range,n=t*Math.cos(e),a=t*Math.sin(e);this.target=cc.v2(n,a)}var i=this.target.x-this.node.x,r=this.target.y-this.node.y;if(Math.sqrt(i*i+r*r)<1)return this.node.x=this.target.x,void(this.node.y=this.target.y);var s=i*this.easing_spear,l=r*this.easing_spear;this.node.x+=s,this.node.y+=l;var d=Math.sqrt(this.node.x*this.node.x+this.node.y*this.node.y)/(130+20*this.info.range);this.node.scale=1+d*(.2*this.info.range)},t.prototype.execute=function(){h.AudioMgr.instance.playSpear()},t}(w),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colTrigger=!0,t}return __extends(t,e),t.prototype.execute=function(){c.default.instance.rigidBody.linearVelocity=cc.v2(-1500,0);var e=this.info.range;this.node.runAction(cc.sequence(cc.rotateTo(.02,0),cc.delayTime(.1),cc.rotateTo(.2,-160)));var t=new cc.Node;t.scale=4,t.group="weapon",t.addComponent(cc.Sprite).spriteFrame=c.default.instance.hammer_gas_s,c.default.instance.node.addChild(t,1e3,"hammer_gas");var o=t.addComponent(cc.BoxCollider),n=t.getContentSize();o.size=cc.size(4*n.width,4*n.height),o.tag=l.G.Game.gasTag,t.active=!0;var a=300+50*e,i=cc.moveBy(.2,a,0);t.runAction(cc.sequence(i,cc.callFunc(function(){t.destroy()})))},t}(w),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(){if(this.node.getComponent("weapon").cur_count,!(this.node.getComponent("weapon").cur_count<=0)){this.node.getComponent("weapon").cur_count--;var e=s.default.instance.getWeaponItem(this.id);null==e.getComponent(y)&&(e.addComponent(t),e.getComponent(y).setInfo()),e.scale=.1;var o=c.default.instance.node.getPosition();e.setPosition(o.x+150,o.y+l.G.randRange(30,100)),s.default.instance.node.addChild(e),e.runAction(cc.sequence(cc.scaleTo(.2,.7),cc.callFunc(function(){e.getComponent(t).isFly=!0})))}},t.prototype.updateAction=function(){this.updata_fly()},t.prototype.onCollisionEnter=function(e,t){if(e.tag==l.G.Game.enemyTag){var o=c.default.instance.currentWeapon.getComponent("weapon").info;e.node.getComponent(u.commonAct).damage(o.hurt,d.ExplodeType.rocket);var n=s.default.instance.weaponPool[this.id];null!=n&&n.put(this.node),c.default.instance.currentWeapon.getComponent("weapon").cur_count++}},t}(v),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.easing=.2,t.axe_manager=[],t}return __extends(t,e),t.prototype.addCount=function(){if(!(this.axe_manager.length+1>=this.info.throw_numb)){var e=this.node.getComponent("weapon"),t=360/e,o=s.default.instance.wpFactory.create(n.axe);o.setRotation(t),this.node.addChild(o),this.axe_manager.push(o);for(var a=0;a<e-1;a++){this.axe_manager[a].rotation=(a+1)*t}}},t.prototype.updateAction=function(){c.default.instance.down?(this.target=o.POS[this.id],this.node.rotation=o.START_ROAT[this.id]):(this.target=cc.v2(500,100),this.node.rotation+=40);var e=this.target.x-this.node.x,t=this.target.y-this.node.y;if(Math.sqrt(e*e+t*t)<1)return this.node.x=this.target.x,void(this.node.y=this.target.y);var n=e*this.easing,a=t*this.easing;this.node.x+=n,this.node.y+=a},t.prototype.execute=function(){this.node.getChildByName("streak").active=!0},t}(w),G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.updateAction=function(){this.updata_fly()},t.prototype.execute=function(){h.AudioMgr.instance.playThrowDarts();var e=this.info.throw_numb,o=s.default.instance.weaponPool[this.id];e>o.size()&&(e=o.size());for(var n=0;n<e;++n){var a=s.default.instance.weaponPool[this.id].get();if(null==a)return;null==a.getComponent(y)&&(a.addComponent(t),a.getComponent(y).setInfo()),a.scale=.7,a.getChildByName("image").runAction(cc.repeatForever(cc.rotateBy(1,3600)));var i=c.default.instance.node.getPosition();if(a.setPosition(i.x-5,i.y+10),s.default.instance.node.addChild(a),a.getComponent(t).isFly=!0,a.getComponent(t).fly_speed=40,e%2==0){a.getComponent(t).fly_speed_y=3*(n-(e-1)/2);var r=Math.abs(n-(e-1)/2);a.getComponent(t).fly_speed-=3*r}else{a.getComponent(t).fly_speed_y=3*(n-Math.floor(e/2));r=Math.abs(n-Math.floor(e/2));a.getComponent(t).fly_speed-=3*r}}},t}(v),A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.target=cc.v2(0,0),t}return __extends(t,e),t.prototype.updateAction=function(){this.node.rotation+=12,this.target.x=this.node.x+this.node.width*Math.cos(-.785),this.target.y=this.node.y+this.node.width*Math.sin(-.785);var e=this.node.rotation/180*3.14,t=this.node.width*Math.cos(e),o=this.node.width*Math.sin(e),n=this.target.x-t,a=this.target.y-o,i=1-Math.sqrt(n*n+a*a)/(2*this.node.width);this.node.getChildByName("image").width=220+100*i},t}(w),L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colTrigger=!0,t}return __extends(t,e),t.prototype.executeBoom=function(e,t){if(1!=e.getComponent(u.commonAct).protect){var o=c.default.instance.currentWeapon.getComponent("weapon").info.throw_numb;if(!(c.default.instance.boomCount>=o)){var a=cc.v2(0,0);if(t==l.G.Game.dir.up)a=cc.v2(0,e.height);else if(t==l.G.Game.dir.left)a=cc.v2(-e.width/2,l.G.randRange(10,e.height-10));else{if(t!=l.G.Game.dir.right)return;a=cc.v2(e.width/2,l.G.randRange(10,e.height-10))}var i=s.default.instance.getWeaponItem(n.bomb);if(null!=i)c.default.instance.boomCount++,i.setScale(.7),i.setPosition(a),e.addChild(i),i.getChildByName("blink").runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.1,130),cc.fadeTo(.1,20)))),this.scheduleOnce(function(){var t=s.default.instance.getExplode(d.ExplodeType.boom),o=e.getPosition();t.setPosition(o.x,o.y),s.default.instance.node.addChild(t),t.getComponent("explode").run(),c.default.instance.boomCount--,s.default.instance.weaponPool[n.bomb].put(i)},1.5)}}},t}(w);o.bombAction=L;var T,k=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colTrigger=!0,t}return __extends(t,e),t.prototype.execute=function(){if(1==c.default.instance.currentWeapon.getComponent("weapon").count)c.default.instance.currentWeapon.runAction(cc.sequence(cc.rotateTo(.01,0),cc.delayTime(.1),cc.rotateTo(.1,180),cc.callFunc(function(){c.default.instance.currentWeapon.rotation=-180})));else{var e=c.default.instance.currentWeapon.getChildByName("sword_gas"),t=cc.sequence(cc.callFunc(function(){e.active=!0,e.rotation=20,e.runAction(cc.fadeTo(1/30,150)),e.setPosition(147,60)}),cc.rotateTo(1/30,-110),cc.rotateTo(1/30,-40),cc.callFunc(function(){e.rotation=20,e.setPosition(116,77),e.scaleX=1.2,e.scaleX=1,e.runAction(cc.fadeOut(1/30))}),cc.rotateTo(1/30,80),cc.callFunc(function(){e.active=!1}),cc.rotateTo(1/30,180),cc.callFunc(function(){c.default.instance.currentWeapon.rotation=-180}));c.default.instance.currentWeapon.runAction(cc.sequence(t,t,t))}},t}(w),N=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.updateAction=function(){this.updata_fly()},t.prototype.execute=function(){h.AudioMgr.instance.playThrowDarts();var e=this.info.throw_numb,o=s.default.instance.weaponPool[this.id];e>o.size()&&(e=o.size());for(var n=0;n<e;n++){var a=s.default.instance.weaponPool[this.id].get();if(null==a)return;null==a.getComponent(y)&&(a.addComponent(t),a.getComponent(y).setInfo()),a.scale=.8;var i=c.default.instance.node.getPosition();i.y+=10,s.default.instance.node.addChild(a),a.getComponent(t).isFly=!0,a.getComponent(t).fly_speed=40,n<e/2?(a.y=-12*(e/2-n)+i.y,a.x=-10*(e/2-n)+i.x):(a.x=-10*(n-e/2)+i.x,a.y=12*(n-e/2)+i.y)}},t}(v),I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.f_p_a=1,t.f_p_spx=null,t.f_p_spy=null,t.runing=!1,t}return __extends(t,e),t.prototype.updateAction=function(){if(0!=this.runing){this.f_p_spy-=this.f_p_a;var e=Math.atan2(this.f_p_spx,this.f_p_spy)/6.28*360;this.node.rotation=e-90,this.node.x+=this.f_p_spx,this.node.y+=this.f_p_spy}},t.prototype.execute=function(){h.AudioMgr.instance.playThrowDarts();var e=s.default.instance.getWeaponItem(this.id);e.y=0,e.opacity=255,e.scale=.6,null==e.getComponent(y)&&(e.addComponent(t),e.getComponent(y).setInfo()),e.getComponent(t).runing=!0,e.getComponent(t).f_p_spx=30,e.getComponent(t).f_p_spy=15;var o=c.default.instance.node.getPosition();e.setPosition(o.x,o.y),e.removeFromParent(!1),s.default.instance.node.addChild(e),e.stopAllActions(),e.runAction(cc.sequence(cc.delayTime(2),cc.fadeOut(1),cc.callFunc(function(){s.default.instance.weaponPool[n.fly_spear].put(e)})))},t.prototype.onCollisionEnter=function(e,o){var a=c.default.instance.currentWeapon.getComponent("weapon").info;o.node.removeFromParent(!1);var i=o.node.convertToWorldSpaceAR(cc.v2(0,0));if(i=e.node.convertToNodeSpaceAR(i),o.node.setPosition(i),o.node.getComponent(t).runing=!1,e.tag==l.G.Game.enemyTag)e.node.addChild(this.node),e.node.getComponent(u.commonAct).damage(a.hurt,d.ExplodeType.hit),s.default.instance.weaponPool[n.fly_spear].put(o.node);else if(e.tag==l.G.Game.roadTag){e.node.getChildByName("otherNode").addChild(o.node)}},t}(v);(function(e){e[e.leave=0]="leave",e[e.hover=1]="hover",e[e.back=2]="back",e[e.none=3]="none"})(T||(T={}));var D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=T.none,t.hoverTime=1,t}return __extends(t,e),t.prototype.updateAction=function(){this.id;switch(this.state){case T.none:return;case T.leave:this.target=cc.v2(600,100),this.node.rotation+=30;break;case T.back:this.target=o.POS[this.id],this.node.rotation=o.START_ROAT[this.id];break;case T.hover:return this.node.rotation+=30,this.hoverTime--,void(this.hoverTime<=0&&(this.hoverTime=1,this.state=T.back))}var e=this.target.x-this.node.x,t=this.target.y-this.node.y;if(Math.sqrt(e*e+t*t)<1){if(this.node.x=this.target.x,this.node.y=this.target.y,this.state==T.back){var n=this.node.getChildByName("streak"),a=this.node.getChildByName("streak1");n.active=!1,a.active=!1}this.state==T.leave&&(this.state=T.back)}else{var i=.15*e,r=.15*t;this.node.x+=i,this.node.y+=r}},t.prototype.execute=function(){h.AudioMgr.instance.playThrowDarts();var e=this.node.getChildByName("streak"),t=this.node.getChildByName("streak1");e.active=!0,t.active=!0,this.state=T.leave},t}(w),R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=T.none,t.hoverTime=1,t}return __extends(t,e),t.prototype.updateAction=function(){this.id;switch(this.state){case T.none:return;case T.leave:this.target=cc.v2(600,100),this.node.rotation+=40;break;case T.back:this.target=o.POS[this.id],this.node.rotation=o.START_ROAT[this.id];break;case T.hover:return this.node.rotation+=40,this.hoverTime--,void(this.hoverTime<=0&&(this.hoverTime=1,this.state=T.back))}var e=this.target.x-this.node.x,t=this.target.y-this.node.y;if(Math.sqrt(e*e+t*t)<1){this.node.x=this.target.x,this.node.y=this.target.y,this.state==T.leave&&(this.state=T.back,this.node.getChildByName("light").active=!1)}else{var n=.15*e,a=.15*t;this.node.x+=n,this.node.y+=a}},t.prototype.execute=function(){h.AudioMgr.instance.playThrowDarts(),this.node.getChildByName("streak").active=!1,this.state=T.leave,this.node.getChildByName("light").active=!0},t}(w),P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colTrigger=!0,t}return __extends(t,e),t.prototype.execute=function(){c.default.instance.rigidBody.linearVelocity=cc.v2(-1500,0);var e=this.info.range;this.node.runAction(cc.sequence(cc.rotateTo(.02,180),cc.delayTime(.1),cc.rotateTo(.2,0)));var t=cc.instantiate(this.node.getComponent("weapon").gas);t.x=c.default.instance.node.x+100,t.y=c.default.instance.node.y,t.getComponent(cc.BoxCollider).size.height=300+40*e,s.default.instance.node.addChild(t,1e3,"hammer_gas");var o=100+30*e,n=.5+.1*e;n>1&&(n=1);var a=cc.moveBy(.3,o,0);a.easing(cc.easeIn(.3)),t.scale=.2,t.runAction(cc.sequence(cc.spawn(a,cc.scaleTo(.2,n)),cc.callFunc(function(){t.destroy()})))},t}(w),M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.updateAction=function(){this.updata_fly()},t.prototype.execute=function(){h.AudioMgr.instance.playThrowDarts();var e=this.info.throw_numb,o=s.default.instance.weaponPool[this.id];e>o.size()&&(e=o.size());for(var n=0;n<e;++n){var a=s.default.instance.weaponPool[this.id].get();if(null==a)return;null==a.getComponent(y)&&(a.addComponent(t),a.getComponent(y).setInfo()),a.scale=.7,a.getChildByName("image").rotation=0;var i=c.default.instance.node.getPosition();if(a.setPosition(i.x-5,i.y+10),s.default.instance.node.addChild(a),a.getComponent(t).isFly=!0,a.getComponent(t).fly_speed=40,e%2==0){a.getComponent(t).fly_speed_y=3*(n-(e-1)/2);var r=Math.abs(n-(e-1)/2);a.getComponent(t).fly_speed-=3*r}else{a.getComponent(t).fly_speed_y=3*(n-Math.floor(e/2));r=Math.abs(n-Math.floor(e/2));a.getComponent(t).fly_speed-=3*r}}},t.prototype.onCollisionEnter=function(e,t){if(e.tag==l.G.Game.enemyTag||e.tag==l.G.Game.tntTag){var o=c.default.instance.currentWeapon.getComponent("weapon").info,n=null;e.tag==l.G.Game.enemyTag&&(n=e.node);var a=s.default.instance.weaponPool[this.id];null!=a&&a.put(t.node),c.default.instance.currentWeapon.getComponent("weapon").cur_count++,null!=n&&n.getComponent(u.commonAct).damage(o.hurt,d.ExplodeType.bat)}},t}(v),B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.colTrigger=!0,t}return __extends(t,e),t.prototype.execute=function(){c.default.instance.rigidBody.linearVelocity=cc.v2(-1500,0);this.info.range;this.node.runAction(cc.sequence(cc.rotateTo(.02,180),cc.delayTime(.1),cc.rotateTo(.2,0)))},t}(w);cc._RF.pop()},{"./../game_scene":"game_scene","./../util/audio_mgr":"audio_mgr","./../util/global_def":"global_def","./enemy":"enemy","./explode":"explode","./hero":"hero"}],windmill:[function(e,t,o){"use strict";cc._RF.push(t,"06fa3J+hEFH/IhLfuwi8YNn","windmill"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./hero"),a=e("./../game_logic"),i=e("../util/event_mgr"),r=e("./../util/global_def"),s=e("./../UI/enemy"),c=e("./explode"),l=cc._decorator,d=l.ccclass,h=l.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.turnplate=null,t.plates=[],t.isRun=!1,t}return __extends(t,e),t.prototype.run=function(){this.isRun=!0},t.prototype.onCollisionEnter=function(e,t){var o=e;e.tag==r.G.Game.enemyTag?(o.getComponent(s.commonAct).damage(100,c.ExplodeType.hit),a.default.instance.eventManager.addEvent(i.EventType.KTaskWindmill,this,{})):o.getComponent("entity").die(n.DieType.impact),a.default.instance.report(a.default.instance.rType.dieOfWindmill,1),r.G.reportToAld(r.G.Report.dieWind)},t.prototype.update=function(){this.isRun&&null!=this.turnplate&&(this.turnplate.rotation-=1.35)},__decorate([h(cc.Node)],t.prototype,"turnplate",void 0),__decorate([h([cc.Node])],t.prototype,"plates",void 0),t=__decorate([d],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../util/event_mgr":"event_mgr","./../UI/enemy":"enemy","./../game_logic":"game_logic","./../util/global_def":"global_def","./explode":"explode","./hero":"hero"}],wp_btn:[function(e,t,o){"use strict";cc._RF.push(t,"b6ee5Tn+FpEaqBTP01W04/0","wp_btn"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,i=n.property,r=e("./../game_scene"),s=e("./../util/global_def"),c=e("./hero"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.image=null,t.select=null,t.num_lable=null,t.num=0,t.wp_id=null,t.index=null,t.isUnlock=!1,t}return __extends(t,e),t.prototype.init=function(e,t){this.index=e,this.wp_id=t;var o=s.G.Game.wp_mark[t];this.image.spriteFrame=s.G.Game.getGRes(s.G.Game.GResType.WeaponTag,o),this.node.opacity=155},t.prototype.showState=function(e){this.select.active=e},t.prototype.unlock=function(){this.isUnlock=!0,this.node.opacity=255,this.num_lable.active=!0,this.num++,this.num_lable.getComponent(cc.Label).string=String(this.num)},t.prototype.onClickSelect=function(){if(this.isUnlock){this.set_select(),this.node.opacity=255,this.set_select(),r.default.instance.weaponLayer.getComponent("weaponLayer").showTip(this.wp_id);var e=c.default.instance.getComponent("hero").weapon_id[this.index];c.default.instance.setWeapon(e)}},t.prototype.set_select=function(){var e=r.default.instance.weaponLayer.getComponent("weaponLayer").weapon;for(var t in e){e[t].getComponent("wp_btn").showState(!1)}this.node.getComponent("wp_btn").showState(!0)},__decorate([i(cc.Sprite)],t.prototype,"image",void 0),__decorate([i(cc.Node)],t.prototype,"select",void 0),__decorate([i(cc.Node)],t.prototype,"num_lable",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"./../game_scene":"game_scene","./../util/global_def":"global_def","./hero":"hero"}],wx_util:[function(e,t,o){"use strict";cc._RF.push(t,"a9bfdIRbPpHdJAlWd+oXAuh","wx_util"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../game_logic"),a=e("./global_def"),i=e("./audio_mgr"),r=e("./structure/hd_map"),s=e("./network/http_req"),c=e("./../game_scene"),l=e("./../UI/load"),d=function(){function e(){}return e.fetchSdkInfo=function(){this.sdkInfo=wx.getSystemInfoSync(),1==n.default.instance.config.testServer&&(this.domain_="http://119.23.108.126:8900/comLogin")},e.compareVersionForWx=function(e,t){for(var o=e.split("."),n=t.split("."),a=Math.max(o.length,n.length);o.length<a;)o.push("0");for(;n.length<a;)n.push("0");for(var i=0;i<a;i++){var r=parseInt(o[i]),s=parseInt(n[i]);if(r>s)return 1;if(r<s)return-1}return 0},e.login=function(e,t,o,a){var i=this;void 0===o&&(o=!1),void 0===a&&(a=!1),o?this._login(e,t,a):wx.checkSession({success:function(e){console.log("check session succ",e),n.default.instance.readWxData(),console.log("read session key",n.default.instance.sessionKey)},fail:function(o){console.log("check session fail",o),i._login(e,t,a)},complete:function(e){}})},e._login=function(e,t,o){var i=this;void 0===o&&(o=!1),wx.login({success:function(r){a.G.console("login succ",1,r,o),r.code&&(i.loginCode=r.code,o?e&&e():wx.request({url:i.domain_+"/user/getSessionKey",data:{code:r.code,proName:n.default.instance.config.proName,choose:"1"},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(o){o.statusCode>=200&&o.statusCode<=400?(console.log("login request succ",o),e&&e(JSON.parse(o.data.res))):(console.log("login request fail",o),t&&t(o))},fail:function(e){console.log("login request complete fail",e)}}))},fail:function(e){console.log("login fail",e)},complete:function(e){}})},e.fetchUserInfo=function(t,o,n,i,r,s){var c=this;-1!=e.compareVersionForWx(this.sdkInfo.SDKVersion,"1.2.0")?wx.getSetting({success:function(l){if(l.authSetting["scope.userInfo"])wx.getUserInfo({withCredentials:!0,lang:"zh_CN",success:function(e){o&&o(e.userInfo),c._authLogin(e,n,i)},fail:function(e){a.G.console("get setting scope userInfo failed",1,e)},complete:function(e){}});else if(-1!=e.compareVersionForWx(c.sdkInfo.SDKVersion,"2.0.1")){var d=wx.createImage();d.src="res/raw-assets/resources/"+t+".png",d.onload=function(){var e=s;if(a.G.isEmptyObj(e)){var t=d.width,c=d.height;e={left:.5*this.sdkInfo.screenWidth-.5*t,top:.5*this.sdkInfo.screenHeight+120,width:t,height:c,color:"#ffffff",lineHeight:40,backgroundColor:"#ff0000",borderColor:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}}this._authentication(o,e,d.src,r,n,i)}.bind(c)}else e.modalDialog("\u5fae\u4fe1\u66f4\u65b0\u63d0\u793a","\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8f83\u4f4e\uff0c\u5efa\u8bae\u5347\u7ea7\u4ee5\u4fdd\u969c\u6e38\u620f\u4f53\u9a8c",function(){wx.exitMiniProgram({})},null,!1)},fail:function(e){},complete:function(e){}}):e.modalDialog("\u5fae\u4fe1\u66f4\u65b0\u63d0\u793a","\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u8bf7\u5347\u7ea7\u5df2\u4fdd\u969c\u6b63\u5e38\u6e38\u620f\u4f53\u9a8c",function(){wx.exitMiniProgram({})},null,!1)},e._authLogin=function(e,t,o){wx.request({url:this.domain_+"/user/auth",data:{encryptedData:e.encryptedData,iv:e.iv,code:this.loginCode,proName:n.default.instance.config.proName},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(e){e.statusCode>=200&&e.statusCode<=400?(console.log("_authLogin request succ",e),t&&t(e.data.res)):(console.log("_authLogin request fail",e),o&&o())},fail:function(e){console.log("_authLogin request complete fail",e)}})},e._authentication=function(e,t,o,n,i,r){var s=wx.createUserInfoButton({type:"image",text:"txt",image:o,style:t,withCredentials:!0,lang:"zh_CN"});s.show(),a.G.console("create button",1,s);var c=function(l){if(a.G.console("_authentication onTap",1,l),null==l.iv||null==l.encryptedData){a.G.console("cancel auth");var d=wx.createImage();d.src=o,d.onload=function(){var o=t;if(a.G.isEmptyObj(o)){var s=d.width,c=d.height;o={left:.5*this.sdkInfo.screenWidth-.5*s,top:.5*this.sdkInfo.screenHeight,width:s,height:c,color:"#ffffff",lineHeight:40,backgroundColor:"#ff0000",borderColor:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}}this._authentication(e,t,d.src,n,i,r)}.bind(this)}else e&&e(l.userInfo),this._authLogin(l,i,r),n&&n();s.offTap(c),s.destroy()}.bind(this);s.onTap(c)},e.uploadUserInfo=function(e,t,o,a,i,r){wx.request({url:this.domain_+"/user/updUser",data:{proName:n.default.instance.config.proName,openid:n.default.instance.openId,unionid:n.default.instance.unionId,nickname:e,gender:o,avatarurl:t,city:a,province:i,country:r},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(e){},fail:function(e){}})},e.showForward=function(e){wx.showShareMenu({withShareTicket:!1,success:function(e){},fail:function(){},complete:function(){}}),wx.onShareAppMessage(function(){var t=null;return e&&(t=e()),t})},e.shareNorm=function(e,t,o,n){wx.shareAppMessage({title:e,imageUrl:t,query:""}),this.normShareTimestamp=Date.now(),this.normShareSuccCallback=o,this.normShareFailCallback=n,this.commStatShare()},e.normShareResult=function(){this.normShareTimestamp>0&&(Date.now()-this.normShareTimestamp>=3500?this.normShareSuccCallback&&this.normShareSuccCallback():this.normShareFailCallback&&this.normShareFailCallback(),this.normShareTimestamp=0)},e._checkIfNotSameGroup=function(t){for(var o=!0,n=0;n<e.shareGroups.length;++n)if(e.shareGroups[n]==t){o=!1;break}return o},e.shareToDiffGroup=function(t,o,r,s,c){var l=this;wx.updateShareMenu({withShareTicket:!0,success:function(d){wx.shareAppMessage({title:t,imageUrl:o,query:r||"",success:function(t){if(console.log("share succ",t),i.AudioMgr.instance.replayMusic(),a.G.isExistObj(t.shareTickets))wx.getShareInfo({shareTicket:t.shareTickets[0],success:function(t){if(console.log("share info succ",t),n.default.instance.sessionKey&&""!=n.default.instance.sessionKey)wx.request({url:l.domain_+"/user/getOpenGid",data:{encryptedData:t.encryptedData,iv:t.iv,sessionKey:n.default.instance.sessionKey},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(t){if(console.log("getOpenGid request succ",t.data),a.G.isExistObj(t))if(e._checkIfNotSameGroup(t.data.res))a.G.isExistObj(s)&&s(),e.shareGroups.push(t.data.res),e.shareGroups.length>=5&&(e.shareGroups.shift(),n.default.instance.shareGroupDate=Date.now()),n.default.instance.saveWxData();else{var o=cc.find("Canvas/Tips");a.G.isExistObj(o)&&o.getComponent("Tips").display("\u8bf7\u4e0d\u8981\u9891\u7e41\u6253\u6270\u540c\u4e00\u4e2a\u7fa4")}},fail:function(e){console.log("getOpenGid request fail",e.data)}});else{e.login(function(e){n.default.instance.sessionKey=e.data.res,console.log("relogin session key",n.default.instance.sessionKey)},null,!0);var o=cc.find("Canvas/Tips");a.G.isExistObj(o)&&o.getComponent("Tips").display("\u53d1\u9001\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}},fail:function(e){console.log("share info fail",e)},complete:function(e){}});else{var o=cc.find("Canvas/Tips");a.G.isExistObj(o)&&o.getComponent("Tips").display("\u8bf7\u53d1\u9001\u5230\u5fae\u4fe1\u7fa4\u9886\u53d6\u5956\u52b1")}},fail:function(){console.log("share fail"),i.AudioMgr.instance.replayMusic(),c&&c()},complete:function(){}})},fail:function(e){var t=cc.find("Canvas/Tips");a.G.isExistObj(t)&&t.getComponent("Tips").display("\u53d1\u9001\u7cfb\u7edf\u51fa\u73b0\u4e86\u95ee\u9898\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")},complete:function(e){}})},e.invitePeriod=function(t,o,i,r,s){void 0===s&&(s=1),o>0&&++this.queryCardId_;var c=function(){wx.request({url:this.domain_+"/invite/invitePeriod",data:{proName:n.default.instance.config.proName,token:t,openId:n.default.instance.openId,resetPeriod:o,cardId:this.queryCardId_,choose:s.toString()},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(e){console.log("invitePeriod request succ",e.data,t,o),e.statusCode>=200&&e.statusCode<=400?i&&i(JSON.parse(e.data.res)):r&&r()},fail:function(e){console.log("invitePeriod request fail",e.data)}})}.bind(this);""==n.default.instance.openId?e.login(function(e){n.default.instance.sessionKey=e.sessionKey,n.default.instance.openId=e.openId,c(),a.G.console("invitePeriod relogin",1,e)},null,!0):c()},e.invitePeriodUnion=function(e,t,o,i,r,s){void 0===s&&(s=1),t>0&&++this.queryCardId_;var c=function(){wx.request({url:this.domain_+"/invite/invitePeriodU",data:{proName:n.default.instance.config.proName,token:e,unionId:n.default.instance.unionId,resetPeriod:t,cardId:this.queryCardId_,choose:s.toString()},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(n){console.log("invitePeriodUnion request succ",n.data,e,t),n.statusCode>=200&&n.statusCode<=400?o&&o(JSON.parse(n.data.res)):i&&i()},fail:function(e){console.log("invitePeriodUnion request fail",e.data)}})}.bind(this);""==n.default.instance.unionId?a.G.console("invitePeriodUnion no unionID"):c()},e.inviteFriend=function(e,t,o,n){var r="token="+o+"&id="+n+"&cardId="+this.queryCardId_;a.G.console("invite",1,r,e,t),wx.shareAppMessage({title:e,imageUrl:t,query:r,success:function(e){a.G.console("share succ",1,e),i.AudioMgr.instance.replayMusic()},fail:function(){a.G.console("share fail"),i.AudioMgr.instance.replayMusic()},complete:function(){}})},e.checkInvitation=function(t,o){var i=function(){wx.request({url:this.domain_+"/invite/checkInvitation",data:{proName:n.default.instance.config.proName,token:t,openId:n.default.instance.openId},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(e){console.log("checkInvitation request succ",e.data,t),e.statusCode>=200&&e.statusCode<=400&&o&&o(JSON.parse(e.data.res))},fail:function(e){console.log("checkInvitation request fail",e.data)}})}.bind(this);""==n.default.instance.openId?e.login(function(e){n.default.instance.sessionKey=e.sessionKey,n.default.instance.openId=e.openId,i(),a.G.console("agreeInvitation relogin",1,e)},null,!0):i()},e.checkInvitationUnion=function(e,t,o){var i=function(){wx.request({url:this.domain_+"/invite/checkInvitationU",data:{proName:n.default.instance.config.proName,token:e,unionId:n.default.instance.unionId},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(e){console.log("checkInvitationUnion request succ",e.data),e.statusCode>=200&&e.statusCode<=400&&t&&t(JSON.parse(e.data.res))},fail:function(e){console.log("checkInvitationUnion request fail",e.data)}})}.bind(this);""==n.default.instance.unionId?(a.G.console("checkInvitationUnion no unionID"),o&&o()):i()},e.launchInvitationCheck=function(e,t){void 0===t&&(t=!1);var o=wx.getLaunchOptionsSync();a.G.isExistObj(o.query)&&""!=o.query.id&&""!=o.query.token&&(a.G.console("launchInvitationCheck",1,o),""!=o.query.snk&&this.commStatShareSucc(),""!=o.query.id&&""!=o.query.token&&(t?o.query.id!=n.default.instance.unionId?this.agreeInvitationUnion(o.query.id,o.query.token,o.query.cardId,e):a.G.console("launchInvitationCheck self"):o.query.id!=n.default.instance.openId?this.agreeInvitation(o.query.id,o.query.token,o.query.cardId,e):a.G.console("launchInvitationCheck self")))},e.onShowInvitationCheck=function(e,t,o){void 0===o&&(o=!1),a.G.isExistObj(e)&&""!=e.id&&""!=e.token&&(a.G.console("onShowInvitationCheck",1,e),o?e.id!=n.default.instance.unionId?this.agreeInvitationUnion(e.id,e.token,e.cardId,t):a.G.console("onShowInvitationCheck self"):e.id!=n.default.instance.openId?this.agreeInvitation(e.id,e.token,e.cardId,t):a.G.console("onShowInvitationCheck self"))},e.agreeInvitation=function(t,o,i,r){var s=function(){wx.request({url:this.domain_+"/invite/agreeInvition",data:{proName:n.default.instance.config.proName,senderId:t,token:o,cardId:i,openId:n.default.instance.openId},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(e){console.log("agreeInvition request succ",e.data),e.statusCode>=200&&e.statusCode<=400&&r&&r(parseInt(e.data.res))},fail:function(e){console.log("agreeInvition request fail",e.data)}})}.bind(this);""==n.default.instance.openId?e.login(function(e){n.default.instance.sessionKey=e.sessionKey,n.default.instance.openId=e.openId,s(),a.G.console("agreeInvitation relogin",1,e)},null,!0):s()},e.agreeInvitationUnion=function(e,t,o,i,r){var s=function(){wx.request({url:this.domain_+"/invite/agreeInvitionU",data:{proName:n.default.instance.config.proName,senderId:e,token:t,cardId:o,unionId:n.default.instance.unionId},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(e){console.log("agreeInvitationUnion request succ",e.data),e.statusCode>=200&&e.statusCode<=400&&i&&i(parseInt(e.data.res))},fail:function(e){console.log("agreeInvitationUnion request fail",e.data)}})}.bind(this);""==n.default.instance.unionId?(a.G.console("agreeInvitationUnion no unionID"),r&&r()):s()},e.funcSwitch=function(e,t,o){void 0===o&&(o=1),wx.request({url:this.domain_+"/user/shareOpen",data:{proName:n.default.instance.config.proName,choose:o},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(t){if(t.statusCode>=200&&t.statusCode<=400){console.log("funcSwitch request succ",t);var o=parseInt(t.data.res);e&&e(o)}else console.log("funcSwitch request fail",t)},fail:function(e){console.log("funcSwitch request fail",e),t&&t(e)}})},e.reqTimerReset=function(t,o,i){var r=function(){wx.request({url:this.domain_+"/user/reqTimerReset",data:{proName:n.default.instance.config.proName,sysName:t,openId:n.default.instance.openId,choose:o.toString()},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(t){if(t.statusCode>=200&&t.statusCode<=400){console.log("reqTimerReset request succ",t);var o=parseInt(t.data.res);i&&i(o)}else console.log("reqTimerReset request fail",t),e.modalDialog("\u7f51\u7edc\u62a5\u544a","\u5f53\u524d\u7f51\u7edc\u73af\u5883\u4e0d\u4f73\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u540e\u91cd\u8bd5")},fail:function(e){console.log("reqTimerReset request fail",e)}})}.bind(this);""==n.default.instance.openId?e.login(function(e){n.default.instance.sessionKey=e.sessionKey,n.default.instance.openId=e.openId,r(),a.G.console("reqTimerReset relogin",1,e)},null,!0):r()},e.reqTimerResetUnion=function(e,t,o,a){var i=function(){wx.request({url:this.domain_+"/user/reqTimerResetU",data:{proName:n.default.instance.config.proName,sysName:e,unionId:n.default.instance.unionId,choose:t.toString()},header:{"content-type":"application/json"},method:"GET",dataType:"json",success:function(e){if(e.statusCode>=200&&e.statusCode<=400){console.log("reqTimerResetUnion request succ",e);var t=parseInt(e.data.res);o&&o(t)}else console.log("reqTimerResetUnion request fail",e)},fail:function(e){console.log("reqTimerResetUnion request complete fail",e)}})}.bind(this);""==n.default.instance.unionId?a&&a():i()},e.updateAdsRequestTimer=function(e){this.adsRequestTimer-=e},e.preloadVideoAds=function(e){var t=this;if(!this.videoAdsBuffer.containsKey(e)){var o=wx.createRewardedVideoAd({adUnitId:e});o.load().then(function(){t.videoAdsBuffer.put(e,o),console.log("preload ad succ")}).catch(function(e){return console.log(e.errMsg)}),o.onError(function(e){console.log("preload ad err",e)})}},e.watchVideoAds=function(t,o,r,s,d,h,u){void 0===u&&(u=!0);var p=function(){e.isLookVideo=!0,wx.showModal({title:"",content:"\u2193\u2193\u2193\u70b9\u51fb\u4e0b\u65b9\u7eff\u8272\u6309\u94ae\u83b7\u5f97100\u7687\u51a0",showCancel:!0,success:function(){}})};if(console.log("\u89c2\u770b\u89c6\u9891"+t),e.adCurID=t,e.adSwitch=!0,!(this.adsRequestTimer>0)){this.adsRequestTimer=5;var f=e.sdkInfo;if(console.log(f.SDKVersion),-1!=e.compareVersionForWx(f.SDKVersion,"2.1.0")){e.videoAd=this.videoAdsBuffer.get(t),e.videoAd?(e.videoAd.show(),this.videoAdsBuffer.remove(t),e.videoAdCallbackProctectFlag=0,e.commStatAdWatch(),console.log("watch ads preloaded")):(e.videoAd=wx.createRewardedVideoAd({adUnitId:t}),e.videoAd.load().then(function(){e.videoAd.show(),0==n.default.instance.ip_switch&&a.G.randRange(0,100)<n.default.instance.showWindowNum&&n.default.instance.scheduleOnce(p,6),e.videoAdCallbackProctectFlag=0,e.commStatAdWatch()}).catch(function(e){return console.log(e.errMsg)}));var m=!1;for(var _ in e.adFunManager){(g=e.adFunManager[_]).unitID==t&&(m=!0,g.closeCbSuc=o,g.closeCbFail=r,console.log("\u8986\u76d6\u56de\u8c03"))}if(0==m){var g={unitID:t,closeCbSuc:o,closeCbFail:r};e.adFunManager.push(g),console.log("\u6ce8\u518c\u56de\u8c03")}e.videoAd.onClose(function(t){if(1!==e.videoAdCallbackProctectFlag){if(console.log("Ads Close callback",t.isEnded),i.AudioMgr.instance.resumeMusic(),e.isLookVideo=!1,e.onClickVideoHide){console.log("\u7ed950\u7687\u51a0"),e.onClickVideoHide=!1;var s=l.default.instance;s.node||(s=c.default.instance),s.showTip("\u606d\u559c\u83b7\u5f97\u7687\u51a0:50"),s.updateWealth(c.WealthType.crown,50,!0)}else console.log("\u89c6\u9891\u6ca1\u6709\u70b9\u51fb\u5e95\u90e8");if(t.isEnded){if(o)for(var d in e.adFunManager)if((u=e.adFunManager[d]).unitID==e.adCurID&&e.adSwitch){u.closeCbSuc(),e.adSwitch=!1,console.log("\u6210\u529f\u6267\u884c\u56de\u8c03"+u.unitID+"123"+e.adCurID);break}e.commStatAdWatchSucc()}else{var h=cc.find("Canvas/Tips");if(a.G.isExistObj(h)&&h.getComponent("Tips").display("\u8bf7\u89c2\u770b\u5b8c\u6574\u89c6\u9891"),n.default.instance.unschedule(p),r)for(var d in e.adFunManager){var u;if((u=e.adFunManager[d]).unitID==e.adCurID&&e.adSwitch){u.closeCbFail(),e.adSwitch=!1,console.log("\u5931\u8d25\u6267\u884c\u56de\u8c03"+u.unitID+"123"+e.adCurID);break}}}e.adsRequestTimer=0,e.videoAd.offClose(),e.videoAdCallbackProctectFlag=1}}),e.videoAd.onLoad(function(t){console.log("Ads load callback",t),h&&h(),e.videoAd.offLoad()}),e.videoAd.onError(function(t){console.log("Ads error callback",t.errMsg),e.adsRequestTimer=0,s&&s(t),e.videoAd.offError()}),d&&d(),i.AudioMgr.instance.pauseMusic()}else e.modalDialog("\u63d0\u793a","\u5fae\u4fe1\u7248\u672c\u8f83\u4f4e\uff0c\u6682\u4e0d\u652f\u6301\u89c6\u9891\u89c2\u770b",null,null,!1)}},e._calBannerPos=function(e,t,o){void 0===o&&(o=1);var n=this.sdkInfo.screenWidth;e&&(n=e);var a=120*(n/300),i=0;if(t){var r=cc.view.getVisibleSize().height,s=t.convertToWorldSpaceAR(cc.Vec2.ZERO),c=t.height*t.anchorY,l=(r-s.y+c)/r;i=this.sdkInfo.screenHeight*l,console.log("addBanner node",t,l,s.y,c,r-s.y,r,i,this.sdkInfo.screenHeight)}else i=this.sdkInfo.screenHeight-a,0==o&&(i=0);return{x:.5*this.sdkInfo.screenWidth-.5*n,y:i,w:n,h:a}},e.createInterstitialAd=function(){wx.createInterstitialAd&&(e.interstitialAd=wx.createInterstitialAd({adUnitId:"adunit-3c0f0b113a118210"}))},e.showInterstitialAd=function(){e.interstitialAd&&e.interstitialAd.show().catch(function(e){console.error(e)})},e.addBanner=function(t,o,i,r,s,c,l){var d=this;if(void 0===r&&(r=1),void 0===s&&(s=!1),void 0===c&&(c=""),void 0===l&&(l=null),-1!=e.compareVersionForWx(this.sdkInfo.SDKVersion,"2.0.4")){""!==c&&(this.bannerPreservedMap_.put(t,c),this.preservedIdMap_.put(c,1),null!=l&&this.preservedFailCbMap_.put(c,l));var h=this.replacedIdMap_.get(t);null!=h&&(t=h,a.G.console("replace banner id",1,h));var u=this.bannerRefreshCntMap_.get(t)||0;if(console.log("banner refresh cnt",u,t),u>0){this.bannerAd_&&(this.bannerAd_.hide(),this.bannerAd_=null),this.bannerId_=t;var p=!0;if(i&&this.bannerRuleMap_.containsKey(i.name)?this.bannerAd_=this.bannerRuleMap_.get(i.name):null==i&&this.bannerNormMap_.containsKey(t)?this.bannerAd_=this.bannerNormMap_.get(t):(p=!1,console.log("banner no buffer")),p&&!s)return this.bannerAd_.show().then(function(e){console.log("banner show",t)}).catch(function(e){console.log("banner show err",t,e),d.bannerRefreshCntMap_.put(t,--u)}),void this.bannerRefreshCntMap_.put(t,--u);if(s)return}else u=n.default.instance.bannerIntervalCount;this.bannerRefreshCntMap_.put(t,--u),i&&i.name&&this.bannerRuleMap_.containsKey(i.name)?(this.bannerAd_=this.bannerRuleMap_.get(i.name),this.delBanner(!0),this.bannerRuleMap_.remove(i.name)):null==i&&this.bannerNormMap_.containsKey(t)&&(this.bannerAd_=this.bannerNormMap_.get(t),this.delBanner(!0),this.bannerNormMap_.remove(t));var f=this._calBannerPos(o,i,r),m=wx.createBannerAd({adUnitId:t,style:{left:f.x,top:f.y,width:f.w,height:f.h}});this.bannerAd_=m,s||this.bannerAd_.show().then(function(e){console.log("new banner show",t)}).catch(function(e){console.log("banner show err",e),d.bannerRefreshCntMap_.put(t,--u)});var _=function(n){if(a.G.console("Banner Ads pull failed",3,n),null!=this.bannerAd_&&this.bannerAd_.offError(),this.bannerRefreshCntMap_.put(t,--u),this.preservedIdMap_.containsKey(t)){var c=this.preservedFailCbMap_.get(t);c&&(c(),a.G.console("preserved banner load failed callback"))}else if(this.bannerPreservedMap_.containsKey(t)){var l=this.bannerPreservedMap_.get(t);e.addBanner(l,o,i,r,s),this.replacedIdMap_.put(t,l),a.G.console("preserved banner add",1,l)}}.bind(this);this.bannerAd_.onError(_),i?this.bannerRuleMap_.put(i.name,m):this.bannerNormMap_.put(t,m),console.log("add banner")}},e.addBanListener=function(){},e.delBanner=function(e){void 0===e&&(e=!1),this.bannerAd_&&(e?(console.log("del banner",this.bannerAd_),this.bannerAd_.destroy(),this.bannerAd_=null):(this.bannerAd_.hide(),console.log("hide banner")))},e.clearBanner=function(){this.bannerNormMap_.clear(),this.bannerRuleMap_.clear(),this.delBanner(!0),console.log("clear all banner")},e.checkVersionUpdate=function(t,o){var n=e.sdkInfo;if(-1!=e.compareVersionForWx(n.SDKVersion,"1.9.90")){var i=n.system;if(-1!==i.indexOf("Android")){var r=i.substr(7).trim();if(-1==e.compareVersionForWx(r,"6.6.7"))return a.G.console("skip update cause the system version is too low",1,r),void(o&&o())}a.G.console("check version update",n.system);var s=wx.getUpdateManager();s.onCheckForUpdate(function(e){console.log(e.hasUpdate),e.hasUpdate?t&&t():o&&o()}),s.onUpdateReady(function(){e.modalDialog("\u66f4\u65b0\u63d0\u793a","\u65b0\u7248\u672c\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u8bf7\u91cd\u542f\u6e38\u620f",function(){s.applyUpdate()},null,!1)}),s.onUpdateFailed(function(){e.modalDialog("\u66f4\u65b0\u63d0\u793a","\u65b0\u7248\u672c\u4e0b\u8f7d\u5931\u8d25\uff0c\u8bf7\u786e\u8ba4\u7f51\u7edc\u73af\u5883\u662f\u5426\u826f\u597d\u6216\u8005\u91cd\u542f\u5fae\u4fe1",function(){wx.exitMiniProgram({})},null,!1)})}else e.modalDialog("\u5fae\u4fe1\u66f4\u65b0\u63d0\u793a","\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8f83\u4f4e\uff0c\u5efa\u8bae\u5347\u7ea7\u4ee5\u4fdd\u969c\u6e38\u620f\u4f53\u9a8c",null,null,!1),o&&o()},e.modalDialog=function(e,t,o,n,a,i,r,s,c){void 0===a&&(a=!0),void 0===i&&(i="\u53d6\u6d88"),void 0===r&&(r="#000000"),void 0===s&&(s="\u786e\u5b9a"),void 0===c&&(c="#3cc51f"),wx.showModal({title:e,content:t,showCancel:a,cancelText:i,cancelColor:r,confirmText:s,confirmColor:c,success:function(e){e.confirm?o&&o():e.cancel&&n&&n()}})},e.showGameClub=function(t,o,n,a){-1!=e.compareVersionForWx(this.sdkInfo.SDKVersion,"2.0.3")&&(null==this.gameClub_&&(this.gameClub_=wx.createGameClubButton({type:"image",text:"",image:"",style:{left:t,top:o,width:n,height:a},icon:"dark"})),this.gameClub_.show())},e.hideGameClub=function(){a.G.isExistObj(this.gameClub_)&&this.gameClub_.hide()},e.removeGameClub=function(){a.G.isExistObj(this.gameClub_)&&(this.gameClub_.destroy(),this.gameClub_=null)},e.commStatShare=function(){""!==n.default.instance.gameId&&(s.default.updateStatistic(n.default.instance.gameId,"shareCnt",1),console.log("share stat"))},e.commStatShareSucc=function(){""!==n.default.instance.gameId&&0===this.shareSuccUpload&&(s.default.updateStatistic(n.default.instance.gameId,"shareSuccCnt",1),console.log("share succ stat"),this.shareSuccUpload=1,n.default.instance.saveWxData())},e.commStatAdWatch=function(){""!==n.default.instance.gameId&&(s.default.updateStatistic(n.default.instance.gameId,"adWatchedCnt",1),console.log("ad watch stat"))},e.commStatAdWatchSucc=function(){""!==n.default.instance.gameId&&(s.default.updateStatistic(n.default.instance.gameId,"adWatchedSuccCnt",1),console.log("ad watch succ stat"))},e.sdkInfo=null,e.domain_="https://login.joyfulh.com/comLogin",e.loginCode="",e.normShareTimestamp=0,e.normShareSuccCallback=null,e.normShareFailCallback=null,e.shareGroups=[],e.queryCardId_=0,e.adsRequestTimer=0,e.videoAdsBuffer=new r.default,e.videoAd=null,e.videoAdCallbackProctectFlag=0,e.adFunManager=[],e.adSwitch=!1,e.adCurID="",e.isLookVideo=!1,e.onClickVideoHide=!1,e.bannerAd_=null,e.bannerId_="",e.bannerRuleMap_=new r.default,e.bannerNormMap_=new r.default,e.bannerPreservedMap_=new r.default,e.preservedFailCbMap_=new r.default,e.preservedIdMap_=new r.default,e.replacedIdMap_=new r.default,e.bannerRefreshCntMap_=new r.default,e.kBannerRefreshCnt=5,e.interstitialAd=null,e.gameClub_=null,e.shareSuccUpload=0,e}();o.default=d,cc._RF.pop()},{"../game_logic":"game_logic","./../UI/load":"load","./../game_scene":"game_scene","./audio_mgr":"audio_mgr","./global_def":"global_def","./network/http_req":"http_req","./structure/hd_map":"hd_map"}]},{},["ALConfig","ALData","ALGameBox","ALGameDrawer","ALGameMore","ALGuessLike","ALGuessLikeV","ALHelpBar","ALIconNode","ALIntercept","ALReport","ALSDK","AladinSDK","UITableView","ALUtil","HttpUtil","ImgLoaderUtil","StringUtil","UIUtil","Boss","BoxLayer","BoxShowLayer","Rank","RankLayer","aceHeroLayer","balloon","begin","box","brick","brickExplode","bridge","dial","dialAward","door","effectManager","endLayer","enemy","entity","explode","fence","floor","gear","getPetLayer","getSkillLayer","hatMenu","helmet","hero","load","magma_node","myCoin","newAwardLayer","openTask","pet","petLayer","petTrialLayer","pet_arrow","pet_sword","pet_wp","bubble_txt","coin","dialog","game_nav","guide","tips","resurgAni","road","signLayer","skinHero","skinLayer","skinPet","task","taskLayer","taskShow","tipWind","tipWindow","tnt","tower","towerCard","towerContent","towerLayer","trialLayer","unlock","vision_road","weapon","weaponLayer","windmill","wp_btn","task_data","endlessLayer","game","game_logic","game_scene","hell_scene","main_scene","audio_mgr","afterImage ","shaker","ui_motion","event_mgr","global_def","http_req","shader_com","shader_lab","shader_material","shader_mgr","shader_hue","statistic_tool","storage","hd_map","wx_util"]);